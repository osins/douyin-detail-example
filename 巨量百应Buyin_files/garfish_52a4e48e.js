var sr=(l,n,o)=>new Promise((c,h)=>{var g=O=>{try{y(o.next(O))}catch(M){h(M)}},b=O=>{try{y(o.throw(O))}catch(M){h(M)}},y=O=>O.done?c(O.value):Promise.resolve(O.value).then(g,b);y((o=o.apply(l,n)).next())});/*!
* @ies/filter-xss v3.0.15
* (c) 2023
*/(function(l,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):n((l=typeof globalThis!="undefined"?globalThis:l||self).xss={})})(this,function(l){"use strict";var n=function(){return n=Object.assign||function(m){for(var E,F=1,re=arguments.length;F<re;F++)for(var Ee in E=arguments[F])Object.prototype.hasOwnProperty.call(E,Ee)&&(m[Ee]=E[Ee]);return m},n.apply(this,arguments)};function o(m,E,F){if(F||arguments.length===2)for(var re,Ee=0,Se=E.length;Ee<Se;Ee++)!re&&Ee in E||(re||(re=Array.prototype.slice.call(E,0,Ee)),re[Ee]=E[Ee]);return m.concat(re||Array.prototype.slice.call(E))}var c={exports:{}},h={},g={exports:{}},b={};function y(){var m={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1};return m}var O=/javascript\s*\:/gim;b.whiteList=y(),b.getDefaultWhiteList=y,b.onAttr=function(m,E,F){},b.onIgnoreAttr=function(m,E,F){},b.safeAttrValue=function(m,E){return O.test(E)?"":E};var M={indexOf:function(m,E){var F,re;if(Array.prototype.indexOf)return m.indexOf(E);for(F=0,re=m.length;F<re;F++)if(m[F]===E)return F;return-1},forEach:function(m,E,F){var re,Ee;if(Array.prototype.forEach)return m.forEach(E,F);for(re=0,Ee=m.length;re<Ee;re++)E.call(F,m[re],re,m)},trim:function(m){return String.prototype.trim?m.trim():m.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(m){return String.prototype.trimRight?m.trimRight():m.replace(/(\s*$)/g,"")}},G=M,le=function(m,E){(m=G.trimRight(m))[m.length-1]!==";"&&(m+=";");var F=m.length,re=!1,Ee=0,Se=0,ze="";function et(){if(!re){var lr=G.trim(m.slice(Ee,Se)),At=lr.indexOf(":");if(At!==-1){var Qt=G.trim(lr.slice(0,At)),fr=G.trim(lr.slice(At+1));if(Qt){var dr=E(Ee,ze.length,Qt,fr,lr);dr&&(ze+=dr+"; ")}}}Ee=Se+1}for(;Se<F;Se++){var kt=m[Se];if(kt==="/"&&m[Se+1]==="*"){var ir=m.indexOf("*/",Se+2);if(ir===-1)break;Ee=(Se=ir+1)+1,re=!1}else kt==="("?re=!0:kt===")"?re=!1:kt===";"?re||et():kt===`
`&&et()}return G.trim(ze)},Pe=b,Ce=le;function De(m){return m==null}function Ae(m){(m=function(E){var F={};for(var re in E)F[re]=E[re];return F}(m||{})).whiteList=m.whiteList||Pe.whiteList,m.onAttr=m.onAttr||Pe.onAttr,m.onIgnoreAttr=m.onIgnoreAttr||Pe.onIgnoreAttr,m.safeAttrValue=m.safeAttrValue||Pe.safeAttrValue,this.options=m}Ae.prototype.process=function(m){if(!(m=(m=m||"").toString()))return"";var E=this.options,F=E.whiteList,re=E.onAttr,Ee=E.onIgnoreAttr,Se=E.safeAttrValue;return Ce(m,function(ze,et,kt,ir,lr){var At=F[kt],Qt=!1;if(At===!0?Qt=At:typeof At=="function"?Qt=At(ir):At instanceof RegExp&&(Qt=At.test(ir)),Qt!==!0&&(Qt=!1),ir=Se(kt,ir)){var fr,dr={position:et,sourcePosition:ze,source:lr,isWhite:Qt};return Qt?De(fr=re(kt,ir,dr))?kt+":"+ir:fr:De(fr=Ee(kt,ir,dr))?void 0:fr}})};var ge=Ae;(function(m,E){var F=b,re=ge;for(var Ee in(E=m.exports=function(Se,ze){return new re(ze).process(Se)}).FilterCSS=re,F)E[Ee]=F[Ee];typeof window!="undefined"&&(window.filterCSS=m.exports)})(g,g.exports);var Te={indexOf:function(m,E){var F,re;if(Array.prototype.indexOf)return m.indexOf(E);for(F=0,re=m.length;F<re;F++)if(m[F]===E)return F;return-1},forEach:function(m,E,F){var re,Ee;if(Array.prototype.forEach)return m.forEach(E,F);for(re=0,Ee=m.length;re<Ee;re++)E.call(F,m[re],re,m)},trim:function(m){return String.prototype.trim?m.trim():m.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(m){var E=/\s|\n|\t/.exec(m);return E?E.index:-1}},ce=g.exports.FilterCSS,x=g.exports.getDefaultWhiteList,P=Te;function $(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var he=new ce;function ye(m){return m.replace(Re,"&lt;").replace(He,"&gt;")}var Re=/</g,He=/>/g,we=/"/g,fe=/&quot;/g,K=/&#([a-zA-Z0-9]*);?/gim,I=/&colon;?/gim,k=/&newline;?/gim,se=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,pe=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Je=/u\s*r\s*l\s*\(.*/gi;function me(m){return m.replace(we,"&quot;")}function Ne(m){return m.replace(fe,'"')}function ne(m){return m.replace(K,function(E,F){return F[0]==="x"||F[0]==="X"?String.fromCharCode(parseInt(F.substr(1),16)):String.fromCharCode(parseInt(F,10))})}function $e(m){return m.replace(I,":").replace(k," ")}function Oe(m){for(var E="",F=0,re=m.length;F<re;F++)E+=m.charCodeAt(F)<32?" ":m.charAt(F);return P.trim(E)}function je(m){return m=Oe(m=$e(m=ne(m=Ne(m))))}function vt(m){return m=ye(m=me(m))}h.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},h.getDefaultWhiteList=$,h.onTag=function(m,E,F){},h.onIgnoreTag=function(m,E,F){},h.onTagAttr=function(m,E,F){},h.onIgnoreTagAttr=function(m,E,F){},h.safeAttrValue=function(m,E,F,re){if(F=je(F),E==="href"||E==="src"){if((F=P.trim(F))==="#")return"#";if(F.substr(0,7)!=="http://"&&F.substr(0,8)!=="https://"&&F.substr(0,7)!=="mailto:"&&F.substr(0,4)!=="tel:"&&F.substr(0,11)!=="data:image/"&&F.substr(0,6)!=="ftp://"&&F.substr(0,2)!=="./"&&F.substr(0,3)!=="../"&&F[0]!=="#"&&F[0]!=="/")return""}else if(E==="background"){if(se.lastIndex=0,se.test(F))return""}else if(E==="style"){if(pe.lastIndex=0,pe.test(F)||(Je.lastIndex=0,Je.test(F)&&(se.lastIndex=0,se.test(F))))return"";re!==!1&&(F=(re=re||he).process(F))}return F=vt(F)},h.escapeHtml=ye,h.escapeQuote=me,h.unescapeQuote=Ne,h.escapeHtmlEntities=ne,h.escapeDangerHtml5Entities=$e,h.clearNonPrintableCharacter=Oe,h.friendlyAttrValue=je,h.escapeAttrValue=vt,h.onIgnoreTagStripAll=function(){return""},h.StripTagBody=function(m,E){typeof E!="function"&&(E=function(){});var F=!Array.isArray(m),re=[],Ee=!1;return{onIgnoreTag:function(Se,ze,et){if(function(lr){return!!F||P.indexOf(m,lr)!==-1}(Se)){if(et.isClosing){var kt="[/removed]",ir=et.position+kt.length;return re.push([Ee!==!1?Ee:et.position,ir]),Ee=!1,kt}return Ee||(Ee=et.position),"[removed]"}return E(Se,ze,et)},remove:function(Se){var ze="",et=0;return P.forEach(re,function(kt){ze+=Se.slice(et,kt[0]),et=kt[1]}),ze+=Se.slice(et)}}},h.stripCommentTag=function(m){for(var E="",F=0;F<m.length;){var re=m.indexOf("<!--",F);if(re===-1){E+=m.slice(F);break}E+=m.slice(F,re);var Ee=m.indexOf("-->",re);if(Ee===-1)break;F=Ee+3}return E},h.stripBlankChar=function(m){var E=m.split("");return(E=E.filter(function(F){var re=F.charCodeAt(0);return re!==127&&(!(re<=31)||re===10||re===13)})).join("")},h.cssFilter=he,h.getDefaultCSSWhiteList=x;var Rt={},_t=Te;function Xe(m){var E,F=_t.spaceIndex(m);return E=F===-1?m.slice(1,-1):m.slice(1,F+1),(E=_t.trim(E).toLowerCase()).slice(0,1)==="/"&&(E=E.slice(1)),E.slice(-1)==="/"&&(E=E.slice(0,-1)),E}function ut(m){return m.slice(0,2)==="</"}var yt=/[^a-zA-Z0-9\\_:.-]/gim;function Bt(m,E){for(;E<m.length;E++){var F=m[E];if(F!==" ")return F==="="?E:-1}}function ar(m,E){for(;E<m.length;E++){var F=m[E];if(F!==" ")return F==="'"||F==='"'?E:-1}}function Et(m,E){for(;E>0;E--){var F=m[E];if(F!==" ")return F==="="?E:-1}}function Zt(m){return function(E){return E[0]==='"'&&E[E.length-1]==='"'||E[0]==="'"&&E[E.length-1]==="'"}(m)?m.substr(1,m.length-2):m}Rt.parseTag=function(m,E,F){var re="",Ee=0,Se=!1,ze=!1,et=0,kt=m.length,ir="",lr="";e:for(et=0;et<kt;et++){var At=m.charAt(et);if(Se===!1){if(At==="<"){Se=et;continue}}else if(ze===!1){if(At==="<"){re+=F(m.slice(Ee,et)),Se=et,Ee=et;continue}if(At===">"||et===kt-1){re+=F(m.slice(Ee,Se)),ir=Xe(lr=m.slice(Se,et+1)),re+=E(Se,re.length,ir,lr,ut(lr)),Ee=et+1,Se=!1;continue}if(At==='"'||At==="'")for(var Qt=1,fr=m.charAt(et-Qt);fr.trim()===""||fr==="=";){if(fr==="="){ze=At;continue e}fr=m.charAt(et-++Qt)}}else if(At===ze){ze=!1;continue}}return Ee<kt&&(re+=F(m.substr(Ee))),re},Rt.parseAttr=function(m,E){var F=0,re=0,Ee=[],Se=!1,ze=m.length;function et(At,Qt){if(!((At=(At=_t.trim(At)).replace(yt,"").toLowerCase()).length<1)){var fr=E(At,Qt||"");fr&&Ee.push(fr)}}for(var kt=0;kt<ze;kt++){var ir,lr=m.charAt(kt);if(Se!==!1||lr!=="=")if(Se===!1||kt!==re){if(/\s|\n|\t/.test(lr)){if(m=m.replace(/\s|\n|\t/g," "),Se===!1){if((ir=Bt(m,kt))===-1){et(_t.trim(m.slice(F,kt))),Se=!1,F=kt+1;continue}kt=ir-1;continue}if((ir=Et(m,kt-1))===-1){et(Se,Zt(_t.trim(m.slice(F,kt)))),Se=!1,F=kt+1;continue}}}else{if((ir=m.indexOf(lr,kt+1))===-1)break;et(Se,_t.trim(m.slice(re+1,ir))),Se=!1,F=(kt=ir)+1}else Se=m.slice(F,kt),F=kt+1,re=m.charAt(F)==='"'||m.charAt(F)==="'"?F:ar(m,kt+1)}return F<m.length&&(Se===!1?et(m.slice(F)):et(Se,Zt(_t.trim(m.slice(F))))),_t.trim(Ee.join(" "))};var xt=g.exports.FilterCSS,zt=h,ae=Rt,Me=ae.parseTag,te=ae.parseAttr,S=Te;function J(m){return m==null}function z(m){(m=function(E){var F={};for(var re in E)F[re]=E[re];return F}(m||{})).stripIgnoreTag&&(m.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),m.onIgnoreTag=zt.onIgnoreTagStripAll),m.whiteList||m.allowList?m.whiteList=function(E){var F={};for(var re in E)Array.isArray(E[re])?F[re.toLowerCase()]=E[re].map(function(Ee){return Ee.toLowerCase()}):F[re.toLowerCase()]=E[re];return F}(m.whiteList||m.allowList):m.whiteList=zt.whiteList,m.onTag=m.onTag||zt.onTag,m.onTagAttr=m.onTagAttr||zt.onTagAttr,m.onIgnoreTag=m.onIgnoreTag||zt.onIgnoreTag,m.onIgnoreTagAttr=m.onIgnoreTagAttr||zt.onIgnoreTagAttr,m.safeAttrValue=m.safeAttrValue||zt.safeAttrValue,m.escapeHtml=m.escapeHtml||zt.escapeHtml,this.options=m,m.css===!1?this.cssFilter=!1:(m.css=m.css||{},this.cssFilter=new xt(m.css))}z.prototype.process=function(m){if(!(m=(m=m||"").toString()))return"";var E=this.options,F=E.whiteList,re=E.onTag,Ee=E.onIgnoreTag,Se=E.onTagAttr,ze=E.onIgnoreTagAttr,et=E.safeAttrValue,kt=E.escapeHtml,ir=this.cssFilter;E.stripBlankChar&&(m=zt.stripBlankChar(m)),E.allowCommentTag||(m=zt.stripCommentTag(m));var lr=!1;E.stripIgnoreTagBody&&(lr=zt.StripTagBody(E.stripIgnoreTagBody,Ee),Ee=lr.onIgnoreTag);var At=Me(m,function(Qt,fr,dr,Rr,Or){var Mr={sourcePosition:Qt,position:fr,isClosing:Or,isWhite:Object.prototype.hasOwnProperty.call(F,dr)},sn=re(dr,Rr,Mr);if(!J(sn))return sn;if(Mr.isWhite){if(Mr.isClosing)return"</"+dr+">";var pn=function(Cr){var $r=S.spaceIndex(Cr);if($r===-1)return{html:"",closing:Cr[Cr.length-2]==="/"};var _=(Cr=S.trim(Cr.slice($r+1,-1)))[Cr.length-1]==="/";return _&&(Cr=S.trim(Cr.slice(0,-1))),{html:Cr,closing:_}}(Rr),vn=F[dr],Yr=te(pn.html,function(Cr,$r){var _=S.indexOf(vn,Cr)!==-1,R=Se(dr,Cr,$r,_);return J(R)?_?($r=et(dr,Cr,$r,ir))?Cr+'="'+$r+'"':Cr:J(R=ze(dr,Cr,$r,_))?void 0:R:R});return Rr="<"+dr,Yr&&(Rr+=" "+Yr),pn.closing&&(Rr+=" /"),Rr+=">"}return J(sn=Ee(dr,Rr,Mr))?kt(Rr):sn},kt);return lr&&(At=lr.remove(At)),At};var B=z;function q(m){return q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(E){return typeof E}:function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},q(m)}(function(m,E){var F=h,re=Rt,Ee=B;function Se(ze,et){return new Ee(et).process(ze)}(E=m.exports=Se).filterXSS=Se,E.FilterXSS=Ee,function(){for(var ze in F)E[ze]=F[ze];for(var et in re)E[et]=re[et]}(),typeof window!="undefined"&&(window.filterXSS=m.exports),typeof self!="undefined"&&typeof DedicatedWorkerGlobalScope!="undefined"&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=m.exports)})(c,c.exports);var oe,We=typeof atob=="function",Qe=typeof btoa=="function",be=typeof Buffer=="function",at=typeof TextDecoder=="function"?new TextDecoder:void 0,Pt=typeof TextEncoder=="function"?new TextEncoder:void 0,qe=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),Ft=(oe={},qe.forEach(function(m,E){return oe[m]=E}),oe),wr=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Wt=String.fromCharCode.bind(String),Gr=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):function(m){return new Uint8Array(Array.prototype.slice.call(m,0))},Nr=function(m){return m.replace(/=/g,"").replace(/[+\/]/g,function(E){return E=="+"?"-":"_"})},tn=function(m){return m.replace(/[^A-Za-z0-9\+\/]/g,"")},rn=Qe?function(m){return btoa(m)}:be?function(m){return Buffer.from(m,"binary").toString("base64")}:function(m){for(var E,F,re,Ee,Se="",ze=m.length%3,et=0;et<m.length;){if((F=m.charCodeAt(et++))>255||(re=m.charCodeAt(et++))>255||(Ee=m.charCodeAt(et++))>255)throw new TypeError("invalid character found");Se+=qe[(E=F<<16|re<<8|Ee)>>18&63]+qe[E>>12&63]+qe[E>>6&63]+qe[63&E]}return ze?Se.slice(0,ze-3)+"===".substring(ze):Se},Zr=be?function(m){return Buffer.from(m).toString("base64")}:function(m){for(var E=[],F=0,re=m.length;F<re;F+=4096)E.push(Wt.apply(null,m.subarray(F,F+4096)));return rn(E.join(""))},Xr=function(m){if(m.length<2)return(E=m.charCodeAt(0))<128?m:E<2048?Wt(192|E>>>6)+Wt(128|63&E):Wt(224|E>>>12&15)+Wt(128|E>>>6&63)+Wt(128|63&E);var E=65536+1024*(m.charCodeAt(0)-55296)+(m.charCodeAt(1)-56320);return Wt(240|E>>>18&7)+Wt(128|E>>>12&63)+Wt(128|E>>>6&63)+Wt(128|63&E)},Wr=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,qr=be?function(m){return Buffer.from(m,"utf8").toString("base64")}:Pt?function(m){return Zr(Pt.encode(m))}:function(m){return rn(m.replace(Wr,Xr))},zr=function(m){return arguments.length>1&&arguments[1]!==void 0&&arguments[1]?Nr(qr(m)):qr(m)},cr=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Ur=function(m){switch(m.length){case 4:var E=((7&m.charCodeAt(0))<<18|(63&m.charCodeAt(1))<<12|(63&m.charCodeAt(2))<<6|63&m.charCodeAt(3))-65536;return Wt(55296+(E>>>10))+Wt(56320+(1023&E));case 3:return Wt((15&m.charCodeAt(0))<<12|(63&m.charCodeAt(1))<<6|63&m.charCodeAt(2));default:return Wt((31&m.charCodeAt(0))<<6|63&m.charCodeAt(1))}},Lr=We?function(m){return atob(tn(m))}:be?function(m){return Buffer.from(m,"base64").toString("binary")}:function(m){if(m=m.replace(/\s+/g,""),!wr.test(m))throw new TypeError("malformed base64.");m+="==".slice(2-(3&m.length));for(var E,F,re,Ee="",Se=0;Se<m.length;)E=Ft[m.charAt(Se++)]<<18|Ft[m.charAt(Se++)]<<12|(F=Ft[m.charAt(Se++)])<<6|(re=Ft[m.charAt(Se++)]),Ee+=F===64?Wt(E>>16&255):re===64?Wt(E>>16&255,E>>8&255):Wt(E>>16&255,E>>8&255,255&E);return Ee},ve=be?function(m){return Gr(Buffer.from(m,"base64"))}:function(m){return Gr(Lr(m).split("").map(function(E){return E.charCodeAt(0)}))},de=be?function(m){return Buffer.from(m,"base64").toString("utf8")}:at?function(m){return at.decode(ve(m))}:function(m){return Lr(m).replace(cr,Ur)},D=function(m){return de(function(E){return tn(E.replace(/[-_]/g,function(F){return F=="-"?"+":"/"}))}(m))},W=function(m){return m&&m.Math==Math&&m},C=W((typeof globalThis=="undefined"?"undefined":q(globalThis))==="object"&&globalThis)||W((typeof window=="undefined"?"undefined":q(window))==="object"&&window)||W((typeof self=="undefined"?"undefined":q(self))==="object"&&self)||W((typeof global=="undefined"?"undefined":q(global))==="object"&&global)||Function("return this")(),Z=new(function(){function m(){var E=this;this.batchData=[],this.uniqKeys=new Set,this.timeout=2e3,this.lock=!1,this.getSlardarBid=function(){var F,re,Ee="lianMengOpen";if(!Ee.includes("bid"))return Ee;if(E.config&&E.config.bid)return E.config.bid;var Se=C;if(Se&&Se._xssBid)return Se._xssBid;if(Se&&Se.slardar&&typeof Se.slardar.config=="function"){var ze=(Se.slardar.config()||{}).bid;if(ze)return ze}if(Se&&Se.Slardar&&typeof Se.Slardar.config=="function"){var et=(Se.Slardar.config()||{}).bid;if(et)return et}return((re=(F=Se==null?void 0:Se.Slardar)===null||F===void 0?void 0:F._baseParams)===null||re===void 0?void 0:re.bid)||"argus"},this.getConfigRegion=function(){var F,re="cn";return re.includes("region")?E.config&&E.config.region?E.config.region:(((F=C==null?void 0:C.gfdatav1)===null||F===void 0?void 0:F.region)||"cn").toLowerCase():re},this.gerReportUrl=function(){var F={cn:D("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boe:D("aHR0cHM6Ly9tb24uemlqaWVhcGkuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),ttp:D("aHR0cHM6Ly9tb24udXMudGlrdG9rdi5jb20vbW9uaXRvcl9icm93c2VyL2NvbGxlY3QvYmF0Y2gvc2VjdXJpdHkvP2JpZD0="),va:D("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),maliva:D("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),sg:D("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9"),boei18n:D("aHR0cHM6Ly9tb24tdmEuYnl0ZW92ZXJzZWEuY29tL21vbml0b3JfYnJvd3Nlci9jb2xsZWN0L2JhdGNoL3NlY3VyaXR5Lz9iaWQ9")}[E.getConfigRegion()];if(F)return F+E.getSlardarBid()}}return m.prototype.setConfig=function(E){this.config=E},m.prototype.upload=function(){var E=this,F=this.gerReportUrl();!this.lock&&F&&this.batchData.length!==0&&(this.lock=!0,setTimeout(function(){var re=E.batchData.slice(0,100);E.batchData=E.batchData.slice(100),C.fetch(F,{method:"post",body:JSON.stringify(re),headers:{"Content-Type":"application/json"}}).catch(function(Ee){console.warn("xss defense report error",Ee)}),E.lock=!1,E.upload()},this.timeout))},m.prototype.generateKey=function(E){return E.collectKey?[E.collectMode,E.collectKey].join("___"):""},m.prototype.push=function(E){this.batchData.push(E),this.upload()},m.prototype.report=function(E){var F=this.generateKey(E);if(C.fetch&&E.collectKey){var re=(typeof window=="undefined"?"undefined":q(window))==="object"?window.location.href:"SSR";E.documentUrl=re;var Ee={age:Math.floor(Date.now()),type:"xss",url:re,body:E,"user-agent":""};E.disposition==="enforce"&&re!=="SSR"||(Ee.url=F),re==="SSR"&&(Ee.url="SSR___".concat(Ee.url),Ee.body.ssr=!0),this.push(Ee)}},m}()),ie=function(m){for(var E=0,F=function(Se){Array.isArray(m[Se])?m[Se].length===0?delete m[Se]:(m[Se]=Array.from(new Set(m[Se])),E+=m[Se].length):Object.keys(m[Se]).length===0?delete m[Se]:Object.keys(m[Se]).forEach(function(ze){m[Se][ze]=Array.from(new Set(m[Se][ze])),E+=m[Se][ze].length})},re=0,Ee=Object.keys(m);re<Ee.length;re++)F(Ee[re]);return{count:E,ret:m}};function Ie(m,E){return Z.setConfig(E),new c.exports.FilterXSS(E).process(m)}function Ze(m){var E,F=(E=/\s|\n|\t/.exec(m))?E.index:-1;if(F===-1)return{html:"",closing:m[m.length-2]==="/"};var re=(m=m.slice(F+1,-1).trim())[m.length-1]==="/";return re&&(m=m.slice(0,-1).trim()),{html:m,closing:re}}var ot=function(m){return(m=(m=(m=(m=m.replace(/&colon;/gi,":")).replace(/&tab;/gi,"")).replace(/&newline;/gi,"")).replace(/(\t|\n|\r)/g,"")).indexOf("&#")===-1?m.trim().toLowerCase():m.trim().replace(/&#(?:(x)([0-9a-f]+)|([0-9]+));?/gi,function(E,F,re,Ee){return String.fromCharCode(F?parseInt(re,16):parseInt(Ee))}).toLowerCase()};function Ye(m,E){if(m===void 0&&(m=""),typeof m!="string")return!0;if((m=ot(m)).includes("base64")&&!function(Se){if(Se===""||Se.trim()==="")return!0;try{return!Se.includes("data:text/html;base64")}catch(ze){return!0}}(m))return E&&E("data:text/html;base64"),!1;var F=["expression(","behavior:","view-source:"];if(F.some(function(Se){return m.indexOf(Se)!==-1}))return F.forEach(function(Se){m.indexOf(Se)!==-1&&E&&E(Se)}),!1;var re=["data:application","data:javascript","data:text/html","data:texthtml"];if(re.some(function(Se){return m.indexOf(Se)!==-1}))return re.forEach(function(Se){m.indexOf(Se)!==-1&&E&&E(Se)}),!1;if(m.indexOf("javascript:")>0)return E&&E("javascript:"),!1;if(/^javascript:/i.test(m)){var Ee=m.slice("javascript:".length).replace(/\s/g,"").trim();return!!["void","void(0)","void0","false","undefined",";"].some(function(Se){return Se===Ee})||(E&&E("javascript:"),!1)}return!0}var ct=function(m,E){return Ye(m,E)?m:"#"};function Gt(m,E,F){if(m===void 0&&(m=""),E===void 0&&(E=[]),typeof m!="string")return!0;if(!Ye(m=ot(m)))return!1;var re=function(ze){var et=ze.match(/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/)||[];return{url:et[0],scheme:et[1],slash:et[2],host:et[3],port:et[4],path:et[5],query:et[6],hash:et[7]}}(m),Ee=re.scheme,Se=re.host;return F?Boolean(F(m)):!["http","https","file"].includes(Ee)||((typeof window=="undefined"?"undefined":q(window))==="object"&&window&&(E=o(o([],E,!0),[location.host],!1)),E.some(function(ze){return!!(ze instanceof RegExp&&ze.test(Se))||ze===Se}))}var $t=Gt,Vt=Gt,vr={a:["target","title","spellcheck","rel"],canvas:[],abbr:["title"],address:[],area:["shape","coords","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:["dir"],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["alt","title","width","height","decoding"],ins:["datetime"],li:[],mark:[],nav:[],ol:["start"],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],delete:[],form:[],strong:[],mask:["maskunits","x","y","width","height","fill"],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],wbr:[],video:["autoplay","controls","loop","preload","height","width"],svg:["viewBox","version","xmlns","fill","width","height","stroke","stroke-width","style"],path:["d","fill","opacity","stroke","p-id","fill-rule","clip-rule","stroke-width","stroke-linecap","stroke-linejoin","fill-opacity","mask"],rect:["x","y","width","height","fill","stroke","rx"],g:[]},Ut={collect:null,initCollect:function(){this.collect={whiteList:{},filterProtocol:[]}},removeCollect:function(){var m=ie(this.collect),E=m.count,F=m.ret;return this.collect=null,{collectKey:E===0?null:JSON.stringify(F),collectMode:"white"}},onIgnoreTagAttr:function(m,E,F){return m&&["href","src"].indexOf(E)>-1?Ut.domainWhiteList&&Array.isArray(Ut.domainWhiteList)&&Ut.domainWhiteList.length>0&&!$t(F,o([],Ut.domainWhiteList,!0))?"":"".concat(E,'="').concat(ct(F,function(re){var Ee;(Ee=Ut.collect)===null||Ee===void 0||Ee.filterProtocol.push(re)}),'"'):m&&(["style","class","id"].indexOf(E)>-1||E.indexOf("data-")>-1)?"".concat(E,'="').concat(F,'"'):(Ut.collect.whiteList[m]=Ut.collect.whiteList[m]||[],void Ut.collect.whiteList[m].push(E))},onIgnoreTag:function(m,E){if(m==="style")return E;c.exports.parseTag(E,function(F,re,Ee,Se){var ze=Ze(Se);c.exports.parseAttr(ze.html.replace("/",""),function(et){Ut.collect.whiteList[Ee]=Ut.collect.whiteList[Ee]||[],Ut.collect.whiteList[Ee].push(et)})},c.exports.escapeHtml)},whiteList:vr,mergeWhiteList:function(m){for(var E={},F=0,re=Object.keys(vr);F<re.length;F++)E[ze=re[F]]=Array.from(vr[ze]);for(var Ee=0,Se=Object.keys(m);Ee<Se.length;Ee++){var ze;E[ze=Se[Ee]]=ze in vr?vr[ze].concat(m[ze]):Array.from(m[ze])}return E},setWhiteList:function(m){for(var E=0,F=Object.keys(m);E<F.length;E++){var re=F[E];this.whiteList[re]=re in vr?vr[re].concat(m[re]):Array.from(m[re])}}};try{var Dt=JSON.parse({}.replace(/'/g,'"')),gr="merge";gr.includes("override")&&(Ut.whiteList=Dt.whiteList),gr.includes("merge")&&Ut.setWhiteList(Dt.whiteList)}catch(m){}var Kt={blackList:{a:["folder"],meta:["content"],iframe:["srcdoc"],input:["pattern"],vmlframe:["xmlns"]},blackTags:["script","xml","embed","isindex","object","base","set","handler","animate","payload","import"],blackAttrs:["charset","ns","namespace","formaction","xlink:href","xmlns:xlink","handler","repeat","repeat-start","repeat-end"],blackAttrRegExps:[/^on/],filterList:{param:["value"],video:["poster"],form:["action"]},filterAttrs:["href","src","background","style","dynsrc","lowsrc","content"]};try{var or=JSON.parse({}.replace(/'/g,'"'));or.blackAttrRegExps&&(or.blackAttrRegExps=or.blackAttrRegExps.map(function(m){return new RegExp(m.toString().slice(1,m.toString().length-1))}));var Ar="merge";Ar.includes("override")&&(Kt=or),Ar.includes("merge")&&(Kt=function m(E,F){for(var re={},Ee=0,Se=Object.keys(E);Ee<Se.length;Ee++){var ze=Se[Ee];Array.isArray(E[ze])?re[ze]=Array.from(E[ze]):re[ze]=m({},E[ze])}for(var et=0,kt=Object.keys(F);et<kt.length;et++)(ze=kt[et])in E?Array.isArray(E[ze])?re[ze]=E[ze].concat(F[ze]):re[ze]=m(E[ze],F[ze]):Array.isArray(F[ze])?re[ze]=Array.from(F[ze]):re[ze]=m({},F[ze]);return re}(Kt,or))}catch(m){}var Kr,tr={whiteList:{},collect:null,initCollect:function(){tr.collect={blackList:{},blackTags:[],blackAttrs:[],blackAttrRegExps:[],filterAttrs:[],filterList:{},filterProtocol:[]}},removeCollect:function(){var m=ie(tr.collect),E=m.count,F=m.ret;return tr.collect=null,{collectKey:E===0?null:JSON.stringify(F),collectMode:"black"}},onIgnoreTag:function(m,E){var F;if(!Kt.blackTags.includes(m)){var re=c.exports.parseTag(E,function(Ee,Se,ze,et,kt){if(ze.indexOf("/")!==-1)return c.exports.escapeHtml(et);if(kt)return"</".concat(ze,">");var ir=Ze(et),lr=c.exports.parseAttr(ir.html,function(At,Qt){var fr,dr=0;if(Kt.blackList[ze]&&Kt.blackList[ze].includes(At)&&(tr.collect.blackList[ze]=tr.collect.blackList[ze]||[],tr.collect.blackList[ze].push(At),dr++),Kt.blackAttrRegExps.length&&Kt.blackAttrRegExps.some(function(Or){return Or.test(At)})&&Kt.blackAttrRegExps.forEach(function(Or){Or.test(At)&&(tr.collect.blackAttrRegExps.push("".concat(Or.toString(),"->").concat(At)),dr++)}),Kt.blackAttrs.length&&Kt.blackAttrs.includes(At)&&(Kt.blackAttrs.push(At),dr++),!dr){if(Kt.filterList&&Kt.filterList[ze]&&Kt.filterList[ze].includes(At)){var Rr=ct(Qt,function(Or){var Mr;(Mr=tr.collect)===null||Mr===void 0||Mr.filterProtocol.push(Or)});return Rr!==Qt&&(tr.collect.filterList[ze]=tr.collect.filterList[ze]||[],tr.collect.filterList[ze].push(At)),Qt?"".concat(At,"='").concat(Rr,"'"):At}return Kt.filterAttrs&&Kt.filterAttrs.includes(At)?(Rr=ct(Qt,function(Or){var Mr;(Mr=tr.collect)===null||Mr===void 0||Mr.filterProtocol.push(Or)}),Rr!==Qt&&((fr=tr.collect)===null||fr===void 0||fr.filterAttrs.push(At)),Qt?"".concat(At,"='").concat(Rr,"'"):At):Qt?"".concat(At,"='").concat(Qt,"'"):At}});return et="<".concat(ze),lr&&(et+=" ".concat(lr)),ir.closing&&(et+=" /"),et+=">"},c.exports.escapeHtml);return re}(F=tr.collect)===null||F===void 0||F.blackTags.push(m)}},Br=function(m){var E=m.reportOnly,F=E===void 0||E,re=m.block;return F&&F==="all"?"report":re?"enforce":F?"report":"enforce"},nn=function(m){return typeof m=="string"?m.replace(/'/g,'"').replace('=""',"").replace(/\s+/g,"").toLowerCase():""},dn=function(m){return function(E,F,re){if(!E||typeof E!="string")return E;var Ee=F;m===Ie&&(Ee=Ut,re&&re.mode==="black"&&(Ee=tr),Ut.enabled?Ee=F:tr.enabled&&(Ee=tr),Ee.initCollect());var Se=m(E,Ee);if(nn(Se)===nn(E))return E;if(!re)return Se;var ze=re.logType,et=Br(re),kt=Ee.removeCollect();return Z.report(n(n({type:ze,disposition:et},kt),{sourceText:zr(E),filterText:zr(Se)})),et==="enforce"?Se:E}},ln=dn(c.exports.filterXSS),on=dn(Ie),wn=(Kr=ct,function(m,E,F){var re=[],Ee=Kr(m,function(kt){re.push(kt)});if(Ee===m)return m;re=Array.from(new Set(re));var Se=E||F||{};if(!Se)return Ee;var ze=Se.logType,et=Br(F);return Z.report({type:ze,disposition:et,collectKey:re.join("___"),collectData:JSON.stringify(re),collectMode:"black",sourceText:zr(m),filterText:zr(Ee)}),et==="enforce"?Ee:m}),Jr=C._xssProject||{},un=C.xssNamespace||{},Qr="3.0.15",Ir={FilterXSS:c.exports.FilterXSS,version:Qr,filterXSS:ln,_filterXSS:on,filterUrl:wn,Config:Ut,BlackConfig:tr,project:Jr,setProjectName:function(m){Jr[m]=this,C._xssProjectName=m}};un.lianMengOpen=Ir,C.xssNamespace=un,C.Math&&!C.Math.xssNamespace&&(C.Math.xssNamespace=un),Jr[Qr]=Ir,C.globalThis=C,C.getFilterXss=function(){return this._xssProjectName!==void 0?this._xssProject[this._xssProjectName]:Ir},C.xss=Ir,C.isSafeUrl=$t,C.isSafeDomain=Vt,C.isSafeProtocol=Ye,C._xssProject=Jr,C._xssProjectName&&(Jr[C._xssProjectName]=Ir);var hn=Ir.setProjectName.bind(Ir);l.BlackConfig=tr,l.Config=Ut,l.FilterXSS=c.exports.FilterXSS,l._filterXSS=on,l.filterUrl=wn,l.filterXSS=ln,l.isSafeDomain=Vt,l.isSafeProtocol=Ye,l.isSafeUrl=$t,l.project=Jr,l.setProjectName=hn,l.setXssNamespace=function(m){var E=m.appId,F=m.bid,re=m.region,Ee=m.mode,Se=Ee===void 0?"black":Ee;un[E]=Ir;var ze=null;(ze=Se==="black"?tr:Ut).bid=F,ze.region=re,ze.enabled=!0},l.xssNamespace=un,Object.defineProperty(l,"__esModule",{value:!0})}),(self.webpackChunkmain=self.webpackChunkmain||[]).push([[707],{13916:(l,n,o)=>{o.d(n,{e:()=>h});var c=o(13550);function h(g){var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},y=g.type,O=function(G){for(var le={},Pe=0,Ce;Pe<G&&(Ce="element".concat(Pe+1),!!g[Ce]);Pe++)le[Ce]=JSON.stringify(g[Ce]);return le};switch(y){case"action":return["bl_action",(0,c.Z)((0,c.Z)({event:g.event,eventInfo:JSON.stringify(g.eventInfo)},O(5)),b)];case"ui":return["bl_ui",(0,c.Z)((0,c.Z)({desc:g.desc},O(5)),b)];case"system":return["bl_system",(0,c.Z)({event:g.event,level:g.level||"info",module:g.module||"unknown",states:g.states?JSON.stringify(g.states):""},b)];default:throw Error("betterLogToTeaLog\uFF1A\u672A\u77E5\u7C7B\u578B\u9519\u8BEF\uFF1A".concat(y))}}},28151:(l,n,o)=>{o.d(n,{Z:()=>Lr});var c=o(56841),h=o(9176),g=o(11022),b=o(35018),y=o(23838),O=o(72035),M=o(81586),G=o(50511),le=o.n(G),Pe=o(64519),Ce=o(13550),De=o(38814),Ae=o(88068),ge=0,Te=(0,g.Z)(function ve(de,D,W){(0,h.Z)(this,ve),(0,M.Z)(this,"inputArgs",void 0),(0,M.Z)(this,"command",void 0),(0,M.Z)(this,"timestamp",void 0),(0,M.Z)(this,"index",void 0),this.command=de,this.inputArgs=D,this.timestamp=W||new Date().getTime(),this.index=++ge}),ce;(function(ve){ve.Action="action",ve.System="system",ve.UI="ui"})(ce||(ce={}));var x=function(){function ve(de){(0,h.Z)(this,ve),(0,M.Z)(this,"type",void 0),(0,M.Z)(this,"logs",void 0),(0,M.Z)(this,"state",void 0),this.type=de,this.logs=[],this.state={}}return(0,g.Z)(ve,[{key:"setState",value:function(D){if(typeof D=="function"){var W=this.state;this.state=(0,Ce.Z)((0,Ce.Z)({},this.state||{}),D(W))}else this.state=(0,Ce.Z)((0,Ce.Z)({},this.state),D)}}]),ve}(),P=(0,g.Z)(function ve(de){(0,h.Z)(this,ve),(0,M.Z)(this,"next",void 0),this.next=de});function $(ve,de){var D=/[^\x00-\xff]/g;if(ve.replace(D,"mm").length<=de)return ve;for(var W=de-3,C=Math.floor(de/2),Z=C;Z<ve.length;Z++)if(ve.substring(0,Z).replace(D,"mm").length>=W)return"".concat(ve.substring(0,Z),"...");return ve}function he(ve){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,W,C;if(typeof ve=="string")W=C=ve;else{var Z=(0,Pe.Z)(ve),ie=Z[0],Ie=Z.slice(1),Ze=Ie.map(function(ot){if(ot){var Ye=de[ot];if(typeof Ye!="undefined")return"".concat(ot,"=").concat($(String(Ye),D))}return""}).filter(function(ot){return ot});W=ie,Ze.length?C="".concat(ie,"[").concat(Ze.join(","),"]"):C=ie}return{name:W,full_name:C}}function ye(ve){var de=[0,0,0,0],D=[0,0,0,0];if(ve instanceof Element&&ve.getBoundingClientRect){var W=ve.getBoundingClientRect(),C=W.left,Z=W.top,ie=W.width,Ie=W.height,Ze=document.documentElement.scrollTop||document.body.scrollTop,ot=document.documentElement.scrollLeft||document.body.scrollLeft;de=[C,Z,ie,Ie],D=[C+ot,Z+Ze,ie,Ie]}return{viewport_rect:de,page_rect:D}}function Re(ve){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100,D=function(C){switch(Object.prototype.toString.call(C).toLowerCase()){case"[object string]":return $(C,de);case"[object number]":case"[object boolean]":return C;case"[object null]":case"[object undefined]":return(0,De.Z)(C);default:try{return $(JSON.stringify(C),de)}catch(Z){}return"unknown"}};return(0,Ae.Z)(ve,function(W){return D(W)})}var He=[];function we(ve){var de=He.find(function(D){return ve[D]});return de||(de=Object.keys(ve).find(function(D){return D.startsWith("__reactFiber$")||D.startsWith("__reactInternalInstance$")}),de&&He.push(de)),de?ve[de]:null}function fe(ve){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Infinity,D=we(ve),W=[];if(D){var C=D;do(C.tag===0||C.tag===1)&&W.unshift(C),C=C.return;while(C&&W.length<de)}return W}function K(){var ve=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"timeout";return new Promise(function(W,C){setTimeout(function(){de===0?W():C(new Error(D))},ve*1e3)})}function I(ve){var de,D=ve;if((de=D)!==null&&de!==void 0&&de.id)return'//*[@id="'.concat(D.id,'"]');for(var W=[];D&&Node.ELEMENT_NODE===((C=D)===null||C===void 0?void 0:C.nodeType);){for(var C,Z=0,ie=!1,Ie=D.previousSibling;Ie;)Ie.nodeType!==Node.DOCUMENT_TYPE_NODE&&Ie.nodeName===D.nodeName&&Z++,Ie=Ie.previousSibling;for(Ie=D.nextSibling;Ie;){if(Ie.nodeName===D.nodeName){ie=!0;break}Ie=Ie.nextSibling}var Ze=D.prefix?"".concat(D.prefix,":"):"",ot=Z||ie?"[".concat(Z+1,"]"):"";W.push(Ze+D.localName+ot),D=D.parentNode}return W.length?"/".concat(W.reverse().join("/")):""}var k=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this,W),(0,M.Z)((0,b.Z)(C),"queue",void 0),(0,M.Z)((0,b.Z)(C),"emitter",void 0),(0,M.Z)((0,b.Z)(C),"middleware",void 0),C.queue=new se,C.emitter=new(le()),C.middleware=[],C}return(0,g.Z)(D,[{key:"send",value:function(){for(var C=this,Z=arguments.length,ie=new Array(Z),Ie=0;Ie<Z;Ie++)ie[Ie]=arguments[Ie];var Ze=ie[0],ot=ie.slice(1),Ye=new Te(Ze,ot),ct=this.request(Ye).then(function(Gt){if(Gt){var $t=Gt.toJSON();$t&&C.emitter.emit("event",$t)}return Gt});this.queue.add(Ye,ct)}},{key:"request",value:function(C){return this.next?this.next.request(C):Promise.reject(new Error("BetterLog\u7F3A\u5C11\u5904\u7406\u51FD\u6570"))}},{key:"on",value:function(C){this.emitter.on("event",C)}},{key:"off",value:function(C){this.emitter.off("event",C)}}]),D}(P),se=function(){function ve(){(0,h.Z)(this,ve),(0,M.Z)(this,"waiting",void 0),(0,M.Z)(this,"running",void 0),this.waiting=[],this.running=!1}return(0,g.Z)(ve,[{key:"add",value:function(D,W){this.waiting.push([D,W]),this.run()}},{key:"run",value:function(){var D=this;if(!this.running){var W=this.waiting[0];W?(this.running=!0,Promise.race([W[1],K(5)]).finally(function(){D.waiting.shift(),D.run()})):this.running=!1}}}]),ve}();const pe=k;var Je=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this),(0,M.Z)((0,b.Z)(C),"impls",void 0),C.impls=W,C}return(0,g.Z)(D,[{key:"request",value:function(C){var Z=this.impls[C.command];return Z&&Z.handler instanceof P?Z.handler.request(Z.logCreator?Z.logCreator(C):C):Promise.reject(new Error("CommandHandler Error\uFF1Aimpl.handler\u7C7B\u578B\u9519\u8BEF"))}}]),D}(P);const me=Je;var Ne=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W,C,Z){var ie;return(0,h.Z)(this,D),ie=de.call(this,W,C,Z),(0,M.Z)((0,b.Z)(ie),"inputArgs",void 0),ie.inputArgs=C,ie}return(0,g.Z)(D,[{key:"event",get:function(){return this.inputArgs[0]}},{key:"componentName",get:function(){return this.inputArgs[1]}},{key:"states",get:function(){return this.inputArgs[2]}}]),D}(Te),ne=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){var W;return(0,h.Z)(this,D),W=de.call(this,ce.Action),(0,M.Z)((0,b.Z)(W),"elements",void 0),W.elements=[],W.setState({type:"action"}),W}return(0,g.Z)(D,[{key:"insertLog",value:function(C){if(this.logs.length===0)this.logs.push(C);else for(var Z=this.logs.length-1;Z>=0;Z--)if(C.timestamp>=this.logs[Z].timestamp){this.logs.splice(Z+1,0,C);break}else Z===0&&this.logs.unshift(C)}},{key:"event",get:function(){return this.state.event},set:function(C){this.setState({event:C})}},{key:"eventInfo",get:function(){return this.state.eventInfo},set:function(C){this.setState({eventInfo:C})}},{key:"toJSON",value:function(){if(this.elements.length>0){var C={};return this.elements.forEach(function(Z,ie){C["element".concat(ie+1)]=Z}),(0,Ce.Z)((0,Ce.Z)({},this.state),C)}return null}}]),D}(x),$e=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){return(0,h.Z)(this,D),de.apply(this,arguments)}return(0,g.Z)(D)}(P);function Oe(ve){return ve instanceof Event?ve.target:ve.currentTarget}var je=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){return(0,h.Z)(this,D),de.apply(this,arguments)}return(0,g.Z)(D,[{key:"request",value:function(C){if(this.next){var Z;return!((Z=C.event)!==null&&Z!==void 0&&Z.target)||C.event.target.nodeType!==Node.ELEMENT_NODE?Promise.reject(new Error("log\u683C\u5F0F\u9519\u8BEF")):this.next.request(C).then(function(ie){return ie&&ie.logs.length>0&&ie.logs[0]===C?ie:null})}else return Promise.reject(new Error("\u7F3A\u5C11\u5904\u7406\u51FD\u6570"))}}]),D}($e);const vt=je;function Rt(ve){var de=Oe(ve);if(!de)return 999;var D=ve.nativeEvent||ve,W=D.composedPath();return W.length-W.indexOf(de)}function _t(ve){var de=ve.nativeEvent||ve;return de instanceof MouseEvent?{meta:de.metaKey,alt:de.altKey,ctrl:de.ctrlKey,shift:de.shiftKey}:null}function Xe(ve){var de,D;if(ve&&typeof ve.clientX=="number"){var W=ve,C=W.clientX,Z=W.clientY,ie=W.pageX,Ie=W.pageY;de=[C,Z],D=[ie,Ie]}return{client_xy:de,page_xy:D}}var ut=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this,W),(0,M.Z)((0,b.Z)(C),"cache",void 0),(0,M.Z)((0,b.Z)(C),"handled",void 0),C.cache=new WeakMap,C.handled=new WeakSet,C}return(0,g.Z)(D,[{key:"parseElementNameInfo",value:function(C,Z){if(C.componentName)return he(C.componentName||"",Z);if(Oe(C.event)){var ie=fe(Oe(C.event),1);if(ie[0]){var Ie,Ze,ot,Ye,ct=((Ie=ie[0])===null||Ie===void 0||(Ze=Ie.type)===null||Ze===void 0?void 0:Ze.displayName)||((ot=ie[0])===null||ot===void 0||(Ye=ot.type)===null||Ye===void 0?void 0:Ye.name)||"";if(ct.length>2)return{name:ct,full_name:ct}}}return{name:"unknown",full_name:"unknown"}}},{key:"parseElementStates",value:function(C){return C?Re(C):{}}},{key:"parseAndCache",value:function(C){var Z,ie,Ie;if(this.cache.has(C))return this.cache.get(C);var Ze=C.event,ot=this.parseElementStates(C.states),Ye={event:Ze.type,eventInfo:(0,Ce.Z)((0,Ce.Z)({target:(Z=Oe(Ze))===null||Z===void 0?void 0:Z.tagName,eventPhase:Ze.eventPhase,isTrusted:Ze.isTrusted,text:((ie=Oe(Ze))===null||ie===void 0||(Ie=ie.innerText)===null||Ie===void 0?void 0:Ie.replace(/(.{20})(.*)/,"$1..."))||"",modifierKeys:_t(Ze)||void 0,xpath:I(Oe(Ze))},ye(Oe(Ze))),Xe(Ze))},ct=(0,Ce.Z)((0,Ce.Z)({},this.parseElementNameInfo(C,ot)),{},{states:ot}),Gt=(0,Ce.Z)((0,Ce.Z)({},Ye),{},{element:ct,deep_level:Rt(Ze)});return this.cache.set(C,Gt),Gt}},{key:"request",value:function(C){var Z=this,ie=C.event;return ie?this.next?(this.parseAndCache(C),this.next.request(C).then(function(Ie){if(!Ie)return null;if(Z.handled.has(Ie))return Ie;if(Ie.logs.length>0){var Ze,ot=Ie.logs.map(function(Ye){var ct=Z.parseAndCache(Ye);return{log:Ye,result:ct,deep_level:(ct==null?void 0:ct.deep_level)||999}}).sort(function(Ye,ct){var Gt=Ye.deep_level,$t=Ye.result.eventInfo.eventPhase,Vt=Ye.log,vr=Vt.timestamp,Ut=Vt.index,Dt=ct.deep_level,gr=ct.result.eventInfo.eventPhase,Kt=ct.log,or=Kt.timestamp,Ar=Kt.index;return Gt!==Dt?Gt-Dt:$t!==gr?$t-gr:vr!==or?or-vr:Ar-Ut});Ie.event=ot[0].result.event,Ie.eventInfo=ot[0].result.eventInfo,(Ze=Ie.elements).push.apply(Ze,(0,c.Z)(ot.map(function(Ye){return Ye.result.element}).filter(function(Ye){return Ye})))}return Z.handled.add(Ie),Ie})):Promise.resolve(null):Promise.reject(new Error("\u7F3A\u5C11event\u5BF9\u8C61"))}}]),D}($e);const yt=ut;var Bt=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){var W;return(0,h.Z)(this,D),W=de.call(this),(0,M.Z)((0,b.Z)(W),"store",void 0),W.store=new WeakMap,W}return(0,g.Z)(D,[{key:"request",value:function(C){var Z=C.event;if(!Z)return Promise.reject(new Error("\u7F3A\u5C11event\u5BF9\u8C61"));var ie=(Z==null?void 0:Z.nativeEvent)||Z,Ie=this.store.get(ie);if(Ie)return Ie.actionEvent.insertLog(C),Ie.p;var Ze=new ne;Ze.insertLog(C);var ot=new Promise(function(Ye){if(ie.bubbles){var ct=!1,Gt=function Vt(){ct||(ct=!0,clearTimeout($t),document.removeEventListener(ie.type,Vt,!1),Ye(Ze))},$t=window.setTimeout(Gt,0);document.addEventListener(ie.type,Gt,!1)}else Ye(Ze)});return this.store.set(ie,{actionEvent:Ze,p:ot}),ot}}]),D}($e);const ar=Bt;function Et(){var ve=new ar,de=new yt(ve),D=new vt(de);return{handler:D,logCreator:function(C){return new Ne(C.command,C.inputArgs)}}}var Zt=o(31320),xt=o(32130),zt=o(69359),ae=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){return(0,h.Z)(this,D),de.apply(this,arguments)}return(0,g.Z)(D)}(P),Me=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W,C,Z){var ie;(0,h.Z)(this,D),ie=de.call(this,W,C),(0,M.Z)((0,b.Z)(ie),"inputArgs",void 0),(0,M.Z)((0,b.Z)(ie),"timestamp",void 0),(0,M.Z)((0,b.Z)(ie),"id",void 0),(0,M.Z)((0,b.Z)(ie),"animDetector",void 0),(0,M.Z)((0,b.Z)(ie),"_animPromise",void 0),ie.inputArgs=C,ie.animDetector=Z,ie.timestamp=new Date().getTime(),ie.id="ui_".concat(ie.index);var Ie=ie.animationOptions;return Ie||(ie._animPromise=Promise.resolve(void 0)),Ie instanceof Promise&&(ie._animPromise=Ie),ie._animPromise=new Promise(function(Ze){ie.animDetector.requestIdleCallback(ie.domElement,Ze,{waitingStart:!0,waitingDeadline:300})}),ie}return(0,g.Z)(D,[{key:"domElement",get:function(){return this.inputArgs[0]}},{key:"reaction",get:function(){return this.inputArgs[1]}},{key:"componentName",get:function(){return this.inputArgs[2]}},{key:"states",get:function(){return this.inputArgs[3]}},{key:"animationOptions",get:function(){var C;return(C=this.inputArgs[4])===null||C===void 0?void 0:C.animation}},{key:"animation",get:function(){return this._animPromise}}]),D}(Te),te=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this,ce.UI),(0,M.Z)((0,b.Z)(C),"elements",void 0),(0,M.Z)((0,b.Z)(C),"fixedLogs",void 0),C.logs=W,C.fixedLogs=[],C.elements=[],C.setState({type:"ui"}),C}return(0,g.Z)(D,[{key:"desc",get:function(){return this.state.desc},set:function(C){this.setState({desc:C})}},{key:"toJSON",value:function(){if(this.elements.length>0){var C={};return this.elements.forEach(function(Z,ie){C["element".concat(ie+1)]=Z}),(0,Ce.Z)((0,Ce.Z)({},this.state),C)}return null}}]),D}(x),S=function(){function ve(){(0,h.Z)(this,ve),(0,M.Z)(this,"waiting",void 0),(0,M.Z)(this,"done",void 0),(0,M.Z)(this,"cache",void 0),(0,M.Z)(this,"timer",void 0),this.waiting=new Map,this.done=new Map,this.cache=new Map,this.timer=0}return(0,g.Z)(ve,[{key:"parse",value:function(){var de=(0,xt.Z)((0,Zt.Z)().mark(function W(C){var Z,ie,Ie,Ze,ot;return(0,Zt.Z)().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(Z=C.domElement,ie=C.componentName,Ie=C.states,Ze=C.reaction,ot=(0,Ce.Z)((0,Ce.Z)({},he(ie||Z.tagName||"unknown",Ie)),{},{reaction:Ze,states:Ie?Re(Ie):{}}),this.done.has(C)){ct.next=6;break}return ct.next=5,C.animation;case 5:this.waitingParseToDone(Z);case 6:return ct.abrupt("return",(0,Ce.Z)((0,Ce.Z)({},ot),this.done.get(C)||{page_rect:[0,0,0,0],viewport_rect:[0,0,0,0]}));case 7:case"end":return ct.stop()}},W,this)}));function D(W){return de.apply(this,arguments)}return D}()},{key:"saveCache",value:function(D,W){var C=this;this.cache.set(D,W),this.timer||(this.timer=window.requestAnimationFrame(function(){C.timer=0,C.cache.clear()}))}},{key:"waitingParseToDone",value:function(D){var W,C=this,Z=this.waiting.get(D);if(Z!=null&&(W=Z.logs)!==null&&W!==void 0&&W.size){this.waiting.delete(D);var ie=this.cache.get(D);return ie||(ie=ye(D),this.saveCache(D,ie)),Z.logs.forEach(function(Ie){C.done.set(Ie,ie)}),Z}return null}},{key:"getType",value:function(D){switch(D){case"show":case"update":return 1;case"hide":return 2;default:return 0}}},{key:"register",value:function(D){var W=D.domElement,C=D.reaction,Z=this.getType(C),ie=this.waiting.get(W),Ie=!ie||ie.type!==Z,Ze=ie&&ie.type!==Z;Ze&&this.waitingParseToDone(W),Ie&&(ie={type:this.getType(C),logs:new Set},this.waiting.set(W,ie)),ie.logs.add(D)}},{key:"unregister",value:function(D){if(!this.done.delete(D)){var W,C=this.waiting.get(D.domElement);return Boolean(C==null||(W=C.logs)===null||W===void 0?void 0:W.delete(D))}return!0}}]),ve}(),J=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W,C){var Z;return(0,h.Z)(this,D),Z=de.call(this,W),(0,M.Z)((0,b.Z)(Z),"animDetector",void 0),(0,M.Z)((0,b.Z)(Z),"handled",void 0),(0,M.Z)((0,b.Z)(Z),"elementParser",void 0),Z.animDetector=C,Z.handled=new WeakMap,Z.elementParser=new S,Z}return(0,g.Z)(D,[{key:"parseRecordDesc",value:function(C){var Z=C.map(function(ot){return"".concat(ot.name,"#").concat(ot.reaction)}),ie=(0,Pe.Z)(Z),Ie=ie[0],Ze=ie.slice(1);return Ie+(Ze.length>0?"(".concat(Ze.join(","),")"):"")}},{key:"sortAndFilter",value:function(C){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5,ie=new Map;C.forEach(function(Dt){var gr=ie.get(Dt.domElement);gr||(gr={el:Dt.domElement,logs:[],parents:[]},ie.set(Dt.domElement,gr)),gr.logs.push(Dt)});for(var Ie=0,Ze=C.length;Ie<Ze;Ie++)for(var ot=Ie+1;ot<Ze;ot++){var Ye=C[Ie].domElement,ct=C[ot].domElement,Gt=Ye.compareDocumentPosition(ct);Gt&Node.DOCUMENT_POSITION_CONTAINS?ie.get(Ye).parents.push(C[ot]):Gt&Node.DOCUMENT_POSITION_CONTAINED_BY&&ie.get(ct).parents.push(C[Ie])}for(var $t=Array.from(ie.values()),Vt=[],vr=function(){for(var gr=[],Kt=0;Kt<$t.length;Kt++)$t[Kt].parents.length===0&&(gr.push($t.splice(Kt,1)[0]),Kt--);gr=gr.sort(function(Ar,Kr){var tr=Ar.el.compareDocumentPosition(Kr.el);return tr&Node.DOCUMENT_POSITION_FOLLOWING?-1:1});var or=gr.map(function(Ar){return Ar.logs}).flat();if(or.length>Z-Vt.length)return Vt.push.apply(Vt,(0,c.Z)(or.slice(0,Z-Vt.length))),"break";Vt.push.apply(Vt,(0,c.Z)(or)),$t.forEach(function(Ar){Ar.parents=Ar.parents.filter(function(Kr){return or.indexOf(Kr)===-1})})};Vt.length<Z&&$t.length;){var Ut=vr();if(Ut==="break")break}return Vt}},{key:"request",value:function(C){var Z=this;return this.next?(this.elementParser.register(C),this.next.request(C).then(function(){var ie=(0,xt.Z)((0,Zt.Z)().mark(function Ie(Ze){var ot;return(0,Zt.Z)().wrap(function(ct){for(;;)switch(ct.prev=ct.next){case 0:if(Ze){ct.next=2;break}return ct.abrupt("return",null);case 2:if(!Z.handled.has(Ze)){ct.next=4;break}return ct.abrupt("return",Z.handled.get(Ze));case 4:return ot=new Promise(function(Gt){if(Ze&&Ze.logs.length>0){var $t,Vt=Ze.logs,vr=Z.sortAndFilter(Vt,5);($t=Ze.fixedLogs).push.apply($t,(0,c.Z)(vr)),Promise.all(vr.map(function(Ut){return Z.elementParser.parse(Ut)})).then(function(Ut){var Dt;(Dt=Ze.elements).push.apply(Dt,(0,c.Z)(Ut)),Ze.desc=Z.parseRecordDesc(Ut),Gt(Ze)}).catch(function(){Gt(null)}).finally(function(){Vt.forEach(function(Ut){return Z.elementParser.unregister(Ut)})})}return Ze}),Z.handled.set(Ze,ot),ct.abrupt("return",ot);case 7:case"end":return ct.stop()}},Ie)}));return function(Ie){return ie.apply(this,arguments)}}())):Promise.resolve(null)}}]),D}(ae);const z=J;var B=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){return(0,h.Z)(this,D),de.apply(this,arguments)}return(0,g.Z)(D,[{key:"request",value:function(C){return this.next?!C.domElement||C.domElement.nodeType!==Node.ELEMENT_NODE?Promise.reject(new Error("log\u683C\u5F0F\u9519\u8BEF")):this.next.request(C).then(function(Z){return Z&&Z.fixedLogs.length>0&&Z.fixedLogs[0]===C?Z:null}):Promise.reject(new Error("\u7F3A\u5C11\u5904\u7406\u51FD\u6570"))}}]),D}(ae);const q=B;var oe=o(12395),We=o(92009);function Qe(ve,de){return{register:function(){de.forEach(function(W){var C=(0,We.Z)(W,3),Z=C[0],ie=C[1],Ie=C[2];ve.addEventListener(Z,ie,Ie)})},unregister:function(){de.forEach(function(W){var C=(0,We.Z)(W,3),Z=C[0],ie=C[1],Ie=C[2];ve.removeEventListener(Z,ie,Ie)})}}}function be(ve,de){var D=0;try{var W=window.getComputedStyle(ve,de).getPropertyValue("animation-iteration-count");W.toLowerCase()==="infinite"&&(D=Infinity)}catch(C){}return D}function at(ve){return new Promise(function(de){window.setTimeout(de,ve)})}var Pt={waitingStart:!1,waitingDeadline:300,animationDuration:2e3},qe=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){var W,C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document.body;(0,h.Z)(this,D),W=de.call(this),(0,M.Z)((0,b.Z)(W),"store",void 0),(0,M.Z)((0,b.Z)(W),"unregister",void 0),(0,M.Z)((0,b.Z)(W),"root",void 0),(0,M.Z)((0,b.Z)(W),"runningTimers",void 0),W.root=C,W.store=new Map,W.runningTimers=new Map;var Z=Qe(C,[["transitionstart",W.handleStart.bind((0,b.Z)(W))],["animationstart",W.handleStart.bind((0,b.Z)(W))]]),ie=Z.register,Ie=Z.unregister;return W.unregister=Ie,ie(),W}return(0,g.Z)(D,[{key:"handleStart",value:function(C){var Z=be(C.target,C.pseudoElement);if(C.target instanceof HTMLElement&&Z!==Infinity&&!this.store.has(C.target)){var ie=Qe(C.target,[["transitionend",this.handleEnd.bind(this)],["transitioncancel",this.handleEnd.bind(this)],["animationend",this.handleEnd.bind(this)],["animationcancel",this.handleEnd.bind(this)]]),Ie=ie.register,Ze=ie.unregister;Ie(),this.store.set(C.target,{listeners:[],unregister:Ze}),this.emit("start",C.target)}}},{key:"handleEnd",value:function(C){if(C.target instanceof HTMLElement&&this.store.has(C.target)){var Z=this.store.get(C.target),ie=Z.listeners;this.store.delete(C.target),ie.forEach(function(Ie){return Ie()}),ie.length=0,this.emit("end",C.target)}}},{key:"check",value:function(C){var Z=(0,oe.Z)(this.store.keys()),ie;try{for(Z.s();!(ie=Z.n()).done;){var Ie=ie.value;if(Ie.contains(C))return!0}}catch(Ze){Z.e(Ze)}finally{Z.f()}return!1}},{key:"registerWaitingFromElement",value:function(C){var Z=[],ie=(0,oe.Z)(this.store),Ie;try{var Ze=function(){var Ye=(0,We.Z)(Ie.value,2),ct=Ye[0],Gt=Ye[1].listeners;if(ct.contains(C)){var $t=new Promise(function(Vt){Gt.push(function(){return Vt(!0)})});Z.push($t)}};for(ie.s();!(Ie=ie.n()).done;)Ze()}catch(ot){ie.e(ot)}finally{ie.f()}return Z}},{key:"waitingStart",value:function(C,Z){var ie=this,Ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1e3,Ze=function(){ie.off("start",ot),window.clearTimeout(Ye)},ot=function(Gt){Gt.contains(C)&&(Ze(),Z(!0))},Ye=window.setTimeout(function(){Ze(),Z(!1)},Ie);return this.on("start",ot),Ze}},{key:"requestIdleCallback",value:function(C,Z,ie){var Ie=this;ie!=null&&ie.animationDuration&&ie.animationDuration<=10&&console.warn("\u3010\u63D0\u793A\u3011animationDuration=".concat(ie==null?void 0:ie.animationDuration,"ms\uFF0C\u5355\u4F4D\u4E3Ams\uFF0C\u8BF7\u786E\u8BA4\u662F\u5426\u6B63\u786E\uFF1F")),ie!=null&&ie.waitingDeadline&&ie.waitingDeadline<=10&&console.warn("\u3010\u63D0\u793A\u3011waitingDeadline=".concat(ie==null?void 0:ie.waitingDeadline,"ms\uFF0C\u5355\u4F4D\u4E3Ams\uFF0C\u8BF7\u786E\u8BA4\u662F\u5426\u6B63\u786E\uFF1F"));var Ze=(0,Ce.Z)((0,Ce.Z)({},Pt),ie),ot=Ze.waitingStart,Ye=Ze.waitingDeadline,ct=Ze.animationDuration,Gt=[],$t=!1,Vt=function(){return!$t&&Z()},vr=function Dt(){var gr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!$t){var Kt=Ie.registerWaitingFromElement(C);if(Kt.length>0)Promise.race([Promise.all(Kt).then(function(){return!0}),at(Math.max(ct,0)).then(function(){return!1})]).then(function(){return Vt()});else if(gr&&ot){var or=Ie.waitingStart(C,function(Ar){return Ar?Dt():Vt()},Ye);Gt.push(or)}else Vt()}},Ut=window.requestAnimationFrame(function(){return vr(!0)});return Gt.push(function(){$t=!0,window.cancelAnimationFrame(Ut)}),this.runningTimers.set(Ut,Gt),Ut}},{key:"cancelIdleCallback",value:function(C){if(this.runningTimers.has(C)){var Z=this.runningTimers.get(C)||[];Z.forEach(function(ie){return ie()}),Z.length=0,this.runningTimers.delete(C)}}},{key:"destroy",value:function(){this.unregister&&(this.unregister(),this.unregister=null)}}]),D}(le()),Ft=function(){function ve(de,D){(0,h.Z)(this,ve),(0,M.Z)(this,"ready",void 0),(0,M.Z)(this,"type",void 0),(0,M.Z)(this,"_record",void 0),(0,M.Z)(this,"wrapper",void 0),(0,M.Z)(this,"dom2Logs",void 0),(0,M.Z)(this,"frameCount",void 0),(0,M.Z)(this,"_resolve",void 0),(0,M.Z)(this,"animation",void 0),(0,M.Z)(this,"isDestroy",void 0),this.wrapper=D.domElement,this.dom2Logs=new Map,this.frameCount=0,this.isDestroy=!1,this.addLog(D),this.type=ve.parseType(D),this.initAnimation(D,de);var W;this.ready=new Promise(function(C){W=C}),this._resolve=function(){W()}}return(0,g.Z)(ve,[{key:"initAnimation",value:function(D,W){var C=this,Z;this.animation={animating:!0,start:new Date,end:new Date,cancel:function(){Z&&(W.cancelIdleCallback(Z),Z=0)}};var ie=D.domElement,Ie=D.animation,Ze=D.animationOptions,ot=Ze?Ie:new Promise(function(Ye){Z=W.requestIdleCallback(ie,Ye,{waitingStart:!0,waitingDeadline:300})});ot.then(function(){C.animation&&(C.animation.animating=!1)})}},{key:"comparePosition",value:function(D){return this.wrapper.compareDocumentPosition(D)}},{key:"contains",value:function(D){return this.dom2Logs.has(D)||this.wrapper.contains(D)}},{key:"containedBy",value:function(D){return D.contains(this.wrapper)}},{key:"addLog",value:function(D){var W=this.dom2Logs.get(D.domElement)||[];this.dom2Logs.set(D.domElement,[].concat((0,c.Z)(W),[D])),this.frameCount=0}},{key:"getAllLogs",value:function(){return Array.from(this.dom2Logs.values()).flat()}},{key:"mergeBlock",value:function(D){var W=this;D.getAllLogs().forEach(function(C){return W.addLog(C)})}},{key:"getRecord",value:function(){return this._record||(this._record=new te(Array.from(this.dom2Logs.values()).flat())),this._record}},{key:"tick",value:function(D){var W;!((W=this.animation)!==null&&W!==void 0&&W.animating)&&!this.isDestroy&&(this.frameCount++,this.frameCount>3&&this._resolve())}},{key:"forceReady",value:function(){this._resolve()}},{key:"destroy",value:function(){this.animation&&this.animation.cancel(),this.dom2Logs.clear(),this.isDestroy=!0}}],[{key:"parseType",value:function(D){switch(D.reaction){case"show":case"update":return 1;case"hide":return 2;default:return 0}}}]),ve}(),wr=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this),(0,M.Z)((0,b.Z)(C),"blocks",void 0),(0,M.Z)((0,b.Z)(C),"creator",void 0),C.blocks=[],C.creator=function(Z){var ie=W(Z);return ie.ready.then(function(){ie.getAllLogs().forEach(function(Ie){C.emit("ready:log:".concat(Ie.id),ie),C.removeBlock(ie)})}),ie},C}return(0,g.Z)(D,[{key:"insert",value:function(C){for(var Z=null,ie=C.domElement,Ie=!1,Ze=0,ot,Ye;Ze<this.blocks.length;Ze++)if(ot=this.blocks[Ze],Ye=ot.comparePosition(ie),Ye&Node.DOCUMENT_POSITION_CONTAINS){Z=this.creator(C),Z.mergeBlock(ot),ot.destroy(),this.blocks[Ze]=Z,Ie=!0;break}else if(Ye&Node.DOCUMENT_POSITION_CONTAINED_BY){ot.addLog(C),Z=ot;break}else if(Ye===0){ot.type===Ft.parseType(C)?(ot.addLog(C),Z=ot):ot.forceReady();break}return Z&&Ie&&(this.blocks=this.blocks.filter(function(ct){return ct!==Z&&ct.containedBy(C.domElement)?(Z.mergeBlock(ct),ct.destroy(),!1):!0})),Z||(Z=this.creator(C),this.blocks.push(Z)),Z}},{key:"removeBlock",value:function(C){var Z=this.blocks.indexOf(C);Z!==-1&&this.blocks.splice(Z,1)}},{key:"length",value:function(){return this.blocks.length}},{key:"tick",value:function(C){this.blocks.forEach(function(Z){return Z.tick(C)})}},{key:"ready",value:function(C){var Z=this;return new Promise(function(ie){Z.once("ready:log:".concat(C.id),function(Ie){return ie(Ie)})})}}]),D}(le()),Wt=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W,C){var Z;return(0,h.Z)(this,D),Z=de.call(this),(0,M.Z)((0,b.Z)(Z),"timer",void 0),(0,M.Z)((0,b.Z)(Z),"animDetector",void 0),(0,M.Z)((0,b.Z)(Z),"blockMgr",void 0),Z.animDetector=C,Z.timer=0,Z.blockMgr=new wr(function(ie){return new Ft(C,ie)}),Z}return(0,g.Z)(D,[{key:"request",value:function(C){return this.blockMgr.insert(C),this.runFrame(),this.blockMgr.ready(C).then(function(Z){return Z?Z.getRecord():null})}},{key:"runFrame",value:function(){var C=this;this.blockMgr.length()&&!this.timer&&(this.timer=window.requestAnimationFrame(function(){C.timer=0;var Z=new Date().getTime();C.blockMgr.tick(Z),C.runFrame()}))}}]),D}(ae);const Gr=Wt;function Nr(){var ve=new qe,de=new Gr(null,ve),D=new z(de,ve),W=new q(D);return{handler:W,logCreator:function(Z){return new Me(Z.command,Z.inputArgs,ve)}}}var tn=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W,C,Z){var ie;return(0,h.Z)(this,D),ie=de.call(this,W,C,Z),(0,M.Z)((0,b.Z)(ie),"inputArgs",void 0),ie.inputArgs=C,ie}return(0,g.Z)(D,[{key:"event",get:function(){return this.inputArgs[0]||"unknown"}},{key:"level",get:function(){return this.inputArgs[1]||"info"}},{key:"module",get:function(){return this.inputArgs[2]||"unknown"}},{key:"states",get:function(){return this.inputArgs[3]||{}}}]),D}(Te),rn=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(W){var C;return(0,h.Z)(this,D),C=de.call(this,ce.System),(0,M.Z)((0,b.Z)(C),"log",void 0),C.log=W,C.setState({type:"system",event:W.event,level:W.level,module:W.module,states:Re(W.states)}),C}return(0,g.Z)(D,[{key:"toJSON",value:function(){return(0,Ce.Z)({},this.state)}}]),D}(x),Zr=function(ve){(0,y.Z)(D,ve);var de=(0,O.Z)(D);function D(){return(0,h.Z)(this,D),de.apply(this,arguments)}return(0,g.Z)(D,[{key:"request",value:function(C){return new Promise(function(Z){Z(new rn(C))})}}]),D}(P);function Xr(){return{handler:new Zr,logCreator:function(de){return new tn(de.command,de.inputArgs)}}}var Wr={action:Et(),system:Xr(),ui:Nr()},qr=new me(Wr),zr=new pe(qr),cr=function(){for(var de=arguments.length,D=new Array(de),W=0;W<de;W++)D[W]=arguments[W];return D.forEach(function(C){zr.send.apply(zr,(0,c.Z)(C))}),1};if(window.betterLogData&&Array.isArray(window.betterLogData)&&window.betterLogData.push===Array.prototype.push)window.betterLogData.forEach(function(ve){zr.send.apply(zr,(0,c.Z)(ve))}),window.betterLogData.push=cr;else{var Ur=[];Ur.push=cr,window.betterLogData=Ur}const Lr=zr},86012:(l,n,o)=>{o.d(n,{f:()=>b});var c=o(45867),h=function(y,O){if(y instanceof RegExp)return y;if(typeof y=="object"){var M=y;return M[O]||M.default||/never-match/g}return/never-match/g},g=function(y,O,M,G){var le=Object.keys(O);return le.every(function(Pe){var Ce,De,Ae;return Pe===M||Pe===((Ae=(De=(Ce=(0,c.Rd)())===null||Ce===void 0?void 0:Ce.Mera)===null||De===void 0?void 0:De.meraMaster)===null||Ae===void 0?void 0:Ae.bid)?!0:!b({bid:M,event:y,match:O[Pe],matchMap:{},isFallback:!1})})?h(O[M],G).test(y.common.url||""):!1},b=function(y){var O,M,G=y.bid,le=y.event,Pe=y.match,Ce=y.matchMap,De=y.isFallback,Ae=De===void 0?!0:De,ge=/./g,Te="";switch(le.ev_type==="js_error"&&(Te=le.payload.error.stack||""),le.ev_type){case"pageview":if(ge=h(Pe,"pageview"),ge.test(le.common.url||""))return!0;break;case"http":if(ge=h(Pe,"http"),((M=(O=le==null?void 0:le.payload)===null||O===void 0?void 0:O.request)===null||M===void 0?void 0:M.url)&&ge.test(le.payload.request.url)||Ae&&g(le,Ce,G,"http"))return!0;break;case"resource_error":if(ge=h(Pe,"resource_error"),le.payload.url&&ge.test(le.payload.url)||Ae&&g(le,Ce,G,"resource_error"))return!0;break;case"js_error":return ge=h(Pe,"js_error"),typeof Te=="string"?!!ge.test(Te):ge.test(le.common.url||"");case"custom":return!0;case"performance":case"performance_longtask":case"performance_timing":case"blank_screen":case"resource":if(ge=h(Pe,"default"),ge.test(le.common.url||""))return!0;break;default:return!0}return!1}},35578:(l,n,o)=>{o.d(n,{Z:()=>b});var c=o(78424),h=function(){return h=Object.assign||function(y){for(var O,M=1,G=arguments.length;M<G;M++){O=arguments[M];for(var le in O)Object.prototype.hasOwnProperty.call(O,le)&&(y[le]=O[le])}return y},h.apply(this,arguments)},g=function(){function y(O,M){this.bid=O,this.eventName=M,this.TEA_APP_ID=409608}return Object.defineProperty(y.prototype,"teaConfigKey",{get:function(){return this.bid+"-"+this.eventName},enumerable:!1,configurable:!0}),y.prototype.init=function(O){O===void 0&&(O={});var M=y.tracker;return y.teaBaseConfig.set(this.teaConfigKey,h(h({},O),{bid:this.bid})),M||(M=new c.P(this.eventName),M.init({app_id:this.TEA_APP_ID,channel:"cn",disable_auto_pv:!0}),M.start(),y.tracker=M,M)},y.prototype.sendEvent=function(O){O===void 0&&(O={});var M=y.teaBaseConfig.get(this.teaConfigKey)||{};y.tracker.event(this.eventName,h(h({},M),O))},y.teaBaseConfig=new Map,y}();const b=g},87374:(l,n,o)=>{o.d(n,{ZP:()=>fe});var c=o(1099),h=o(35278),g=o.n(h),b={bid:"",context:{},plugins:{ajax:{ignoreUrls:[/rc-api.snssdk.com/g,/verify.snssdk.com/g,/\/\/i.snssdk.com/g,/mcs.zijieapi.com/g]}}},y=o(45867),O=o(86012),M=!1,G="("+function(I,k){var se=3e4,pe=5e3,Je=function(){function Ne(){var ne=this;this.timeout=se,this.duration=pe,this.log=!1,this.hasStuck=!1,this.pageViewData=null,this.performanceList=[],this.maxListLength=20,this.getReply=function(){},this.uploadError=function(){if(ne.getReply=function(){},!ne.hasStuck){if(!ne.pageViewData){console.log("Mera:\u7531\u4E8E\u6CA1\u6709\u89E6\u53D1pageview\u4E8B\u4EF6\uFF0C\u83B7\u53D6\u4E0D\u5230\u5FC5\u8981\u7684\u4FE1\u606F\uFF0C\u53D6\u6D88\u4E0A\u62A5\u9875\u9762\u5361\u6B7B\u72B6\u6001");return}ne.pageViewData.common.timestamp=+new Date,ne.pageViewData.ev_type="custom";var $e=ne.pageViewData.payload;ne.pageViewData.payload={name:"PageStuck",type:"event",metrics:{count:1},categories:{pid:$e.pid,performance:k(ne.performanceList)}};var Oe=new XMLHttpRequest;Oe.open("post","https://mon.zijieapi.com/monitor_browser/collect/batch/"),Oe.onerror=function(je){console.log("Mera:\u4E0A\u62A5\u9875\u9762\u5361\u6B7B\u9519\u8BEF\u8BF7\u6C42\u5931\u8D25",je)},Oe.setRequestHeader("Content-Type","application/json"),Oe.send(k({env_type:"batch",list:[ne.pageViewData]})),ne.hasStuck=!0,console.log("Mera:\u5FC3\u8DF3\u68C0\u6D4B\u4E0A\u62A5\u5361\u6B7B\u72B6\u6001  => ",ne.pageViewData)}},this.start=function(){if(!ne.hasStuck){var $e=I.setTimeout(ne.uploadError,ne.timeout);ne.getReply=function(Oe){if(Oe===void 0&&(Oe=!1),I.clearTimeout($e),ne.log&&console.log("Mera:\u5FC3\u8DF3\u68C0\u6D4B\u6536\u5230\u56DE\u590D"),!Oe){if(ne.hasStuck)return;I.setTimeout(ne.start,ne.duration)}},I.postMessage(""+ +new Date),ne.log&&console.log("Mera:\u5FC3\u8DF3\u68C0\u6D4B\u53D1\u9001\u8BF7\u6C42")}},this.addPerformanceData=function($e){ne.performanceList.push($e),ne.performanceList.length>ne.maxListLength&&ne.performanceList.shift()}}return Ne}(),me=new Je;I.addEventListener("message",function(Ne){switch(Ne.data.type){case"init":var ne=Ne.data.data;me.timeout=ne.timeout||se,me.duration=ne.duration||pe,me.log=ne.log||!1;break;case"start":me.start();break;case"reply":me.addPerformanceData(Ne.data.performanceData),me.getReply();break;case"cancel":me.getReply(!0);break;case"update":me.pageViewData=Ne.data.data;break;default:break}})}.toString()+")(self, self.JSON.stringify)";function le(){var K=(0,y.Rd)(),I=Date.now(),k=(K==null?void 0:K.location.href)||"";try{var se=(K==null?void 0:K.performance).memory,pe=se.jsHeapSizeLimit,Je=pe===void 0?0:pe,me=se.totalJSHeapSize,Ne=me===void 0?0:me,ne=se.usedJSHeapSize,$e=ne===void 0?0:ne;return{jsHeapSizeLimit:Je,totalJSHeapSize:Ne,usedJSHeapSize:$e,time:I,href:k}}catch(Oe){return{jsHeapSizeLimit:0,totalJSHeapSize:0,usedJSHeapSize:0,href:k,time:I}}}function Pe(K){var I=K.timeout,k=K.bid,se=K.duration,pe=K.log;(0,y.i3)(function(){var Je=(0,y.Rd)();if(!!Je){if(Je==null?void 0:Je.Mera.heartBeatWorker){console.log("Mera:\u5DF2\u6709\u5176\u4ED6\u5E94\u7528\u5F00\u542F\u4E86\u5FC3\u8DF3\u68C0\u6D4B,\u6B64\u5904\u4E0D\u505A\u5904\u7406");return}var me=new Blob([G],{type:"application/javascript"}),Ne=URL.createObjectURL(me),ne=new Worker(Ne);ne.addEventListener("message",function($e){ne.postMessage({type:"reply",data:$e.data,performanceData:le()})}),ne.postMessage({type:"init",data:{timeout:I,bid:k,duration:se,log:pe}}),(0,y.R3)("heartBeatWorker",ne)}})()}function Ce(){var K=(0,y.Rd)();if(!!K&&!!K.Mera.heartBeatWorker&&!M){var I=K.Mera.heartBeatWorker;I.postMessage({type:"start"}),M=!0}}function De(K){var I=(0,y.Rd)();if(!!I&&!!I.Mera.heartBeatWorker&&!!M){var k=I.Mera.heartBeatWorker;k.postMessage({type:"update",data:K})}}function Ae(){var K=(0,y.Rd)();if(!!K&&!!K.Mera.heartBeatWorker&&!!M){var I=K.Mera.heartBeatWorker;I.postMessage({type:"cancel"}),M=!1}}function ge(K){var I,k;if(typeof __GARFISH_GLOBAL_ENV__!="undefined"&&__GARFISH_GLOBAL_ENV__.currentApp)return __GARFISH_GLOBAL_ENV__.currentApp;if(K)return(k=(I=window==null?void 0:window.Garfish)===null||I===void 0?void 0:I.activeApps)===null||k===void 0?void 0:k.filter(function(se){return se.appInfo.name===K})[0]}function Te(K){var I=[];return K?(K.blankScreenTime&&I.push({name:"mffp",value:K.blankScreenTime,type:"mf",extra:{isFirstRender:String(K.isFirstRender)}}),K.firstScreenTime&&I.push({name:"mffmp",value:K.firstScreenTime,type:"mf",extra:{isFirstRender:String(K.isFirstRender)}}),I):[]}function ce(K,I){var k=!1;function se(Je){Je.forEach(function(me){k=!0,K("sendCustomPerfMetric",me)})}function pe(){k||setTimeout(function(){var Je,me=Te((Je=I==null?void 0:I.appPerformance)===null||Je===void 0?void 0:Je.performanceData);se(me),k||pe()},5e3)}return pe(),function(Je){if(!k){var me=Te(Je);return se(me),me}}}var x=function(K){var I=getAppInstance(K);if(I&&I.provider&&typeof I.provider.destroy=="function"){var k=I.provider.destroy;I.provider.destroy=function(){for(var se=[],pe=0;pe<arguments.length;pe++)se[pe]=arguments[pe];k.apply(this,se),I.provider&&(I.provider.destroy=k)}}};function P(K){var I=K.slardarInstance,k=K.appName;if(!window.__GARFISH__){console.error("GarfishSlardarPlugin: Not running in Garfish environment, GarfishSlardarPlugin is invalid");return}I("on","init",function(){var se,pe=ge(k);((se=pe==null?void 0:pe.appPerformance)===null||se===void 0?void 0:se.subscribePerformanceDataOnce)&&pe.appPerformance.subscribePerformanceDataOnce(ce(I,pe))})}var $=function(){return $=Object.assign||function(K){for(var I,k=1,se=arguments.length;k<se;k++){I=arguments[k];for(var pe in I)Object.prototype.hasOwnProperty.call(I,pe)&&(K[pe]=I[pe])}return K},$.apply(this,arguments)},he=function(K,I){var k={};for(var se in K)Object.prototype.hasOwnProperty.call(K,se)&&I.indexOf(se)<0&&(k[se]=K[se]);if(K!=null&&typeof Object.getOwnPropertySymbols=="function")for(var pe=0,se=Object.getOwnPropertySymbols(K);pe<se.length;pe++)I.indexOf(se[pe])<0&&Object.prototype.propertyIsEnumerable.call(K,se[pe])&&(k[se[pe]]=K[se[pe]]);return k},ye=function(){function K(I){var k=this,se,pe=I.isSubApp,Je=pe===void 0?!1:pe,me=I.devReport,Ne=me===void 0?!1:me,ne=I.fallbackStart,$e=ne===void 0?5:ne,Oe=I.syncInit,je=Oe===void 0?!1:Oe,vt=I.match,Rt=I.beforeSend,_t=I.context,Xe=I.heartbeat,ut=Xe===void 0?!1:Xe,yt=I.heartbeatTimeout,Bt=I.heartbeatDuration,ar=I.onInit,Et=I.maxBatchReportLength,Zt=I.batchReportWait,xt=I.garfishSlardarPlugin,zt=xt===void 0?!1:xt,ae=I.Collector,Me=he(I,["isSubApp","devReport","fallbackStart","syncInit","match","beforeSend","context","heartbeat","heartbeatTimeout","heartbeatDuration","onInit","maxBatchReportLength","batchReportWait","garfishSlardarPlugin","Collector"]);this.context={},this.devReport=!1,this.started=!1,this.syncInit=!1,this.heartbeat=!1,this.isSubApp=!1,this.getRelease=function(){try{var z=window.gfdatav1.ver;return z||""}catch(B){return""}},this.onSlardarInit=function(z,B,q){(0,y.i3)(function(){if(!!z){var oe=z.getSender();!oe||(B&&oe.setSize(B),q&&oe.setWait(q))}})()},this.enableReport=function(){return(0,y.ti)()||k.devReport},this.init=function(z){var B,q=z.fallbackStart,oe=q===void 0?5:q,We=z.beforeSend;k.mergeContext((0,y.I_)(k.context));var Qe=$({},z);Qe.plugins=(0,y.FT)(b.plugins,Qe.plugins||{},z.garfishSlardarPlugin);try{(B=k.slardar)===null||B===void 0||B.call(k,"init",$({},Qe))}catch(be){(0,y.i3)(function(){var at;(at=k.slardar)===null||at===void 0||at.call(k,"config",$({},Qe))})()}(0,y.i3)(function(){k.sendCustom("mera_init",{init:1},{bid:k.bid||""})})(),oe!==!1&&setTimeout(function(){k.started||(k.sendCustom("mera_start_fail",{start_fail:1},{bid:k.bid||""}),k.start(),k.sendCustom("mera_start",{start:1},{bid:k.bid||""}))},Number(oe)*1e3),(0,y.i3)(function(){var be;(be=k.slardar)===null||be===void 0||be.call(k,"on","beforeSend",function(at){var Pt,qe=at.common.bid;if(!qe)return!1;if(at.ev_type==="custom"){var Ft=at.payload.name;if(Ft==="mera_init"||Ft==="mera_start"||Ft==="mera_start_fail"){var wr=g()(at);return wr.common.bid="mera",wr.common.context={sdk_version:"3.0.9-beta.1",env:z.env||""},wr}}at.ev_type==="pageview"&&k.heartbeat&&De(at);var Wt=((Pt=(0,y.Rd)())===null||Pt===void 0?void 0:Pt.Mera.matchMap)||{};return!Wt[qe]||!(0,O.f)({bid:k.bid,event:at,match:Wt[qe],matchMap:Wt})?null:typeof We=="function"?We(at):at})})()},this.destroy=function(){(0,y.i3)(function(){var z,B,q;(z=(0,y.Rd)())===null||z===void 0||delete z.Mera.instanceMap[k.bid],(B=(0,y.Rd)())===null||B===void 0||delete B.Mera.matchMap[k.bid],(q=k.slardar)===null||q===void 0||q.call(k,"destroy")})()},this.start=function(){return(0,y.i3)(function(){var z,B;!k.enableReport()||(k.syncInit?k.started||((z=k.slardar)===null||z===void 0||z.call(k,"start"),k.sendCustom("mera_start",{start:1},{bid:k.bid||""}),k.started=!0):(B=k.startPromise)===null||B===void 0||B.then(function(){var q;k.started||((q=k.slardar)===null||q===void 0||q.call(k,"start"),k.sendCustom("mera_start",{start:1},{bid:k.bid||""}),k.started=!0)}),k.heartbeat&&Ce(),typeof k.garfishSlardarPlugin=="object"&&k.slardar&&k.isSubApp&&P({appName:k.garfishSlardarPlugin.appName,slardarInstance:k.slardar}))})()},this.config=function(z){return(0,y.i3)(function(){var B,q;!k.enableReport()||(k.syncInit?(B=k.slardar)===null||B===void 0||B.call(k,"config",z):(q=k.startPromise)===null||q===void 0||q.then(function(){var oe;(oe=k.slardar)===null||oe===void 0||oe.call(k,"config",z)}))})()},this.mergeContext=function(z){return(0,y.i3)(function(){var B;!k.enableReport()||(k.context=(0,y.I_)($($({},k.context),z)),(B=k.slardar)===null||B===void 0||B.call(k,"context.merge",k.context))})()},this.getContext=function(){return k.context},this.sendCustom=function(z,B,q){return z===void 0&&(z="perf"),q===void 0&&(q={}),(0,y.i3)(function(){var oe;!k.enableReport()||(oe=k.slardar)===null||oe===void 0||oe.call(k,"sendEvent",{name:z,metrics:B,categories:q})})()},this.sendCounter=function(z,B,q){return(0,y.i3)(function(){var oe;!k.enableReport()||(oe=k.slardar)===null||oe===void 0||oe.call(k,"sendEvent",{name:z,metrics:{count:B},categories:q})})()},this.sendTiming=function(z,B,q){return(0,y.i3)(function(){var oe,We;!k.enableReport()||(We=k.slardar)===null||We===void 0||We.call(k,"sendEvent",{name:z,metrics:(oe={},oe[z]=B,oe),categories:q})})()},this.sendLog=function(z,B,q){return z===void 0&&(z="info"),(0,y.i3)(function(){var oe;!k.enableReport()||(oe=k.slardar)===null||oe===void 0||oe.call(k,"sendLog",{content:B,level:z,extra:q})})()},this.sendErrorLog=function(z,B,q){B===void 0&&(B="default"),k.sendLog("error",z,$($({},q),{module:B}))},this.sendWarningLog=function(z,B,q){B===void 0&&(B="default"),k.sendLog("warn",z,$($({},q),{module:B}))},this.sendInfoLog=function(z,B,q){B===void 0&&(B="default"),k.sendLog("info",z,$($({},q),{module:B}))},this.sendAjaxStatus=function(z,B,q,oe){return oe===void 0&&(oe=0),(0,y.i3)(function(){var We;if(!!k.enableReport()){var Qe="ajax_code_monitor",be=z===oe?"right_ajax_code":"error_ajax_code",at=(We={},We[be]=1,We),Pt=B.replace(/^https?:\/\/[^/]+/,"").replace(/\?.*/,""),qe=$({path:Pt,code:z.toString()},q);k.sendCustom(Qe,at,qe)}})()},this.sendBoundaryError=function(z,B){return(0,y.i3)(function(){var q="boundary_error",oe=1,We={stack:(z==null?void 0:z.stack)||"no stack",name:z==null?void 0:z.name,message:z==null?void 0:z.message,componentStack:B};k.sendCounter(q,oe,We)})()},this.sendFormError=function(z,B){return(0,y.i3)(function(){if(!!k.enableReport()){var q="form_validate_error",oe=1,We={errkey:z,errtext:B};k.sendCounter(q,oe,We)}})()},this.sendMeraCustom=function(z,B){return B===void 0&&(B={}),(0,y.i3)(function(){var q;!k.enableReport()||k.sendCustom("mera_custom_event",(q={},q[z]=1,q),B)})()},this.captureException=function(z,B){return(0,y.i3)(function(){var q;!k.enableReport()||(q=k.slardar)===null||q===void 0||q.call(k,"captureException",z,{error_type:B})})()},this.captureMessage=function(z,B){return(0,y.i3)(function(){var q;!k.enableReport()||(q=k.slardar)===null||q===void 0||q.call(k,"captureException",new Error(z),B)})()},this.sendBreadcrumb=function(z,B,q,oe){return(0,y.i3)(function(){var We;!k.enableReport()||(We=k.slardar)===null||We===void 0||We.call(k,"addBreadcrumb",{type:z,message:B,category:q,data:oe})})()},this.cancelHeartBeat=function(){Ae()},this.sendCoreLinkEvent=function(z){var B=z.event_name,q=z.extra,oe=q===void 0?{}:q;k.sendCounter(y.HP+"_"+B,1,$({event_name:B},oe))};var te=(0,y.Rd)();if(!!te){if((0,y.gC)(),!Me.bid){console.error("\u914D\u7F6E\u4E2D\u7F3A\u5C11bid\u5C5E\u6027\uFF01");return}if(Me.release||(Me.release=this.getRelease()),this.bid=Me.bid,this.context=_t,this.devReport=Ne,this.syncInit=je,this.heartbeat=ut,this.isSubApp=Je,this.garfishSlardarPlugin=zt,(0,y.Xx)(this.bid,_t),(0,y.Il)(this.bid,vt),!!this.enableReport()){ut&&Pe({timeout:yt,duration:Bt,bid:Me.bid,log:Me.heartbeatLog});var S=$({garfishSlardarPlugin:zt,fallbackStart:$e,context:_t,beforeSend:Rt},Me);if(te.Mera.instanceMap[this.bid])return te.Mera.instanceMap[this.bid];if(((se=te.Mera.meraMaster)===null||se===void 0?void 0:se.bid)===this.bid)return te.Mera.meraMaster;var J=function(z){var B,q,oe,We,Qe,be;((oe=(0,y.Rd)())===null||oe===void 0?void 0:oe.SlardarWeb)&&!Je&&!((We=(0,y.Rd)())===null||We===void 0?void 0:We.Mera.meraMaster)?(z==null||z(k.slardar),(0,y.R3)("meraMaster",k)):(k.slardarClient=(0,c.AY)(),!Je&&((Qe=(0,y.Rd)())===null||Qe===void 0?void 0:Qe.Mera.meraMaster)===void 0&&(0,y.R3)("meraMaster",k),(0,y.R3)("instanceMap",$($({},te.Mera.instanceMap),(B={},B[k.bid]=k,B))),z==null||z(k.slardar)),(be=k.slardar)===null||be===void 0||be.call(k,"on","init",function(){typeof ar=="function"&&(0,y.i3)(function(){k.slardar&&ar(k.slardar)})(),k.onSlardarInit(k.slardar,Et,Zt)}),(0,y.R3)("matchMap",$($({},te.Mera.matchMap),(q={},q[k.bid]=vt||/.*/,q))),k.init(S)};this.syncInit?J():this.startPromise=new Promise(function(z){J(z)})}}}return Object.defineProperty(K.prototype,"slardar",{get:function(){var I;return this.slardarClient||((I=(0,y.Rd)())===null||I===void 0?void 0:I.SlardarWeb)},enumerable:!1,configurable:!0}),K}();const Re=ye;var He=function(){return He=Object.assign||function(K){for(var I,k=1,se=arguments.length;k<se;k++){I=arguments[k];for(var pe in I)Object.prototype.hasOwnProperty.call(I,pe)&&(K[pe]=I[pe])}return K},He.apply(this,arguments)},we=function(K){return new Mera(He(He(He({},defaultConfig),K),{plugins:mergePluginConfig(defaultConfig.plugins,K.plugins)}))};const fe=Re},23335:(l,n,o)=>{o.d(n,{C:()=>y});var c=o(35578),h=o(45867),g=function(){return g=Object.assign||function(O){for(var M,G=1,le=arguments.length;G<le;G++){M=arguments[G];for(var Pe in M)Object.prototype.hasOwnProperty.call(M,Pe)&&(O[Pe]=M[Pe])}return O},g.apply(this,arguments)},b="ecom_fe_core_link",y=function(O){var M=O.business;return{name:"coreLink",setup:function(G){var le=G.config();if(!!le){var Pe=le.bid,Ce=new c.Z(Pe,b);Ce.init({bid:Pe,business:M}),G.on("beforeSend",function(De){var Ae=De.ev_type,ge=De.payload,Te=De.common,ce=Te.pid,x=ge,P=x.name,$=x.categories,he=$===void 0?{}:$;return Ae==="custom"&&(P==null?void 0:P.includes(h.HP))&&Ce.sendEvent(g(g({},he),{pid:ce})),De})}}}}},84325:(l,n,o)=>{o.d(n,{I:()=>De});var c=o(55347),h=o.n(c),g=o(78424),b=o(86012),y=o(45867),O=o(35578),M=function(){return M=Object.assign||function(Ae){for(var ge,Te=1,ce=arguments.length;Te<ce;Te++){ge=arguments[Te];for(var x in ge)Object.prototype.hasOwnProperty.call(ge,x)&&(Ae[x]=ge[x])}return Ae},M.apply(this,arguments)},G;(function(Ae){Ae.S_PV="S_PV",Ae.S_JS_ERROR="S_JS_ERROR",Ae.S_BOUNDARY_ERROR="S_BOUNDARY_ERROR",Ae.S_RESOURCE_IMG_ERROR="S_RESOURCE_IMG_ERROR",Ae.S_RESOURCE_CSS_ERROR="S_RESOURCE_CSS_ERROR",Ae.S_RESOURCE_JS_ERROR="S_RESOURCE_JS_ERROR",Ae.S_BLANK_SCREEN="S_BLANK_SCREEN"})(G||(G={}));var le="ecom_infra_fe_monitor",Pe={enabled:!1,onlineEnv:"production",collector:g.P,collect:{S_PV:!0,S_JS_ERROR:!0,S_BOUNDARY_ERROR:!0,S_RESOURCE_IMG_ERROR:!0,S_RESOURCE_CSS_ERROR:!0,S_RESOURCE_JS_ERROR:!0,S_BLANK_SCREEN:!0}},Ce=function(Ae,ge,Te){if(!(!Te||!Ae)){var ce=Ae.ev_type,x=Ae.common,P=Ae.payload,$=x.pid,he=x.env,ye=function($e,Oe){$e&&Te.sendEvent(M(M({},Oe),{pid:$,env:he}))},Re=ge.S_PV,He=Re===void 0?!0:Re,we=ge.S_JS_ERROR,fe=we===void 0?!0:we,K=ge.S_BOUNDARY_ERROR,I=K===void 0?!0:K,k=ge.S_BLANK_SCREEN,se=k===void 0?!0:k;if(!(!P||(0,y.J)($))){switch(ce){case"pageview":{ye((0,y.oA)(He),{type:G.S_PV,detail:""});break}case"js_error":{ye((0,y.oA)(fe),{type:G.S_JS_ERROR,detail:JSON.stringify({stack:P.error.stack,name:P.error.name,message:P.error.message})});break}case"custom":{var pe=P.name;pe==="boundary_error"&&ye((0,y.oA)(I),{type:G.S_BOUNDARY_ERROR,detail:JSON.stringify({stack:P.categories.stack,name:P.categories.name,message:P.categories.message})});break}case"resource_error":{var Je={img:G.S_RESOURCE_IMG_ERROR,script:G.S_RESOURCE_JS_ERROR,link:G.S_RESOURCE_CSS_ERROR},me=P,Ne=me.type,ne=me.url;Je[Ne]&&ye((0,y.oA)(ge[Je[Ne]]),{type:Je[Ne],detail:JSON.stringify({url:ne})});break}case"blank_screen":{ye((0,y.oA)(se),{detail:""});break}default:break}return!1}}},De=function(Ae){var ge=h()(Pe,Ae),Te=ge.enabled,ce=ge.onlineEnv,x=ge.collect;return{name:"kepler",setup:function(P){var $;if(!!Te){var he=P.config()||{bid:"",env:""},ye=he,Re=ye.bid,He=ye.env,we=ye.beforeSend,fe=(($=(0,y.Rd)())===null||$===void 0?void 0:$.Mera.matchMap)||{};if(!(!ce||!Re||He!==ce)){var K=new O.Z(Re,le);K.init({bid:Re}),P.on("beforeSend",function(I){var k=typeof we=="function"?we(I):I;return k&&(!fe[Re]||!(0,b.f)({bid:Re,event:I,match:fe[Re],matchMap:fe})?null:(Ce(k,x,K),k))})}}}}}},83190:(l,n,o)=>{o.d(n,{Y:()=>O});var c=o(55347),h=o.n(c),g=o(45867),b="rehearsal",y=function(){var M=(0,g.pm)().recordId;return M?{recordId:M,rehearsalStatus:"1"}:null},O=function(){return{name:"rehearse",setup:function(M){M.on("beforeSend",function(G){var le=(0,g.i3)(y)();if(le){var Pe=G.common;G.common=h()(Pe,{context:(0,g.I_)(le),env:b})}return G})}}}},45867:(l,n,o)=>{o.d(n,{ti:()=>y,FT:()=>O,gC:()=>M,Rd:()=>G,R3:()=>Pe,Xx:()=>Ce,Il:()=>De,i3:()=>Ae,I_:()=>ge,J:()=>He,oA:()=>we,pm:()=>fe,HP:()=>K});var c=o(55347),h=o.n(c),g=function(){return g=Object.assign||function(I){for(var k,se=1,pe=arguments.length;se<pe;se++){k=arguments[se];for(var Je in k)Object.prototype.hasOwnProperty.call(k,Je)&&(I[Je]=k[Je])}return I},g.apply(this,arguments)},b=function(I,k){for(var se=0,pe=k.length,Je=I.length;se<pe;se++,Je++)I[Je]=k[se];return I},y=function(){var I,k,se;return typeof window=="undefined"?!1:(((se=(k=(I=G())===null||I===void 0?void 0:I.localStorage)===null||k===void 0?void 0:k.getItem)===null||se===void 0?void 0:se.call(k,"enableDevMera"))==="1",!0)},O=function(I,k,se){var pe=h()({},I,k||{});if(Object.keys(I).forEach(function(Oe){k[Oe]&&Array.isArray(I[Oe])&&(pe[Oe]=b(b([],I[Oe]),k[Oe]))}),typeof pe.pageview=="object"&&typeof pe.pageview.extractPid=="function"){var Je=pe.pageview.extractPid;pe.pageview.extractPid=function(Oe){var je=Oe;try{window.URL?je=new URL(je).pathname:je=je.replace(/^https?:\/\/[^/]*/,"").replace(/\?.*$/,"")}catch(vt){console.error(vt)}return Je(Oe,je)}}if(se){pe.performance={fp:!1,fcp:!1,fid:!1,mpfid:!1,lcp:!1,cls:!1},pe.tti=!1,pe.fmp=!1;var me=["xmlhttprequest","beacon"];if(typeof pe.resource=="object")if(pe.resource.ignoreTypes){pe.resource.ignoreTypes.forEach(function(Oe){Oe===me[0]&&me.shift(),Oe===me[1]&&me.pop()});for(var Ne=0,ne=me;Ne<ne.length;Ne++){var $e=ne[Ne];pe.resource.ignoreTypes.push($e)}}else pe.resource.ignoreTypes=me;else pe.resource={ignoreTypes:me}}return pe},M=function(){var I=G();I&&!(I==null?void 0:I.Mera)&&(I.Mera={matchMap:{},instanceMap:{}}),window.Mera||(window.Mera={matchMap:{},instanceMap:{}})},G=function(){if(typeof window!="undefined")return window.Garfish?window.Garfish.getGlobalObject():window},le=function(I,k){var se;typeof window!="undefined"&&(window.Mera=g(g({},window.Mera),(se={},se[I]=k,se)))},Pe=function(I,k){var se,pe,Je;if(typeof window!="undefined"){if(window.Garfish){var me=((Je=G())===null||Je===void 0?void 0:Je.Mera)||{};window.Garfish.setGlobalValue("Mera",g(g({},me),(se={},se[I]=k,se)));return}window.Mera=g(g({},window.Mera),(pe={},pe[I]=k,pe))}},Ce=function(I,k){return!(k==null?void 0:k.version)===void 0||(k==null?void 0:k.canary)===void 0?(console.error("context\u4E2D\u7F3A\u5C11version\u6216canary\u4FE1\u606F\uFF0C\u53EF\u80FD\u5BFC\u81F4\u76D1\u63A7\u529F\u80FD\u5F02\u5E38\uFF01\u8BF7\u53CA\u65F6\u8865\u5145\u3002error Mera bid\uFF1A"+I),!1):!0},De=function(I,k){if(k===void 0||k instanceof RegExp)return!0;if(typeof k=="object"){for(var se=!0,pe=Object.keys(k).map(function(Ne){return k[Ne]}),Je=0;Je<pe.length;Je++){var me=pe[Je];if(!(me instanceof RegExp)){se=!1;break}}return se}return console.error("match\u76EE\u524D\u4EC5\u652F\u6301\u6B63\u5219\u6216\u6B63\u5219\u5BF9\u8C61\uFF0C\u8BF7\u68C0\u67E5match\u914D\u7F6E\u3002error Mera bid\uFF1A"+I),!1},Ae=function(I){return function(){for(var k=[],se=0;se<arguments.length;se++)k[se]=arguments[se];try{return I.apply(void 0,k)}catch(pe){}}},ge=function(I){if(I==null||typeof I!="object")return{};var k={};return Object.keys(I).forEach(function(se){k[se]=""+I[se]}),k},Te=function(I){Ae(function(){NativeModules&&NativeModules.hybridMonitor&&NativeModules.hybridMonitor.config&&NativeModules.hybridMonitor.config(I,function(k){k&&k.errorCode!==0&&console.error("hybridMonitor.customReport\u4E0A\u62A5\u5931\u8D25 ",k.errorMessage)})})()},ce=function(I){Ae(function(){NativeModules&&NativeModules.hybridMonitor&&NativeModules.hybridMonitor.customReport&&(I=g({level:0},I),NativeModules.hybridMonitor.customReport(I,function(k){var se=k.errorCode,pe=k.errorMessage;se!==0&&console.error("hybridMonitor.customReport\u4E0A\u62A5\u9519\u8BEF\u5931\u8D25 ",pe)}))})()},x=function(I){var k=window;k&&k.SlardarHybrid?I():setTimeout(Ae(I),3e3)},P=function(I,k){Ae(function(){k&&(k("init",I),k("start")),x(function(){var se=window;se&&typeof se.SlardarHybrid=="function"&&se.SlardarHybrid("config",I)})})()},$=function(I,k){Ae(function(){k&&k.sendEvent?k.sendEvent(I):x(function(){var se=g(g({},I),{metric:I.metrics}),pe=window;pe&&typeof pe.SlardarHybrid=="function"&&pe.SlardarHybrid("emit","custom",se)})})()},he=function(I,k){Ae(function(){x(function(){var se=window;se&&typeof se.SlardarHybrid=="function"&&se.SlardarHybrid("captureException",I,k)})})()},ye=function(I,k){P(I,k),Te(I)},Re=function(I,k){$(I,k),ce(I)},He=function(I){if(!!I){var k="";return/^\//.test(I)||(k+="pid\u5E94\u8BE5\u4EE5\u201D/\u201C\u5F00\u5934\u3002"),/\?/.test(I)&&(k+="pid\u4E0D\u5E94\u5305\u542B\u67E5\u8BE2\u5B57\u7B26\u4E32(\u901A\u8FC7\u68C0\u6D4B\u95EE\u53F7?)\u3002"),k&&console.warn("\u3010Mera\u3011"+k+" pid: "+I),k}},we=function(I){return I===!0};function fe(){var I=localStorage.getItem("recordId")||(localStorage.rawStorage||{}).recordId;if(I)return{recordId:I};var k=decodeURIComponent(location.search),se={};if(k.indexOf("?")!==-1)for(var pe=k.slice(1),Je=pe.split("&"),me=0;me<Je.length;me++){var Ne=Je[me].split("=");se[Ne[0]]=Ne[1]}return se}var K="CORE_LINK"},17755:(l,n,o)=>{o.d(n,{j2:()=>ae});var c=o(50436),h=o(28003),g=o.n(h),b=o(72635),y=function(){return y=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},y.apply(this,arguments)},O=function(te){return Promise.all(te.map(function(S){var J,z,B,q,oe;try{if(S.component){var We={};(z=(J=S.component)===null||J===void 0?void 0:J.params)===null||z===void 0||z.forEach(function(be){var at=y(y(y({},S.contextStore),S.storeGetters),S.modalStore);We[be.key]=be.value?typeof be.value=="string"?(0,b.k)(be.value,S,void 0):be.value:g()(at,be.path)});var Qe={};(q=(B=S.component)===null||B===void 0?void 0:B.funcArr)===null||q===void 0||q.forEach(function(be){var at=y(y(y({},S.contextStore),S.storeGetters),S.modalStore);Qe[be.funcName]=function(){var Pt,qe,Ft;return(Ft=(Pt=ae())===null||Pt===void 0?void 0:(qe=Pt.customBizFuncMap)[be==null?void 0:be.funcName])===null||Ft===void 0?void 0:Ft.call(qe,at)}}),S.component.props=y(y(y({},((oe=S==null?void 0:S.component)===null||oe===void 0?void 0:oe.props)||{}),We),Qe)}return S}catch(be){return S.conditionRes=!1,S}})).catch(function(S){return S})};const M=O;var G=function(){return G=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},G.apply(this,arguments)},le=function(te,S){var J,z,B=te.operator;if(te.leftChild?J=le(te.leftChild,S):(te.left||te.left===0)&&(typeof te.left=="number"||typeof te.left=="string"?J=te.left:J=g()(S,te.left.path)),te.rightChild?z=le(te.rightChild,S):(te.right||te.right===0)&&(typeof te.right=="number"||typeof te.right=="string"?z=te.right:z=g()(S,te.right.path)),typeof J=="boolean"&&typeof z=="boolean"){if(B==="&&")return J&&z;if(B==="||")return J||z}else if(typeof J=="string"&&typeof z=="string"||typeof J=="number"&&typeof z=="number"){if(B===">=")return J>=z;if(B==="<=")return J<=z;if(B===">")return J>z;if(B==="<")return J<z;if(B==="===")return J===z;if(B==="!==")return J!==z}else{if(B==="===")return J===z;if(B==="!==")return J!==z}return!1},Pe=function(te){return Promise.resolve(te.filter(function(S){try{var J=S.condition,z=S.conditionRes;return J?(S.conditionRes=le(J,G(G(G({},S.contextStore),S.storeGetters),S.modalStore)),S.conditionRes):typeof z=="undefined"?!0:typeof z=="string"?(S.conditionRes=(0,b.k)(z,S,!1),S.conditionRes):z}catch(B){return!1}})).catch(function(S){return S})};const Ce=Pe;var De=function(){return De=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},De.apply(this,arguments)},Ae=function(te){return Promise.all(te.map(function(S){var J,z,B,q;try{if(S.modalFunc){var oe={};(z=(J=S.modalFunc)===null||J===void 0?void 0:J.params)===null||z===void 0||z.forEach(function(Qe){var be=De(De(De({},S.contextStore),S.storeGetters),S.modalStore);oe[Qe.key]=Qe.value?typeof Qe.value=="string"?(0,b.k)(Qe.value,S,void 0):Qe.value:g()(be,Qe.path)});var We={};(q=(B=S.modalFunc)===null||B===void 0?void 0:B.funcArr)===null||q===void 0||q.forEach(function(Qe){var be=De(De(De({},S.contextStore),S.storeGetters),S.modalStore);We[Qe.funcName]=function(){var at,Pt,qe;return(qe=(at=ae())===null||at===void 0?void 0:(Pt=at.customBizFuncMap)[Qe==null?void 0:Qe.funcName])===null||qe===void 0?void 0:qe.call(Pt,be)}}),S.modalFunc.props=De(De(De({},S.modalFunc.props||{}),oe),We)}return S}catch(Qe){return S.conditionRes=!1,S}})).catch(function(S){return S})};const ge=Ae;var Te=function(){return Te=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},Te.apply(this,arguments)},ce=function(te){return Promise.all(te.map(function(S){var J,z;try{if(S.afterModalClose){var B={};(z=(J=S.afterModalClose)===null||J===void 0?void 0:J.params)===null||z===void 0||z.forEach(function(q){var oe=Te(Te(Te({},S.contextStore),S.storeGetters),S.modalStore);B[q.key]=q.value?typeof q.value=="string"?(0,b.k)(q.value,S,void 0):q.value:g()(oe,q.path)}),S.afterModalClose.props=B}return S}catch(q){return S.conditionRes=!1,S}})).catch(function(S){return S})};const x=ce;var P=function(){return P=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},P.apply(this,arguments)},$=function(te){return Promise.all(te.map(function(S){var J,z;try{if(S.onNext){var B={};(z=(J=S.onNext)===null||J===void 0?void 0:J.params)===null||z===void 0||z.forEach(function(q){var oe=P(P(P({},S.contextStore),S.storeGetters),S.modalStore);B[q.key]=q.value?typeof q.value=="string"?(0,b.k)(q.value,S,void 0):q.value:g()(oe,q.path)}),S.onNext.props=B}return S}catch(q){return S.conditionRes=!1,S}})).catch(function(S){return S})};const he=$;var ye=o(55921),Re=o(63508),He=o.n(Re),we=function(){return we=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},we.apply(this,arguments)},fe=function(te,S){var J,z=function(){};if(S.action==="close"&&(z=function(){}),(S.action==="jumpPage"||S.action==="download")&&(S.url=(0,b.k)(S.url||"",te,""),z=function(){S.url&&window.open(S.url)}),S.action==="get"||S.action==="post"){var B=S.action==="get"?He().get:He().post,q={};(J=S==null?void 0:S.params)===null||J===void 0||J.forEach(function(oe){var We=we(we(we({},te.contextStore),te.storeGetters),te.modalStore);q[oe.key]=oe.value?typeof oe.value=="string"?(0,b.k)(oe.value,te,void 0):oe.value:g()(We,oe.path)}),z=function(){S.url&&B(S.url,q).then(function(){}).catch(function(){ye.ZP.error("\u8BF7\u6C42\u5931\u8D25")})}}return S.action==="customOperate"&&(z=function(){var oe,We,Qe,be=((oe=ae())===null||oe===void 0?void 0:oe.customBizFuncMap[(We=S==null?void 0:S.customOperate)===null||We===void 0?void 0:We.funcName])||null,at=((Qe=S==null?void 0:S.customOperate)===null||Qe===void 0?void 0:Qe.props)||void 0;(S==null?void 0:S.customOperate)&&be&&be(at)}),function(){if(z(),S.nextAction)var oe=fe(te,S.nextAction),We=setTimeout(function(){oe(),clearTimeout(We)},500)}},K=function(te){return Promise.resolve(te.map(function(S){var J;try{return((J=S==null?void 0:S.operations)===null||J===void 0?void 0:J.length)?S.operations=S.operations.map(function(z){var B;z.text=(0,b.k)(z.text||"",S,""),z.url=(0,b.k)(z.url||"",S,"");var q={};return(B=z==null?void 0:z.propsArr)===null||B===void 0||B.forEach(function(oe){var We=we(we(we({},S.contextStore),S.storeGetters),S.modalStore);q[oe.key]=oe.value?typeof oe.value=="string"?(0,b.k)(oe.value,S,void 0):oe.value:g()(We,oe.path)}),z.props=q,z.actionFunc=fe(S,{action:z.action,params:z.params,url:z.url,nextAction:z.nextAction,customOperate:z.customOperate}),z}):S.operations=[{action:"close",type:"ok"},{action:"close",type:"cancel"}],S}catch(z){return S.conditionRes=!1,S}})).catch(function(S){return S})};const I=K;var k=o(21216),se=function(){if(typeof window=="undefined")return{};var te=window.location.search,S=te.split("?");return S[1]?(0,k.parse)(S[1]):{}},pe=function(){return pe=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},pe.apply(this,arguments)},Je=function(te,S,J,z){function B(q){return q instanceof J?q:new J(function(oe){oe(q)})}return new(J||(J=Promise))(function(q,oe){function We(at){try{be(z.next(at))}catch(Pt){oe(Pt)}}function Qe(at){try{be(z.throw(at))}catch(Pt){oe(Pt)}}function be(at){at.done?q(at.value):B(at.value).then(We,Qe)}be((z=z.apply(te,S||[])).next())})},me=function(te,S){var J={label:0,sent:function(){if(q[0]&1)throw q[1];return q[1]},trys:[],ops:[]},z,B,q,oe;return oe={next:We(0),throw:We(1),return:We(2)},typeof Symbol=="function"&&(oe[Symbol.iterator]=function(){return this}),oe;function We(be){return function(at){return Qe([be,at])}}function Qe(be){if(z)throw new TypeError("Generator is already executing.");for(;J;)try{if(z=1,B&&(q=be[0]&2?B.return:be[0]?B.throw||((q=B.return)&&q.call(B),0):B.next)&&!(q=q.call(B,be[1])).done)return q;switch(B=0,q&&(be=[be[0]&2,q.value]),be[0]){case 0:case 1:q=be;break;case 4:return J.label++,{value:be[1],done:!1};case 5:J.label++,B=be[1],be=[0];continue;case 7:be=J.ops.pop(),J.trys.pop();continue;default:if(q=J.trys,!(q=q.length>0&&q[q.length-1])&&(be[0]===6||be[0]===2)){J=0;continue}if(be[0]===3&&(!q||be[1]>q[0]&&be[1]<q[3])){J.label=be[1];break}if(be[0]===6&&J.label<q[1]){J.label=q[1],q=be;break}if(q&&J.label<q[2]){J.label=q[2],J.ops.push(be);break}q[2]&&J.ops.pop(),J.trys.pop();continue}be=S.call(te,J)}catch(at){be=[6,at],B=0}finally{z=q=0}if(be[0]&5)throw be[1];return{value:be[0]?be[1]:void 0,done:!0}}},Ne=function(te){return Promise.all(te.map(function(S){return Je(void 0,void 0,void 0,function(){var J,z,B,q,oe,We,Qe,be,at,Pt;return me(this,function(qe){switch(qe.label){case 0:return qe.trys.push([0,3,,4]),J=S.request||{},z=J.url,B=J.path,q=B===void 0?"data":B,S.storeGetters=JSON.parse((sessionStorage==null?void 0:sessionStorage.getItem(S.sessionKey||"storeGetters"))||((be=sessionStorage==null?void 0:sessionStorage.rawStorage)===null||be===void 0?void 0:be.getItem(S.sessionKey||"storeGetters"))||"{}"),S.localStorageKey&&(S.storeGetters=pe(pe({},S.storeGetters),JSON.parse((localStorage==null?void 0:localStorage.getItem(S.localStorageKey))||"{}"))),S.contextStore=pe(pe({},S.contextStore),se()),z?(oe=(0,b.k)(z,S,""),oe?[4,He().get(oe)]:[3,2]):[3,2];case 1:We=qe.sent(),S.contextStore=pe(pe({},S.contextStore),g()(We,q)),S.bizData=((at=S==null?void 0:S.request)===null||at===void 0?void 0:at.path)?g()(We,q):(Pt=g()(We,q))===null||Pt===void 0?void 0:Pt.data,qe.label=2;case 2:return[2,S];case 3:return Qe=qe.sent(),S.conditionRes=!1,[2,S];case 4:return[2]}})})})).catch(function(S){return S})};const ne=Ne;var $e=o(22505),Oe=o.n($e),je=function(){var te=navigator.userAgent,S=te.indexOf("Opera")>-1;if(te.indexOf("Opera")>-1)return"Opera";if(te.indexOf("Firefox")>-1)return"Firefox";if(te.indexOf("Chrome")>-1)return"Chrome";if(te.indexOf("Safari")>-1)return"Safari";if(te.indexOf("compatible")>-1&&te.indexOf("MSIE")>-1&&!S)return"IE";if(te.indexOf("Trident")>-1)return"Edge"};const vt=je;var Rt=function(te){return Promise.resolve(te.filter(function(S){var J,z;try{var B=S.name,q=S.rules;if(!q)return!0;var oe=(J=q==null?void 0:q.popup_duration_range)===null||J===void 0?void 0:J.start,We=(z=q==null?void 0:q.popup_duration_range)===null||z===void 0?void 0:z.end,Qe=q==null?void 0:q.popup_time,be=q==null?void 0:q.popup_duration,at=q==null?void 0:q.allow_page_list,Pt=q==null?void 0:q.allow_browser_list,qe=JSON.parse(localStorage.getItem("cyborg-modal-list-modal".concat(B))||"{}"),Ft=Oe()().unix();if(Pt){var wr=vt();if(wr&&Pt.indexOf(wr)===-1)return!1}if(at){var Wt=window.location.pathname;if(Wt&&at.indexOf(Wt)===-1)return!1}return oe&&Ft<oe||We&&Ft>We?!1:be&&Oe().unix(qe==null?void 0:qe.firstPopTimeStamp).add(be,"seconds").unix()<Ft?(localStorage.removeItem("cyborg-modal-list-modal".concat(B)),!0):!(Qe&&Number(qe.popedTimes)>=Qe)}catch(Gr){return!1}}))};const _t=Rt;var Xe=function(){return Xe=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},Xe.apply(this,arguments)},ut=function(te){return Promise.all(te.map(function(S){var J,z,B,q,oe;try{if(S.customContent){var We={};(z=(J=S.customContent)===null||J===void 0?void 0:J.params)===null||z===void 0||z.forEach(function(be){var at=Xe(Xe(Xe({},S.contextStore),S.storeGetters),S.modalStore);We[be.key]=be.value?typeof be.value=="string"?(0,b.k)(be.value,S,void 0):be.value:g()(at,be.path)});var Qe={};(q=(B=S.customContent)===null||B===void 0?void 0:B.funcArr)===null||q===void 0||q.forEach(function(be){var at=Xe(Xe(Xe({},S.contextStore),S.storeGetters),S.modalStore);Qe[be.funcName]=function(){var Pt,qe,Ft;return(Ft=(Pt=ae())===null||Pt===void 0?void 0:(qe=Pt.customBizFuncMap)[be==null?void 0:be.funcName])===null||Ft===void 0?void 0:Ft.call(qe,at)}}),S.customContent.props=Xe(Xe(Xe({},((oe=S==null?void 0:S.customContent)===null||oe===void 0?void 0:oe.props)||{}),We),Qe)}return S}catch(be){return S.conditionRes=!1,S}})).catch(function(S){return S})};const yt=ut;var Bt=function(){return Bt=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},Bt.apply(this,arguments)},ar=function(te){return Promise.all(te.map(function(S){var J,z;try{return S.operations=(z=(J=S==null?void 0:S.operations)===null||J===void 0?void 0:J.map)===null||z===void 0?void 0:z.call(J,function(B){var q,oe;if(B.customOperate){var We={};(oe=(q=B.customOperate)===null||q===void 0?void 0:q.params)===null||oe===void 0||oe.forEach(function(Qe){var be=Bt(Bt(Bt({},S.contextStore),S.storeGetters),S.modalStore);We[Qe.key]=Qe.value?typeof Qe.value=="string"?(0,b.k)(Qe.value,S,void 0):Qe.value:g()(be,Qe.path)}),B.customOperate.props=We}return B}),S}catch(B){return S.conditionRes=!1,S}})).catch(function(S){return S})};const Et=ar;var Zt=function(){return Zt=Object.assign||function(te){for(var S,J=1,z=arguments.length;J<z;J++){S=arguments[J];for(var B in S)Object.prototype.hasOwnProperty.call(S,B)&&(te[B]=S[B])}return te},Zt.apply(this,arguments)},xt=function(te,S,J){if(J||arguments.length===2)for(var z=0,B=S.length,q;z<B;z++)(q||!(z in S))&&(q||(q=Array.prototype.slice.call(S,0,z)),q[z]=S[z]);return te.concat(q||Array.prototype.slice.call(S))},zt=function(){function te(){var S=this;this.customBizFuncMap={},this.customModalFuncMap={},this.componentMap={},this.customContentMap={},this.registerKeyArr=[],this.preRegisterArr=[],this.handlers=[],this.registerModal=function(J,z){var B=new Promise(function(q){z(q)});return setTimeout(function(){var q,oe;((q=S.registerKeyArr)===null||q===void 0?void 0:q.indexOf(J))!==-1?console.warn("=====\u5F39\u7A97key".concat(J,"\u91CD\u590D\u6CE8\u518C=====")):((oe=S.getEmitter())===null||oe===void 0||oe.emit("emit-modal-register"),S.registerKeyArr.push(J),S.preRegisterArr=xt(xt([],S.preRegisterArr,!0),[{key:J,p:B}],!1))},20),B},this.registerComponent=function(J){var z={};Object.keys(J).forEach(function(B){S.componentMap[B]?console.warn("=====\u7EC4\u4EF6".concat(B,"\u91CD\u590D\u6CE8\u518C=====")):z[B]=J[B]}),S.componentMap=Zt(Zt({},S.componentMap),z)},this.registerCustomContent=function(J){var z={};Object.keys(J).forEach(function(B){S.customContentMap[B]?console.warn("=====\u81EA\u5B9A\u4E49\u5F39\u7A97\u5185\u5BB9".concat(B,"\u91CD\u590D\u6CE8\u518C=====")):z[B]=J[B]}),S.customContentMap=Zt(Zt({},S.customContentMap),z)},this.registerCustomModalFunc=function(J){var z={};Object.keys(J).forEach(function(B){S.customModalFuncMap[B]?console.warn("====\u81EA\u5B9A\u4E49\u5F39\u7A97".concat(B,"\u91CD\u590D\u6CE8\u518C=====")):z[B]=J[B]}),S.customModalFuncMap=Zt(Zt({},S.customModalFuncMap),z)},this.registerCustomBizFunc=function(J){var z={};Object.keys(J).forEach(function(B){S.customBizFuncMap[B]?console.warn("====\u81EA\u5B9A\u4E49\u4E1A\u52A1\u51FD\u6570".concat(B,"\u91CD\u590D\u6CE8\u518C=====")):z[B]=J[B]}),S.customBizFuncMap=Zt(Zt({},S.customBizFuncMap),z)},this.registerReportInstance=function(J,z){S.reportInstance||(S.reportInstance=J),z&&(S.eventName=z)},this.setPreRegisterArr=function(J){S.preRegisterArr=J},this.getPreRegisterArr=function(){return S.preRegisterArr},this.setRegisterKeyArr=function(J){S.registerKeyArr=J},this.getRegisterKeyArr=function(){return S.registerKeyArr},this.getEmitter=function(){return S.emitter},this.getReportInstance=function(){return S.reportInstance?S.reportInstance:null},this.getEventName=function(){return S.eventName},this.customModalFuncMap={},this.componentMap={},this.reportInstance=null,this.eventName={modalShow:"show_home_page_layer",btnClick:"click_home_page_layer"},this.handlers=[ne,_t,Et,I,M,yt,ge,x,he,Ce],this.emitter=new c.EventEmitter2({wildcard:!1,delimiter:".",newListener:!0,removeListener:!0,maxListeners:10,verboseMemoryLeak:!1,ignoreErrors:!1})}return te}(),ae=function(te){var S;te===void 0&&(te=window);var J=(S=window==null?void 0:window.Garfish)===null||S===void 0?void 0:S.getGlobalObject();return J?J.modalManger?J.modalManger:J.modalManger=new zt:(te.modalManger||(te.modalManger=new zt),te.modalManger)},Me=function(te){var S,J,z,B,q,oe,We,Qe;if(!te)return null;var be=(S=window==null?void 0:window.Garfish)===null||S===void 0?void 0:S.getGlobalObject(),at;try{((z=(J=be==null?void 0:be.Mera)===null||J===void 0?void 0:J.meraMaster)===null||z===void 0?void 0:z.bid)===(te==null?void 0:te.bid)?at=(B=be==null?void 0:be.Mera)===null||B===void 0?void 0:B.meraMaster:((oe=(q=be==null?void 0:be.Mera)===null||q===void 0?void 0:q.instanceMap)===null||oe===void 0?void 0:oe[te==null?void 0:te.bid])?at=(Qe=(We=be==null?void 0:be.Mera)===null||We===void 0?void 0:We.instanceMap)===null||Qe===void 0?void 0:Qe[te==null?void 0:te.bid]:(at=new Mera(te),at==null||at.start())}catch(Pt){}return at}},65817:(l,n,o)=>{o.d(n,{Z:()=>Je});var c=o(37545),h=o(25055),g=o.n(h),b=o(63671),y=o.n(b),O=function(me,Ne,ne,$e){function Oe(je){return je instanceof ne?je:new ne(function(vt){vt(je)})}return new(ne||(ne=Promise))(function(je,vt){function Rt(ut){try{Xe($e.next(ut))}catch(yt){vt(yt)}}function _t(ut){try{Xe($e.throw(ut))}catch(yt){vt(yt)}}function Xe(ut){ut.done?je(ut.value):Oe(ut.value).then(Rt,_t)}Xe(($e=$e.apply(me,Ne||[])).next())})},M=function(me,Ne){var ne={label:0,sent:function(){if(je[0]&1)throw je[1];return je[1]},trys:[],ops:[]},$e,Oe,je,vt;return vt={next:Rt(0),throw:Rt(1),return:Rt(2)},typeof Symbol=="function"&&(vt[Symbol.iterator]=function(){return this}),vt;function Rt(Xe){return function(ut){return _t([Xe,ut])}}function _t(Xe){if($e)throw new TypeError("Generator is already executing.");for(;ne;)try{if($e=1,Oe&&(je=Xe[0]&2?Oe.return:Xe[0]?Oe.throw||((je=Oe.return)&&je.call(Oe),0):Oe.next)&&!(je=je.call(Oe,Xe[1])).done)return je;switch(Oe=0,je&&(Xe=[Xe[0]&2,je.value]),Xe[0]){case 0:case 1:je=Xe;break;case 4:return ne.label++,{value:Xe[1],done:!1};case 5:ne.label++,Oe=Xe[1],Xe=[0];continue;case 7:Xe=ne.ops.pop(),ne.trys.pop();continue;default:if(je=ne.trys,!(je=je.length>0&&je[je.length-1])&&(Xe[0]===6||Xe[0]===2)){ne=0;continue}if(Xe[0]===3&&(!je||Xe[1]>je[0]&&Xe[1]<je[3])){ne.label=Xe[1];break}if(Xe[0]===6&&ne.label<je[1]){ne.label=je[1],je=Xe;break}if(je&&ne.label<je[2]){ne.label=je[2],ne.ops.push(Xe);break}je[2]&&ne.ops.pop(),ne.trys.pop();continue}Xe=Ne.call(me,ne)}catch(ut){Xe=[6,ut],Oe=0}finally{$e=je=0}if(Xe[0]&5)throw Xe[1];return{value:Xe[0]?Xe[1]:void 0,done:!0}}},G=function(me,Ne){return function(){return O(void 0,void 0,void 0,function(){var ne;return M(this,function($e){return ne=function(Oe,je){return O(void 0,void 0,void 0,function(){var vt;return M(this,function(Rt){switch(Rt.label){case 0:return Oe===me.length-1?[2,me[Oe](je)]:[4,me[Oe](je)];case 1:return vt=Rt.sent(),[2,ne(Oe+1,vt)]}})})},[2,ne(0,Ne)]})})}};const le=G;var Pe=o(22505),Ce=o.n(Pe),De=o(62507),Ae=o(7980),ge=o(72635),Te=function(){return Te=Object.assign||function(me){for(var Ne,ne=1,$e=arguments.length;ne<$e;ne++){Ne=arguments[ne];for(var Oe in Ne)Object.prototype.hasOwnProperty.call(Ne,Oe)&&(me[Oe]=Ne[Oe])}return me},Te.apply(this,arguments)},ce=function(me){return c.createElement(De.ZP,Te({},me),me.content)},x=(0,Ae.y)(ce),P=function(me){var Ne=me.timeRef,ne=(0,c.useState)(Ne.timeout),$e=ne[0],Oe=ne[1],je=(0,c.useRef)();return(0,c.useEffect)(function(){return je.current=setInterval(function(){if(--Ne.timeout<=0){Oe(Ne.timeout),clearInterval(je.current);return}Oe(Ne.timeout)},1e3),function(){clearInterval(je.current)}},[]),c.createElement(c.Fragment,null,$e?" ".concat($e,"s"):"")},$=function(me,Ne,ne,$e){if(!me)return{text:null,props:{},onClick:function(yt){var Bt;if(ne.intercept){yt==null||yt.preventDefault();return}typeof($e==null?void 0:$e.getReportInstance())=="function"&&(ne==null?void 0:ne.modalStore)&&($e==null||$e.getReportInstance()((Bt=$e.getEventName())===null||Bt===void 0?void 0:Bt.btnClick,Te({button_text:null},ne==null?void 0:ne.modalStore))),Ne==null||Ne()}};var Oe=me==null?void 0:me.actionFunc,je=me.text,vt=me.timeout,Rt=me.type,_t=me.props;je||(je=Rt==="ok"?"\u786E\u5B9A":"\u53D6\u6D88");var Xe={timeout:vt},ut=function(yt){var Bt;if(Xe.timeout)return ne.modalType&&ne.modalType!=="default"?Promise.reject():void 0;if(typeof Oe=="function"&&Oe(),ne.intercept){yt==null||yt.preventDefault();return}typeof($e==null?void 0:$e.getReportInstance())=="function"&&(ne==null?void 0:ne.modalStore)&&($e==null||$e.getReportInstance()((Bt=$e.getEventName())===null||Bt===void 0?void 0:Bt.btnClick,Te({button_text:je},ne==null?void 0:ne.modalStore))),Ne==null||Ne()};return{onClick:ut,props:_t,text:c.createElement(c.Fragment,null,je,vt?c.createElement(P,{onTimeout:ut,timeRef:Xe}):null)}},he=function(me){var Ne=me.modalArr,ne=me.modalManager,$e=me.isReload,Oe=me.onFinalClose,je=me.onRedirectPage,vt=me.page,Rt=ne.componentMap,_t=ne.customModalFuncMap,Xe=ne.customContentMap,ut=ne.customBizFuncMap,yt=(0,c.useRef)(Ne),Bt=(0,c.useRef)(vt);yt.current=Ne;var ar=(0,c.useRef)(0),Et=(0,c.useRef)(null),Zt=(0,c.useRef)(null);return Zt.current=function(){var xt,zt,ae,Me,te,S,J,z,B,q,oe,We,Qe,be,at,Pt;try{if(location.pathname!==Bt.current){Zt.current=null,typeof((xt=Et.current)===null||xt===void 0?void 0:xt.destroy)=="function"&&((ae=(zt=Et.current)===null||zt===void 0?void 0:zt.destroy)===null||ae===void 0||ae.call(zt)),je==null||je();return}var qe=yt.current[ar.current];if(!qe){Oe==null||Oe();return}var Ft=function(){var Ye,ct,Gt,$t,Vt,vr,Ut,Dt=yt.current[ar.current],gr=ut[(Ye=Dt==null?void 0:Dt.onNext)===null||Ye===void 0?void 0:Ye.funcName]||null,Kt=((ct=Dt==null?void 0:Dt.onNext)===null||ct===void 0?void 0:ct.props)||void 0;if((Dt==null?void 0:Dt.onNext)&&gr&&gr(Kt),Et==null?void 0:Et.current){typeof((Gt=Et.current)===null||Gt===void 0?void 0:Gt.destroy)=="function"&&((Vt=($t=Et.current)===null||$t===void 0?void 0:$t.destroy)===null||Vt===void 0||Vt.call($t));var or=yt.current[ar.current],Ar=ut[(vr=or==null?void 0:or.afterModalClose)===null||vr===void 0?void 0:vr.funcName]||null,Kr=((Ut=or==null?void 0:or.afterModalClose)===null||Ut===void 0?void 0:Ut.props)||void 0;(or==null?void 0:or.afterModalClose)&&Ar&&Ar(Kr)}if(ar.current+=1,localStorage.getItem("cyborg-modal-list-modal".concat(Dt==null?void 0:Dt.name)))try{var tr=JSON.parse(localStorage.getItem("cyborg-modal-list-modal".concat(Dt==null?void 0:Dt.name))||"{}");tr.popedTimes+=1,localStorage.setItem("cyborg-modal-list-modal".concat(Dt==null?void 0:Dt.name),JSON.stringify(tr))}catch(Br){}else localStorage.setItem("cyborg-modal-list-modal".concat(Dt==null?void 0:Dt.name),JSON.stringify({popedTimes:1,firstPopTimeStamp:Ce()().unix()}));setTimeout(function(){var Br;(Br=Zt.current)===null||Br===void 0||Br.call(Zt)},20)},wr=qe.operations,Wt=wr===void 0?[]:wr,Gr=qe.modalType,Nr=$((Me=Wt==null?void 0:Wt.filter(function(Ye){return Ye.type==="ok"}))===null||Me===void 0?void 0:Me[0],Ft,qe,ne),tn=Nr.text,rn=Nr.onClick,Zr=Nr.props,Xr=$((te=Wt==null?void 0:Wt.filter(function(Ye){return Ye.type==="cancel"}))===null||te===void 0?void 0:te[0],Ft,qe,ne),Wr=Xr.text,qr=Xr.onClick,zr=Xr.props,cr=null,Ur={};(qe==null?void 0:qe.component)&&(cr=(Rt==null?void 0:Rt[(S=qe==null?void 0:qe.component)===null||S===void 0?void 0:S.componentType])||null,Ur=((J=qe.component)===null||J===void 0?void 0:J.props)||{});var Lr=null,ve={};(qe==null?void 0:qe.customContent)&&(Lr=(Xe==null?void 0:Xe[(z=qe==null?void 0:qe.customContent)===null||z===void 0?void 0:z.componentType])||null,ve=((B=qe.customContent)===null||B===void 0?void 0:B.props)||{});var de=null,D={};if((qe==null?void 0:qe.modalFunc)&&(de=(_t==null?void 0:_t[(q=qe==null?void 0:qe.modalFunc)===null||q===void 0?void 0:q.funcName])||null,D=((oe=qe==null?void 0:qe.modalFunc)===null||oe===void 0?void 0:oe.props)||{}),qe.displayType||(qe.displayType="always"),qe.displayType==="always"||qe.displayType==="once"&&!$e)if(qe.renderType==="func"&&qe.modalFunc&&de)Et.current=de(Te({next:Ft},D));else if(qe.renderType==="components"&&qe.component&&cr){var W=(0,Ae.y)(cr);Et.current=W(Te({next:Ft},Ur))}else{var C=Te(Te({title:qe.title,content:qe.renderType==="customContent"&&qe.customContent?Lr?c.createElement(Lr,Te({},ve,{next:Ft})):null:c.createElement("div",{dangerouslySetInnerHTML:{__html:(0,ge.k)(qe.content||"",qe,"")}}),onOk:rn,okText:tn,cancelText:Wr,onCancel:qr,showCancel:!!Wr,okButtonProps:Zr,cancelButtonProps:zr},qe.modalProps),{afterClose:function(){var Ye,ct;(ct=(Ye=qe==null?void 0:qe.modalProps)===null||Ye===void 0?void 0:Ye.afterClose)===null||ct===void 0||ct.call(Ye)}});if(!Gr||Gr==="default")Et.current=x(C);else{var Z=["warning","info","error","success"].includes(Gr)?Gr:"confirm";Et.current=De.ZP[Z](C)}var ie=(We=qe.operations.filter(function(Ye){return Ye.type==="ok"}))===null||We===void 0?void 0:We[0],Ie=(Qe=qe.operations.filter(function(Ye){return Ye.type==="cancel"}))===null||Qe===void 0?void 0:Qe[0];if(ie&&ie.timeout!==0){(be=Et==null?void 0:Et.current)===null||be===void 0||be.update({okButtonProps:Te(Te({},C.okButtonProps),{disabled:!0})});var Ze=window.setTimeout(function(){var Ye;(Ye=Et==null?void 0:Et.current)===null||Ye===void 0||Ye.update({okButtonProps:Te(Te({},C.okButtonProps),{disabled:!1})}),clearTimeout(Ze)},ie.timeout*1e3)}if(Ie&&Ie.timeout!==0){(at=Et==null?void 0:Et.current)===null||at===void 0||at.update({cancelButtonProps:Te(Te({},C.cancelButtonProps),{disabled:!0})});var ot=window.setTimeout(function(){var Ye;(Ye=Et==null?void 0:Et.current)===null||Ye===void 0||Ye.update({cancelButtonProps:Te(Te({},C.cancelButtonProps),{disabled:!1})}),clearTimeout(ot)},Ie.timeout*1e3)}typeof(ne==null?void 0:ne.getReportInstance())=="function"&&(qe==null?void 0:qe.modalStore)&&(ne==null||ne.getReportInstance()((Pt=ne.getEventName())===null||Pt===void 0?void 0:Pt.modalShow,Te({},qe==null?void 0:qe.modalStore)))}else Ft()}catch(Ye){ar.current+=1,setTimeout(function(){var ct;(ct=Zt.current)===null||ct===void 0||ct.call(Zt)},20)}},(0,c.useEffect)(function(){var xt;return(xt=Zt.current)===null||xt===void 0||xt.call(Zt),function(){var zt,ae,Me;Zt.current=null,typeof((zt=Et.current)===null||zt===void 0?void 0:zt.destroy)=="function"&&((Me=(ae=Et.current)===null||ae===void 0?void 0:ae.destroy)===null||Me===void 0||Me.call(ae))}},[]),null},ye=o(17755),Re=o(58952),He=typeof window=="undefined",we=function(){if(typeof window=="undefined")return"";var me=window.location.pathname;return me.indexOf("/index.html")===0?window.location.hash.slice(1).split("?")[0].replace(/\/\d+$/,"")||"/":me.replace(/\/\d+$/,"")};function fe(me,Ne){var ne=He?{}:(0,Re.lX)(),$e=(0,c.useState)(typeof window=="undefined"?"":ne.location.pathname),Oe=$e[0],je=$e[1],vt=function(){var Rt=we();Rt!==Oe&&(je(Rt),me&&me(Rt))};return(0,c.useEffect)(function(){me&&me(Oe)},Array.isArray(Ne)?Ne:[]),(0,c.useEffect)(function(){if(typeof window=="undefined")return function(){};var Rt=ne.listen(vt);return Rt},[Oe]),Oe}var K=function(me,Ne,ne){if(ne||arguments.length===2)for(var $e=0,Oe=Ne.length,je;$e<Oe;$e++)(je||!($e in Ne))&&(je||(je=Array.prototype.slice.call(Ne,0,$e)),je[$e]=Ne[$e]);return me.concat(je||Array.prototype.slice.call(Ne))},I=function(me,Ne){if(typeof window!="undefined"){var ne=0,$e=[];me.current=window.setInterval(function(){var Oe,je,vt=[],Rt=!1,_t=((Oe=Array.from(document.querySelectorAll('div[class$="y-guide"]')))===null||Oe===void 0?void 0:Oe.filter(function(ut){var yt;return(yt=ut.querySelectorAll('div[class$="guide-mask"]'))===null||yt===void 0?void 0:yt.length}))||[],Xe=((je=Array.from(document.querySelectorAll('div[class$="modal-root"]')))===null||je===void 0?void 0:je.filter(function(ut){var yt;return(yt=ut.querySelectorAll('div[class$="modal-mask"]'))===null||yt===void 0?void 0:yt.length}))||[];Number(Boolean(_t.length))+Xe.length>1&&(Xe.forEach(function(ut){var yt,Bt,ar,Et=((yt=ut==null?void 0:ut.querySelector('div[class$="modal-title"]'))===null||yt===void 0?void 0:yt.innerHTML)||((Bt=ut==null?void 0:ut.querySelector('span[class$="modal-confirm-title"]'))===null||Bt===void 0?void 0:Bt.innerHTML)||((ar=ut==null?void 0:ut.innerText)===null||ar===void 0?void 0:ar.slice(0,50));$e.indexOf(Et)===-1&&(Rt=!0),vt=K(K([],vt,!0),[Et],!1)}),_t.length&&_t.forEach(function(ut){var yt,Bt,ar,Et=((yt=ut==null?void 0:ut.querySelector('div[class$="guide-normal-title"]'))===null||yt===void 0?void 0:yt.innerHTML)||((Bt=ut==null?void 0:ut.querySelector('div[class$="guide-single-title"]'))===null||Bt===void 0?void 0:Bt.innerHTML)||((ar=ut==null?void 0:ut.innerText)===null||ar===void 0?void 0:ar.slice(0,50))||"\u65B0\u4EBA\u5F15\u5BFC";vt=K(K([],vt,!0),["\u65B0\u4EBA\u5F15\u5BFC:\u3010".concat(Et,"\u3011")],!1)})),vt.length>1&&Rt&&Ne({arr:vt}),$e=vt,ne++,ne>10&&(clearInterval(me.current),me.current=void 0)},1e3)}},k=function(me,Ne,ne){if(ne||arguments.length===2)for(var $e=0,Oe=Ne.length,je;$e<Oe;$e++)(je||!($e in Ne))&&(je||(je=Array.prototype.slice.call(Ne,0,$e)),je[$e]=Ne[$e]);return me.concat(je||Array.prototype.slice.call(Ne))},se=window.location.pathname,pe=function(me){var Ne=me.context,ne=me.timeWaitForNextModal,$e=ne===void 0?3e3:ne,Oe=me.onConflict,je=Oe===void 0?null:Oe,vt=(0,c.useState)(!1),Rt=vt[0],_t=vt[1],Xe=(0,c.useRef)(null),ut=(0,c.useRef)($e),yt=(0,c.useRef)(!0),Bt=(0,c.useRef)(void 0),ar=(0,c.useState)(se),Et=ar[0],Zt=ar[1],xt=(0,ye.j2)(Ne),zt=(0,c.useState)([]),ae=zt[0],Me=zt[1],te=(0,c.useState)(void 0),S=te[0],J=te[1],z=(0,c.useState)(!1),B=z[0],q=z[1];return(0,c.useEffect)(function(){var oe,We=function(){q(!1),console.log("open-modal")};return(oe=xt.getEmitter())===null||oe===void 0||oe.addListener("emit-modal-register",We),function(){var Qe;(Qe=xt.getEmitter())===null||Qe===void 0||Qe.removeListener("emit-modal-register",We)}},[]),fe(function(oe){Zt(oe),je&&typeof je=="function"&&(Bt.current&&(clearInterval(Bt.current),Bt.current=void 0),I(Bt,je))}),(0,c.useEffect)(function(){var oe=!0;if(Et!==window.location.pathname){oe=!1;return}return oe=!0,function(){oe&&(xt.setPreRegisterArr([]),xt.setRegisterKeyArr([]),_t(!0),J([]),q(!1),yt.current=!0)}},[Et]),(0,c.useEffect)(function(){if(!(Et!==window.location.pathname||B)){var oe=xt.getPreRegisterArr();(oe==null?void 0:oe.length)||J([]),Me(oe)}},[Et,B]),(0,c.useEffect)(function(){if(!(Et!==window.location.pathname||B)&&!(!ae.length||S)){var oe=ae;(oe==null?void 0:oe.length)&&(yt.current=!1,Promise.all(oe.map(function(We){return We.p})).then(function(We){var Qe=g()(k([],y()(We),!0),"name");le(xt.handlers||[],Qe)().then(function(be){yt.current=!(be==null?void 0:be.length),J(be)}).catch(function(be){console.log("compose-handlers-catch",be),yt.current=!0,J([])})}).catch(function(We){console.log("promise-all-catch",We),yt.current=!0,J([])}).finally(function(){console.log("promise-all-finally");var We=oe.map(function(Qe){return Qe.key});xt.setPreRegisterArr(xt.getPreRegisterArr().filter(function(Qe){return!We.includes(Qe.key)}))}))}},[Et,ae,S,B]),(0,c.useEffect)(function(){if(!(Et!==window.location.pathname||B)&&S&&(S==null?void 0:S.length)===0){Xe.current&&(window.clearInterval(Xe.current),Xe.current=null,ut.current=$e);var oe=!1;Xe.current=window.setInterval(function(){var We,Qe;ut.current-=1e3,ut.current<=0&&(oe||(yt.current=!0,q(!0),console.log("emit-closed:no other modals"),(We=xt.getEmitter())===null||We===void 0||We.emit("all-modal-closed")),Xe.current&&(window.clearInterval(Xe.current),Xe.current=null,ut.current=$e)),yt.current&&((Qe=xt.getPreRegisterArr())===null||Qe===void 0?void 0:Qe.length)&&!B&&(oe=!0,Me(xt.getPreRegisterArr()),J(void 0))},1e3)}},[Et,S,B]),c.createElement("div",null,(S==null?void 0:S.length)&&!B?c.createElement("div",null,c.createElement(he,{modalArr:S,modalManager:xt,isReload:Rt,page:Et,onRedirectPage:function(){Me(xt.getPreRegisterArr()),J(void 0)},onFinalClose:function(){var oe,We;((oe=xt.getPreRegisterArr())===null||oe===void 0?void 0:oe.length)||(q(!0),console.log("emit-closed"),(We=xt.getEmitter())===null||We===void 0||We.emit("all-modal-closed")),yt.current=!0,Me(xt==null?void 0:xt.getPreRegisterArr()),J(void 0)}})):null)};const Je=pe},53808:(l,n,o)=>{var c={base:0,module:1,page:2,important:3}},72635:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>evalWrapper});var evalWrapper=function(str,item,defaultValue){var _a,_b;if(str.startsWith("eval-express://")){var express=((_a=str.split("://"))===null||_a===void 0?void 0:_a[1])||"",exec=`
        const func = (data, defaultValue)=>{ 
          try {
            return `.concat(express,`;
          } catch {
            return defaultValue
          }
        };
        func({...item.contextStore, ...item.storeGetters, ...item.modalStore}, defaultValue);
        `);return eval(exec)}else if(str.startsWith("custom-express://")){var express=((_b=str.split("://"))===null||_b===void 0?void 0:_b[1])||"",exec=`
        const func = (globalData, defaultValue)=>{ 
          try {
            return `.concat(express,`;
          } catch {
            return defaultValue
          }
        };
        func({...item.contextStore, ...item.storeGetters, ...item.modalStore, bizData: item.bizData}, defaultValue);
        `);return eval(exec)}return str}},7980:(l,n,o)=>{o.d(n,{y:()=>b});var c=o(86824),h=o(37545),g=function(){return g=Object.assign||function(y){for(var O,M=1,G=arguments.length;M<G;M++){O=arguments[M];for(var le in O)Object.prototype.hasOwnProperty.call(O,le)&&(y[le]=O[le])}return y},g.apply(this,arguments)},b=function(y){var O="".concat(Date.now().toString(),"__func_preview__");return function(M){var G=document.getElementById(O);G&&G.remove();var le=document.createElement("div");le.id=O,document.body.appendChild(le);var Pe=function(){(M==null?void 0:M.onClose)&&(M==null||M.onClose()),De(!1),le.remove()},Ce=M;function De(ge){c.render(ge?h.createElement(y,g({},Ce,{visible:ge,onClose:Pe})):h.createElement(h.Fragment,null),le)}function Ae(ge){Ce=g(g({},Ce),ge),De(!0)}return De(!1),setTimeout(function(){De(!0)}),{destroy:function(){return De(!1)},update:function(ge){return Ae(ge)}}}}},42578:(l,n,o)=>{o.d(n,{iV:()=>$r,_N:()=>Yr});var c=o(63660),h=o(26358),g=o(39356),b=o(67471),y=o(30653),O=o(37545),M=Object.create,G=Object.defineProperty,le=Object.defineProperties,Pe=Object.getOwnPropertyDescriptor,Ce=Object.getOwnPropertyDescriptors,De=Object.getOwnPropertyNames,Ae=Object.getOwnPropertySymbols,ge=Object.getPrototypeOf,Te=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,x=(_,R,N)=>R in _?G(_,R,{enumerable:!0,configurable:!0,writable:!0,value:N}):_[R]=N,P=(_,R)=>{for(var N in R||(R={}))Te.call(R,N)&&x(_,N,R[N]);if(Ae)for(var N of Ae(R))ce.call(R,N)&&x(_,N,R[N]);return _},$=(_,R)=>le(_,Ce(R)),he=(_=>o(96358))(function(_){return o(96358).apply(this,arguments)}),ye=(_,R)=>{var N={};for(var X in _)Te.call(_,X)&&R.indexOf(X)<0&&(N[X]=_[X]);if(_!=null&&Ae)for(var X of Ae(_))R.indexOf(X)<0&&ce.call(_,X)&&(N[X]=_[X]);return N},Re=(_,R)=>function(){return R||(0,_[De(_)[0]])((R={exports:{}}).exports,R),R.exports},He=(_,R,N,X)=>{if(R&&typeof R=="object"||typeof R=="function")for(let ee of De(R))!Te.call(_,ee)&&ee!==N&&G(_,ee,{get:()=>R[ee],enumerable:!(X=Pe(R,ee))||X.enumerable});return _},we=(_,R,N)=>(N=_!=null?M(ge(_)):{},He(R||!_||!_.__esModule?G(N,"default",{value:_,enumerable:!0}):N,_)),fe=(_,R,N)=>new Promise((X,ee)=>{var j=ke=>{try{Ke(N.next(ke))}catch(rt){ee(rt)}},ue=ke=>{try{Ke(N.throw(ke))}catch(rt){ee(rt)}},Ke=ke=>ke.done?X(ke.value):Promise.resolve(ke.value).then(j,ue);Ke((N=N.apply(_,R)).next())}),K=Re({"../../node_modules/js-cookie/src/js.cookie.js"(_,R){(function(N){var X;if(typeof define=="function"&&o.amdO&&(define(N),X=!0),typeof _=="object"&&(R.exports=N(),X=!0),!X){var ee=window.Cookies,j=window.Cookies=N();j.noConflict=function(){return window.Cookies=ee,j}}})(function(){function N(){for(var j=0,ue={};j<arguments.length;j++){var Ke=arguments[j];for(var ke in Ke)ue[ke]=Ke[ke]}return ue}function X(j){return j.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function ee(j){function ue(){}function Ke(rt,st,bt){if(typeof document!="undefined"){bt=N({path:"/"},ue.defaults,bt),typeof bt.expires=="number"&&(bt.expires=new Date(new Date*1+bt.expires*864e5)),bt.expires=bt.expires?bt.expires.toUTCString():"";try{var Be=JSON.stringify(st);/^[\{\[]/.test(Be)&&(st=Be)}catch(tt){}st=j.write?j.write(st,rt):encodeURIComponent(String(st)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),rt=encodeURIComponent(String(rt)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var Fe="";for(var it in bt)!bt[it]||(Fe+="; "+it,bt[it]!==!0&&(Fe+="="+bt[it].split(";")[0]));return document.cookie=rt+"="+st+Fe}}function ke(rt,st){if(typeof document!="undefined"){for(var bt={},Be=document.cookie?document.cookie.split("; "):[],Fe=0;Fe<Be.length;Fe++){var it=Be[Fe].split("="),tt=it.slice(1).join("=");!st&&tt.charAt(0)==='"'&&(tt=tt.slice(1,-1));try{var rr=X(it[0]);if(tt=(j.read||j)(tt,rr)||X(tt),st)try{tt=JSON.parse(tt)}catch(Tr){}if(bt[rr]=tt,rt===rr)break}catch(Tr){}}return rt?bt[rt]:bt}}return ue.set=Ke,ue.get=function(rt){return ke(rt,!1)},ue.getJSON=function(rt){return ke(rt,!0)},ue.remove=function(rt,st){Ke(rt,"",N(st,{expires:-1}))},ue.defaults={},ue.withConverter=ee,ue}return ee(function(){})})}}),I=Re({"../../node_modules/debug/node_modules/ms/index.js"(_,R){var N=1e3,X=N*60,ee=X*60,j=ee*24,ue=j*7,Ke=j*365.25;R.exports=function(Be,Fe){Fe=Fe||{};var it=typeof Be;if(it==="string"&&Be.length>0)return ke(Be);if(it==="number"&&isFinite(Be))return Fe.long?st(Be):rt(Be);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(Be))};function ke(Be){if(Be=String(Be),!(Be.length>100)){var Fe=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(Be);if(!!Fe){var it=parseFloat(Fe[1]),tt=(Fe[2]||"ms").toLowerCase();switch(tt){case"years":case"year":case"yrs":case"yr":case"y":return it*Ke;case"weeks":case"week":case"w":return it*ue;case"days":case"day":case"d":return it*j;case"hours":case"hour":case"hrs":case"hr":case"h":return it*ee;case"minutes":case"minute":case"mins":case"min":case"m":return it*X;case"seconds":case"second":case"secs":case"sec":case"s":return it*N;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return it;default:return}}}}function rt(Be){var Fe=Math.abs(Be);return Fe>=j?Math.round(Be/j)+"d":Fe>=ee?Math.round(Be/ee)+"h":Fe>=X?Math.round(Be/X)+"m":Fe>=N?Math.round(Be/N)+"s":Be+"ms"}function st(Be){var Fe=Math.abs(Be);return Fe>=j?bt(Be,Fe,j,"day"):Fe>=ee?bt(Be,Fe,ee,"hour"):Fe>=X?bt(Be,Fe,X,"minute"):Fe>=N?bt(Be,Fe,N,"second"):Be+" ms"}function bt(Be,Fe,it,tt){var rr=Fe>=it*1.5;return Math.round(Be/it)+" "+tt+(rr?"s":"")}}}),k=Re({"../../node_modules/debug/src/common.js"(_,R){function N(X){j.debug=j,j.default=j,j.coerce=bt,j.disable=ke,j.enable=Ke,j.enabled=rt,j.humanize=I(),j.destroy=Be,Object.keys(X).forEach(Fe=>{j[Fe]=X[Fe]}),j.names=[],j.skips=[],j.formatters={};function ee(Fe){let it=0;for(let tt=0;tt<Fe.length;tt++)it=(it<<5)-it+Fe.charCodeAt(tt),it|=0;return j.colors[Math.abs(it)%j.colors.length]}j.selectColor=ee;function j(Fe){let it,tt=null,rr,Tr;function mr(...xr){if(!mr.enabled)return;const Vr=mr,Hr=Number(new Date),Sn=Hr-(it||Hr);Vr.diff=Sn,Vr.prev=it,Vr.curr=Hr,it=Hr,xr[0]=j.coerce(xr[0]),typeof xr[0]!="string"&&xr.unshift("%O");let gn=0;xr[0]=xr[0].replace(/%([a-zA-Z%])/g,(e,r)=>{if(e==="%%")return"%";gn++;const s=j.formatters[r];if(typeof s=="function"){const f=xr[gn];e=s.call(Vr,f),xr.splice(gn,1),gn--}return e}),j.formatArgs.call(Vr,xr),(Vr.log||j.log).apply(Vr,xr)}return mr.namespace=Fe,mr.useColors=j.useColors(),mr.color=j.selectColor(Fe),mr.extend=ue,mr.destroy=j.destroy,Object.defineProperty(mr,"enabled",{enumerable:!0,configurable:!1,get:()=>tt!==null?tt:(rr!==j.namespaces&&(rr=j.namespaces,Tr=j.enabled(Fe)),Tr),set:xr=>{tt=xr}}),typeof j.init=="function"&&j.init(mr),mr}function ue(Fe,it){const tt=j(this.namespace+(typeof it=="undefined"?":":it)+Fe);return tt.log=this.log,tt}function Ke(Fe){j.save(Fe),j.namespaces=Fe,j.names=[],j.skips=[];let it;const tt=(typeof Fe=="string"?Fe:"").split(/[\s,]+/),rr=tt.length;for(it=0;it<rr;it++)!tt[it]||(Fe=tt[it].replace(/\*/g,".*?"),Fe[0]==="-"?j.skips.push(new RegExp("^"+Fe.slice(1)+"$")):j.names.push(new RegExp("^"+Fe+"$")))}function ke(){const Fe=[...j.names.map(st),...j.skips.map(st).map(it=>"-"+it)].join(",");return j.enable(""),Fe}function rt(Fe){if(Fe[Fe.length-1]==="*")return!0;let it,tt;for(it=0,tt=j.skips.length;it<tt;it++)if(j.skips[it].test(Fe))return!1;for(it=0,tt=j.names.length;it<tt;it++)if(j.names[it].test(Fe))return!0;return!1}function st(Fe){return Fe.toString().substring(2,Fe.toString().length-2).replace(/\.\*\?$/,"*")}function bt(Fe){return Fe instanceof Error?Fe.stack||Fe.message:Fe}function Be(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return j.enable(j.load()),j}R.exports=N}}),se=Re({"../../node_modules/debug/src/browser.js"(_,R){_.formatArgs=X,_.save=ee,_.load=j,_.useColors=N,_.storage=ue(),_.destroy=(()=>{let ke=!1;return()=>{ke||(ke=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),_.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function N(){return typeof window!="undefined"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document!="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function X(ke){if(ke[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+ke[0]+(this.useColors?"%c ":" ")+"+"+R.exports.humanize(this.diff),!this.useColors)return;const rt="color: "+this.color;ke.splice(1,0,rt,"color: inherit");let st=0,bt=0;ke[0].replace(/%[a-zA-Z%]/g,Be=>{Be!=="%%"&&(st++,Be==="%c"&&(bt=st))}),ke.splice(bt,0,rt)}_.log=console.debug||console.log||(()=>{});function ee(ke){try{ke?_.storage.setItem("debug",ke):_.storage.removeItem("debug")}catch(rt){}}function j(){let ke;try{ke=_.storage.getItem("debug")}catch(rt){}return!ke&&typeof process!="undefined"&&"env"in process&&(ke=process.env.DEBUG),ke}function ue(){try{return localStorage}catch(ke){}}R.exports=k()(_);var{formatters:Ke}=R.exports;Ke.j=function(ke){try{return JSON.stringify(ke)}catch(rt){return"[UnexpectedJSONParseError]: "+rt.message}}}}),pe=Re({"../../node_modules/has-flag/index.js"(_,R){"use strict";R.exports=(N,X=process.argv)=>{const ee=N.startsWith("-")?"":N.length===1?"-":"--",j=X.indexOf(ee+N),ue=X.indexOf("--");return j!==-1&&(ue===-1||j<ue)}}}),Je=Re({"../../node_modules/supports-color/index.js"(_,R){"use strict";var N=he("os"),X=he("tty"),ee=pe(),{env:j}=process,ue;ee("no-color")||ee("no-colors")||ee("color=false")||ee("color=never")?ue=0:(ee("color")||ee("colors")||ee("color=true")||ee("color=always"))&&(ue=1),"FORCE_COLOR"in j&&(j.FORCE_COLOR==="true"?ue=1:j.FORCE_COLOR==="false"?ue=0:ue=j.FORCE_COLOR.length===0?1:Math.min(parseInt(j.FORCE_COLOR,10),3));function Ke(st){return st===0?!1:{level:st,hasBasic:!0,has256:st>=2,has16m:st>=3}}function ke(st,bt){if(ue===0)return 0;if(ee("color=16m")||ee("color=full")||ee("color=truecolor"))return 3;if(ee("color=256"))return 2;if(st&&!bt&&ue===void 0)return 0;const Be=ue||0;if(j.TERM==="dumb")return Be;if(process.platform==="win32"){const Fe=N.release().split(".");return Number(Fe[0])>=10&&Number(Fe[2])>=10586?Number(Fe[2])>=14931?3:2:1}if("CI"in j)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(Fe=>Fe in j)||j.CI_NAME==="codeship"?1:Be;if("TEAMCITY_VERSION"in j)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(j.TEAMCITY_VERSION)?1:0;if(j.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in j){const Fe=parseInt((j.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(j.TERM_PROGRAM){case"iTerm.app":return Fe>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(j.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(j.TERM)||"COLORTERM"in j?1:Be}function rt(st){const bt=ke(st,st&&st.isTTY);return Ke(bt)}R.exports={supportsColor:rt,stdout:Ke(ke(!0,X.isatty(1))),stderr:Ke(ke(!0,X.isatty(2)))}}}),me=Re({"../../node_modules/debug/src/node.js"(_,R){var N=he("tty"),X=he("util");_.init=st,_.log=Ke,_.formatArgs=j,_.save=ke,_.load=rt,_.useColors=ee,_.destroy=X.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),_.colors=[6,2,3,4,5,1];try{const Be=Je();Be&&(Be.stderr||Be).level>=2&&(_.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(Be){}_.inspectOpts=Object.keys(process.env).filter(Be=>/^debug_/i.test(Be)).reduce((Be,Fe)=>{const it=Fe.substring(6).toLowerCase().replace(/_([a-z])/g,(rr,Tr)=>Tr.toUpperCase());let tt=process.env[Fe];return/^(yes|on|true|enabled)$/i.test(tt)?tt=!0:/^(no|off|false|disabled)$/i.test(tt)?tt=!1:tt==="null"?tt=null:tt=Number(tt),Be[it]=tt,Be},{});function ee(){return"colors"in _.inspectOpts?Boolean(_.inspectOpts.colors):N.isatty(process.stderr.fd)}function j(Be){const{namespace:Fe,useColors:it}=this;if(it){const tt=this.color,rr="[3"+(tt<8?tt:"8;5;"+tt),Tr=`  ${rr};1m${Fe} [0m`;Be[0]=Tr+Be[0].split(`
`).join(`
`+Tr),Be.push(rr+"m+"+R.exports.humanize(this.diff)+"[0m")}else Be[0]=ue()+Fe+" "+Be[0]}function ue(){return _.inspectOpts.hideDate?"":new Date().toISOString()+" "}function Ke(...Be){return process.stderr.write(X.format(...Be)+`
`)}function ke(Be){Be?process.env.DEBUG=Be:delete process.env.DEBUG}function rt(){return process.env.DEBUG}function st(Be){Be.inspectOpts={};const Fe=Object.keys(_.inspectOpts);for(let it=0;it<Fe.length;it++)Be.inspectOpts[Fe[it]]=_.inspectOpts[Fe[it]]}R.exports=k()(_);var{formatters:bt}=R.exports;bt.o=function(Be){return this.inspectOpts.colors=this.useColors,X.inspect(Be,this.inspectOpts).split(`
`).map(Fe=>Fe.trim()).join(" ")},bt.O=function(Be){return this.inspectOpts.colors=this.useColors,X.inspect(Be,this.inspectOpts)}}}),Ne=Re({"../../node_modules/debug/src/index.js"(_,R){window&&window.location&&window.location.href||typeof process=="undefined"||process.type==="renderer"||process.browser===!0||process.__nwjs?R.exports=se():R.exports=me()}}),ne="__MONA_WORKBENCH_DEFAULT_CONTAINER__",$e={[-100]:{code:-100,message:"\u672A\u77E5\u9519\u8BEF"},[-101]:{code:-101,message:"\u53C2\u6570\u9519\u8BEF"},[-102]:{code:-102,message:"\u6743\u9650\u7F3A\u5931"},[-103]:{code:-103,message:"\u5E94\u7528\u4E0D\u63D0\u4F9B\u6B64\u80FD\u529B"}},Oe="__WORKBENCH_EVENT_SDK_IN_WINDOW__",je="__PLATFORM_VARIABLES_IN_BENCH__",vt="__ORIGINAL_XMLHTTPREQUEST__",Rt="__ORIGINAL_FETCH__",_t="__CURRENT_ACTIVE_APP__",Xe="fems",ut={[-100]:{code:-100,message:"\u672A\u77E5\u9519\u8BEF"},[-101]:{code:-101,message:"\u53C2\u6570\u9519\u8BEF"},[-102]:{code:-102,message:"\u6743\u9650\u7F3A\u5931"},[-103]:{code:-103,message:"\u5E94\u7528\u4E0D\u63D0\u4F9B\u6B64\u80FD\u529B"}},yt=(_=>(_.UNKNOWN_PARAMS_TYPE_ERROR="____UNKNOWN_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____",_.INPUT_PARAMS_TYPE_ERROR="____INPUT_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____",_.NO_PERMISSION_PARAMS_TYPE_ERROR="____NO_PERMISSION_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____",_))(yt||{}),Bt=["number","string","undefined","boolean"],ar=_=>!!(Bt.includes(typeof _)||_===null),Et=(_,R)=>$(P({},ut[_]),{message:R!=null?R:ut[_].message});function Zt(_){if(typeof _=="function")return _;try{return JSON.parse(JSON.stringify(_))}catch(R){console.error(R)}return _}function xt(_){return ar(_)?_:Zt(_)}var zt=class{constructor(){return this._runListener=(_,R,N,X,ee,j)=>fe(this,null,function*(){this.hooks.afterEmit.call(R,ee,j),(j==null?void 0:j.isDeepClone)&&ee&&(ee=xt(ee));const{listener:Ke,once:ke}=_;let rt=!1,st;try{ke&&this.off(R,Ke),st=yield Ke==null?void 0:Ke(ee,{appId:(j==null?void 0:j.pluginId)||(_==null?void 0:_.pluginId)}),st==="____INPUT_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"?(rt=!0,st=-101):st==="____UNKNOWN_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"?(rt=!0,st=-100):st==="____NO_PERMISSION_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"&&(rt=!0,st=-102)}catch(bt){rt=!0,st=-100}finally{return rt?X(Et(st)):N(st)}}),this._runSyncListener=(_,R,N,X)=>{this.hooks.afterEmit.call(R,N,X),(X==null?void 0:X.isDeepClone)&&N&&(N=xt(N));const{listener:j,once:ue}=_;let Ke=!1,ke;try{ue&&this.off(R,j),ke=j==null?void 0:j(N,{appId:X==null?void 0:X.pluginId}),ke==="____INPUT_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"?(Ke=!0,ke=-101):ke==="____UNKNOWN_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"?(Ke=!0,ke=-100):ke==="____NO_PERMISSION_PARAMS_TYPE_ERROR_BY_MONA_PLUGIN____"&&(Ke=!0,ke=-102)}catch(rt){Ke=!0,ke=-100}finally{return Ke?Et(ke):ke}},this.on=(_,R,N)=>{(N==null?void 0:N.once)||this.hooks.on.call(_,R,N),this._eventIsSyncMap.get(_)===void 0&&this._eventIsSyncMap.set(_,Boolean(N==null?void 0:N.isSync));const{once:X,pluginId:ee}=N||{},j={listener:R,once:X,pluginId:ee},ue=this._eventListenerInfoMap.get(_);return ue?ue.push(j):this._eventListenerInfoMap.set(_,[j]),R},this.emit=(_,R,N)=>{this.hooks.beforeEmit.call(_,R,N),N=N||{},N.isDeepClone===void 0&&(N.isDeepClone=!0);let X=this._eventListenerInfoMap.get(_);(N==null?void 0:N.target)&&(X==null?void 0:X.length)&&(X=X.filter(j=>{var ue,Ke;return(Ke=(ue=N==null?void 0:N.target)==null?void 0:ue.includes)==null?void 0:Ke.call(ue,j.pluginId||"")}));const ee=this._eventIsSyncMap.get(_);if(X){if(ee)return X.length===1?this._runSyncListener(X[0],_,R,N):X.map(j=>this._runSyncListener(j,_,R,N));if(X.length===1){const j=X[0];return new Promise((ue,Ke)=>{this._runListener(j,_,ue,Ke,R,N)})}else{const j=X.map(ue=>new Promise((Ke,ke)=>{this._runListener(ue,_,Ke,ke,R,N)}));return Promise.all(j)}}else return Et(-103)},this.off=(_,R)=>{const N=this._eventListenerInfoMap.get(_);if(!N)return;const X=N==null?void 0:N.findIndex(ee=>ee.listener===R);X!==-1&&N.splice(X,1),N.length===0&&(this._eventListenerInfoMap.delete(_),this._eventIsSyncMap.delete(_)),this.hooks.afterOff.call(_,R)},this.once=(_,R,N)=>(this.hooks.once.call(_,R,N),N=N||{},N.once=!0,this.on(_,R,N)),this.removePluginListener=(_,R)=>{const N=this._eventListenerInfoMap.get(_);if(!N)return;const X=N.filter(ee=>!(ee==null?void 0:ee.pluginId)||(ee==null?void 0:ee.pluginId)!==R);(X==null?void 0:X.length)?this._eventListenerInfoMap.set(_,X):(this._eventListenerInfoMap.delete(_),this._eventIsSyncMap.delete(_))},this.removeAllPluginListener=_=>{const R=this._eventListenerInfoMap.keys();for(const N of Array.from(R))this.removePluginListener(N,_)},this.removeAppListener=_=>{const R=this._eventListenerInfoMap.get(_);if(!R)return;const N=R.filter(X=>X==null?void 0:X.pluginId);(N==null?void 0:N.length)?this._eventListenerInfoMap.set(_,N):(this._eventListenerInfoMap.delete(_),this._eventIsSyncMap.delete(_))},this.removeAllAppListener=()=>{const _=this._eventListenerInfoMap.keys();for(const R of Array.from(_))this.removeAppListener(R)},this.isSync=_=>Boolean(this._eventIsSyncMap.get(_)),this.getListenerCount=_=>{let R=0;const N=this._eventListenerInfoMap.keys();for(const X of Array.from(N)){const ee=this._eventListenerInfoMap.get(X);if(ee)for(const j of ee)j.listener===_&&R++}return R},zt.instance||(this._eventListenerInfoMap=new Map,this._eventIsSyncMap=new Map,this.hooks={on:new c.SyncHook(["eventName","listener","options"]),once:new c.SyncHook(["eventName","listener","options"]),afterOff:new c.SyncHook(["eventName","listener"]),beforeEmit:new c.SyncHook(["eventName","data","options"]),afterEmit:new c.SyncHook(["eventName","data","options"])},zt.instance=this),zt.instance}},ae=new zt,Me=new Proxy(ae,{get:(_,R)=>{if(R==="once"||R==="on"||R==="off"||R==="emit")return _[R]},set:()=>!1});window[Oe]=Me;var te=()=>{ae.on("getLaunchOptionsSync",(_,R)=>{var N,X,ee,j;const ue=(N=g.HO.runningApps.get((R==null?void 0:R.appId)||""))==null?void 0:N.app;if((R==null?void 0:R.appId)&&ue){const{sceneId:Ke,appId:ke,query:rt}=ue,st=(0,g.gU)(Ke,ke,rt);return $(P({},st),{userUniqueId:(j=(ee=(X=g.HO)==null?void 0:X.config)==null?void 0:ee.platformInfo)==null?void 0:j.shopId})}return{}},{isSync:!0})};function S(){vn.prototype.initLight=function(_){return fe(this,null,function*(){this.light=g.HO;try{yield g.HO.init({platformInfo:{shopId:_.userUniqueId,name:_.platform}})}catch(R){console.error(R)}te()})},vn.prototype.destroyLight=function(_){return g.HO.destroy(_)},vn.prototype.openOfficialLight=function(R,N){return fe(this,null,function*(){var X,ee,j,ue,Ke;(Ke=(ee=(X=this==null?void 0:this.slardarLoader)==null?void 0:X.slardar)==null?void 0:ee.sendEvent)==null||Ke.call(ee,{name:"openOfficialLight",metrics:{},categories:{microAppId:(j=R==null?void 0:R.appId)!=null?j:"",microSceneId:(ue=R==null?void 0:R.sceneId)!=null?ue:""}}),yield g.HO.openOfficial(R,N)})}}var J=we(K()),z=window.webviewBridge,B=Boolean(z)||navigator.userAgent.includes("feige"),q={},oe;try{q=B?JSON.parse((oe=J.default.get("__desk_options__"))!=null?oe:"{}"):{}}catch(_){}var We=z==null?void 0:z.clientVersion,Qe,be,at,Pt=(at=q==null?void 0:q.version)!=null?at:(be=(Qe=navigator.userAgent)==null?void 0:Qe.match(/deskVersion=\[(.*?)\]/))==null?void 0:be[1],qe=We||Pt,Ft=()=>{var _;const R=(_=window["@_@DoudianWVContext"])!=null?_:{};return(R==null?void 0:R.type)==="preheat"},wr=class{constructor(){return this.sendApiCall=(_,R,N,X,ee="")=>{var j,ue;(ue=(j=this.slardar)==null?void 0:j.sendEvent)==null||ue.call(j,{name:"apiCall",metrics:{},categories:{appid:_,platform:R,apiName:N,apiType:X,pluginId:ee}})},wr.instance||(this.slardar=(0,b.AY)(),wr.instance=this),wr.instance}init(_){var R=_,{bid:N,env:X,fems_app_id:ee}=R,j=ye(R,["bid","env","fems_app_id"]);this.slardar("init",P({bid:N,env:X,plugins:{performance:{fp:!1,fcp:!1,fid:!1,mpfid:!1,lcp:!1,cls:!1,timing:!1},tti:!1,fmp:!1,resource:!1,resourceError:!1,jsError:{dedupe:!0},ajax:!1,fetch:!1,pageview:{extractPid:()=>location.pathname,routeMode:"history"}}},j)),this.slardar("on","beforeSend",ue=>{var Ke;let{context:ke}=ue.common;try{ke=$(P({},ke),{fems_app_id:ee,is_desk:`${B}`,desk_version:`${(Ke=qe)!=null?Ke:""}`}),ue.common.context=ke}catch(rt){}return ue})}start(){this.slardar("start")}};function Wt(){return function(){return{name:"eventMount",version:"0.0.1",afterLoad(_,R){(R==null?void 0:R.global)&&(R.global[_t]=_.name)},afterUnmount(_){ae.removeAllPluginListener(_.name)}}}}function Gr(_,R){const N=_.headers,X=Object.keys(R);if(X.length!==0)if(!N)_.headers=R;else if(N instanceof Headers)for(let ee=0;ee<X.length;ee++){const j=X[ee];N.has(j)&&N.delete(j),N.append(j,R[j])}else if(Array.isArray(N))for(let ee=0;ee<X.length;ee++){const j=X[ee],ue=N.findIndex(Ke=>Ke[0]===j);ue!==-1&&N.splice(ue,1),N&&N.push([j,R[j]])}else Object.assign(N,R)}function Nr(_,R,N){const X=Object.keys(_);if(X.length===0)return{newInput:R,newInit:N};for(let ee=0;ee<X.length;ee++){const j=X[ee];if(j==="url")R instanceof Request?R=new Request(_[j],R):R=_[j];else if(j==="method")N[j]=_[j];else if(j==="withCredentials")_[j]?N.credentials="include":N.credentials="omit";else if(j==="headers"){const ue=_[j];Gr(N,ue)}}return{newInput:R,newInit:N}}function tn(_,R,N,X){_=_||window,_[Rt]=_[Rt]||_.fetch,_.fetch=function(ee,j){j=j||{};const{newInput:ue,newInit:Ke}=rn(ee,j,R,N,X);return new Promise((ke,rt)=>{_[Rt].call(this,ue,Ke).then(st=>{ke(st)}).catch(st=>rt(st))})}}function rn(_,R,N,X,ee){let j,ue;if(X)if(typeof X=="object")({newInput:j,newInit:ue}=Nr(X,_,R));else{const Ke={name:N};Ke.url=_ instanceof Request?_.url:_ instanceof URL?_.href:_,Ke.method=R.method||"GET",Ke.withCredentials=R.credentials==="include";const ke=R.headers;if(ke)if(Ke.headers={},ke instanceof Headers)ke.forEach((st,bt)=>{Ke.headers[bt]=st});else if(Array.isArray(ke))for(let st=0;st<ke.length;st++)Ke.headers[ke[st][0]]=ke[st][1];else Ke.headers=ke;const rt=X(Ke);({newInput:j,newInit:ue}=Nr(rt,_,R))}return ee&&(j&&ue?{newInput:j,newInit:ue}=Nr({headers:ee},j,ue):{newInput:j,newInit:ue}=Nr({headers:ee},_,R)),{newInput:j,newInit:ue}}var Zr=(_,R)=>{var N,X;const ee=Object.keys(R);if(ee.length!==0)for(let j=0;j<ee.length;j++){const ue=ee[j];if(ue==="url"||ue==="method"||ue==="withCredentials")_[ue]=R[ue];else if(ue==="headers"){_.headers=_.headers||{};const Ke=Object.keys(R.headers||{});if(Ke.length===0)return;for(let ke=0;ke<Ke.length;ke++){const rt=Ke[ke];_.headers[rt]=(X=(N=R.headers)==null?void 0:N[rt])!=null?X:""}}}};function Xr(_,R,N,X){_=_||window,_[vt]=_[vt]||_.XMLHttpRequest;class ee extends _[vt]{constructor(){super();this.curRequestOptions={name:R}}open(...ue){return this.curRequestOptions.method=ue[0],this.curRequestOptions.url=ue[1],this.curRequestOptions.headers={},super.open.call(this,...ue)}setRequestHeader(...ue){this.curRequestOptions.headers&&(this.curRequestOptions.headers[ue[0]]=ue[1])}send(...ue){if(this.curRequestOptions.withCredentials=this.withCredentials,N)if(typeof N=="object")Zr(this.curRequestOptions,N);else{const Be=N(this.curRequestOptions);Be&&Zr(this.curRequestOptions,Be)}X&&Zr(this.curRequestOptions,{headers:X});const{url:Ke,method:ke,headers:rt={},withCredentials:st}=this.curRequestOptions;this.withCredentials=st,super.open.call(this,ke,Ke);const bt=Object.keys(rt);if(bt.length!==0){for(let Be=0;Be<bt.length;Be++){const Fe=bt[Be];super.setRequestHeader.call(this,Fe,rt[Fe])}super.send.call(this,...ue)}}}_.XMLHttpRequest=ee}function Wr(){return function(){let _;return{name:"requesHook",version:"0.0.1",bootstrap(R){_=R==null?void 0:R.requestOptions},afterLoad(R,N){const X=R.requestOptions||_||void 0,{headers:ee}=R;!ee&&(!X||typeof X=="object"&&Object.keys(X).length===0)||(Xr(N==null?void 0:N.global,R.name,X,ee),tn(N==null?void 0:N.global,R.name,X,ee))}}}}var qr=we(Ne()),zr=window.requestIdleCallback||window.requestAnimationFrame;function cr(_){const R=Object.create(null);for(let N=0;N<_.length;N++)R[_[N]]=!0;return N=>!!R[N]}var Ur="[Garfish warning]",Lr=(_,R)=>{try{typeof _=="string"?(_=`${Ur}: ${_}

`,R(_,!0)):_ instanceof Error&&(_.message.startsWith(Ur)||(_.message=`${Ur}: ${_.message}`),R(_,!1))}catch(N){R(_,typeof _=="string")}};function ve(_){Lr(_,(R,N)=>{const X=N?R:R.message;console.warn(X)})}function de(_){Lr(_,(R,N)=>{throw N?new Error(R):R})}function D(_,R){try{_()}catch(N){!R&&(typeof process!="undefined"&&process.env)}}function W(_,R){_||de(R||"unknow reason")}var C=["link","style","script","img","video","audio","iframe"],Z=cr(C),ie="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Ie=cr(ie.split(",")),Ze=Symbol.for("__LOADER_FLAG__"),ot=Symbol.for("__GARFISH_FLAG__");function Ye(_,R,N){const X=50,ee=document.querySelector(_);if(ee!==null||N<=0){R(ee);return}setTimeout(function(){Ye(_,R,N-X)},X)}function ct(_){return new Promise(function(R){setTimeout(R,_)})}function Gt(_,R=3e3){const N=new Promise(function(X){Ye(_,function(ee){return X(ee)},R)});return Promise.race([ct(R),N])}function $t(_){return fe(this,null,function*(){W(_,`Invalid domGetter:
 ${_}.`);let R;return typeof _=="string"?R=yield Gt(_):typeof _=="function"&&(R=yield Promise.resolve(_())),W(R instanceof Element,`Invalid domGetter: ${_}`),R})}var Vt=(0,qr.default)("garfish"),vr=Vt.extend("core"),Ut=Vt.extend("router"),Dt=cr(["h1","h2","h3","h4","h5","h6","h7","h8","p","div","span","a","button","input","textarea","label","select","option","li","ul","ol","dl","dt","dd","table","thead","tbody","tfoot","tr","th","td","body","html"]);function gr(_){return Dt(_.tagName.toLocaleLowerCase())&&_.innerText}function Kt(_){return _.tagName.toLocaleLowerCase()==="img"&&_ instanceof HTMLImageElement}function or(_){return _.style.backgroundImage&&_.style.backgroundImage.includes("url")}function Ar(_){return _.tagName.toLocaleLowerCase()==="svg"&&_ instanceof SVGElement}var Kr={isSupport:!0,isPolyfill:!1,isBounced:!1,isCustom:!1,isUserEvent:!1,isMark:!1,type:"perf"},tr=(_,R)=>P({name:_,value:R},Kr),Br=_=>{let R=!1;return[(...X)=>{R||(R=!0,_&&_(...X))}]},nn=_=>{const[R]=Br(_);["unload","beforeunload","pagehide"].forEach(N=>{addEventListener(N,R)})},dn=_=>{const R=()=>{document.visibilityState==="hidden"&&(_(),removeEventListener("visibilitychange",R,!0))};addEventListener("visibilitychange",R,!0)},ln=_=>{var R,N;const X=(R=performance.getEntriesByType("navigation"))==null?void 0:R[0];return((N=X==null?void 0:X.name)==null?void 0:N.includes(location.pathname))&&_},on=_=>{let R=window.innerHeight,N=window.innerWidth,{top:X,left:ee,bottom:j,right:ue}=_.getBoundingClientRect();return X>=0&&ee>=0&&j<=R&&ue<=N},wn="mffcp",Jr=["keydown","click"],un=(_,R)=>{const N=_&&new _(R);return[(j,ue)=>{N&&j&&N.observe(j,ue)},()=>N&&N.disconnect()]},Qr=_=>{if(gr(_)||Kt(_)||or(_)||Ar(_))return _;if(_.childNodes.length===0)return!1;for(let R=0;R<_.childNodes.length;R++){const N=_.childNodes[R];if(N instanceof HTMLElement){const X=Qr(N);if(X)return X}}return!1},Ir=(_=window.MutationObserver)=>(R,N)=>fe(void 0,null,function*(){const X=performance.now(),ee=yield $t(R);let j=null;const ue=tr(wn,0),[Ke]=Br(N);if(!_){ue.isSupport=!1,Ke(ue,j);return}const ke=(tt,rr)=>{for(let Tr=0;Tr<tt.length;Tr++){const mr=tt[Tr];if(mr.type==="childList")for(let xr=0;xr<mr.addedNodes.length;xr++){const Vr=mr.addedNodes[xr],Hr=Vr instanceof HTMLElement&&Qr(Vr);if(Hr){j=Hr;const Sn=performance.now();ue.value=Math.ceil(Sn-X),rr.disconnect(),Ke(ue,j);return}}}},[rt,st]=un(_,ke),bt=()=>{st(),Jr.forEach(tt=>{window.removeEventListener(tt,Be,!0)})},Be=()=>{Ke(ue,j),bt()};Jr.forEach(tt=>{window.addEventListener(tt,Be,!0)}),dn(()=>{ue.isSupport=!1,Be()}),nn(()=>{ue.isBounced=!0,Be()}),rt(ee,{subtree:!0,childList:!0})}),hn="mffp";function m(_){const R=tr(hn,performance.now());return function(){R.value=Math.ceil(performance.now()-R.value),_(R)}}var E="mflcp",F=["keydown","click"],re=(_,R)=>{const N=_&&new _(R);return[j=>{N&&N.observe(j)},()=>N&&N.disconnect()]},Ee=(_=window.PerformanceObserver)=>{let R=null;return(N,X)=>{const ee=tr(E,0),j=performance.now(),[ue]=Br(X);if(!_||!_.supportedEntryTypes){ee.isSupport=!1,ue(ee,null);return}const Ke=(ke,rt)=>{D(()=>fe(void 0,null,function*(){const st=yield $t(N);ke.getEntries().forEach(Be=>{var Fe,it,tt,rr;if((Be==null?void 0:Be.element)&&(Be==null?void 0:Be.intersectionRect)&&(st==null?void 0:st.contains(Be.element)))if(!R)R=Be,ee.value=Math.ceil(Be.startTime-j);else{const Tr=((Fe=Be==null?void 0:Be.intersectionRect)==null?void 0:Fe.width)*((it=Be==null?void 0:Be.intersectionRect)==null?void 0:it.height),mr=((tt=R==null?void 0:R.intersectionRect)==null?void 0:tt.width)*((rr=R==null?void 0:R.intersectionRect)==null?void 0:rr.height);Tr>mr&&(R=Be,ee.value=Math.ceil(Be.startTime-j))}})}))};try{const[ke,rt]=re(_,Ke),st=()=>{rt(),F.forEach(it=>{window.removeEventListener(it,bt,!0)})},bt=()=>{ue(ee,R),st()};F.forEach(it=>{window.addEventListener(it,bt,!0)}),dn(()=>{ee.isSupport=!1,bt()}),nn(()=>{ee.isBounced=!0,bt()}),ke({type:"element",buffered:!1})}catch(ke){ee.isSupport=!1,ue(ee,null),console.warn(ke)}}},Se="TimeToFirstMeaningfulPaint",ze=["keydown","click"],et=(_,R)=>{const N=_&&new _(R);return[(j,ue)=>{N&&j&&N.observe(j,ue)},()=>N&&N.disconnect()]},kt=(_=window.MutationObserver)=>(R,N,X)=>fe(void 0,null,function*(){const ee=performance.now(),j=yield $t(R),ue=X.isFirstRender,Ke=ln(ue),ke=X.subAppName,rt=tr(Se,0);rt.isFirstScreen=Ke;const[st]=Br(N);if(!_){rt.isSupport=!1,st(rt,null);return}if(ke==="helper"){rt.isSupport=!1,st(rt,null);return}let bt=null;const Be=(Hr,Sn)=>{let gn=!1;Hr.forEach((u,e)=>{u.target.nodeName==="STYLE"||u.target.nodeName==="SCRIPT"||on(u.target)&&(gn=!0)}),!!gn&&(bt&&clearTimeout(bt),bt=setTimeout(()=>{const u=performance.now();rt.value=u-ee-3e3,rr()},3e3))},[Fe,it]=et(_,Be),tt=()=>{it(),ze.forEach(Hr=>{window.removeEventListener(Hr,Tr,!0)}),document.removeEventListener("UDiff_event",mr)},rr=()=>{st(rt,null),tt()},Tr=()=>{rt.value=performance.now()-ee,rt.isUserEvent=!0,rr()};ze.forEach(Hr=>{window.addEventListener(Hr,Tr,!0)});const mr=()=>{Ke||(rt.value=performance.now()-ee,rt.isMark=!0),rr()};return document.addEventListener("UDiff_event",mr),dn(()=>{rt.isSupport=!1,rr()}),nn(()=>{rt.isBounced=!0,rr()}),Fe(j,{subtree:!0,childList:!0}),()=>{bt&&clearTimeout(bt),rr()}});function ir(_){return function(R){let N=[],X;return{name:"garfish-slardar-container-plugin",version:"0.0.1",beforeLoad(ee){var j;const ue=!(ee.cache&&((j=R.cacheApps[ee.name])==null?void 0:j.mounted)),Ke=m(ke=>{ke.extra={isFirstRender:String(ue),subAppName:ee.name},_("sendCustomPerfMetric",ke)});N.push(Ke),Ir()(ee.domGetter,ke=>{ke.extra={isFirstRender:String(ue),subAppName:ee.name},_("sendCustomPerfMetric",ke)}),Ee()(ee.domGetter,ke=>{ke.extra={isFirstRender:String(ue),subAppName:ee.name},_("sendCustomPerfMetric",ke)}),kt()(ee.domGetter,ke=>{ke.value&&_("sendEvent",{name:ke.name,metrics:{value:ke.value},categories:{isFirstRender:String(ue),subAppName:ee.name,isSupport:`${ke.isSupport}`,isPolyfill:`${ke.isPolyfill}`,isBounced:`${ke.isBounced}`,isCustom:`${ke.isCustom}`,isUserEvent:`${ke.isUserEvent}`,is_preheat:`${Ft()}`,isFirstScreen:`${ke.isFirstScreen}`,isMark:`${ke.isMark}`}})},{isFirstRender:ue,subAppName:ee.name}).then(ke=>{X=ke})},beforeMount(ee){N.forEach(j=>j()),N=[],_("sendEvent",{name:"subAppPV",categories:{subAppName:ee.name}})},afterMount(ee){_("sendEvent",{name:"successMount",categories:{subAppName:ee.name}})},beforeUnmount(){X==null||X()},errorLoadApp(ee,j){_("sendEvent",{name:"errorLoad",categories:{subAppName:j.name,errorMsg:ee.message,errorName:ee.name,errorStack:JSON.stringify(ee.stack)}})},errorMountApp(ee,j){_("sendEvent",{name:"errorMount",categories:{subAppName:j.name,errorMsg:ee.message,errorName:ee.name,errorStack:JSON.stringify(ee.stack)}})}}}}var lr=window.location.host.indexOf("boe")>=0||window.location.host.includes(":")?"boe":"prod",At={get:_=>localStorage.getItem(_)||"",set:(_,R)=>localStorage.setItem(_,R),remove:_=>localStorage.removeItem(_),clear:()=>localStorage.clear()},Qt="__FEMS_SUB_APP_LIST__",fr={get:()=>{const _=At.get(Qt);return _?JSON.parse(_):null},set:_=>At.set(Qt,JSON.stringify(_))};function dr(_,R){const{domId:N}=R;return _.map(X=>{const ee=N?`#${N}`:`#${ne}`;let j;try{const ue=JSON.parse(X.extraConfig);j=ue==null?void 0:ue.headers}catch(ue){}return{name:X.subAppPrefix,entry:X.innerEntry,domGetter:ee,activeWhen:`/${X.subAppPrefix}`,requestOptions:R.requestOptions,basename:R.basename||"/",headers:j}})}function Rr(_,R){const{domId:N,requestOptions:X,basename:ee}=R;return Array.isArray(_)||(_=[_]),_.map(j=>{const{domGetter:ue,basename:Ke}=j,ke=ue||(N?`#${N}`:`#${ne}`);return $(P({requestOptions:X,basename:Ke||ee||"/"},j),{domGetter:ke})})}var Or=class{constructor(){return Or.instance||(Or.instance=this),Or.instance}useGarfishPlugins(_){_.forEach(R=>{y.ZP.usePlugin(R)})}runGarfish(_){return y.ZP.run(_)}registerFemsApps(_,R){return fe(this,null,function*(){var N;const X=fr.get();if(X){const ee=dr(X,_.workbenchOptions);y.ZP.registerApp(ee),setTimeout(()=>fe(this,null,function*(){var j;try{const ue=yield Mr(R),Ke=(j=ue==null?void 0:ue.data)==null?void 0:j.subAppList;Ke&&fr.set(Ke)}catch(ue){console.log(ue)}}),200)}else try{const ee=yield Mr(R),j=(N=ee==null?void 0:ee.data)==null?void 0:N.subAppList;if(j){fr.set(j);const ue=dr(j,_.workbenchOptions);y.ZP.registerApp(ue)}}catch(ee){console.log(ee)}})}loadApp(_,R){return y.ZP.loadApp(_,R)}registerApp(_){return y.ZP.registerApp(_)}},Mr=_=>{const R=`https://fems.bytedance.com/api/v1/sdk/config?femsAppId=${_}`;return fetch(R).then(N=>N.json())},sn=new Or,pn=(_,R,N,X)=>{R.hooks.afterEmit.tap("apiCall",(ee,j,ue,Ke)=>{(ue==null?void 0:ue.pluginId)&&_.sendApiCall(X,N,ee,"new",ue.pluginId)})},vn=class{constructor(){this._hasInit=!1,this.garfishLoader=sn,this.workbenchEvent=ae,this.garfishLoader=new Or,this.slardarLoader=new wr}onDomIdChange(_){this.domIdChangeListener=_}emitDomIdChange(_){var R;(R=this.domIdChangeListener)==null||R.call(this,_)}offDomIdChange(){this.domIdChangeListener=null}init(_){return fe(this,null,function*(){if(this._hasInit)return console.warn("workbench has init,don't init again");this._hasInit=!0,this.workbenchOptions=_,this.emitDomIdChange(this.workbenchOptions.domId);const R=_,{platform:N,appid:X,domId:ee,extra:j,apps:ue}=R,Ke=ye(R,["platform","appid","domId","extra","apps"]);pn(this.slardarLoader,this.workbenchEvent,N,X);const ke={platform:N,appid:X,extra:j};window[je]=ke,this.garfishLoader.useGarfishPlugins([Wr(),Wt(),ir(this.slardarLoader.slardar)]),_.isBackup&&this.garfishLoader.useGarfishPlugins([(0,h.bb)()]),this.slardarLoader.init({bid:Xe,env:lr,fems_app_id:X}),this.slardarLoader.start(),this.garfishLoader.runGarfish(Ke),ue?this.garfishLoader.registerApp(Rr(ue,this.workbenchOptions)):this.garfishLoader.registerFemsApps(this,X),yield this.initLight(_)})}loadApp(_,R){return this.garfishLoader.loadApp(_,R)}registerApp(_){return this.garfishLoader.registerApp(_)}getFemsSubAppList(_){return Mr(_)}sendOldApiCall(_,R,N){R=R||this.workbenchOptions.appid,N=N||this.workbenchOptions.platform,this.slardarLoader.sendApiCall(R,N,_,"old")}initLight(_){return fe(this,null,function*(){})}openOfficialLight(_){return fe(this,arguments,function*(R,N={}){})}destroyLight(_){}};S();var Yr=new vn;window.__workbench__=Yr;var Cr=_=>{var R=_,{slotId:N,children:X}=R,ee=ye(R,["slotId","children"]);return O.createElement("div",P({id:N},ee),X)},$r=_=>{var R=_,{children:N,id:X}=R,ee=ye(R,["children","id"]),j,ue;const[Ke,ke]=(0,O.useState)((ue=(j=Yr)==null?void 0:j.workbenchOptions)==null?void 0:ue.domId);(0,O.useLayoutEffect)(()=>{if(!X&&!Ke)return Yr.onDomIdChange(ke),()=>{Yr.offDomIdChange()}},[X,Ke]);const rt=X||Ke||ne;return O.createElement(Cr,P({slotId:rt},ee),N)};/*! Bundled license information:

js-cookie/src/js.cookie.js:
  (*!
   * JavaScript Cookie v2.2.1
   * https://github.com/js-cookie/js-cookie
   *
   * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
   * Released under the MIT license
   *)
*/},969:(l,n,o)=>{o.d(n,{Z:()=>Te});var c=function(ce,x,P){if(!ce||["SCRIPT","STYLE","META","HEAD"].indexOf(ce.tagName)>-1)return 0;var $=ce.children,he=$===void 0?[]:$,ye=[].slice.call(he).reduceRight(function(fe,K){return fe+c(K,x+1,fe>0)},0);if(ye<=0&&!P){if(!ce.getBoundingClientRect)return 0;var Re=ce.getBoundingClientRect()||{},He=Re.top,we=Re.height;if(He>window.innerHeight||we<=0)return 0}return ye+1+.5*x},h=function(ce){return ce?ce.querySelectorAll("*").length:0},g=function(ce,x){var P=ce===void 0?[]:ce,$=P[0],he=P.slice(1);return x===void 0&&(x="score"),he&&he.reduce(function(ye,Re){var He=ye[0],we=ye[1],fe=Re[x]-He[x];return[Re,Re.time>=He.time&&we.rate<fe?{time:Re.time,rate:fe}:we]},[$,{time:$==null?void 0:$.time,rate:0}])[1].time||0},b=function(ce,x){if(ce.length>2)return performance.now();for(var P=[],$=0,he=x;$<he.length;$++){var ye=he[$];P.push({timestamp:ye.start,type:"requestStart"}),P.push({timestamp:ye.end,type:"requestEnd"})}for(var Re=0,He=ce;Re<He.length;Re++){var we=He[Re];P.push({timestamp:we,type:"requestStart"})}P.sort(function(k,se){return k.timestamp-se.timestamp});for(var fe=ce.length,K=P.length-1;K>=0;K--){var I=P[K];switch(I.type){case"requestStart":fe--;break;case"requestEnd":if(fe++,fe>2)return I.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0},y=function(ce,x,P,$){if(P-x<5e3)return null;var he=$.length===0?ce:$[$.length-1].end;return P-he<5e3?null:he},O=0;function M(ce,x,P){P===void 0&&(P=[]);var $=XMLHttpRequest.prototype.open,he=O++;XMLHttpRequest.prototype.open=function(){for(var ye=this,Re=[],He=0;He<arguments.length;He++)Re[He]=arguments[He];var we=P.some(function(fe){return Re[1].toString().indexOf(fe)!==-1});return we&&ce(he),this.addEventListener("readystatechange",function(){ye.readyState===4&&we&&x(he)}),$.apply(this,Re)}}function G(ce,x,P){P===void 0&&(P=[]);var $=window.fetch;window.fetch=function(he,ye){var Re=P.some(function(He){return he.toString().indexOf(He)!==-1});return new Promise(function(He,we){var fe=O++;Re&&ce(fe),$(he,ye).then(function(K){Re&&x(fe),He(K)},function(K){Re&&x(fe),we(K)})})}}function le(ce){return PerformanceObserver?(ce.forEach(function(x){if(PerformanceObserver.supportedEntryTypes.indexOf(x)===-1)return!1}),!0):!1}var Pe=function(){function ce(x){var P=this;this.spaBeforeLoadTime=0,this.firstPaint=0,this.dataTimer=0,this.targetSubscriber=[],this.errorSubscriber=[],this.reportTimeLag=x.waitTTINotifyMaxTime||2e4,this.isRecordFinish=!1,this.isCallBackFinish=!1,this.isTTINotifyFinish=!1,this.finishAction="",this.performanceData={tti:0,action:""},this.started=!1,this._scheduleTimerTasks=!1,this._longTasks=[],this._networkRequests=[],this._timerId=0,this._timerActivationTime=0,this._incompleteJSInitiatedRequestStartTimes={},this.ignoreList=x.ignoreList||[],M(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this),this.ignoreList),G(this._beforeJSInitiatedRequestCallback.bind(this),this._afterJSInitiatedRequestCallback.bind(this),this.ignoreList),this._performanceObserver=new PerformanceObserver(function($){for(var he=$.getEntries(),ye=function(fe){if(fe.entryType==="resource"){var K=P.ignoreList.every(function(I){return fe.name.indexOf(I)===-1});K&&P._networkRequestFinishedCallback(fe)}fe.entryType==="longtask"&&P._longTaskFinishedCallback(fe)},Re=0,He=he;Re<He.length;Re++){var we=He[Re];ye(we)}})}return ce.prototype.ttiEndObserver=function(x,P){console.warn("ttiEndObserver"),this.isRecordFinish=!0,this.finishAction=x,this._ttiPerformanceDataHandle(P||performance.now()),this._scheduleTimerTasks=!1,this._performanceObserver&&this._performanceObserver.disconnect(),clearTimeout(this._timerId)},ce.prototype._ttiStartObserver=function(){console.warn("ttiStartObserver");try{this.started=!0,this._performanceObserver.observe({entryTypes:["longtask","resource"]})}catch(x){console.error(x)}},ce.prototype._beforeJSInitiatedRequestCallback=function(x){this._incompleteJSInitiatedRequestStartTimes[x]=performance.now()},ce.prototype._afterJSInitiatedRequestCallback=function(x){delete this._incompleteJSInitiatedRequestStartTimes[x]},Object.defineProperty(ce.prototype,"_incompleteRequestStarts",{get:function(){var x=[];for(var P in this._incompleteJSInitiatedRequestStartTimes)Object.prototype.hasOwnProperty.call(this._incompleteJSInitiatedRequestStartTimes,P)&&x.push(this._incompleteJSInitiatedRequestStartTimes[P]);return x},enumerable:!1,configurable:!0}),ce.prototype._checkTTI=function(){if(!this.isRecordFinish){var x=b(this._incompleteRequestStarts,this._networkRequests),P=this.firstPaint,$=performance.now(),he=y(P,x,$,this._longTasks);he&&this.ttiEndObserver("PerformanceObserver",he),this.rescheduleTimer(performance.now()+1e3)}},ce.prototype.rescheduleTimer=function(x){var P=this;!this._scheduleTimerTasks||this._timerActivationTime>x||(clearTimeout(this._timerId),this.isRecordFinish||(this._timerId=setTimeout(function(){P._checkTTI()},x-performance.now())),this._timerActivationTime=x)},ce.prototype._networkRequestFinishedCallback=function(x){this._networkRequests.push({start:x.fetchStart,end:x.responseEnd}),this.rescheduleTimer(b(this._incompleteRequestStarts,this._networkRequests)+5e3)},ce.prototype._longTaskFinishedCallback=function(x){var P=x.startTime+x.duration;this._longTasks.push({start:x.startTime,end:P}),this.rescheduleTimer(P+5e3)},ce.prototype.startSchedulingTimerTasks=function(){this._scheduleTimerTasks=!0;var x=this._longTasks.length>0?this._longTasks[this._longTasks.length-1].end:0,P=b(this._incompleteRequestStarts,this._networkRequests);this.rescheduleTimer(Math.max(P+5e3,x))},ce.prototype._ttiPerformanceDataHandle=function(x){console.warn("ttiPerformanceDataHandle"),this.performanceData={tti:x-this.spaBeforeLoadTime,action:this.finishAction}},ce.prototype._handleCallback=function(){var x=this;console.warn("handleCallback");try{this.isCallBackFinish=!0,this.targetSubscriber.forEach(function(P){var $=x.performanceData,he=$.action,ye=$.tti;he&&ye>0?(console.warn("SUCCESS -> \u9875\u9762\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData),P(x.performanceData)):(x.errorSubscriber.forEach(function(Re){return Re(x)}),console.warn("ERROR -> \u9875\u9762\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData))})}catch(P){console.error(P)}},ce.prototype._handleSubscribeCallback=function(x){var P=this;try{clearTimeout(this.dataTimer),x?this.isCallBackFinish||this._handleCallback():this.dataTimer=setTimeout(function(){clearTimeout(P.dataTimer),P.isRecordFinish||P.ttiEndObserver("TimeOut"),P._handleCallback()},this.reportTimeLag)}catch($){console.error($)}},ce.prototype.subscribePerformanceData=function(x){try{this.targetSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.subscribeErrorInfo=function(x){try{this.errorSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.ttiStart=function(){console.warn("ttiStart"),this.firstPaint=performance.now(),this.isRecordFinish=!1,this.isTTINotifyFinish=!1,this.isCallBackFinish=!1,this._scheduleTimerTasks=!1,this._longTasks=[],this._networkRequests=[],clearTimeout(this._timerId),this._timerActivationTime=0,this._incompleteJSInitiatedRequestStartTimes={},this._ttiStartObserver()},ce.prototype.unMount=function(){console.warn("tti UnMount"),this.isRecordFinish||this.ttiEndObserver("SPAUnMount"),this._handleSubscribeCallback(!0)},ce.prototype.restart=function(){this.started&&this.unMount(),this.finishAction="",this.performanceData={tti:0,action:""},this.started=!1,this.spaBeforeLoadTime=performance.now(),this.ttiStart()},ce.prototype.ttiNotify=function(){console.warn("ttiNotify"),this.isRecordFinish?this.isTTINotifyFinish||(this.isTTINotifyFinish=!0,this.finishAction="TTINotify",this._ttiPerformanceDataHandle(performance.now())):(this.isTTINotifyFinish=!0,this.ttiEndObserver("TTINotify"))},ce.prototype.updateFirstPaint=function(x){this.firstPaint=x},ce}();const Ce=Pe;var De=function(){function ce(x){var P=this;this._eventCallback=function(){var he;clearTimeout(P.observeTimer),P.isRecordFinish||P._spaEndObserver("UserEvent"),(he=P.ttiObserver)===null||he===void 0||he.ttiEndObserver("UserEvent")};var $=!1;try{$=le(["resource","longtask"])}catch(he){console.error(he)}$?(this.ttiObserver=new Ce({waitTTINotifyMaxTime:x.waitTTINotifyMaxTime,ignoreList:x.ignoreList}),this.ttiObserver.subscribePerformanceData(this._handleTTICallback.bind(this))):console.warn("\u5F53\u524D\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u76D1\u63A7tti"),window[x.spaMonitorName||"spaMonitor"]=this,this.observer=new MutationObserver(function(){P._mutationObserverCallback()}),this.spaBeforeLoadTime=performance.now(),this.spaModa=x.spaModa,this._prePath="",this._nowPath="",this.spaStartPageShowTime=0,this.spaPageShowTime=0,this.observeTimer=0,this.dataTimer=0,this.domQuerySelector=x.subAppRootSelector,this.spaRootSelector=x.spaRootSelector,this.targetNode=null,this.config={attributes:!1,childList:!0,subtree:!0},this.targetSubscriber=[],this.targetTTISubscriber=[],this.errorSubscriber=[],this.timeLag=x.domObserverMaxTime||3e3,this.reportTimeLag=x.waitSPANotifyMaxTime||1e4,this.isRecordFinish=!1,this.isStartShowFlag=!0,this.isCallBackFinish=!1,this.isSPANotifyFinish=!1,this.finishAction="",this.entry=x.entry||"",this.noFmp=x.noFmp||!1,this.flag=!1,this.performanceData={blankScreenTime:0,firstScreenTime:0,fmp:0,fmpByLength:0,prePath:this._prePath,currentPath:this._nowPath,action:"",entry:this.entry},this.started=!1,this.spaTargetNodefound=!1,this.countdownStart=!1,this.list=[],this.start(this.entry)}return ce.prototype._routeHandle=function(x){var P;this._nowPath!==location.pathname&&(console.log("spa \u8DEF\u7531\u76D1\u6D4B",x,location.pathname),this.spaRestart(),(P=this.ttiObserver)===null||P===void 0||P.restart(),this._prePath=this._nowPath,this._nowPath=location.pathname,this.performanceData.prePath=this._prePath,this.performanceData.currentPath=this._nowPath)},ce.prototype._watchRouteChange=function(){this.flag||(window.addEventListener("popstate",this._routeHandle.bind(this)),this.flag=!0)},ce.prototype._mutationObserverCallback=function(){var x=this,P,$,he,ye,Re;if(this.isStartShowFlag){var He=performance.now();this.spaStartPageShowTime=He,(P=this.ttiObserver)===null||P===void 0||P.updateFirstPaint(He),this.isStartShowFlag=!1}if(!this.spaTargetNodefound){if(!this.spaRootSelector){this.spaTargetNodefound=!0;var He=performance.now();this.list.push({time:He-this.spaBeforeLoadTime,score:0,lengthScore:0}),this.spaStartPageShowTime=He,($=this.ttiObserver)===null||$===void 0||$.updateFirstPaint(He);return}var we=document.querySelector(typeof this.spaRootSelector=="function"?this.spaRootSelector():this.spaRootSelector);if(we){this.spaTargetNodefound=!0,this.observer.disconnect(),this._spaClickEventObserver(this.targetNode,!0),this.targetNode=we,this.observer.observe(we,this.config),this._spaClickEventObserver(we);var He=performance.now();this.list.push({time:He-this.spaBeforeLoadTime,score:0,lengthScore:0}),this.spaStartPageShowTime=He,(he=this.ttiObserver)===null||he===void 0||he.updateFirstPaint(He)}return}var fe=this.noFmp?0:c(this.targetNode,1,!1);this.list.push({time:performance.now()-this.spaBeforeLoadTime,score:fe,lengthScore:h(this.targetNode)}),this.countdownStart||(this._handleSubscribeCallback(!1),(ye=this.ttiObserver)===null||ye===void 0||ye.startSchedulingTimerTasks(),(Re=this.ttiObserver)===null||Re===void 0||Re._handleSubscribeCallback(!1),this.countdownStart=!0),clearTimeout(this.observeTimer),this.observeTimer=setTimeout(function(){clearTimeout(x.observeTimer),x.isRecordFinish||x._spaEndObserver("MutationObserver")},this.timeLag)},ce.prototype._spaEndObserver=function(x){console.warn("spaEndObserver"),this.isRecordFinish=!0,this.finishAction=x,this.spaPageShowTime=performance.now(),this.observer.disconnect(),this._spaClickEventObserver(this.targetNode,!0),this._spaPerformanceDataHandle(),this.isStartShowFlag=!0},ce.prototype._spaPerformanceDataHandle=function(){console.warn("spaPerformanceDataHandle");var x=this.finishAction==="MutationObserver"?this.timeLag:0;this.performanceData={blankScreenTime:this.spaStartPageShowTime-this.spaBeforeLoadTime,firstScreenTime:this.spaPageShowTime-this.spaBeforeLoadTime-x,fmpByLength:g(this.list,"lengthScore"),prePath:this._prePath,currentPath:this._nowPath,action:this.finishAction,entry:this.entry},this.noFmp||(this.performanceData.fmp=g(this.list,"score"))},ce.prototype._spaClickEventObserver=function(x,P){P===void 0&&(P=!1),console.warn("spaClickEventObserver");var $=x||this.targetNode;if(P){$==null||$.removeEventListener("click",this._eventCallback),$==null||$.removeEventListener("keyup",this._eventCallback),$==null||$.removeEventListener("keydown",this._eventCallback),$==null||$.removeEventListener("keypress",this._eventCallback);return}$==null||$.addEventListener("click",this._eventCallback),$==null||$.addEventListener("keyup",this._eventCallback),$==null||$.addEventListener("keydown",this._eventCallback),$==null||$.addEventListener("keypress",this._eventCallback)},ce.prototype._handleCallback=function(){var x=this;console.warn("handleCallback");try{this.isCallBackFinish=!0,this.targetSubscriber.forEach(function(P){var $=x.performanceData,he=$.firstScreenTime,ye=$.blankScreenTime,Re=$.action,He=$.currentPath;he>0&&ye>0&&Re&&He?(console.warn("SUCCESS -> \u9875\u9762\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData),P(x.performanceData)):(x.errorSubscriber.forEach(function(we){return we(x)}),console.warn("ERROR -> \u9875\u9762\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData))})}catch(P){console.error(P)}},ce.prototype._handleTTICallback=function(x){var P=this;console.warn("handleTTICallback");try{this.targetTTISubscriber.forEach(function($){var he=x.tti,ye=x.action;$({tti:he,prePath:P._prePath,currentPath:P._nowPath,action:ye,entry:P.entry})})}catch($){console.error($)}},ce.prototype._handleSubscribeCallback=function(x){var P=this;try{clearTimeout(this.dataTimer),x?this.isCallBackFinish||this._handleCallback():this.dataTimer=setTimeout(function(){clearTimeout(P.dataTimer),P.isRecordFinish||P._spaEndObserver("TimeOut"),P._handleCallback()},this.reportTimeLag)}catch($){console.error($)}},ce.prototype.start=function(x,P){var $=P||{},he=$.subAppRootSelector,ye=$.spaRootSelector,Re=$.spaModa,He=$.noFmp;this.entry=x,he&&(this.domQuerySelector=he),ye&&(this.spaRootSelector=ye),typeof Re=="boolean"&&(this.spaModa=Re),typeof He=="boolean"&&(this.noFmp=He),this.spaModa?this._watchRouteChange():window.removeEventListener("popstate",this._routeHandle.bind(this))},ce.prototype.destroy=function(){this.spaUnMount()},ce.prototype.subscribePerformanceData=function(x){try{this.targetSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.subscribeTTIPerformanceData=function(x){try{this.targetTTISubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.subscribeTTIErrorInfo=function(x){var P;(P=this.ttiObserver)===null||P===void 0||P.subscribeErrorInfo(x)},ce.prototype.subscribeErrorInfo=function(x){try{this.errorSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.spaStartObserver=function(){console.warn("spaStartObserver");try{console.warn(typeof this.domQuerySelector=="function"?this.domQuerySelector():this.domQuerySelector);var x=document.querySelector(typeof this.domQuerySelector=="function"?this.domQuerySelector():this.domQuerySelector);x&&!this.started&&(this.started=!0,this.targetNode=x,this.observer.observe(x,this.config),this._spaClickEventObserver(x))}catch(P){console.error(P)}},ce.prototype.spaBeforeLoad=function(){console.warn("spaBeforeLoad"),this.spaBeforeLoadTime=performance.now(),this.isRecordFinish=!1,this.isSPANotifyFinish=!1,this.list=[],this.isCallBackFinish=!1,this.spaStartObserver()},ce.prototype.spaUnMount=function(){var x;console.warn("spaUnMount"),this.isRecordFinish||this._spaEndObserver("SPAUnMount"),this._handleSubscribeCallback(!0),(x=this.ttiObserver)===null||x===void 0||x.unMount()},ce.prototype.spaRestart=function(){console.warn("spaRestart"),this.started&&this.spaUnMount(),this.spaStartPageShowTime=0,this.spaPageShowTime=0,clearTimeout(this.observeTimer),this.isStartShowFlag=!0,this.finishAction="",this.performanceData={blankScreenTime:0,firstScreenTime:0,fmp:0,fmpByLength:0,prePath:this._prePath,currentPath:this._nowPath,action:"",entry:this.entry},this.started=!1,this.spaTargetNodefound=!1,this.countdownStart=!1,this.observer.disconnect(),this._spaClickEventObserver(this.targetNode,!0),this.spaBeforeLoad()},ce.prototype.afterRenderNotify=function(){console.warn("afterRenderNotify"),this.isRecordFinish?this.isSPANotifyFinish||(this.isSPANotifyFinish=!0,this.finishAction="SPARenderNotify",this._spaPerformanceDataHandle()):(this.isSPANotifyFinish=!0,this._spaEndObserver("SPARenderNotify"))},ce.prototype.ttiNotify=function(){var x;(x=this.ttiObserver)===null||x===void 0||x.ttiNotify()},ce}();const Ae=De;var ge=function(){function ce(x){this.observer=new MutationObserver(this._mutationObserverCallback.bind(this)),this.subAppBeforeLoadTime=0,this.subAppBeforeMountTime=0,this.subAppStartPageShowTime=0,this.subAppPageShowTime=0,this.entry="",this.observeTimer=0,this.dataTimer=0,this.domQuerySelector=x.subAppRootSelector,this.config={attributes:!0,childList:!0,subtree:!0},this.targetSubscriber=[],this.errorSubscriber=[],this.timeLag=x.domObserverMaxTime||3e3,this.reportTimeLag=x.waitSubAppNotifyMaxTime||1e4,this.isRecordFinish=!1,this.cbEntryList=[],this.isStartShowFlag=!0,this.isCallBackFinish=!1,this.isSubAppNotifyFinish=!1,this.finishAction="",this.performanceData={resourceLoadTime:0,blankScreenTime:0,firstScreenTime:0,isFirstRender:!0,entry:"",action:""},this.spaModa=Boolean(x.spaModa),this.spaDomQuerySelector=x.spaDomQuerySelector,this.spaObserver=new Ae({subAppRootSelector:x.subAppRootSelector,spaModa:Boolean(this.spaModa),spaRootSelector:this.spaDomQuerySelector,entry:this.entry,domObserverMaxTime:x.domObserverMaxTime,waitSPANotifyMaxTime:x.waitSPANotifyMaxTime,waitTTINotifyMaxTime:x.waitTTINotifyMaxTime,spaMonitorName:x.spaMonitorName,noFmp:x.noFmp,ignoreList:x.ignoreList})}return ce.prototype.subscribeSpaPerformanceData=function(x){try{this.spaObserver.subscribePerformanceData(x)}catch(P){console.error(P)}},ce.prototype.subscribeSpaErrorInfo=function(x){try{this.spaObserver.subscribeErrorInfo(x)}catch(P){console.error(P)}},ce.prototype.subscribeTTIPerformanceData=function(x){try{this.spaObserver.subscribeTTIPerformanceData(x)}catch(P){console.error(P)}},ce.prototype.subscribeTTIErrorInfo=function(x){try{this.spaObserver.subscribeTTIErrorInfo(x)}catch(P){console.error(P)}},ce.prototype.subscribePerformanceData=function(x){console.warn("subscribe");try{this.targetSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.subscribeErrorInfo=function(x){console.warn("subscribe");try{this.errorSubscriber.push(x)}catch(P){console.error(P)}},ce.prototype.subAppBeforeLoad=function(x,P){console.warn("subAppBeforeLoad"),this.entry=x,this.isRecordFinish=!1,this.isSubAppNotifyFinish=!1,this.subAppBeforeLoadTime=performance.now(),this.isCallBackFinish=!1,this.spaObserver.start(x,P)},ce.prototype.subAppBeforeMount=function(x){console.warn("subAppBeforeMount"),this.subAppBeforeMountTime=performance.now(),this._subAppStartObserver(),this._handleSubscribeCallback(!1)},ce.prototype.subAppUnMount=function(x){console.warn("subAppUnMount"),this.isRecordFinish||this._subAppEndObserver("SubAppUnMount"),this.spaObserver.destroy(),this._handleSubscribeCallback(!0)},ce.prototype.afterRenderNotify=function(){console.warn("afterRenderNotify"),this.isRecordFinish?this.isSubAppNotifyFinish||(this.isSubAppNotifyFinish=!0,this.isRecordFinish=!0,this.finishAction="SubAppRenderNotify",this._subAppPerformanceDataHandle()):(this.isSubAppNotifyFinish=!0,this._subAppEndObserver("SubAppRenderNotify"))},ce.prototype.spaStartObserver=function(){this.spaObserver.spaStartObserver()},ce.prototype._mutationObserverCallback=function(){var x=this;console.warn("mutationObserverCallback"),this.isStartShowFlag&&(this.subAppStartPageShowTime=performance.now(),this.isStartShowFlag=!1),clearTimeout(this.observeTimer),this.observeTimer=setTimeout(function(){clearTimeout(x.observeTimer),x.isRecordFinish||x._subAppEndObserver("MutationObserver")},this.timeLag)},ce.prototype._subAppEndObserver=function(x){console.warn("subAppEndObserver"),this.isRecordFinish=!0,this.finishAction=x,this.subAppPageShowTime=performance.now(),this.observer.disconnect(),this._subAppPerformanceDataHandle(),this.isStartShowFlag=!0},ce.prototype._subAppStartObserver=function(){console.warn("subAppStartObserver");try{console.warn(typeof this.domQuerySelector=="function"?this.domQuerySelector():this.domQuerySelector);var x=document.querySelector(typeof this.domQuerySelector=="function"?this.domQuerySelector():this.domQuerySelector);this.observer.observe(x,this.config),this._subAppClickEventObserver(x)}catch(P){console.error(P)}},ce.prototype._subAppPerformanceDataHandle=function(){console.warn("subAppPerformanceDataHandle");var x=this.finishAction==="MutationObserver"?this.timeLag:0;this.performanceData={resourceLoadTime:this.subAppBeforeMountTime-this.subAppBeforeLoadTime,blankScreenTime:this.subAppStartPageShowTime-this.subAppBeforeLoadTime,firstScreenTime:this.subAppPageShowTime-this.subAppBeforeLoadTime-x,isFirstRender:this.cbEntryList.indexOf(this.entry)===-1,entry:this.entry,action:this.finishAction}},ce.prototype._subAppClickEventObserver=function(x){var P=this;console.warn("subAppClickEventObserver");var $=function(he){clearTimeout(P.observeTimer),P.isRecordFinish||P._subAppEndObserver("UserEvent")};x.addEventListener("click",$),x.addEventListener("keyup",$),x.addEventListener("keydown",$),x.addEventListener("keypress",$)},ce.prototype._handleCallback=function(){var x=this;console.warn("handleCallback");try{this.isCallBackFinish=!0,this.targetSubscriber.forEach(function(P){var $=x.performanceData,he=$.firstScreenTime,ye=$.blankScreenTime,Re=$.resourceLoadTime,He=$.action,we=$.entry;he>0&&ye>0&&Re>0&&He&&we?(console.warn("SUCCESS -> \u5B50\u5E94\u7528\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData),x.cbEntryList.push(x.entry),P(x.performanceData)):(x.errorSubscriber.forEach(function(fe){return fe(x)}),console.warn("ERROR -> \u5B50\u5E94\u7528\u6027\u80FD\u6570\u636E\u8F93\u51FA\uFF1A",x.performanceData))})}catch(P){console.error(P)}},ce.prototype._handleSubscribeCallback=function(x){var P=this;console.warn("handleSubscribeCallback");try{clearTimeout(this.dataTimer),x?this.isCallBackFinish||this._handleCallback():this.dataTimer=setTimeout(function(){clearTimeout(P.dataTimer),P.isRecordFinish||P._subAppEndObserver("TimeOut"),P._handleCallback()},this.reportTimeLag)}catch($){console.error($)}},ce}();const Te=ge},78446:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>Collector$1});var __assign=function(){return(__assign=Object.assign||function(l){for(var n,o=1,c=arguments.length;o<c;o++)for(var h in n=arguments[o])Object.prototype.hasOwnProperty.call(n,h)&&(l[h]=n[h]);return l}).apply(this,arguments)};function __rest(l,n){var o={};for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&n.indexOf(c)<0&&(o[c]=l[c]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function"){var h=0;for(c=Object.getOwnPropertySymbols(l);h<c.length;h++)n.indexOf(c[h])<0&&(o[c[h]]=l[c[h]])}return o}function __values(l){var n=typeof Symbol=="function"&&l[Symbol.iterator],o=0;return n?n.call(l):{next:function(){return l&&o>=l.length&&(l=void 0),{value:l&&l[o++],done:!l}}}}function __read(l,n){var o=typeof Symbol=="function"&&l[Symbol.iterator];if(!o)return l;var c,h,g=o.call(l),b=[];try{for(;(n===void 0||n-- >0)&&!(c=g.next()).done;)b.push(c.value)}catch(y){h={error:y}}finally{try{c&&!c.done&&(o=g.return)&&o.call(g)}finally{if(h)throw h.error}}return b}function __spread(){for(var l=[],n=0;n<arguments.length;n++)l=l.concat(__read(arguments[n]));return l}var commonjsGlobal=typeof window!="undefined"?window:typeof __webpack_require__.g!="undefined"?__webpack_require__.g:typeof self!="undefined"?self:{};function createCommonjsModule(l,n){return l(n={exports:{}},n.exports),n.exports}var js_cookie=createCommonjsModule(function(l,n){var o;o=function(){function c(){for(var g=0,b={};g<arguments.length;g++){var y=arguments[g];for(var O in y)b[O]=y[O]}return b}function h(g){return g.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function g(b){function y(){}function O(G,le,Pe){if(typeof document!="undefined"){typeof(Pe=c({path:"/"},y.defaults,Pe)).expires=="number"&&(Pe.expires=new Date(1*new Date+864e5*Pe.expires)),Pe.expires=Pe.expires?Pe.expires.toUTCString():"";try{var Ce=JSON.stringify(le);/^[\{\[]/.test(Ce)&&(le=Ce)}catch(ge){}le=b.write?b.write(le,G):encodeURIComponent(String(le)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),G=encodeURIComponent(String(G)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var De="";for(var Ae in Pe)Pe[Ae]&&(De+="; "+Ae,Pe[Ae]!==!0&&(De+="="+Pe[Ae].split(";")[0]));return document.cookie=G+"="+le+De}}function M(G,le){if(typeof document!="undefined"){for(var Pe={},Ce=document.cookie?document.cookie.split("; "):[],De=0;De<Ce.length;De++){var Ae=Ce[De].split("="),ge=Ae.slice(1).join("=");le||ge.charAt(0)!=='"'||(ge=ge.slice(1,-1));try{var Te=h(Ae[0]);if(ge=(b.read||b)(ge,Te)||h(ge),le)try{ge=JSON.parse(ge)}catch(ce){}if(Pe[Te]=ge,G===Te)break}catch(ce){}}return G?Pe[G]:Pe}}return y.set=O,y.get=function(G){return M(G,!1)},y.getJSON=function(G){return M(G,!0)},y.remove=function(G,le){O(G,"",c(le,{expires:-1}))},y.defaults={},y.withConverter=g,y}(function(){})},l.exports=o()}),Memory=function(){function l(){this.cache={}}return l.prototype.setItem=function(n,o){this.cache[n]=o},l.prototype.getItem=function(n){return this.cache[n]},l.prototype.removeItem=function(n){this.cache[n]=void 0},l}();function isSupportLS(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(l){return!1}}function isSupportSession(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(l){return!1}}var local={getItem:function(l){try{var n=localStorage.getItem(l),o=n;try{n&&typeof n=="string"&&(o=JSON.parse(n))}catch(c){}return o||void 0}catch(c){}},setItem:function(l,n){try{var o=typeof n=="string"?n:JSON.stringify(n);localStorage.setItem(l,o)}catch(c){}},removeItem:function(l){try{localStorage.removeItem(l)}catch(n){}},getCookie:function(l,n){try{return js_cookie.get(l,{domain:n||document.domain})}catch(o){return""}},setCookie:function(l,n,o,c){try{var h=c||document.domain,g=+new Date+o;js_cookie.set(l,n,{expires:new Date(g),path:"/",domain:h})}catch(b){}},isSupportLS:isSupportLS()},session={getItem:function(l){try{var n=sessionStorage.getItem(l),o=n;try{n&&typeof n=="string"&&(o=JSON.parse(n))}catch(c){}return o||void 0}catch(c){}},setItem:function(l,n){try{var o=typeof n=="string"?n:JSON.stringify(n);sessionStorage.setItem(l,o)}catch(c){}},removeItem:function(l){try{sessionStorage.removeItem(l)}catch(n){}},isSupportSession:isSupportSession()},Storage=function(){function l(n,o){this._storage=o&&o==="session"?session:!n&&local.isSupportLS?local:new Memory}return l.prototype.getItem=function(n){return this._storage.getItem(n)},l.prototype.setItem=function(n,o){this._storage.setItem(n,o)},l.prototype.getCookie=function(n,o){return this._storage.getCookie(n,o)},l.prototype.setCookie=function(n,o,c,h){this._storage.setCookie(n,o,c,h)},l.prototype.removeItem=function(n){this._storage.removeItem(n)},l}(),LOG_URL={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},WEBID_URL="/webid",TOB_URL="/tobid",REPORT_URL="/list",GIF_URL="/gif",SDK_VERSION="4.2.9",ERROR={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},CACHEKEY=function(l,n){return n?"__tea_cache_tokens_"+l:"__tea_cache_events_"+l},CONFIGKEY=function(l){return"__tea_cache_config_"+l},COOKIEKEY=function(l){return"__tea_cookie_tokens_"+l},SESSIONKEY=function(l){return"__tea_session_id_"+l},CEPKEY=function(l){return"__tea_cep_plan_"+l},getNameSpace=function(){if(typeof window!="undefined")return window.TeaAnalyticsObject},DOMAINS={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},COOKIE_EXPIRE=6048e5,API="/service/2/abtest_config/",STYLE_ID="__rangers_ab_style__",STORAGE_DATA_KEY="__tea_sdk_ab_version",STORAGE_DATA_EXPRIRE=2592e6,ET_TEST_URL="v1/list_test",EDITOR_URL_NEW_ASC="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21",EDITOR_URL_OLD_ASC="1fz22z22z1nz21z4mz4bz4bz21z4fz4az1nz21z22z18z22z1nz4az1az1mz1kz4bz1nz1ez1az4bz22z1cz1az1fz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z4az1hz21",VISUAL_URL_ASC="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21",VISUAL_URL_RANGER="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21",HOT_PIC_URL="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c",VISUAL_URL_INSPECTOR="1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz22z1cz21z22z1cz20z4bz21z1bz1iz4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20z4az4ez4az4ez4az4cz4az1hz21";function xhr(l,n,o,c,h,g,b,y){try{var O=new XMLHttpRequest,M=y||"POST";O.open(M,""+l,!0),O.setRequestHeader("Content-Type","application/json; charset=utf-8"),h&&O.setRequestHeader("X-MCS-AppKey",""+h),b&&(O.withCredentials=!0),O.onload=function(){if(o){var G=null;if(O.responseText){try{G=JSON.parse(O.responseText)}catch(le){G={}}o(G,n)}}};try{g&&(O.timeout=g),g&&(O.ontimeout=function(){c&&c(n,ERROR.TIMEOUT)}),O.onerror=function(){O.abort(),c&&c(n,ERROR.XHR_ON)},O.send(JSON.stringify(n))}catch(G){}}catch(G){}}var isSupportBeacon=function(){return!(!window.navigator||!window.navigator.sendBeacon)},NOOP=function(){},encodePayload=function(l){var n="";for(var o in l)l.hasOwnProperty(o)&&l[o]!==void 0&&(n+="&"+o+"="+encodeURIComponent(JSON.stringify(l[o])));return n=n[0]==="&"?n.slice(1):n},sendByImg=function(l,n,o,c){try{var h=l.match(/\/v\d\//),g="";g=h?h[0]:l.indexOf("/v1/")!==-1?"/v1/":"/v2/";var b=l.split(g)[0];if(!b)return void c(l,n,ERROR.NO_URL);n.forEach(function(y){var O=encodePayload(y),M=new Image(1,1);M.onload=function(){M=null,o&&o()},M.onerror=function(){M=null,c&&c(l,n,ERROR.IMG_ON)},M.src=""+b+GIF_URL+"?"+O})}catch(y){c&&c(l,n,ERROR.IMG_CATCH,y.message)}},request=function(l,n,o,c,h,g,b,y,O,M){var G=window.navigator.userAgent,le=window.navigator.appName.indexOf("Microsoft Internet Explorer")!==-1&&(G.indexOf("MSIE 8.0")!==-1||G.indexOf("MSIE 9.0")!==-1),Pe=!!c;if(!Pe&&le)sendByImg(l,o,h,g);else if(!Pe&&y)return isSupportBeacon()?(M?M():NOOP(),void(window.navigator.sendBeacon(l,JSON.stringify(o))?h():g(l,o,ERROR.BEACON_FALSE))):void sendByImg(l,o,h,g);b&&delete o.app_key,xhr(l,o,h,g,c,n,O)};function b(l){return l?(l^16*Math.random()>>l/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,b)}var webid=function(){return b().replace(/-/g,"").slice(0,19)};function decrypto(l,n,o){if(typeof l=="string"&&typeof n=="number"&&typeof o=="number"){var c,h=[];o=o<=25?o:o%25;var g=String.fromCharCode(o+97);c=l.split(g);for(var b=0;b<c.length;b++){var y=parseInt(c[b],o);y=1*y^n;var O=String.fromCharCode(y);h.push(O)}return h.join("")}}var decodeUrl=function(l){return decrypto(l,64,25)},UTM=function(l,n,o,c){var h=new Storage(!1),g=new Storage(!1,"session"),b=l?"_tea_utm_cache_"+l:"_tea_utm_cache",y=l?"_$utm_from_url_"+l:"_$utm_from_url",O={},M=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],G={creative_id:Number(n.creative_id),ad_id:Number(n.ad_id),campaign_id:Number(n.campaign_id),utm_source:n.utm_source,utm_medium:n.utm_medium,utm_campaign:n.utm_campaign,utm_term:n.utm_term,utm_content:n.utm_content,tr_shareuser:n.tr_shareuser,tr_admaster:n.tr_admaster,tr_param1:n.tr_param1,tr_param2:n.tr_param2,tr_param3:n.tr_param3,tr_param4:n.tr_param4},le=c;try{var Pe=!1;for(var Ce in G)G[Ce]&&(M.indexOf(Ce)!==-1?(O.hasOwnProperty("tracer_data")||(O.tracer_data={}),O.tracer_data[Ce]=G[Ce]):O[Ce]=G[Ce],Pe=!0);if(Pe)g.setItem(y,"1"),h.setCookie(b,JSON.stringify(O),le,o);else{var De=h.getCookie(b,o);De&&(O=JSON.parse(De)),h.setCookie(b,De,le,o)}g.getItem(y)&&(O.hasOwnProperty("tracer_data")||(O.tracer_data={}),O.tracer_data.$utm_from_url=1)}catch(Ae){return G}return O},parseURL=function(l){var n=document.createElement("a");return n.href=l,n},parseUrlQuery=function(l){var n=parseURL(l).search;n=n.slice(1);var o={};return n.split("&").forEach(function(c){var h,g,b=c.split("=");b.length&&(h=b[0],g=b[1]);try{o[h]=decodeURIComponent(g===void 0?"":g)}catch(y){o[h]=g}}),o},client=function(l,n,o){var c,h,g=window.screen.width,b=window.screen.height,y=window.navigator.appVersion,O=window.navigator.userAgent,M=window.navigator.language,G=document.referrer,le=G?parseURL(G).hostname:"",Pe=parseUrlQuery(window.location.href),Ce="",De="",Ae="",ge=""+parseFloat(y);(c=O.indexOf("Opera"))!==-1&&(Ae="Opera",ge=O.substring(c+6),(c=O.indexOf("Version"))!==-1&&(ge=O.substring(c+8))),O.indexOf("Edge")!==-1||O.indexOf("Edg")!==-1?(Ae="Microsoft Edge",O.indexOf("Edge")!==-1?(c=O.indexOf("Edge"),ge=O.substring(c+5)):(c=O.indexOf("Edg"),ge=O.substring(c+4))):(c=O.indexOf("MSIE"))!==-1?(Ae="Microsoft Internet Explorer",ge=O.substring(c+5)):(c=O.indexOf("Lark"))!==-1?(Ae="Lark",ge=O.substring(c+5,c+11)):O.indexOf("Chrome")!==-1?(c=O.indexOf("MicroMessenger"))!==-1?(Ae="weixin",ge=O.substring(c+15,c+20)):(c=O.indexOf("MQQBrowser"))!==-1?(Ae="qqbrowser",ge=O.substring(c+11,c+15)):(c=O.indexOf("360"))!==-1?(Ae="360browser",ge=O.substring(O.indexOf("Chrome")+7)):O.indexOf("baidubrowser")!==-1||O.indexOf("BIDUBrowser")!==-1?(O.indexOf("baidubrowser")!==-1?(c=O.indexOf("baidubrowser"),ge=O.substring(c+13,c+16)):O.indexOf("BIDUBrowser")!==-1&&(c=O.indexOf("BIDUBrowser"),ge=O.substring(c+12,c+15)),Ae="baidubrowser"):(c=O.indexOf("xiaomi"))!==-1?O.indexOf("openlanguagexiaomi")!==-1?(Ae="openlanguage xiaomi",ge=O.substring(c+7,c+13)):(Ae="xiaomi",ge=O.substring(c-7,c-1)):(c=O.indexOf("TTWebView"))!==-1?(Ae="TTWebView",ge=O.substring(c+10,c+23)):(c=O.indexOf("Chrome"))!==-1&&(Ae="Chrome",ge=O.substring(c+7)):O.indexOf("Safari")!==-1?(c=O.indexOf("QQ"))!==-1?(Ae="qqbrowser",ge=O.substring(c+10,c+16)):(c=O.indexOf("Safari"))!==-1&&(Ae="Safari",ge=O.substring(c+7),(c=O.indexOf("Version"))!==-1&&(ge=O.substring(c+8))):(c=O.indexOf("Firefox"))!==-1?(Ae="Firefox",ge=O.substring(c+8)):(c=O.indexOf("MicroMessenger"))!==-1?(Ae="weixin",ge=O.substring(c+15,c+20)):(c=O.indexOf("QQ"))!==-1&&(Ae="qqbrowser",ge=O.substring(c+3,c+8)),(h=ge.indexOf(";"))!==-1&&(ge=ge.substring(0,h)),(h=ge.indexOf(" "))!==-1&&(ge=ge.substring(0,h)),(h=ge.indexOf(")"))!==-1&&(ge=ge.substring(0,h));for(var Te,ce,x=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(y)?"wap":"web",P=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],$=0;$<P.length;$++){var he=P[$];if(he.r.test(O)){Ce=he.s;break}}function ye(He,we){var fe=He.exec(we);return fe&&fe[1]?fe[1]:""}switch(/Windows/.test(Ce)&&(De=ye(/Windows (.*)/,Ce),Ce="windows"),Ce){case"Mac OS X":Te=O,De=(ce=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?)","i").exec(Te))?ce.slice(1)[0]:"",Ce="mac";break;case"Android":De=function(He){var we=ye(/Android ([\.\_\d]+)/,He);return we||(we=ye(/Android\/([\.\_\d]+)/,He)),we}(O),Ce="android";break;case"iOS":De=(De=/OS (\d+)_(\d+)_?(\d+)?/.exec(y))?De[1]+"."+De[2]+"."+(0|De[3]):"",Ce="ios"}var Re=UTM(l,Pe,n,o);return{browser:Ae,browser_version:ge,platform:x,os_name:Ce,os_version:De,userAgent:O,screen_width:g,screen_height:b,device_model:function(He){var we="";try{if(He==="android")navigator.userAgent.split(";").forEach(function(I){I.indexOf("Build/")>-1&&(we=I.slice(0,I.indexOf("Build/")))});else if(He==="ios"||He==="mac"||He==="windows"){var fe=navigator.userAgent.replace("Mozilla/5.0 (",""),K=fe.indexOf(";");we=fe.slice(0,K)}}catch(I){}return we.trim()}(Ce),language:M,referrer:G,referrer_host:le,creative_id:Re.creative_id,ad_id:Re.ad_id,campaign_id:Re.campaign_id,utm_source:Re.utm_source,utm_medium:Re.utm_medium,utm_campaign:Re.utm_campaign,utm_term:Re.utm_term,utm_content:Re.utm_content,tracer_data:Re.tracer_data}},Token=function(){function l(n,o,c,h){this.enableCustomWebid=!1,this.config=n,this.cfg=o,this.storage=new Storage(!1),this.appInfo=n.app_key||n.app_id,this.isNoWebid=n.disable_webid,this.enable_ttwebid=n.enable_ttwebid||!1,this.domain=n.channel_domain||decodeUrl(LOG_URL[n.channel]),this.tokenReady=!1,this.enableCustomWebid=n.enable_custom_webid,this.checkExp=n.checkExp||!1,this.enableCookie=n.cross_subdomain||!1,this.expiresTime=n.cookie_expire||COOKIE_EXPIRE,this.fetchUrl=""+this.domain+WEBID_URL,this.hook=c,this.session=h,this.cookieDomain=n.cookie_domain||""}return l.prototype._getToken=function(){var n=this;try{if(this.tokensKey=CACHEKEY(this.appInfo,!0),this.cookieKey=COOKIEKEY(this.appInfo),this.enableCustomWebid)return void this.hook.on("custom-webid",function(){n.tokenReady=!0,n.hook.emit("token-ready")});if(this._checkEnv())return;var o=this.storage.getItem(this.tokensKey);if(this.enable_ttwebid)if(o){var c={user_unique_id:o.user_unique_id||"",timestamp:Date.now()};this.storage.setItem(this.tokensKey,c),this._setTtWid(o,!1)}else this._setTtWid(o,!0);else if(this.enableCookie){var h=this.storage.getCookie(this.cookieKey,this.cookieDomain);if(h){var g=(h=JSON.parse(decodeURIComponent(h))).user_unique_id,b=h.web_id,y=h.timestamp;this._setToken(b,g,y)}else{if(!o)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(o)),this.expiresTime,this.cookieDomain),this._checkLocal(o)}}else{if(!o)return void this._requestWebId();this._checkLocal(o)}}catch(O){console.log(""+O.message)}},l.prototype._checkEnv=function(){if(window.navigator.userAgent.indexOf("miniProgram")!==-1){var n=parseUrlQuery(window.location.href);return!(!n||!n.Web_ID)&&(this._setTokenId(""+n.Web_ID),!0)}return!1},l.prototype._checkLocal=function(n){var o=n.user_unique_id,c=n.web_id,h=n.timestamp;c&&o?this._setToken(c,o,h):this._requestWebId()},l.prototype._setToken=function(n,o,c){if(this.checkExp){var h=Date.now()-parseFloat(c);if(h>7344e6)return void this._requestWebId();if(h>432e7)return void this._updateWebId(n)}this.cfg.envInfo.user.user_unique_id=o,this.cfg.envInfo.user.web_id=n,this.storage.setItem(this.tokensKey,{user_unique_id:o,web_id:n,timestamp:Date.now()}),this.tokenReady=!0},l.prototype._requestWebId=function(){this.isNoWebid?this._setTokenId(webid()):this._fetchWebId(this.fetchUrl,!1)},l.prototype._updateWebId=function(n){var o=""+this.domain+WEBID_URL+"/"+n+"/update";this._fetchWebId(o,!0)},l.prototype._fetchWebId=function(n,o){var c=this;request(n,3e3,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""},this.config.app_key,function(h){h&&h.e===0?c._setTokenId(h.web_id):(c.hook.emit("token-error"),console.warn("[]appid: "+c.config.app_id+", "+(o?" update":"get")+" webid error, init error~"))},function(){c.hook.emit("token-error"),console.warn("[]appid: "+c.config.app_id+", get webid error, init error~")},!0,!1,this.enable_ttwebid)},l.prototype._setTtWid=function(n,o){if(!o){var c={web_id:n.web_id||"",timestamp:Date.now()},h=n.user_unique_id||"";this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||h,this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(c)),108e5,this.cookieDomain)}this.tokenReady=!0,this.hook.emit("token-ready")},l.prototype._setTokenId=function(n){var o=this.cfg.envInfo.user.web_id||n,c={web_id:o,user_unique_id:this.cfg.envInfo.user.user_unique_id||o,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(c)),this.expiresTime,this.cookieDomain),this.storage.setItem(this.tokensKey,c),this.cfg.envInfo.user.web_id=this.cfg.envInfo.user.web_id||o,this.cfg.envInfo.user.user_unique_id=this.cfg.envInfo.user.user_unique_id||o,this.tokenReady=!0,this.hook.emit("token-ready")},l.prototype._setUuid=function(n){try{var o=this.storage.getItem(this.tokensKey);if(n){typeof n!="string"&&console.warn("user_unique_id must be string!!! please check");var c=String(n);if(c===this.cfg.envInfo.user.user_unique_id)return;this.cfg.envInfo.user.user_unique_id=c,o&&o.user_unique_id?o.user_unique_id!==c&&(o.user_unique_id=c):(o={}).user_unique_id=c,o.timestamp=Date.now(),this.storage.setItem(this.tokensKey,o),this.session._resetSessionId(),this.hook.emit("token-change","uuid")}else this._clearUuid(o)}catch(h){}},l.prototype._clearUuid=function(n){this.enable_ttwebid||n&&n.web_id&&(this.cfg.envInfo.user.user_unique_id=n.web_id||void 0,n.user_unique_id=n.web_id||void 0,n.timestamp=Date.now(),this.storage.setItem(this.tokensKey,n))},l.prototype._setWebid=function(n){if(!this.enable_ttwebid){var o=this.storage.getItem(this.tokensKey);o&&o.web_id?o.web_id!==n&&(o.user_unique_id=o.web_id===o.user_unique_id?n:o.user_unique_id,o.web_id=n):((o={}).web_id=n,o.user_unique_id=n),o.timestamp=Date.now(),this.storage.setItem(this.tokensKey,o),this.cfg.envInfo.user.user_unique_id&&this.cfg.envInfo.user.user_unique_id!==this.cfg.envInfo.user.web_id||(this.cfg.envInfo.user.user_unique_id=n,this.hook.emit("token-change","uuid")),n!==this.cfg.envInfo.user.web_id&&(this.cfg.envInfo.user.web_id=n,this.hook.emit("token-change","webid"))}},l.prototype.isTokenReady=function(){return this.tokenReady},l.prototype._getTobId=function(n){var o=""+this.domain+TOB_URL;request(o,3e4,{app_id:this.config.app_id,user_unique_id:this.cfg.envInfo.user.user_unique_id,web_id:this.cfg.envInfo.user.web_id},this.config.app_key,function(c){c&&c.e===0?n(c.tobid):n(null)},function(){n(null)},!0,!1,this.enable_ttwebid)},l}(),beforePageUnload=function(l){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",l,!1):window.addEventListener("beforeunload",l,!1)},splitArrayByFilter=function(l,n,o){l===void 0&&(l=[]),n===void 0&&(n=function(b){return b}),o===void 0&&(o=20);var c,h=[],g=0;return l.forEach(function(b){var y=n(b);c===void 0?c=y:(y!==c||h[g].length>=o)&&(g+=1,c=y),h[g]=h[g]||[],h[g].push(b)}),h},EventManager=function(){function l(n,o,c,h,g,b,y){this.collect=n,this.cfg=c,this.config=o,this._token=h,this.appInfo=o.app_id||o.app_key,this.debugMode=!!o.log,this.evtDataKey=CACHEKEY(this.appInfo,!1);var O=o.channel_domain||decodeUrl(LOG_URL[o.channel]);if(this.reportUrl=o.report_url?o.report_url:""+O+REPORT_URL,this.storage=new Storage(!0),this.EventStorage=new Storage(!1),this.maxStorage=o.max_storage_num||-1,this.maxReport=o.max_report||10,this.reportTime=o.reportTime||30,this.timeout=o.timeout||1e5,this.closeStorage=!0,this.plugin=g,this.session=b,this.match=y,this.filter=o.filter,this.plugin){var M=o.enable_storage,G=o.disable_storage;(M||G===!1)&&(this.closeStorage=!1)}this.addListener()}return l.prototype.addListener=function(){var n=this;window.addEventListener("unload",function(){n.report(!0)},!1),beforePageUnload(function(){n.report(!0)}),document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&n.report(!0)},!1)},l.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},l.prototype.event=function(n){var o=this;n===void 0&&(n=[]);try{var c=__spread(n,this.storage.getItem(this.evtDataKey)||[]);this.storage.setItem(this.evtDataKey,c),this.reportTimer&&clearTimeout(this.reportTimer),c.length>=this.maxReport?this.report(!1):this.reportTimer=setTimeout(function(){o.report(!1),o.reportTimer=null},this.reportTime)}catch(h){}},l.prototype.beconEvent=function(n){n===void 0&&(n=[]);var o=this._mergeEvents(n);this._dealData(o,!0)},l.prototype.report=function(n){if(n===void 0&&(n=!1),!this.collect.destroyInstance&&this._token.isTokenReady()&&this.isReady){var o=this.storage.getItem(this.evtDataKey)||[],c=this._mergeEvents(o);this.storage.removeItem(this.evtDataKey),this._dealData(c,n)}},l.prototype.clearEventCache=function(){this.report(!1)},l.prototype._mergeEvents=function(n){var o=this;if(!n.length)return n;var c=this.cfg.get();return c.header.custom=JSON.stringify(c.header.custom),splitArrayByFilter(n,function(h){return!o.closeStorage&&!!h.params.__disable_storage__},this.maxReport).map(function(h){return __assign({events:h.map(function(g){var b=__assign({},o.cfg.get("evtParams"),g.params);try{if(g.event&&g.event!=="applog_trace"){delete b.__disable_storage__;var y=!0,O=o.EventStorage.getItem("__tea_sdk_ab_version_"+o.appInfo);if(O&&O.uuid&&c.user.user_unique_id!==O.uuid&&(y=!1),y&&o.plugin&&o.plugin.ab&&o.plugin.ab.versions&&o.plugin.ab.extVersions){var M=[];return M=o.config.enable_multilink||window.location.href.indexOf("multilink=true")!==-1?o.plugin.ab.mulilinkVersions.concat(o.plugin.ab.extVersions):o.plugin.ab.versions.concat(o.plugin.ab.extVersions),__assign({},g,{params:JSON.stringify(b),ab_sdk_version:M.join(","),session_id:o.session._getSessionId()})}return __assign({},g,{params:JSON.stringify(b),session_id:o.session._getSessionId()})}return __assign({},g,{params:JSON.stringify(g.params)})}catch(G){return __assign({},g,{params:JSON.stringify(g.params)})}}),user:c.user,header:c.header},o.closeStorage?{}:{__disable_storage__:h[0].params.__disable_storage__},{verbose:o.debugMode?1:void 0,local_time:parseInt(""+new Date().getTime()/1e3),user_unique_type:o.config.enable_ttwebid?o.config.user_unique_type:void 0})})},l.prototype._dealData=function(n,o){var c=this;if(!this.config.disable_track_event){if(!n.length)return n;var h=[];h=splitArrayByFilter(n,function(b){return!!b.__disable_storage__},this.maxReport),!this.closeStorage&&this.plugin.maxStorage&&this.plugin.maxStorage(h,this.maxStorage,this.evtDataKey,this.storage);var g={};h.forEach(function(b){var y=webid(),O=JSON.parse(JSON.stringify(b));try{c.filter&&(O=c.filter(O)),c.collect.eventFilter&&(O=c.collect.eventFilter(O))}catch(le){}var M=O||b;if(!c.closeStorage&&!M[0].__disable_storage__){var G=JSON.parse(JSON.stringify(b));G&&G[0]&&(G[0].header.__storage_index__=Date.now()),g[y]=G,c.EventStorage.setItem(c.evtDataKey,g)}c._send(y,M,o),c.match&&setTimeout(function(){c.match.matchEvent(M)},0)})}},l.prototype._send=function(n,o,c){var h=this;this.isSending=!0;var g=function(){h.isSending=!1};if(!this.closeStorage)try{o&&o[0]&&o[0].header.__storage_index__&&delete(o=JSON.parse(JSON.stringify(o)))[0].header.__storage_index__}catch(b){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(o),request(this.reportUrl,this.timeout,o,this.config.app_key,function(b,y){if(g(),h.plugin&&!h.closeStorage){var O=h.EventStorage.getItem(h.evtDataKey)||{};Object.keys(O).length?(delete O[n],h.EventStorage.setItem(h.evtDataKey,O)):h.EventStorage.removeItem(h.evtDataKey)}b&&b.e!==0&&h.collect&&h.collect.tracer&&h.cfg.staging!==1&&h.collect.tracer.addErrorCount(y,"f_data",b.e,b)},function(b,y){g(),h.cfg.get("reportErrorCallback")(b,y),h.collect&&h.collect.tracer&&h.cfg.staging!==1&&h.collect.tracer.addErrorCount(b,"f_net",y),h.plugin&&h.plugin.monitor&&h.plugin.monitor.sdkError(h.config.app_key,h.reportUrl,b,y)},!1,c,this.config.enable_ttwebid,g),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,o)},l.prototype.checkStorageEvent=function(){var n=this;try{var o=this.EventStorage.getItem(this.evtDataKey)||{},c=Object.keys(o);c.length>0&&setTimeout(function h(){for(var g=[],b=0;b<n.maxReport;b++)c.length>0&&g.push(c.shift());g.length>0&&g.forEach(function(y){n._send(y,o[y],!1)}),setTimeout(h,5)},5)}catch(h){}},l}(),undef=void 0,date=new Date,timeZoneMin=date.getTimezoneOffset(),timezone=parseInt(""+-timeZoneMin/60,10),tz_offset=60*timeZoneMin,ConfigManager=function(){function l(n,o,c){this.initConfig=o;var h=client(n,o.cookie_domain||"",o.cookie_expire||COOKIE_EXPIRE);this.configKey=CONFIGKEY(""+n),this.sessionStorage=new Storage(!1,"session"),this.localStorage=new Storage(!1,"local"),c&&(this.storage=c===1?this.sessionStorage:this.localStorage),this.envInfo={user:{user_unique_id:undef,user_type:undef,user_id:undef,user_is_auth:undef,user_is_login:undef,device_id:undef,web_id:undef,ip_addr_id:undef,ssid:undef},header:{app_id:undef,app_name:undef,app_install_id:undef,install_id:undef,app_package:undef,app_channel:undef,app_version:undef,os_name:h.os_name,os_version:h.os_version,device_model:h.device_model,ab_client:undef,ab_version:undef,ab_sdk_version:undef,traffic_type:undef,client_ip:undef,device_brand:undef,os_api:undef,access:undef,language:h.language,region:undef,app_language:undef,app_region:undef,creative_id:h.creative_id,ad_id:h.ad_id,campaign_id:h.campaign_id,log_type:undef,rnd:undef,platform:h.platform,sdk_version:SDK_VERSION,sdk_lib:"js",province:undef,city:undef,timezone,tz_offset,tz_name:undef,sim_region:undef,carrier:undef,resolution:h.screen_width+"x"+h.screen_height,browser:h.browser,browser_version:h.browser_version,referrer:h.referrer,referrer_host:h.referrer_host,width:h.screen_width,height:h.screen_height,screen_width:h.screen_width,screen_height:h.screen_height,utm_term:h.utm_term,utm_content:h.utm_content,utm_source:h.utm_source,utm_medium:h.utm_medium,utm_campaign:h.utm_campaign,tracer_data:JSON.stringify(h.tracer_data),custom:{},wechat_openid:undef,wechat_unionid:undef}},this.evtParams={},this.reportErrorCallback=function(){}}return l.prototype.set=function(n,o){var c=this;if(o==null&&(this.delete(n),o=void 0),n==="evtParams"||n==="_staging_flag"){var h;h=n==="evtParams"?o:{_staging_flag:Number(o)};var g=__assign({},h);Object.keys(g).forEach(function(O){c.evtParams[O]=g[O]})}else if(n==="reportErrorCallback"&&typeof o=="function")this.reportErrorCallback=o;else{var b="";if(n.indexOf(".")>-1){var y=n.split(".");b=y[0],n=y[1]}if(n==="user_unique_id"&&(!o||["0","Null","None","","undefined"].indexOf(o)!==-1))return;n==="os_version"&&(n=""+o),b?b==="user"||b==="header"?this.envInfo[b][n]=o:this.envInfo.header.custom[n]=o:this.envInfo.user.hasOwnProperty(n)?["user_type","ip_addr_id"].indexOf(n)>-1?this.envInfo.user[n]=o&&Number(o):["user_id","web_id","user_unique_id","ssid"].indexOf(n)>-1?this.envInfo.user[n]=o&&String(o):["user_is_auth","user_is_login"].indexOf(n)>-1?this.envInfo.user[n]=Boolean(o):n==="device_id"&&(this.envInfo.user[n]=o):this.envInfo.header.hasOwnProperty(n)?this.envInfo.header[n]=o:this.envInfo.header.custom[n]=o}},l.prototype.get=function(n){try{return n?n==="evtParams"?this.evtParams:n==="reportErrorCallback"?this[n]:JSON.parse(JSON.stringify(this.envInfo[n])):JSON.parse(JSON.stringify(this.envInfo))}catch(o){console.log("get config stringify error ")}},l.prototype.setStore=function(n){try{var o=this.storage.getItem(this.configKey);if(Object.keys(n).length){var c=Object.assign(n,o);this.storage.setItem(this.configKey,c)}}catch(h){}},l.prototype.getStore=function(){try{var n=this.storage.getItem(this.configKey);return Object.keys(n).length?n:null}catch(o){return null}},l.prototype.delete=function(n){try{var o=this.storage.getItem(this.configKey);o&&o.hasOwnProperty(n)&&(delete o[n],this.storage.setItem(this.configKey,o))}catch(c){}},l}(),Logger=function(){function l(o,c){this.isLog=c||!1,this.name=o||""}var n=l.prototype;return n.info=function(o){this.isLog&&console.log("["+this.name+"] "+o)},n.warn=function(o){this.isLog&&console.warn("["+this.name+"] "+o)},n.error=function(o){this.isLog&&console.error("["+this.name+"] "+o)},n.throw=function(o){throw this.error(this.name),new Error(o)},l}(),Hook=function(){function l(){this._hooks={}}return l.prototype.on=function(n,o){n&&o&&typeof o=="function"&&(this._hooks[n]||(this._hooks[n]=[]),this._hooks[n].push(o))},l.prototype.once=function(n,o){var c=this;n&&o&&typeof o=="function"&&this.on(n,function h(g){o(g),c.off(n,h)})},l.prototype.off=function(n,o){if(n&&this._hooks[n]&&this._hooks[n].length)if(o){var c=this._hooks[n].indexOf(o);c!==-1&&this._hooks[n].splice(c,1)}else this._hooks[n]=[]},l.prototype.emit=function(n,o){n&&this._hooks[n]&&this._hooks[n].length&&__spread(this._hooks[n]).forEach(function(c){try{c(o)}catch(h){}})},l}(),sessionId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(l){var n=16*Math.random()|0;return(l==="x"?n:3&n|8).toString(16)})},Session=function(){function l(n,o){this.storage=new Storage(!1,"session"),this.sessionKey=SESSIONKEY(n),this.expireTime=o.expireTime||18e5,this.disableSession=o.disable_session,this.disableSession||this._setSessionId()}return l.prototype._updateSessionId=function(){var n=this.storage.getItem(this.sessionKey);if(n&&n.sessionId){var o=n.timestamp;Date.now()-o>this.expireTime?n={sessionId:sessionId(),timestamp:Date.now()}:n.timestamp=Date.now(),this.storage.setItem(this.sessionKey,n),this._resetExpTime()}},l.prototype._setSessionId=function(){var n=this,o=this.storage.getItem(this.sessionKey);o&&o.sessionId?o.timestamp=Date.now():o={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,o),this.sessionExp=setInterval(function(){n._checkEXp()},this.expireTime)},l.prototype._getSessionId=function(){var n=this.storage.getItem(this.sessionKey);return this.disableSession?"":n&&n.sessionId?n.sessionId:""},l.prototype._resetExpTime=function(){var n=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){n._checkEXp()},this.expireTime))},l.prototype._resetSessionId=function(){var n={sessionId:sessionId(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,n)},l.prototype._checkEXp=function(){var n=this.storage.getItem(this.sessionKey);n&&n.sessionId&&Date.now()-n.timestamp+30>=this.expireTime&&(n={sessionId:sessionId(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,n))},l}(),EventList={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},Tracer=function(){function l(n,o,c,h){this.count={pv:0,sdk:0,autotrack:0,log:0},this.limit={pv:1,sdk:10,autotrack:10,log:3},this.errorCode={f_net:0,f_data:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}},this.collect=n,this.disable_tracer=o.disable_tracer||o.channel_domain,this.ready=!(!o.app_id||this.disable_tracer||o.disable_track_event),this.appid=o.app_id,this.process=c,this.event=h;var g=o.channel_domain||decodeUrl(LOG_URL[o.channel]);this.reportUrl=o.report_url?o.report_url:""+g+REPORT_URL,this.listener()}return l.prototype.addCount=function(n){try{if(!this.ready)return;if(this.count[n]++,this.count[n]>=this.limit[n]){var o=[];for(var c in o=__spread(o,this.processTracer(this.count[n],n,"net")),this.errorInfo[n])this.errorInfo[c]&&(o=__spread(o,this.processTracer(this.errorInfo[n][c],n,c)));o.length&&this.sendTracer(o,!0,n,!1)}}catch(h){}},l.prototype.addErrorCount=function(n,o,c,h){var g=this;try{if(!this.ready)return;if(n&&n.length){var b=n[0].events;b&&b.length&&(o==="f_data"?(h&&h.hasOwnProperty("sc")?this.errorInfo.log.f_data=b.length-h.sc:this.errorInfo.log.f_data=b.length,this.errorCode.f_data=c):b.forEach(function(y){var O="log";for(var M in EventList)if(EventList[M].indexOf(y.event)!==-1){O=M;break}g.errorInfo[O].f_net++,g.errorCode.f_net=c}))}}catch(y){}},l.prototype.clearCount=function(n){try{n?(this.count[n]=0,this.errorInfo[n]={f_net:0,f_data:0}):(this.count={pv:0,sdk:0,autotrack:0,log:0},this.errorInfo={pv:{f_net:0,f_data:0},sdk:{f_net:0,f_data:0},autotrack:{f_net:0,f_data:0},log:{f_net:0,f_data:0}})}catch(o){}},l.prototype.sendTracer=function(n,o,c,h){try{if(!this.ready||this.collect.staging)return;var g=this.event._mergeEvents(n);h&&window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify(g)):request(this.reportUrl,3e5,g,""),o?this.clearCount(c):this.clearCount()}catch(b){}},l.prototype.processTracer=function(n,o,c){try{var h={count:n,state:c,key:o,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:SDK_VERSION};c!=="f_net"&&c!=="f_data"||(h.errorCode=this.errorCode[c]);var g=[];if(g.push(this.process("applog_trace",h,!0)),g&&g.length)return delete g[0].is_bav,g}catch(b){}},l.prototype.listener=function(){var n=this;this.ready&&(document.addEventListener("visibilitychange",function(){n.leavePage()}),beforePageUnload(function(){n.leavePage()}))},l.prototype.leavePage=function(){if(this.ready)try{var n=[];for(var o in this.count)if(this.count[o]){var c=this.errorInfo[o];for(var h in n=__spread(n,this.processTracer(this.count[o],o,"net")),c)c[h]&&(n=__spread(n,this.processTracer(c[h],o,h)))}n&&n.length&&this.sendTracer(n,!1,"",!0)}catch(g){}},l}(),AppBridge=function(){function l(o){this.logger=o}var n=l.prototype;return n.bridgeInject=function(){try{return AppLogBridge?(this.logger.info("AppLogBridge is injected"),!0):(this.logger.info("AppLogBridge is not inject"),!1)}catch(o){return this.logger.info("AppLogBridge is not inject"),!1}},n.hasStarted=function(o){var c=this;try{this.bridgeInject()?AppLogBridge.hasStarted(function(h){c.logger.info("AppLogBridge is started? : "+h),o(h)}):o(0)}catch(h){this.logger.info("AppLogBridge, error:"+JSON.stringify(h.stack)),o(0)}},n.setUserUniqueId=function(o){try{AppLogBridge.setUserUniqueId(o)}catch(c){this.logger.error("setUserUniqueId error")}},n.addHeaderInfo=function(o,c){try{AppLogBridge.addHeaderInfo(o,c)}catch(h){this.logger.error("addHeaderInfo error")}},n.setHeaderInfo=function(o){try{AppLogBridge.setHeaderInfo(JSON.stringify(o))}catch(c){this.logger.error("setHeaderInfo error")}},n.removeHeaderInfo=function(o){try{AppLogBridge.removeHeaderInfo(o)}catch(c){this.logger.error("removeHeaderInfo error")}},n.onEventV3=function(o,c){try{AppLogBridge.onEventV3(o,c)}catch(h){this.logger.error("onEventV3 error")}},n.profileSet=function(o){try{AppLogBridge.profileSet(o)}catch(c){this.logger.error("profileSet error")}},n.profileSetOnce=function(o){try{AppLogBridge.profileSetOnce(o)}catch(c){this.logger.error("profileSetOnce error")}},n.profileIncrement=function(o){try{AppLogBridge.profileIncrement(o)}catch(c){this.logger.error("profileIncrement error")}},n.profileUnset=function(o){try{AppLogBridge.profileUnset(o)}catch(c){this.logger.error("profileUnset error")}},n.profileAppend=function(o){try{AppLogBridge.profileAppend(o)}catch(c){this.logger.error("profileAppend error")}},l}();function stringify(l,n,o){n===void 0&&(n=""),o===void 0&&(o={});var c=l;(c=c.split("#")[0].split("?")[0])[l.length-1]==="/"&&(c=c.substr(0,l.length-1)),c=n[0]==="/"?c.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+n):c.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+n);var h=Object.keys(o).map(function(g){return g+"="+o[g]}).join("&");return h.length>0?c+"?"+h:c}var Ruote=function(){function l(n){this.autotrack=!1,this.spa=!1,(n.spa||n.autotrack)&&(this.autotrack=!!n.autotrack,this.spa=n.spa,this.fncArray=new Map,this.setLocation(),this.hack(),this.storage=new Storage(!0),this.storage.setItem("__tea_cache_refer_key",location.href),this.listener())}return l.prototype.hack=function(){var n=this,o=window.history.pushState;history.pushState=function(h){for(var g=[],b=1;b<arguments.length;b++)g[b-1]=arguments[b];typeof history.onpushstate=="function"&&history.onpushstate({state:h});var y=o.call.apply(o,__spread([history,h],g)),O=n.getPopStateChangeEventData();return n.lastLocation=stringify(location.href,g[1]),n.storage.setItem("__tea_cache_refer_key",n.lastLocation),n.sendPv(O),y};var c=history.replaceState;history.replaceState=function(h){for(var g=[],b=1;b<arguments.length;b++)g[b-1]=arguments[b];typeof history.onreplacestate=="function"&&history.onreplacestate({state:h});var y=c.call.apply(c,__spread([history,h],g)),O=n.getPopStateChangeEventData();return n.lastLocation=stringify(location.href,g[1]),n.storage.setItem("__tea_cache_refer_key",n.lastLocation),n.sendPv(O),y}},l.prototype.setLocation=function(){typeof window!="undefined"&&(this.lastLocation=window.location.href)},l.prototype.add=function(n,o){this.fncArray.get(n)||this.fncArray.set(n,o)},l.prototype.init=function(n,o){this.add(n,o),this.fncArray.get(n)(this.getPopStateChangeEventData())},l.prototype.listener=function(){var n=this,o=null;window.addEventListener("hashchange",function(c){n.lastLocation!==window.location.href&&clearTimeout(o)}),window.addEventListener("popstate",function(c){n.lastLocation!==window.location.href&&(o=setTimeout(function(){n.lastLocation=window.location.href;var h=n.getPopStateChangeEventData();n.sendPv(h)},10))})},l.prototype.getPopStateChangeEventData=function(){var n=this.pageConfig();return n.is_back=0,n},l.prototype.pageConfig=function(){var n="";try{n=document.referrer?document.referrer:this.storage.getItem("__tea_cache_refer_key")||""}catch(o){}return{is_html:1,url:location.href,referrer:n,page_key:location.href,refer_page_key:n,page_manual_key:"",refer_page_manual_key:""}},l.prototype.sendPv=function(n){this.fncArray.forEach(function(o){o(n)})},l}(),hashCode=function(l){for(var n=0,o=0,c=(l+="").length,h=0;h<c;h++)((n=31*n+l.charCodeAt(o++))>140737488355327||n<-140737488355328)&&(n&=281474976710655);return n<0&&(n+=2251799813685247),n};function getCommonParams(l,n,o){return{title:n||document.title||location.pathname,url:o||location.href,url_path:l||location.pathname}}function getCurrentTime(){return Date.now()}function getPageStartTime(){var l=getNameSpace();return window[l]?window[l].l:getCurrentTime()}function isSupVisChange(){var l=!1;return["hidden","msHidden","webkitHidden"].forEach(function(n){document[n]!==void 0&&(l=!0)}),l}var PageAlive=function(){function l(n,o){var c=this;this._sendEvent=function(h){h===void 0&&(h=!1);var g=h?c.options.aliveDTime:getCurrentTime()-c.sessionStartTime;g<0||getCurrentTime()-c.pageStartTime>c.options.maxDuration||(c.event("predefine_page_alive",__assign({},getCommonParams(c.url_path,c.title,c.url),{duration:g,is_support_visibility_change:c.options.sup_vis_change?1:0,startTime:c.sessionStartTime}),"sdk"),c.sessionStartTime=getCurrentTime())},this._setUpTimer=function(){return c.timerHandler&&clearInterval(c.timerHandler),setInterval(function(){getCurrentTime()-c.sessionStartTime>c.options.aliveDTime&&c._sendEvent(!0)},1e3)},this._visibilitychange=function(){document.visibilityState==="hidden"?c.timerHandler&&(clearInterval(c.timerHandler),c._sendEvent()):document.visibilityState==="visible"&&(c.sessionStartTime=getCurrentTime(),c.timerHandler=c._setUpTimer())},this._beforeunload=function(){document.hidden||c._sendEvent()},this._wtest=function(){document.getElementById("wtest").innerHTML="visibilitychange"},this._dtest=function(){document.getElementById("dtest").innerHTML="dvisibilitychange"},this.event=n,this.config=o,this.isSupVisChange=isSupVisChange(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:isSupVisChange()},this.pageStartTime=getPageStartTime(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return l.prototype.enable=function(n,o,c){this.url_path=n,this.url=c,this.title=o,this.disableCallback=this._enablePageAlive()},l.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},l.prototype._enablePageAlive=function(){var n=this;return this.timerHandler=this._setUpTimer(),document.addEventListener("visibilitychange",this._visibilitychange),beforePageUnload(this._beforeunload),function(){n._beforeunload(),document.removeEventListener("visibilitychange",n._visibilitychange),window.removeEventListener("beforeunload",n._beforeunload),window.removeEventListener("pagehide",n._beforeunload)}},l}(),PageClose=function(){function l(n,o){var c=this;this._visibilitychange=function(){document.visibilityState==="hidden"?c.activeEndTime=getCurrentTime():document.visibilityState==="visible"&&(c.activeEndTime&&(c.totalTime+=c.activeEndTime-c.activeStartTime,c.activeTimes+=1),c.activeEndTime=void 0,c.activeStartTime=getCurrentTime())},this._beforeunload=function(){if(c.totalTime+=(c.activeEndTime||getCurrentTime())-c.activeStartTime,c.config.autotrack)try{window.sessionStorage.setItem("_tea_cache_duration",JSON.stringify({duration:c.totalTime,page_title:document.title||location.pathname}))}catch(h){}c._sendEventPageClose()},this.event=n,this.config=o,this.isSupVisChange=isSupVisChange(),this.options={sup_vis_change:this.isSupVisChange},this.maxDuration=o.maxDuration||864e5,this.disableCallback=function(){},this.pageStartTime=getPageStartTime(),this._resetData()}return l.prototype.enable=function(n,o,c){this.url_path=n,this.url=c,this.title=o,this.disableCallback=this._enablePageClose()},l.prototype.disable=function(){this.disableCallback()},l.prototype._resetData=function(){this.activeStartTime=this.activeStartTime===void 0?getPageStartTime():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},l.prototype._sendEventPageClose=function(){var n=getCurrentTime()-this.pageStartTime;this.totalTime<0||n<0||this.totalTime>=this.maxDuration||(this.event("predefine_page_close",__assign({},getCommonParams(this.url_path,this.title,this.url),{active_times:this.activeTimes,duration:this.totalTime,total_duration:n,is_support_visibility_change:this.options.sup_vis_change?1:0}),"sdk"),this.pageStartTime=Date.now(),this._resetData())},l.prototype._enablePageClose=function(){var n=this;return document.addEventListener("visibilitychange",this._visibilitychange),beforePageUnload(this._beforeunload),function(){n._beforeunload(),document.removeEventListener("visibilitychange",n._visibilitychange),window.removeEventListener("beforeunload",n._beforeunload),window.removeEventListener("pagehide",n._beforeunload)}},l}(),StayDuration=function(){function l(n,o){this.pageAlive=new PageAlive(n,o),this.pageClose=new PageClose(n,o),this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this._enable(this.url_path,this.title,this.url)}return l.prototype._enable=function(n,o,c){this.pageAlive.enable(n,o,c),this.pageClose.enable(n,o,c)},l.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},l.prototype.reset=function(n,o,c){this._disable(),this._enable(n,o,c)},l}();function selfAdjust(l,n){l===void 0&&(l=function(){}),n===void 0&&(n=1e3);var o,c=Date.now()+n;return o=window.setTimeout(function h(){var g=Date.now()-c;l(),c+=n,o=window.setTimeout(h,Math.max(0,n-g))},n),function(){window.clearTimeout(o)}}var Session$1=function(){function l(n){var o=this;this._setInterval=function(){o._clearIntervalFunc=selfAdjust(function(){o._isSessionhasEvent&&o._endCurrentSession()},o.sessionInterval)},this._clearInterval=function(){o._clearIntervalFunc&&o._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=n,this._startTime=0,this._lastTime=0,this._setInterval()}return l.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer},"sdk"),this._isSessionhasEvent=!1,this._startTime=0},l.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var n=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-n>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},l}(),SDK_USE_TYPE="npm",Monitor=function(){function l(n){this.config=n}return l.prototype.sdkOnload=function(n,o,c){if(!this.config.disable_track_event&&!this.sdkReady){this.sdkReady=!0;try{if(c.length===0)return;var h=c[0],g=h.header,b=h.user,y=g.app_id,O=g.app_name,M=g.sdk_version,G=b.web_id,le={events:[{event:"onload",params:JSON.stringify({app_key:n,app_id:y,app_name:O||"",sdk_version:M,sdk_type:SDK_USE_TYPE,sdk_config:this.config}),local_time_ms:Date.now()}],user:{user_unique_id:G},header:{}};setTimeout(function(){request(o,3e4,[le],"566f58151b0ed37e")},16)}catch(Pe){}}},l.prototype.sdkError=function(n,o,c,h){try{if(this.config.disable_track_event)return;var g=c[0],b=g.user,y=g.header,O=[];c.forEach(function(G){G.events.forEach(function(le){O.push(le)})});var M={events:O.map(function(G){return{event:"on_error",params:JSON.stringify({error_code:h,app_key:n,app_id:y.app_id,app_name:y.app_name||"",error_event:G.event,sdk_version:y.sdk_version,local_time_ms:G.local_time_ms,tea_event_index:Date.now(),params:G.params,header:JSON.stringify(y),user:JSON.stringify(b)}),local_time_ms:Date.now()}}),user:{user_unique_id:b.user_unique_id},header:{}};setTimeout(function(){request(o,3e4,[M],"566f58151b0ed37e")},16)}catch(G){}},l}(),getIframeUrl=function(){try{var l=JSON.parse(atob(window.name));return l||void 0}catch(n){return}};function openOverlayer(){if(!document.getElementById(STYLE_ID)){var l="body { opacity: 0 !important; }",n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.id=STYLE_ID,o.type="text/css",o.styleSheet?o.styleSheet.cssText=l:o.appendChild(document.createTextNode(l)),n.appendChild(o)}}function closeOverlayer(){var l=document.getElementById(STYLE_ID);l&&l.parentElement.removeChild(l)}var storage=new Storage(!1),getStorageKey=function(l){return STORAGE_DATA_KEY+"_"+l},getCache=function(l){var n={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};try{n=storage.getItem(getStorageKey(l))||n}catch(o){}return n},_setCache=function(l,n){try{var o=getCache(l);storage.setItem(getStorageKey(l),__assign({},o,n))}catch(c){}},setVersionCache=function(l,n,o){o===void 0&&(o=!1);var c=o?{ab_ext_version:n,timestamp:Date.now()}:{ab_version:n,timestamp:Date.now()};_setCache(l,c)},setMultilinkCache=function(l,n){var o={ab_version_multilink:n,timestamp:Date.now()};_setCache(l,o)},setDataCache=function(l,n,o){_setCache(l,{data:n,uuid:o})},checkExpiration=function(l){var n=getCache(l),o=n.timestamp;if(Date.now()-o>=STORAGE_DATA_EXPRIRE){try{storage.removeItem(STORAGE_DATA_KEY)}catch(c){}return null}return n},msgQueueMap={},allowdOrigins=[],addAllowdOrigin=function(l){l.length&&l.forEach(function(n){allowdOrigins.push(n)})};function dispatchMsg(l,n,o,c){var h=l&&l.source||window.opener||window.parent,g=l&&l.origin||c||"*",b={type:n,payload:o};h.postMessage(JSON.stringify(b),g)}function receiveMsg(l,n){msgQueueMap[l]=msgQueueMap[l]||[],msgQueueMap[l].push(n)}function processMsg(l){if(allowdOrigins.some(function(h){return h==="*"})||allowdOrigins.some(function(h){return l.origin.indexOf(h)>-1})){var n=l.data;if(typeof l.data=="string")try{n=JSON.parse(l.data)}catch(h){n=void 0}if(!n)return;var o=n.type,c=n.payload;msgQueueMap[o]&&msgQueueMap[o].forEach(function(h){typeof h=="function"&&h(l,c)})}}function init(l,n){delete l.filter,(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:l,version:n},"*"),window.addEventListener("message",processMsg,!1)}function loadScript(l,n,o){var c=document.createElement("script");c.src=l,c.onerror=function(){o(l)},c.onload=function(){n()},document.getElementsByTagName("head")[0].appendChild(c)}window.TEAVisualEditor=window.TEAVisualEditor||{};var VISUAL_URL="",isLoaded=!1;function loadEditorScript(l){var n=l.event,o=l.editorUrl;l.collectInstance,l.fromSession,isLoaded||(isLoaded=!0,loadScript(o,function(){dispatchMsg(n,"abEditorScriptloadSuccess")},function(){n&&dispatchMsg(n,"abEditorScriptloadError"),isLoaded=!1}))}function readyToLoadEditor(l,n,o,c){addAllowdOrigin(["*"]);var h,g="";init(c,SDK_VERSION);var b="";try{var y=window.performance.getEntriesByType("resource");if(y&&y.length&&(y.forEach(function(M){M.initiatorType==="script"&&M.name&&M.name.indexOf("collect")!==-1&&(b=M.name)}),b||document.currentScript&&(b=document.currentScript.src),b&&(h=b.split("/"))&&h.length)){g="https:/";for(var O=2;O<h.length&&O!==h.length-1;O++)g=g+"/"+h[O];g+="/visual-ab-core"}}catch(M){}receiveMsg("tea:openVisualABEditor",function(M){var G=M.data;if(typeof M.data=="string")try{G=JSON.parse(M.data)}catch(Ce){G=void 0}if(G){var le=G.lang;if(G.appId!==n)return dispatchMsg(M,"appIdError"),void console.error("abtest appid is not belong the page appid please check");var Pe=G.version;Pe?VISUAL_URL=g?""+g+(Pe?"."+Pe:".1.0.1")+".js?query="+Date.now():decodeUrl(VISUAL_URL_ASC)+"?query="+Date.now():VISUAL_URL=decodeUrl(VISUAL_URL_ASC)+"?query="+Date.now(),window.TEAVisualEditor.lang=le,o&&(window.TEAVisualEditor.__ab_domin=o),loadEditorScript({event:M,editorUrl:VISUAL_URL,collectInstance:l})}})}var loadMuiltlink=function(l,n,o,c){window.TEAVisualEditor.appId=n,receiveMsg("tea:openTesterEventInspector",function(h){var g=h.data;if(typeof h.data=="string")try{g=JSON.parse(h.data)}catch(M){g=void 0}if(g){var b=g.referrer,y=g.lang,O=g.appId;window.TEAVisualEditor.__editor_ajax_domain=b||"",window.TEAVisualEditor.__ab_appId=O||"",window.TEAVisualEditor.lang=y||"",loadEditorScript({event:h,editorUrl:decodeUrl(VISUAL_URL_INSPECTOR)+"?query="+Date.now(),collectInstance:l})}})},VISUAL_RANGER_URL=decodeUrl(VISUAL_URL_RANGER)+"?query="+Date.now(),loadVisual=function(l){window.TEAVisualEditor.__ab_config=l,loadScript(VISUAL_RANGER_URL,function(){console.log("load visual render success")},function(){console.log("load visual render fail")})},FetchStatus,RefreshFetchStatus,CallbackType;(function(l){l[l.No=0]="No",l[l.Ing=1]="Ing",l[l.Complete=2]="Complete"})(FetchStatus||(FetchStatus={})),function(l){l[l.No=0]="No",l[l.Ing=1]="Ing",l[l.Complete=2]="Complete"}(RefreshFetchStatus||(RefreshFetchStatus={})),function(l){l[l.Var=0]="Var",l[l.All=1]="All"}(CallbackType||(CallbackType={}));var AB=function(){function l(n,o,c){this.appId=0,this.user={},this.header={},this.domain="",this.protocal=location.protocol,this.fetchStatus=FetchStatus.No,this.refreshFetchStatus=RefreshFetchStatus.Complete,this.callbacks=[],this.data=null,this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.collector=n,this.initConfig=c;var h=this.collector._initConfig,g=h.app_id,b=h.channel,y=h.enable_multilink,O=h.multilink_timeout_ms,M=h.ab_channel_domain,G=h.channel_domain,le=h.enable_ab_visual,Pe=h.ab_timeout;if(this.appId=g,this.timeout=Pe||3e3,this.domain=M||decodeUrl(DOMAINS[b||"cn"]),this.domain){this.needOverlay=y||le||!1,this.enable_ab_visual=le,this.enable_multilink=y,this.closeTime=O||500,this.Hook=o;var Ce=G||decodeUrl(LOG_URL[b]);this.reportUrl=""+Ce+REPORT_URL,this.editCheck(),le&&(readyToLoadEditor(n,this.appId,M||"",c),this.editMode==="visual-editor")?this.collector.destroy():(y&&loadMuiltlink(n,this.appId,M||"",c),this._check(),this.wait())}else console.warn("sorry, channel in is not support abtest yet~")}return l.prototype.editCheck=function(){var n=getIframeUrl();if(n){var o=n.scenario,c=n.href;o?o==="heatmap"?(console.log("heatmap mode"),this.editMode="heatmap"):o==="visual-editor"&&(console.log("visual mode"),this.editMode="visual-editor"):!c||c.indexOf("datatester")===-1&&c.indexOf("visual-editor")===-1||(console.log("visual mode"),this.editMode="visual-editor")}},l.prototype.checkFromUrl=function(){var n=parseUrlQuery(window.location.href);return n&&n.vid?n.vid:""},l.prototype.refetch=function(){this.data={},this.versions=[],this.mulilinkVersions=[],this.extVersions=[],this.refreshFetchStatus=RefreshFetchStatus.Ing;var n=this.collector._config.get();this.init(n)},l.prototype.init=function(n,o){if(!this.collector.destroyInstance)if(this.domain){this.config=n;var c=n.user,h=n.header,g=__rest(h,[]);this.user=__assign({},c),this.header=__assign({},h),this._fetch(__assign({},g),{success:o,fail:o})}else console.warn("sorry, channel in is not support abtest yet~")},l.prototype._check=function(){var n=this,o=checkExpiration(this.appId);if(o){var c=o.ab_version,h=o.data,g=o.ab_ext_version,b=o.ab_version_multilink,y=this.checkFromUrl();y?this.mulilinkVersions.push(y):this.mulilinkVersions=b||[],this.extVersions=g,c&&c.length&&(this.versions=c,this.data=h,setTimeout(function(){n._configVersions()}))}},l.prototype.wait=function(){var n=this;this.needOverlay&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout(function(){n.closeOverlayer()},this.closeTime))},l.prototype.getAllVars=function(n){if(typeof n!="function")throw new Error("callback must be a function");var o={callback:n,type:CallbackType.All};this.fetchStatus===FetchStatus.Complete&&this.refreshFetchStatus===RefreshFetchStatus.Complete?this._getAllVars(o):this.callbacks.push(o)},l.prototype._getAllVars=function(n){(0,n.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},l.prototype.getVids=function(){try{var n=getCache(this.appId),o=n.ab_version,c=n.ab_version_multilink,h=n.ab_ext_version,g="",b=o.concat(c).concat(h);return b&&b.length&&(g=b.join(",")),g}catch(y){return""}},l.prototype.getAbSdkVersion=function(n){n(this.getVids())},l.prototype.getVar=function(n,o,c){if(!n)throw new Error("variable must not be empty");if(o===void 0)throw new Error("variable no default value");if(typeof c!="function")throw new Error("callback must be a function");var h={name:n,defaultValue:o,callback:c,type:CallbackType.Var};if(this.fetchStatus===FetchStatus.Complete&&this.refreshFetchStatus===RefreshFetchStatus.Complete){this._getVar(h,n);try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(g){}}else this.callbacks.push(h)},l.prototype._getVar=function(n,o){var c=n.name,h=n.defaultValue,g=n.callback,b=this.data;if(b){if(typeof b[c]=="object"&&b[c].val!==void 0){var y=b[c].vid;return o==="$ab_url"?(this.mulilinkVersions.indexOf(y)===-1&&this.mulilinkVersions.push(y),this._updateMultilinkVersions()):(this.versions.indexOf(y)===-1&&this.versions.push(y),this._updateVersions()),this._abEvent(y,o,h),void g(b[c].val)}g(h)}else g(h)},l.prototype._abEvent=function(n,o,c){var h=this;try{if(this.initConfig.disable_track_event)return;var g=this.collector._config.get(),b=g.header,y=g.user,O=getCache(this.appId);if(O&&O.uuid&&O.uuid!==y.user_unique_id)return;if(n){var M={event:"abtest_exposure",ab_sdk_version:""+n,params:JSON.stringify({app_id:this.appId,ab_url:o==="$ab_url"?c:window.location.href}),local_time_ms:Date.now()};b.ab_sdk_version=""+n,b.custom=JSON.stringify(b.custom);var G={events:[M],user:y,header:b};o==="$ab_url"?window.navigator.sendBeacon?window.navigator.sendBeacon(this.reportUrl,JSON.stringify([G])):request(this.reportUrl,2e4,[G],""):setTimeout(function(){request(h.reportUrl,2e4,[G],"")},16)}}catch(le){}},l.prototype.openOverlayer=function(){openOverlayer()},l.prototype.closeOverlayer=function(){closeOverlayer()},l.prototype._setAbVersion=function(n){this.extVersions=[n],setVersionCache(this.appId,this.extVersions,!0)},l.prototype._updateVersions=function(){setVersionCache(this.appId,this.versions),this._configVersions()},l.prototype._updateMultilinkVersions=function(){setMultilinkCache(this.appId,this.mulilinkVersions)},l.prototype._configVersions=function(){var n=this.versions.join(",");n&&this.collector.config({ab_sdk_version:n})},l.prototype._clearCache=function(){this.versions=[],this.mulilinkVersions=[]},l.prototype._getABconfig=function(n,o){var c=Object.keys(n);c&&c.length&&this.collector.config(n),this.init(this.collector._config.get(),o)},l.prototype._fetchComplete=function(n,o){var c=this;if(n&&Object.prototype.toString.call(n)=="[object Object]"){setDataCache(this.appId,n,o),this.data=n;var h=[];Object.keys(n).forEach(function(M){var G=n[M].vid;G&&h.push(G)}),window.location.href.indexOf("multilink=true")!==-1||(this.versions=this.versions.filter(function(M){return h.indexOf(M)!==-1}));var g=n.$ab_url,b=n.$ab_modification;if(b&&b.val&&this.enable_ab_visual){if(this.collector.destroyInstance)return;this.getVar("$ab_modification",window.location.href,function(){loadVisual(b.val)})}else if(g&&this.enable_multilink){var y=g.val,O=g.vid;y&&O&&this.getVar("$ab_url",y,function(){if(c.editMode!=="heatmap"){var M=window.location.href;M.indexOf("multilink=true")!==-1&&(M=c.filterUrl(M)),y!==M?setTimeout(function(){if(!c.collector.destroyInstance){var G=""+y;(G=G.indexOf("http")===-1?"https://"+G:G).indexOf("?")!==-1?G+="&multilink=true":G+="?multilink=true",parseURL(G).host!==location.host&&(G=G+"&vid="+O),window.location.href=G}},50):c.closeOverlayer()}})}else this.closeOverlayer()}this.callbacks.forEach(function(M){c[M.type===CallbackType.Var?"_getVar":"_getAllVars"](M,"")}),this.callbacks=[],this._updateVersions();try{this.Hook.emit("onAbSdkVersionChange",this.getVids())}catch(M){}this.isWait||this.closeOverlayer()},l.prototype._fetch=function(n,o){var c=this,h=o===void 0?{}:o,g=h.success,b=g===void 0?function(){}:g,y=h.fail,O=y===void 0?function(){}:y;this.fetchStatus=FetchStatus.Ing;var M=""+this.domain+API,G=window.location.href,le=!1;G.indexOf("multilink=true")!==-1&&(G=this.filterUrl(G),le=!0);var Pe=le?this.mulilinkVersions:this.versions;xhr(M,{header:__assign({aid:this.appId},this.user||{},n||{},{ab_sdk_version:Pe.join(","),ab_url:G})},function(Ce){c.fetchStatus=FetchStatus.Complete,c.refreshFetchStatus=RefreshFetchStatus.Complete;var De=Ce.data;Ce.message==="success"?(c._fetchComplete(De,c.user.user_unique_id),b(De)):(c._fetchComplete(null,c.user.user_unique_id),O())},function(){c.fetchStatus=FetchStatus.Complete,c.refreshFetchStatus=RefreshFetchStatus.Complete,O(),c._fetchComplete(null,c.user.user_unique_id)},"",this.timeout)},l.prototype.filterUrl=function(n){try{var o="";n.indexOf("&multilink=true")!==-1?o="&multilink=true[\0-\xFF]*":n.indexOf("?multilink=true")!==-1&&(o="\\?multilink=true[\0-\xFF]*");var c=new RegExp(o,"g");n=n.replace(c,"")}catch(h){}return n},l}(),maxStorage=function(l,n,o,c){if(n){var h=l.filter(function(le){return!le[0].__disable_storage__}).length;if(h>0)try{var g=c.getItem(o);if(g){var b=Object.keys(g),y=b.length+h-n;if(y>0){for(var O=b.map(function(le){var Pe=g[le];return{id:le,index:Pe&&Pe[0]?Pe[0].header.__storage_index__:+new Date}}).sort(function(le,Pe){return le.index-Pe.index}),M=0;M<y;M++){var G=O.shift();G&&G.id&&g[G.id]&&delete g[G.id]}c.setItem(o,g)}}}catch(le){}}},Et_Test=function(){function l(n){typeof n.event_verify_url=="string"?this.url=n.event_verify_url+"/"+ET_TEST_URL:console.log("please use correct et_test url")}return l.prototype.send=function(n){this.url&&request(this.url,3e4,n)},l}(),Plugin=function(){return function(l,n,o,c,h){n&&(n.enable_stay_duration&&(this.stay=new StayDuration(c,n)),n.disable_session||(this.session=new Session$1(o)),n.channel_domain||n.disable_sdk_monitor||(this.monitor=new Monitor(n)),n.event_verify_url&&(this.et_test=new Et_Test(n)),n.enable_ab_test&&(this.ab=new AB(l,h,n)),n.max_storage_num&&(this.maxStorage=maxStorage))}}(),Profile=function(){function l(n,o,c){this.processEvent=n,this._event=o,this.cache={},this.duration=6e4,this.config=c,this.profileReady=!1,this.reportUrl=(c.channel_domain||decodeUrl(LOG_URL[c.channel]))+"/profile/list"}return l.prototype.start=function(){this.profileReady=!0},l.prototype.report=function(n,o){o===void 0&&(o={});try{if(this.config.disable_track_event)return;var c=[];c.push(this.processEvent(n,o));var h=this._event._mergeEvents(c);request(this.reportUrl,3e5,h)}catch(g){}},l.prototype.setProfile=function(n){var o=this._formatParams(n);o&&Object.keys(o).length&&(this._pushCache(o),this.report("__profile_set",__assign({},o,{profile:!0})))},l.prototype.setOnceProfile=function(n){var o=this._formatParams(n,!0);o&&Object.keys(o).length&&(this._pushCache(o),this.report("__profile_set_once",__assign({},o,{profile:!0})))},l.prototype.incrementProfile=function(n){n?this.report("__profile_increment",__assign({},n,{profile:!0})):console.warn("please check the params, must be object!!!")},l.prototype.unsetProfile=function(n){if(n){var o={};o[n]="1",this.report("__profile_unset",__assign({},o,{profile:!0}))}else console.warn("please check the key, must be string!!!")},l.prototype.appendProfile=function(n){if(n){var o={};for(var c in n)typeof n[c]=="string"||Object.prototype.toString.call(n[c]).slice(8,-1)==="Array"?o[c]=n[c]:console.warn("please check the value of param: "+c+", must be string or array !!!");Object.keys(o).length&&this.report("__profile_append",__assign({},o,{profile:!0}))}else console.warn("please check the params, must be object!!!")},l.prototype._pushCache=function(n){var o=this;Object.keys(n).forEach(function(c){o.cache[c]={val:o._clone(n[c]),timestamp:Date.now()}})},l.prototype._formatParams=function(n,o){var c=this;o===void 0&&(o=!1);try{if(!n||Object.prototype.toString.call(n)!=="[object Object]")return void console.warn("please check the params type, must be object !!!");var h={};for(var g in n)typeof n[g]=="string"||typeof n[g]=="number"||Object.prototype.toString.call(n[g]).slice(8,-1)==="Array"?h[g]=n[g]:console.warn("please check the value of params:"+g+", must be string,number,Array !!!");var b=Object.keys(h);if(!b.length)return;var y=Date.now();return b.filter(function(O){var M=c.cache[O];return o?!M:!(M&&c._compare(M.val,n[O])&&y-M.timestamp<c.duration)}).reduce(function(O,M){return O[M]=h[M],O},{})}catch(O){}},l.prototype._compare=function(n,o){try{return JSON.stringify(n)===JSON.stringify(o)}catch(c){return!1}},l.prototype._clone=function(n){try{return JSON.parse(JSON.stringify(n))}catch(o){return n}},l.prototype._unReady=function(){console.warn("sdk is not ready, please use this api after start")},l}(),dayjs_min=createCommonjsModule(function(l,n){l.exports=function(){var o="millisecond",c="second",h="minute",g="hour",b="day",y="week",O="month",M="quarter",G="year",le="date",Pe="Invalid Date",Ce=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,De=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Ae={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},ge=function(we,fe,K){var I=String(we);return!I||I.length>=fe?we:""+Array(fe+1-I.length).join(K)+we},Te={s:ge,z:function(we){var fe=-we.utcOffset(),K=Math.abs(fe),I=Math.floor(K/60),k=K%60;return(fe<=0?"+":"-")+ge(I,2,"0")+":"+ge(k,2,"0")},m:function we(fe,K){if(fe.date()<K.date())return-we(K,fe);var I=12*(K.year()-fe.year())+(K.month()-fe.month()),k=fe.clone().add(I,O),se=K-k<0,pe=fe.clone().add(I+(se?-1:1),O);return+(-(I+(K-k)/(se?k-pe:pe-k))||0)},a:function(we){return we<0?Math.ceil(we)||0:Math.floor(we)},p:function(we){return{M:O,y:G,w:y,d:b,D:le,h:g,m:h,s:c,ms:o,Q:M}[we]||String(we||"").toLowerCase().replace(/s$/,"")},u:function(we){return we===void 0}},ce="en",x={};x[ce]=Ae;var P=function(we){return we instanceof Re},$=function(we,fe,K){var I;if(!we)return ce;if(typeof we=="string")x[we]&&(I=we),fe&&(x[we]=fe,I=we);else{var k=we.name;x[k]=we,I=k}return!K&&I&&(ce=I),I||!K&&ce},he=function(we,fe){if(P(we))return we.clone();var K=typeof fe=="object"?fe:{};return K.date=we,K.args=arguments,new Re(K)},ye=Te;ye.l=$,ye.i=P,ye.w=function(we,fe){return he(we,{locale:fe.$L,utc:fe.$u,x:fe.$x,$offset:fe.$offset})};var Re=function(){function we(K){this.$L=$(K.locale,null,!0),this.parse(K)}var fe=we.prototype;return fe.parse=function(K){this.$d=function(I){var k=I.date,se=I.utc;if(k===null)return new Date(NaN);if(ye.u(k))return new Date;if(k instanceof Date)return new Date(k);if(typeof k=="string"&&!/Z$/i.test(k)){var pe=k.match(Ce);if(pe){var Je=pe[2]-1||0,me=(pe[7]||"0").substring(0,3);return se?new Date(Date.UTC(pe[1],Je,pe[3]||1,pe[4]||0,pe[5]||0,pe[6]||0,me)):new Date(pe[1],Je,pe[3]||1,pe[4]||0,pe[5]||0,pe[6]||0,me)}}return new Date(k)}(K),this.$x=K.x||{},this.init()},fe.init=function(){var K=this.$d;this.$y=K.getFullYear(),this.$M=K.getMonth(),this.$D=K.getDate(),this.$W=K.getDay(),this.$H=K.getHours(),this.$m=K.getMinutes(),this.$s=K.getSeconds(),this.$ms=K.getMilliseconds()},fe.$utils=function(){return ye},fe.isValid=function(){return this.$d.toString()!==Pe},fe.isSame=function(K,I){var k=he(K);return this.startOf(I)<=k&&k<=this.endOf(I)},fe.isAfter=function(K,I){return he(K)<this.startOf(I)},fe.isBefore=function(K,I){return this.endOf(I)<he(K)},fe.$g=function(K,I,k){return ye.u(K)?this[I]:this.set(k,K)},fe.unix=function(){return Math.floor(this.valueOf()/1e3)},fe.valueOf=function(){return this.$d.getTime()},fe.startOf=function(K,I){var k=this,se=!!ye.u(I)||I,pe=ye.p(K),Je=function(Rt,_t){var Xe=ye.w(k.$u?Date.UTC(k.$y,_t,Rt):new Date(k.$y,_t,Rt),k);return se?Xe:Xe.endOf(b)},me=function(Rt,_t){return ye.w(k.toDate()[Rt].apply(k.toDate("s"),(se?[0,0,0,0]:[23,59,59,999]).slice(_t)),k)},Ne=this.$W,ne=this.$M,$e=this.$D,Oe="set"+(this.$u?"UTC":"");switch(pe){case G:return se?Je(1,0):Je(31,11);case O:return se?Je(1,ne):Je(0,ne+1);case y:var je=this.$locale().weekStart||0,vt=(Ne<je?Ne+7:Ne)-je;return Je(se?$e-vt:$e+(6-vt),ne);case b:case le:return me(Oe+"Hours",0);case g:return me(Oe+"Minutes",1);case h:return me(Oe+"Seconds",2);case c:return me(Oe+"Milliseconds",3);default:return this.clone()}},fe.endOf=function(K){return this.startOf(K,!1)},fe.$set=function(K,I){var k,se=ye.p(K),pe="set"+(this.$u?"UTC":""),Je=(k={},k[b]=pe+"Date",k[le]=pe+"Date",k[O]=pe+"Month",k[G]=pe+"FullYear",k[g]=pe+"Hours",k[h]=pe+"Minutes",k[c]=pe+"Seconds",k[o]=pe+"Milliseconds",k)[se],me=se===b?this.$D+(I-this.$W):I;if(se===O||se===G){var Ne=this.clone().set(le,1);Ne.$d[Je](me),Ne.init(),this.$d=Ne.set(le,Math.min(this.$D,Ne.daysInMonth())).$d}else Je&&this.$d[Je](me);return this.init(),this},fe.set=function(K,I){return this.clone().$set(K,I)},fe.get=function(K){return this[ye.p(K)]()},fe.add=function(K,I){var k,se=this;K=Number(K);var pe=ye.p(I),Je=function(ne){var $e=he(se);return ye.w($e.date($e.date()+Math.round(ne*K)),se)};if(pe===O)return this.set(O,this.$M+K);if(pe===G)return this.set(G,this.$y+K);if(pe===b)return Je(1);if(pe===y)return Je(7);var me=(k={},k[h]=6e4,k[g]=36e5,k[c]=1e3,k)[pe]||1,Ne=this.$d.getTime()+K*me;return ye.w(Ne,this)},fe.subtract=function(K,I){return this.add(-1*K,I)},fe.format=function(K){var I=this,k=this.$locale();if(!this.isValid())return k.invalidDate||Pe;var se=K||"YYYY-MM-DDTHH:mm:ssZ",pe=ye.z(this),Je=this.$H,me=this.$m,Ne=this.$M,ne=k.weekdays,$e=k.months,Oe=function(_t,Xe,ut,yt){return _t&&(_t[Xe]||_t(I,se))||ut[Xe].substr(0,yt)},je=function(_t){return ye.s(Je%12||12,_t,"0")},vt=k.meridiem||function(_t,Xe,ut){var yt=_t<12?"AM":"PM";return ut?yt.toLowerCase():yt},Rt={YY:String(this.$y).slice(-2),YYYY:this.$y,M:Ne+1,MM:ye.s(Ne+1,2,"0"),MMM:Oe(k.monthsShort,Ne,$e,3),MMMM:Oe($e,Ne),D:this.$D,DD:ye.s(this.$D,2,"0"),d:String(this.$W),dd:Oe(k.weekdaysMin,this.$W,ne,2),ddd:Oe(k.weekdaysShort,this.$W,ne,3),dddd:ne[this.$W],H:String(Je),HH:ye.s(Je,2,"0"),h:je(1),hh:je(2),a:vt(Je,me,!0),A:vt(Je,me,!1),m:String(me),mm:ye.s(me,2,"0"),s:String(this.$s),ss:ye.s(this.$s,2,"0"),SSS:ye.s(this.$ms,3,"0"),Z:pe};return se.replace(De,function(_t,Xe){return Xe||Rt[_t]||pe.replace(":","")})},fe.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},fe.diff=function(K,I,k){var se,pe=ye.p(I),Je=he(K),me=6e4*(Je.utcOffset()-this.utcOffset()),Ne=this-Je,ne=ye.m(this,Je);return ne=(se={},se[G]=ne/12,se[O]=ne,se[M]=ne/3,se[y]=(Ne-me)/6048e5,se[b]=(Ne-me)/864e5,se[g]=Ne/36e5,se[h]=Ne/6e4,se[c]=Ne/1e3,se)[pe]||Ne,k?ne:ye.a(ne)},fe.daysInMonth=function(){return this.endOf(O).$D},fe.$locale=function(){return x[this.$L]},fe.locale=function(K,I){if(!K)return this.$L;var k=this.clone(),se=$(K,I,!0);return se&&(k.$L=se),k},fe.clone=function(){return ye.w(this.$d,this)},fe.toDate=function(){return new Date(this.valueOf())},fe.toJSON=function(){return this.isValid()?this.toISOString():null},fe.toISOString=function(){return this.$d.toISOString()},fe.toString=function(){return this.$d.toUTCString()},we}(),He=Re.prototype;return he.prototype=He,[["$ms",o],["$s",c],["$m",h],["$H",g],["$W",b],["$M",O],["$y",G],["$D",le]].forEach(function(we){He[we[1]]=function(fe){return this.$g(fe,we[0],we[1])}}),he.extend=function(we,fe){return we.$i||(we(fe,Re,he),we.$i=!0),he},he.locale=$,he.isDayjs=P,he.unix=function(we){return he(1e3*we)},he.en=x[ce],he.Ls=x,he.p={},he}()}),duration=createCommonjsModule(function(l,n){var o,c,h,g,b,y,O,M,G,le,Pe,Ce,De,Ae,ge,Te,ce;l.exports=(b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,M=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,G={years:y=31536e6,months:O=2592e6,days:g=864e5,hours:h=36e5,minutes:6e4,seconds:1e3,milliseconds:1,weeks:6048e5},le=function(x){return x instanceof ce},Pe=function(x,P,$){return new ce(x,$,P.$l)},Ce=function(x){return c.p(x)+"s"},De=function(x){return x<0},Ae=function(x){return De(x)?Math.ceil(x):Math.floor(x)},ge=function(x){return Math.abs(x)},Te=function(x,P){return x?De(x)?{negative:!0,format:""+ge(x)+P}:{negative:!1,format:""+x+P}:{negative:!1,format:""}},ce=function(){function x($,he,ye){var Re=this;if(this.$d={},this.$l=ye,$===void 0&&(this.$ms=0,this.parseFromMilliseconds()),he)return Pe($*G[Ce(he)],this);if(typeof $=="number")return this.$ms=$,this.parseFromMilliseconds(),this;if(typeof $=="object")return Object.keys($).forEach(function(fe){Re.$d[Ce(fe)]=$[fe]}),this.calMilliseconds(),this;if(typeof $=="string"){var He=$.match(M);if(He){var we=He.slice(2).map(function(fe){return Number(fe)});return this.$d.years=we[0],this.$d.months=we[1],this.$d.weeks=we[2],this.$d.days=we[3],this.$d.hours=we[4],this.$d.minutes=we[5],this.$d.seconds=we[6],this.calMilliseconds(),this}}return this}var P=x.prototype;return P.calMilliseconds=function(){var $=this;this.$ms=Object.keys(this.$d).reduce(function(he,ye){return he+($.$d[ye]||0)*G[ye]},0)},P.parseFromMilliseconds=function(){var $=this.$ms;this.$d.years=Ae($/y),$%=y,this.$d.months=Ae($/O),$%=O,this.$d.days=Ae($/g),$%=g,this.$d.hours=Ae($/h),$%=h,this.$d.minutes=Ae($/6e4),$%=6e4,this.$d.seconds=Ae($/1e3),$%=1e3,this.$d.milliseconds=$},P.toISOString=function(){var $=Te(this.$d.years,"Y"),he=Te(this.$d.months,"M"),ye=+this.$d.days||0;this.$d.weeks&&(ye+=7*this.$d.weeks);var Re=Te(ye,"D"),He=Te(this.$d.hours,"H"),we=Te(this.$d.minutes,"M"),fe=this.$d.seconds||0;this.$d.milliseconds&&(fe+=this.$d.milliseconds/1e3);var K=Te(fe,"S"),I=$.negative||he.negative||Re.negative||He.negative||we.negative||K.negative,k=He.format||we.format||K.format?"T":"",se=(I?"-":"")+"P"+$.format+he.format+Re.format+k+He.format+we.format+K.format;return se==="P"||se==="-P"?"P0D":se},P.toJSON=function(){return this.toISOString()},P.format=function($){var he=$||"YYYY-MM-DDTHH:mm:ss",ye={Y:this.$d.years,YY:c.s(this.$d.years,2,"0"),YYYY:c.s(this.$d.years,4,"0"),M:this.$d.months,MM:c.s(this.$d.months,2,"0"),D:this.$d.days,DD:c.s(this.$d.days,2,"0"),H:this.$d.hours,HH:c.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:c.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:c.s(this.$d.seconds,2,"0"),SSS:c.s(this.$d.milliseconds,3,"0")};return he.replace(b,function(Re,He){return He||String(ye[Re])})},P.as=function($){return this.$ms/G[Ce($)]},P.get=function($){var he=this.$ms,ye=Ce($);return ye==="milliseconds"?he%=1e3:he=ye==="weeks"?Ae(he/G[ye]):this.$d[ye],he===0?0:he},P.add=function($,he,ye){var Re;return Re=he?$*G[Ce(he)]:le($)?$.$ms:Pe($,this).$ms,Pe(this.$ms+Re*(ye?-1:1),this)},P.subtract=function($,he){return this.add($,he,!0)},P.locale=function($){var he=this.clone();return he.$l=$,he},P.clone=function(){return Pe(this.$ms,this)},P.humanize=function($){return o().add(this.$ms,"ms").locale(this.$l).fromNow(!$)},P.milliseconds=function(){return this.get("milliseconds")},P.asMilliseconds=function(){return this.as("milliseconds")},P.seconds=function(){return this.get("seconds")},P.asSeconds=function(){return this.as("seconds")},P.minutes=function(){return this.get("minutes")},P.asMinutes=function(){return this.as("minutes")},P.hours=function(){return this.get("hours")},P.asHours=function(){return this.as("hours")},P.days=function(){return this.get("days")},P.asDays=function(){return this.as("days")},P.weeks=function(){return this.get("weeks")},P.asWeeks=function(){return this.as("weeks")},P.months=function(){return this.get("months")},P.asMonths=function(){return this.as("months")},P.years=function(){return this.get("years")},P.asYears=function(){return this.as("years")},x}(),function(x,P,$){o=$,c=$().$utils(),$.duration=function(Re,He){var we=$.locale();return Pe(Re,{$l:we},He)},$.isDuration=le;var he=P.prototype.add,ye=P.prototype.subtract;P.prototype.add=function(Re,He){return le(Re)&&(Re=Re.asMilliseconds()),he.bind(this)(Re,He)},P.prototype.subtract=function(Re,He){return le(Re)&&(Re=Re.asMilliseconds()),ye.bind(this)(Re,He)}})});dayjs_min.extend(duration);var ignoreList=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],moreOP=["and","or","not"],CEP_URL="/service/2/cep_settings/",CepRule=function(){function CepRule(l,n,o){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[],this.storage=new Storage(!1),this.config=l;var c=l.channel_domain||decodeUrl(LOG_URL[l.channel||"cn"]);this.url=l.cep_url?""+l.cep_url:""+c+CEP_URL,this.reportUrl=""+c+REPORT_URL,this.key=CEPKEY(l.app_id),this.quotasKey="__tea_cep_plan_quotas_"+this.config.app_id,this.configManager=n,this.hook=o,this.isWait=!1,this.eventCache=[],this.test=n.staging}return CepRule.prototype.init=function(){var l=this,n=!0,o=0,c=0,h=0,g=!1,b=this.storage.getItem(this.key)||{};if(b&&Object.keys(b).length&&(g=!0,o=b.last_update_time,h=b.fetch_interval,c=b.config_version||0,n=Date.now()-o>1e3*h),n){var y=this.configManager.get(),O=y.header,M=y.user;xhr(this.url,{header:O,user:M,local_time:Date.now(),config_version:c},function(G){G&&G.code===0?(b.fetch_interval=G.fetch_interval,b.data=G.data,b.last_update_time=Date.now(),b.config_version=G.config_version,l.clearQuotas(),l.initState(G.data),l.storage.setItem(l.key,b),G.data.forEach(function(le){l.event("__cep_sdk_onboard",le.plan_id)})):G.code!==304&&G.code!==400||!g?console.log("code: "+G.code+", request error\uFF0Cplease try leater"):(console.log("code: "+G.code+", use old rules~"),b.last_update_time=Date.now(),l.storage.setItem(l.key,b),l.initState(b.data))},function(){g?(l.planData=b.data,l.initState(b.data)):(l.support=!1,console.log("request error\uFF0Cplease try leater"))})}else b.last_update_time=Date.now(),this.storage.setItem(this.key,b),console.log("rule still work, use cache"),this.initState(b.data)},CepRule.prototype.initState=function(l){var n=this;l&&l.length&&(this.stateArray=new Map,this.waitArray=new Map,this.planData=l,l.forEach(function(o){var c=new Map;if(o.pattern&&o.pattern.events){var h=o.pattern.events.length===1;o.pattern.events.forEach(function(g){c.set(g.id,{id:g.id,isMatch:!1,event:null,after:g.after||null,connection:g.connection||null,window:g.window||null,matchTime:0,initTime:Date.now(),singleRule:h})}),n.stateArray.set(o.plan_id,{patternState:c,singleRule:h,pattern:{aid:o.aid,biz_id:o.biz_id,end_time:o.end_time,start_time:o.start_time,web_sdk_version:o.web_sdk_version,stage:o.stage},quotas:o.quotas})}}),this.cepReady=!0,this.dealCache(),console.log(this.stateArray))},CepRule.prototype.check=function(l){var n=Date.now();return Date.now()>1e3*l.end_time?(console.log("event rules:"+l.plan_id+" is over"),!1):n<1e3*l.start_time||n>1e3*l.end_time?(console.log("rule:"+l.plan_id+" time error"),!1):(this.staing=l.staing==="testing",!(SDK_VERSION<l.web_sdk_version)||(this.support=!1,console.log("you sdk version is old\uFF0Cplease update to "+l.web_sdk_version+" at least"),!1))},CepRule.prototype.dealCache=function(){var l=this;if(this.eventCache.length){var n=1;this.eventCache.forEach(function(o){l.matchEvent(o),n++}),n===this.eventCache.length&&(this.eventCache=[])}},CepRule.prototype.matchEvent=function(l){if(this.support&&(!this.staing||this.test)&&l&&l.length)try{if(!this.cepReady)return void this.eventCache.push(l);var n=l[0],o=n.header,c=n.user,h=n.events;h.length&&h.reverse();for(var g=0;g<h.length;g++){var b=h[g].event;if(ignoreList.indexOf(b)!==-1)return!1;this.matchRule(o,c,h[g])}}catch(y){return void console.log(y.message)}},CepRule.prototype.matchRule=function(l,n,o){try{for(var c=0;c<this.planData.length;c++){var h=this.planData[c],g=h.plan_id;if(this.check(h)&&this.checkQuotas(g)&&h.pattern&&h.pattern.events){for(var b=h.pattern.events,y=0;y<b.length;y++)if(this.rule(l,n,o,b[y].condition)){var O=this.stateArray.get(g).patternState,M=O.get(b[y].id);if(this.stateArray.get(g).singleRule){this.changeStatus(g,b[y].id,o),this.publish([o],g,b[y].id);break}if(!M.isMatch){M.after&&O.get(M.after).isMatch?this.changeStatus(g,b[y].id,o):M.after||this.changeStatus(g,b[y].id,o);break}}}}this.statusCheck()}catch(G){return void console.log(G.message)}},CepRule.prototype.changeStatus=function(l,n,o){var c=this.stateArray.get(l),h=c.patternState.get(n);h.isMatch=!0,h.event=o,h.matchTime=o.local_time_ms||Date.now(),c.patternState.set(n,h),this.stateArray.set(l,c)},CepRule.prototype.statusCheck=function(){var l,n,o,c;try{for(var h=__values(this.stateArray),g=h.next();!g.done;g=h.next()){var b=__read(g.value,2),y=b[0],O=b[1],M=O.patternState;if(O.isSingle)break;try{for(var G=__values(M),le=G.next();!le.done;le=G.next()){var Pe=__read(le.value,2),Ce=Pe[0],De=Pe[1];if(De.after&&(!De.after||M.get(De.after).isMatch)){if(De.connection==="NOT_FOLLOWED_BY"){De.isMatch?this.reset(y,Ce):Date.now()-M.get(De.after).matchTime>De.window?this.publish([M.get(De.after).event,De.event],y,Ce):this.startWait(y,Ce,De);break}De.isMatch?De.matchTime-M.get(De.after).matchTime<=De.window?this.publish([M.get(De.after).event,De.event],y,Ce):this.reset(y,Ce):Date.now()-M.get(De.after).matchTime>De.window?this.reset(y,Ce):this.startWait(y,Ce,De);break}}}catch(Ae){o={error:Ae}}finally{try{le&&!le.done&&(c=G.return)&&c.call(G)}finally{if(o)throw o.error}}}}catch(Ae){l={error:Ae}}finally{try{g&&!g.done&&(n=h.return)&&n.call(h)}finally{if(l)throw l.error}}},CepRule.prototype.startWait=function(l,n,o){var c=this;try{this.waitArray.get(l)||this.waitArray.set(l,new Map);var h=this.waitArray.get(l);if(!h.get(n)){var g=setTimeout(function(){var b=c.stateArray.get(l).patternState,y=b.get(n);if(y.connection==="NOT_FOLLOWED_BY")!y.isMatch&&b.get(y.after).isMatch||y.matchTime-b.get(y.after).matchTime>o.window?((O=c.waitArray.get(l).get(n)).triggerWait=!0,c.waitArray.set(l,c.waitArray.get(l).set(n,O)),c.publish([b.get(y.after).event],l,n)):c.reset(l,n);else if(y.connection==="FOLLOWED_BY"){var O;y.isMatch&&b.get(y.after).isMatch?((O=c.waitArray.get(l).get(n)).triggerWait=!0,c.waitArray.set(l,c.waitArray.get(l).set(n,O)),c.publish([b.get(y.after).event],l,n)):c.reset(l,n)}},o.window);h.set(n,{waitFn:g,triggerWait:!1}),this.waitArray.set(l,h)}}catch(b){console.log(b.message,b.stack)}},CepRule.prototype.rule=function(l,n,o,c){var h=this;try{var g=o.event,b=o.params;if(b=JSON.parse(b),moreOP.indexOf(c.op)!==-1){if(c.conditions&&c.conditions.length){var y=c.conditions,O=0,M=new Map;M.set(O,{op:c.op,result:void 0,resultList:[],resultKey:[],resultLength:y.length}),function ge(Te,ce){for(var x=0;x<Te.length;x++)if(O++,moreOP.indexOf(Te[x].op)!==-1&&Te[x].hasOwnProperty("conditions"))M.set(O,{op:Te[x].op,result:void 0,fatherKey:ce,resultList:[],resultKey:[],resultLength:Te[x].conditions.length}),ge(Te[x].conditions,O);else{var P=h.scope(Te[x].key),$=P.scope,he=P.key,ye=P.key2,Re=$?$==="header"?ye?JSON.parse(l[ye])[he]:l[he]:$==="user"?n[he]:b[he]:g,He=h.calculate(Te[x].op,Re,Te[x].value);M.set(O,{op:Te[x].op,result:He,fatherKey:ce})}}(y,O);for(var G=M.get(0);G.result===void 0||G.resultList.length<G.resultLength;)M.forEach(function(ge,Te){if(ge.result!==void 0&&ge.fatherKey!==void 0){var ce=M.get(ge.fatherKey);ce.resultList.length<ce.resultLength&&ce.resultKey.indexOf(Te)===-1&&(ce.resultKey.push(Te),ce.resultList.push(ge.result),M.set(ge.fatherKey,ce))}}),M.forEach(function(ge){ge.resultList&&ge.resultList.length===ge.resultLength&&(ge.op==="and"&&(ge.result=ge.resultList.indexOf(!1)===-1),ge.op==="or"&&(ge.result=ge.resultList.indexOf(!0)!==-1))});return M.get(0).result}return!1}var le=this.scope(c.key),Pe=le.scope,Ce=le.key,De=le.key2,Ae=Pe?Pe==="header"?De?JSON.parse(l[De])[Ce]:l[Ce]:Pe==="user"?n[Ce]:b[Ce]:g;return this.calculate(c.op,Ae,c.value)}catch(ge){return console.log(ge.message),!1}},CepRule.prototype.publish=function(l,n,o){try{var c=this.configManager.get().user,h={biz_id:this.stateArray.get(n).pattern.biz_id,plan_id:n,uid:c.user_id||"",did:c.device_id||"",uuid:c.user_unique_id,events:l,extra:{url:window.location.href}};this.hook.emit("__cep_match",h),(window.opener||window.parent).postMessage({type:"__cep_match",data:h},"*"),this.event("__cep_trigger_sdk",n),this.addQuotas(n),this.reset(n,o),console.log(this.stateArray)}catch(g){return void console.log(g.message)}},CepRule.prototype.addQuotas=function(l){var n=this.stateArray.get(l).quotas;if(n&&n.length){var o=this.storage.getItem(this.quotasKey)||{};o[l]||(o[l]={value:0,lastTime:Date.now()});var c=o[l].value;c===0&&(o[l].lastTime=Date.now()),o[l].value=c+1,this.storage.setItem(this.quotasKey,o)}},CepRule.prototype.checkQuotas=function(l){var n=this.stateArray.get(l).quotas,o=this.storage.getItem(this.quotasKey)||{};if(o[l]||(o[l]={value:0,lastTime:Date.now()}),n&&n.length){var c=n[0].granularity,h=n[0].value;if(n[0].type!=="per_keyid")return!0;var g=this.release(c);return g==="all"?!(o[l].value>=h)||(console.log("plan:"+l+" \u8FBE\u5230\u89E6\u53D1\u4E0A\u9650\u4E86, \u672C\u6B21\u4E0D\u518D\u89E6\u53D1"),!1):Date.now()-o[l].lastTime>=g?(o[l].value=0,o[l].lastTime=Date.now(),this.storage.setItem(this.quotasKey,o),!0):!(o[l].value>=h)||(console.log("plan:"+l+" \u8FBE\u5230\u89E6\u53D1\u4E0A\u9650\u4E86~\uFF0C \u672C\u6B21\u4E0D\u518D\u89E6\u53D1"),!1)}return!0},CepRule.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},CepRule.prototype.release=function(l){if(l==="all")return l;var n=dayjs_min.duration(l);return n?n.asMilliseconds():"all"},CepRule.prototype.reset=function(l,n){var o=this.stateArray.get(l);if(o.singleRule){var c=o.patternState.get(n);c.isMatch=!1,c.event=null,c.matchTime=0,c.initTime=Date.now(),o.patternState.set(n,c)}else o.patternState.forEach(function(g){g.isMatch=!1,g.event=null,g.matchTime=0,g.initTime=Date.now()});this.stateArray.set(l,o);var h=this.waitArray.get(l);h&&h.get(n)&&(clearTimeout(h.get(n).waitFn),h.delete(n))},CepRule.prototype.event=function(l,n){try{var o={event:l,params:JSON.stringify({plan_id:n||"",biz_id:this.stateArray.get(n).pattern.biz_id}),local_time_ms:Date.now()},c=this.configManager.get(),h=c.header,g=c.user;h.custom=JSON.stringify(h.custom);var b={events:[o],user:g,header:h};xhr(this.reportUrl,[b])}catch(y){return void console.log(y.message)}},CepRule.prototype.scope=function(l){var n="",o="";if(l.indexOf(".")>-1){var c=l.split(".");n=c[0],l=c[1],n==="header"&&l==="custom"&&(l=c[2],o=c[1])}return{scope:n,key:l,key2:o}},CepRule.prototype.calculate=function(op,paramA,paramB){try{if(op==="=")return paramA===paramB;if(["=","<",">",">=","<=","!="].indexOf(op)!==-1)return eval(""+paramA+op+paramB);if(["in","contains"].indexOf(op)!==-1)return paramB.indexOf(paramA)!==-1;if(["is not null","is null"].indexOf(op)!==-1)return op==="is null"?paramA==null:paramA!=null;if(["startswith","endswith"].indexOf(op)!==-1){if(op==="startswith")return paramA.indexOf(paramB)===0;var start=paramA.length-paramB.length,str=paramA.substr(start,paramB.length);return str===paramB}}catch(l){return console.log(l.message),!1}},CepRule}();function isNeedElement(l,n){if(n===void 0&&(n="list"),!l)return!1;if(n&&n==="list"){if(["LI","TR","DL"].includes(l.nodeName)||l.dataset&&l.dataset.hasOwnProperty("teaIdx")||l.hasAttribute&&l.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(l.nodeName)||l.dataset&&l.dataset.hasOwnProperty("teaContainer")||l.hasAttribute&&l.hasAttribute("data-tea-container"))return!0;return!1}function getContainer(l){for(var n=l;n&&!isNeedElement(n,"container");){if(n.nodeName==="HTML"||n.nodeName==="BODY")return l;n=n.parentElement}return n||l}function getNodeText(l){var n="";return l.nodeType===3?n=l.textContent.trim():l.dataset&&l.dataset.hasOwnProperty("teaTitle")||l.hasAttribute("ata-tea-title")?n=l.getAttribute("data-tea-title"):l.hasAttribute("title")?n=l.getAttribute("title"):l.nodeName==="INPUT"&&["button","submit"].includes(l.getAttribute("type"))?n=l.getAttribute("value"):l.nodeName==="IMG"&&l.getAttribute("alt")&&(n=l.getAttribute("alt")),n.slice(0,200)}function getText(l){var n=getContainer(l),o=[];return function c(h){var g=getNodeText(h);if(g&&o.indexOf(g)===-1&&o.push(g),h.childNodes.length>0)for(var b=h.childNodes,y=0;y<b.length;y++)b[y].nodeType!==8&&c(b[y])}(n),o}function getTextSingle(l){var n=getContainer(l),o="";return function c(h){var g=getNodeText(h);if(g&&(o+=g),h.childNodes.length>0)for(var b=h.childNodes,y=0;y<b.length;y++)b[y].nodeType===3&&c(b[y])}(n),o}function ignore(l){for(var n=l;n&&n.parentNode;){if(n.hasAttribute("data-tea-ignore"))return!0;if(n.nodeName==="HTML"||n.nodeName==="body")return!1;n=n.parentNode}return!1}var elementLevel=function(l){if(l.children.length){var n=l.children;return![].slice.call(n).some(function(o){return o.children.length>0})}return!0},isSVG=function(l){if(l.tagName.toLowerCase()==="svg")return!0;for(var n=l.parentElement,o=!1;n;)n.tagName.toLowerCase()==="svg"?(n=null,o=!0):n=n.parentElement;return o};function isTrack(l,n){if(window.innerHeight,window.innerWidth,l.nodeType!==1||!n.svg&&isSVG(l)||["HTML","BODY"].includes(l.tagName.toUpperCase()))return!1;var o=l;return o.style.display!=="none"&&(!!isNeedElement(o,"container")||!!elementLevel(o))}var Listener=function(){function l(n,o,c){var h=this;this.clickEvent=function(g){isTrack(g.target,h.options)&&h.eventHandel({eventType:"dom",eventName:"click"},g)},this.changeEvent=function(g){h.eventHandel({eventType:"dom",eventName:"change"},g)},this.submitEvent=function(g){h.eventHandel({eventType:"dom",eventName:"submit"},g)},this.getPageViewEvent=function(g,b){h.eventHandel({eventType:"dom",eventName:"beat"},__assign({beat_type:0},g)),h.eventHandel({eventType:"dom",eventName:"page_view"},g)},this.getPageLoadEvent=function(g){h.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:g})},this.config=o.getConfig().eventConfig,this.options=n,this.beatTime=n.beat,this.statistics=!1,this.route=c}return l.prototype.init=function(n){this.eventHandel=n;var o=this.config.mode;this.addListener(o)},l.prototype.addListener=function(n){var o=this;if(n==="proxy-capturing"&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&this.route.init("autotrack",this.getPageViewEvent),this.config.beat)){try{document.readyState==="complete"?this.beatEvent(this.beatTime):window.addEventListener("load",function(){o.beatEvent(o.beatTime)});var c=0,h=null;window.addEventListener("scroll",function(){clearTimeout(h),h=setTimeout(g,500),c=document.documentElement.scrollTop||document.body.scrollTop});var g=function(){(document.documentElement.scrollTop||document.body.scrollTop)==c&&o.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(y){}try{var b=window.performance&&window.performance.getEntriesByType("paint");b&&b.length?(new PerformanceObserver(function(y){var O=y.getEntries(),M=O[O.length-1],G=M.renderTime||M.loadTime;o.statistics||(o.getPageLoadEvent(G),o.statistics=!0)}).observe({entryTypes:["largest-contentful-paint"]}),setTimeout(function(){o.statistics||(o.getPageLoadEvent(b[0].startTime||0),o.statistics=!0)},2e3)):this.getPageLoadEvent(0)}catch(y){this.getPageLoadEvent(0)}}},l.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},l.prototype.beatEvent=function(n){var o=this;try{var c;this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3}),this.beatTime&&(c=setInterval(function(){o.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},n)),beforePageUnload(function(){o.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),o.beatTime&&clearInterval(c)})}catch(h){}},l}(),defaultConfig={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Config=function(){function l(n){this.config=n}return l.prototype.getConfig=function(){return this.config},l.prototype.setConfig=function(n){return this.config=n},l}();function getPositionData(l){if(l){var n=l.getBoundingClientRect(),o=n.width,c=n.height;return{left:n.left,top:n.top,element_width:o,element_height:c}}}function getEventData(l,n){l===void 0&&(l={}),n===void 0&&(n={});var o=l.clientX,c=l.clientY,h=n.left,g=n.top,b=o-h>=0?o-h:0,y=c-g>=0?c-g:0;return{touch_x:Math.floor(b),touch_y:Math.floor(y)}}function getXpath(l){for(var n=[];l.parentElement!==null;)n.push(l),l=l.parentElement;var o=[],c=[];return n.forEach(function(h){var g=getXpathIndex(h),b=g.str,y=g.index;o.unshift(b),c.unshift(y)}),{element_path:"/"+o.join("/"),positions:c}}function getXpathIndex(l){if(l===null)return{str:"",index:0};var n=0,o=l.parentElement;if(o)for(var c=o.children,h=0;h<c.length&&c[h]!==l;h++)c[h].nodeName===l.nodeName&&n++;return{str:[l.nodeName.toLowerCase(),isNeedElement(l,"list")?"[]":""].join(""),index:n}}function getElementData(l,n,o){var c={element_path:"",positions:[],texts:[]},h=getPositionData(n),g=getEventData(l,h),b=h.element_width,y=h.element_height,O=g.touch_x,M=g.touch_y,G=getXpath(n),le=G.element_path,Pe=G.positions,Ce=getText(n),De=window.performance.timing.navigationStart,Ae=Date.now()-De,ge=Pe.map(function(x){return""+x}),Te=null;window.TEAVisualEditor.getOriginXpath&&(Te=window.TEAVisualEditor.getOriginXpath({xpath:le,positions:ge})),c.element_path=Te&&Te.xpath||le,c.positions=Te&&Te.positions||ge,o&&!o.text&&(c.texts=Ce,c.element_title=getTextSingle(n)),c.element_width=Math.floor(b),c.element_height=Math.floor(y),c.touch_x=O,c.touch_y=M,c.page_manual_key="",c.elememt_manual_key="",c.since_page_start_ms=Ae,c.page_start_ms=De;var ce=getContainer(n);return ce.tagName==="A"&&(c.href=ce.getAttribute("href")),n.tagName==="IMG"&&(c.src=n.getAttribute("src")),c}function getEventData$1(l,n,o,c){return __assign({event:l},getElementData(n,o,c),{is_html:1,page_key:window.location.href,page_title:document.title})}function getExtraEventData(l,n){try{if(l==="bav2b_change")return n.hasAttribute("data-tea-track")?{value:n.value}:{}}catch(o){return{}}}var EventHandle=function(){function l(n){this.ignore={text:!1},this.eventName=n&&n.custom==="tea"?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics"},n&&n.text===!1&&(this.ignore.text=!0)}return l.prototype.handleEvent=function(n,o){try{if(ignore(n.target))return null;var c="bav2b_click";switch(o){case"click":return getEventData$1(c=this.eventName.click,n,n.target,this.ignore);case"change":return __assign({},getEventData$1(c="bav2b_change",n,n.target),getExtraEventData(c,n.target));case"submit":return getEventData$1(c="bav2b_submit",n,n.target)}}catch(h){return console.error(h),null}},l.prototype.handleViewEvent=function(n){n.event=this.eventName.page,n.page_title=document.title,n.page_total_width=window.innerWidth,n.page_total_height=window.innerHeight;try{var o=window.sessionStorage.getItem("_tea_cache_duration");if(o){var c=JSON.parse(o);n.refer_page_duration_ms=c?c.duration:"",n.refer_page_title=c?c.page_title:""}else n.refer_page_duration_ms="",n.refer_page_title="";n.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,n.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,n.page_start_ms=window.performance.timing.navigationStart}catch(h){console.log("page event error "+JSON.stringify(h))}return n},l.prototype.handleStatisticsEvent=function(n){var o={};o.event=this.eventName.static,o.is_html=1,o.page_key=location.href,o.refer_page_key=document.referrer||"",o.page_title=document.title,o.page_manual_key="",o.refer_page_manual_key="";try{var c=n.lcp,h=window.performance.timing,g=h.loadEventEnd-h.navigationStart;o.page_init_cost_ms=parseInt(c||(g>0?g:0)),o.page_start_ms=h.navigationStart}catch(b){console.log("page_statistics event error "+JSON.stringify(b))}return o},l.prototype.handleBeadtEvent=function(n){n.event=this.eventName.beat,n.is_html=1,n.page_title=document.title,n.page_manual_key="";try{n.page_total_width=document.documentElement.scrollWidth,n.page_total_height=document.documentElement.scrollHeight,n.scroll_width=document.documentElement.scrollLeft+window.innerWidth,n.scroll_height=document.documentElement.scrollTop+window.innerHeight,n.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,n.page_start_ms=window.performance.timing.navigationStart}catch(o){console.log("beat event error "+JSON.stringify(o))}return n},l}(),Request=function(){function l(n,o){this.logFunc=n,this.logFuncBecon=o,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return l.prototype.send=function(n,o){n.eventName;var c=n.eventSend,h=o.event;delete o.event,c&&c==="becon"?this.logFuncBecon(h,o,"autotrack"):this.logFunc(h,o,"autotrack")},l.prototype.get=function(n,o){var c=Object.assign({headers:{"content-type":"application/json"},method:"GET"},o);fetch(n,c)},l.prototype.post=function(n,o){var c=Object.assign({headers:{"content-type":"application/json"},method:"POST"},o);fetch(n,c)},l}(),COOKIE_KEY="_TEA_VE_OPEN",COOKIE_KEY_HOST="_TEA_VE_APIHOST",COOKIE_LANG="lang",COOKIE_EDIT_VERISON="_VISUAL_EDITOR_V",COOKIE_EDIT_URL="_VISUAL_EDITOR_U";function checkSession(){return js_cookie.get(COOKIE_KEY)==="1"}function checkSessionHost(){var l=js_cookie.get(COOKIE_KEY_HOST);try{l=JSON.parse(l)}catch(n){}return l}function checkEditUrl(){return js_cookie.get(COOKIE_EDIT_URL)}function setSession(){try{var l=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||js_cookie.get(COOKIE_LANG),n=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||js_cookie.get(COOKIE_KEY_HOST),o=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||js_cookie.get(COOKIE_EDIT_VERISON),c=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||js_cookie.get(COOKIE_EDIT_URL),h=+new Date,g=new Date(h+18e5);js_cookie.set(COOKIE_KEY,"1",{expires:g}),js_cookie.set(COOKIE_KEY_HOST,n,{expires:g}),js_cookie.set(COOKIE_EDIT_URL,c,{expires:g}),js_cookie.set(COOKIE_LANG,l,{expires:g}),js_cookie.set(COOKIE_EDIT_VERISON,o||"",{expires:g})}catch(b){console.log("set cookie err")}}window.TEAVisualEditor=window.TEAVisualEditor||{};var EDITOR_URL="",EDITOR_URL_OLD=window.TEAVisualEditor.__editor_url||decodeUrl(EDITOR_URL_OLD_ASC);EDITOR_URL_OLD=EDITOR_URL_OLD+"?query="+Date.now();var EDITOR_URL_NEW=decodeUrl(EDITOR_URL_NEW_ASC)+"?query="+Date.now(),isLoaded$1=!1;function loadEditorScript$1(l){var n=l.event,o=l.editorUrl,c=l.autoTrackInstance;l.fromSession,isLoaded$1||(isLoaded$1=!0,loadScript(o,function(){dispatchMsg(n,"editorScriptloadSuccess"),c.destroy()},function(){n&&dispatchMsg(n,"editorScriptloadError"),isLoaded$1=!1}))}function readyToLoadEditor$1(l,n){window.TEAVisualEditor.appId=n.app_id;var o=n.channel_domain,c="";if(addAllowdOrigin(["*"]),o){var h,g="";try{var b=window.performance.getEntriesByType("resource");if(b&&b.length&&(b.forEach(function(M){M.initiatorType==="script"&&M.name&&M.name.indexOf("collect")!==-1&&(g=M.name)}),g||document.currentScript&&(g=document.currentScript.src),g&&(h=g.split("/"))&&h.length)){c="https:/";for(var y=2;y<h.length&&y!==h.length-1;y++)c=c+"/"+h[y];c+="/visual-editor-rangers"}}catch(M){}}if(init(n,SDK_VERSION),checkSession()){var O=checkSessionHost();O?(window.TEAVisualEditor.__editor_ajax_domain=O,loadEditorScript$1({event:null,editorUrl:checkEditUrl()||EDITOR_URL_NEW,autoTrackInstance:l,fromSession:!1})):loadEditorScript$1({event:null,editorUrl:EDITOR_URL_OLD,autoTrackInstance:l,fromSession:!1}),setSession()}else try{receiveMsg("tea:openVisualEditor",function(M){var G=M.data;if(typeof M.data=="string")try{G=JSON.parse(M.data)}catch(De){G=void 0}if(G){var le=G.referrer,Pe=G.lang;if(le?(window.TEAVisualEditor.__editor_ajax_domain=le,EDITOR_URL=EDITOR_URL_NEW):EDITOR_URL=EDITOR_URL_OLD,o){var Ce=G.version;EDITOR_URL=c?""+c+(Ce?"-v"+Ce:"-v1.0.0")+".js":EDITOR_URL_NEW,window.TEAVisualEditor.__editor_verison=Ce}window.TEAVisualEditor.__editor_url=EDITOR_URL,window.TEAVisualEditor.lang=Pe,loadEditorScript$1({event:M,editorUrl:EDITOR_URL,autoTrackInstance:l}),setSession()}}),window.TEAVisualEditor.openAutotrackEditor=function(){loadEditorScript$1({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:l})}}catch(M){console.log("receive message error")}try{receiveMsg("tea:openHeatMapCore",function(M){loadEditorScript$1({event:M,editorUrl:decodeUrl(HOT_PIC_URL)+".js?query="+Date.now(),autoTrackInstance:l})})}catch(M){console.log("openHeatMapCore error")}}var defaultOpt={hashTag:!1,impr:!1},AutoTrack=function(){function l(){this.autoTrackStart=!1}return l.prototype.start=function(n,o,c,h){o=Object.assign(defaultOpt,o),this.destroyed=!1,this.options=o,this.logFunc=n,this.logFuncBecon=c,this.Config=new Config(defaultConfig),this.Listener=new Listener(o,this.Config,h),this.EventHandle=new EventHandle(o),this.Request=new Request(this.logFunc,this.logFuncBecon),this.autoTrackStart=!0,this.init()},l.prototype.init=function(){this.Listener.init(this.handle.bind(this))},l.prototype.handle=function(n,o){n.eventType==="dom"&&this.handleDom(n,o)},l.prototype.handleDom=function(n,o){try{var c=n.eventName;if(c==="click"||c==="change"||c==="submit"){var h=this.EventHandle.handleEvent(o,c);h!==null&&this.Request.send({eventType:"custom",eventName:"report_"+c+"_event",extra:{methods:"GET"}},h)}else if(c==="page_view"||c==="page_statistics"){var g=void 0;g=c==="page_view"?this.EventHandle.handleViewEvent(o):this.EventHandle.handleStatisticsEvent(o),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},g)}else if(c==="beat"){var b=this.EventHandle.handleBeadtEvent(o),y=n.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:y},b)}}catch(O){console.log("handel dom event error "+JSON.stringify(O))}},l.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},l}(),exportAutoTrack=function(l,n,o,c){var h=new AutoTrack,g=l.autotrack;if(g){var b={};typeof g=="object"&&(b=g),h.start(n,b,o,c),readyToLoadEditor$1(h,l)}else h.autoTrackStart&&h.destroy();return null},exportMethods=["profileSet","profileSetOnce","profileIncrement","profileUnset","profileAppend","getVar","getAbSdkVersion","onAbSdkVersionChange","offAbSdkVersionChange","getABconfig","openOverlayer","closeOverlayer","getAllVars","setExternalAbVersion","getToken","destroy"],Methods=__spread(["init","config","send","start","predefinePageView","beconEvent","on","clearEventCache","resetStayDuration","autoInitializationRangers","setWebIDviaUnionID","setWebIDviaOpenID","filterEvent"],exportMethods),getIndex=(lastEventId=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return lastEventId+=1}),lastEventId,Collector=function(){function l(n){var o=this;this.is_first_time=!1,this.Native=!1,this.staging=!1,this.sdkload=!1,this.initPv=!0,this.predefinePageView=function(c,h){if(c===void 0&&(c={}),o.sdkload){var g={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+o.is_first_time},b=__assign({},g,c);h?o.beconEvent("predefine_pageview",b,"pv"):o.event("predefine_pageview",b,"pv")}else o.logger.warn("sdk init error, api can not call")},this.getToken=function(c,h){if(!o.sdkload)return o.logger.warn("sdk init error, api can not call, getToken will return {}"),void c({});var g=!1,b=function(y){if(!g){g=!0;var O=o._config.get().user;return y&&(O.tobid=y),c(__assign({},O))}};h&&setTimeout(function(){b()},h);try{o._token._getTobId(function(y){b(y)})}catch(y){b()}},this.name=n,this._isSend=!1,this.hook=new Hook,this.storage=new Storage(!1)}return l.prototype.autoInitializationRangers=function(n){},l.prototype.init=function(n){var o=this;if(!this._inited)if(this._inited=!0,n&&typeof n=="object"){this.logger=new Logger(this.name,n.log);var c=n.app_id,h=n.app_key;h||c?c&&typeof c!="number"?this.logger.warn("app_id param is error, must be number, please check !!!"):h&&typeof h!="string"?this.logger.warn("app_key is empty, please check!"):(n.channel_domain||["cn","sg","va"].indexOf(n.channel)!==-1||(this.logger.warn("channel must be `cn`, `sg`,`va` !!!"),n.channel="cn"),this.Native=n.Native,this._initConfig=n,this.appBridge=new AppBridge(this.logger),this.storage.getItem("__tea_cache_first_"+c)?this.is_first_time=!1:(this.is_first_time=!0,this.storage.setItem("__tea_cache_first_"+c,"1")),this.sdkload=!0,n.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(g){g||o._init(n)}):this._init(n)):this.logger.warn("no app_key or app_id please check !!!")}else console.warn("init params is error,please check")},l.prototype._init=function(n){var o=this;this.autoPV=!0,this.sdkload=!0,this._initConfig=n,this._config=new ConfigManager(n.app_id,n,n.configPersist||0),this.configPersist=n.configPersist||0,this._config.set("app_id",n.app_id),this.hook.on("token-ready",function(){o.callbackSend?o._isSend?o._event&&o._event.report():o.start():o._event&&o._event.report()}),this._session=new Session(n.app_key||n.app_id,n),this._token=new Token(n,this._config,this.hook,this._session),this.plugin=new Plugin(this,n,this.event.bind(this),this.beconEvent.bind(this),this.hook),n.cep&&(this.match=new CepRule(n,this._config,this.hook)),this._event=new EventManager(this,n,this._config,this._token,this.plugin,this._session,this.match),this.tracer=new Tracer(this,n,this._processEvent.bind(this),this._event),this.spaView=new Ruote(n),this._token._getToken();try{n.autotrack&&exportAutoTrack(n,this.event.bind(this),this.beconEvent.bind(this),this.spaView)}catch(c){console.log("e")}},l.prototype.config=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){if(c)for(var h in n)h==="user_unique_id"?o.appBridge.setUserUniqueId(n[h]):n[h]?o.appBridge.addHeaderInfo(h,n[h]):o.appBridge.removeHeaderInfo(h);else o._setConfig(n)}):this._setConfig(n):this.logger.warn("sdk init error, api can not call")},l.prototype._setConfig=function(n){if(this._inited)if(n&&typeof n=="object"){n.disable_auto_pv&&(this.autoPV=!1,delete n.disable_auto_pv),n._staging_flag&&n._staging_flag===1&&(this.staging=!0);var o=__assign({},n);if(this.configPersist){var c=this._config.getStore();c&&(o=Object.assign(c,n)),this._config.setStore(n)}for(var h in o)h!=="user_unique_id"?h!=="web_id"?this._config.set(h,o[h]):this._token._setWebid(o[h]):this._token._setUuid(o[h])}else this.logger.warn("config params is error, please check");else this.logger.warn("config must be use after function init")},l.prototype.on=function(n,o){try{n&&typeof n=="string"&&typeof o=="function"&&this.hook.on(n,o)}catch(c){}},l.prototype.send=function(){this.start()},l.prototype.start=function(){var n=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(o){o?(n.logger.info("jsbrige\u5F00\u542F\uFF0C\u4E8B\u4EF6\u5C06\u7531\u539F\u751F sdk\u8FDB\u884C\u4E0A\u62A5"),n.predefinePageView()):n._start()}):this._start():this.logger.warn("sdk init error, api can not call")},l.prototype._start=function(){var n=this;if(this._token.isTokenReady()){if(this._isSend)return void this.logger.warn("method start can not be use over one time , please check !!");this._isSend=!0,this.logger.info("userInfo:"+JSON.stringify(this._config.get("user"))),this.logger.info("sdk is ready,version is "+SDK_VERSION+". you can report now !!!"),this.match&&this.match.init(),this._event.setReady(),this.autoPV&&(this.predefinePageView(),this.initPv=!1),this._initConfig.spa&&this.spaView.add("spa",this.predefinePageView),this.hook.on("token-change",function(o){n.initPv||o!=="webid"||n._initConfig.enable_custom_webid||n.predefinePageView({},!0),n.logger.info("token change, new userinfo:"+JSON.stringify(n._config.get("user"))),o==="uuid"&&n.plugin&&n.plugin.ab&&n.plugin.ab.refetch()});try{(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(o){}this.profile=new Profile(this._processEvent.bind(this),this._event,this._initConfig),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},l.prototype.beconEvent=function(n,o,c){var h=this;o===void 0&&(o={});var g=c||"log",b=[];b.push([n,o]),b=b.map(function(y){return h._processEvent(y[0],y[1])}),this._dealEvent(!0,b,g),this._addTracerCount(g)},l.prototype.event=function(){for(var n=this,o=[],c=0;c<arguments.length;c++)o[c]=arguments[c];if(this.sdkload){var h=__read(o,1)[0],g=[];Object.prototype.toString.call(h).slice(8,-1)!=="Array"?g[0]=o:g=o,g=g.map(function(b){return n._processEvent(b[0],b[1])}),this._dealEvent(!1,g,"log"),this._addTracerCount("log")}else this.logger.warn("sdk init error, api can not call")},l.prototype._dealEvent=function(n,o,c){var h=this;if(this.sdkload)if(this.Native&&this.appBridge.bridgeInject()){if(c==="autotrack"||c==="sdk")return;this.appBridge.hasStarted(function(g){g?o&&o.length&&o.forEach(function(b){var y=b.event,O=b.params;h.appBridge.onEventV3(y,JSON.stringify(O))}):h._commonEvent(n,o)})}else this._commonEvent(n,o);else this.logger.warn("sdk init error, api can not call")},l.prototype._commonEvent=function(n,o){n?this._event.beconEvent(o):this._event.event(o),this._session._updateSessionId(),this.plugin&&this.plugin.session&&this.plugin.session.process()},l.prototype._addTracerCount=function(n){this.sdkload?this.Native||this.staging||this.tracer.addCount(n):this.logger.warn("sdk init error, api can not call")},l.prototype._processEvent=function(n,o){try{var c=n;/^event\./.test(n)&&(c=n.slice(6));var h,g=o;return typeof g!="object"&&(g={}),g.profile?delete g.profile:g.event_index=getIndex(),g.local_ms?(h=g.local_ms,delete g.local_ms):h=+new Date,{event:c,params:g,local_time_ms:h,is_bav:this._initConfig.autotrack?1:0}}catch(b){return{event:n,params:o}}},l.prototype.filterEvent=function(n){this.eventFilter=n},l.prototype.clearEventCache=function(){this._event.clearEventCache()},l.prototype.setWebIDviaUnionID=function(n){if(n){var o=hashCode(n);this.config({web_id:""+o,wechat_unionid:n}),this.hook.emit("custom-webid")}},l.prototype.setWebIDviaOpenID=function(n){if(n){var o=hashCode(n);this.config({web_id:""+o,wechat_openid:n}),this.hook.emit("custom-webid")}},l.prototype.resetStayDuration=function(n,o,c){this.sdkload?this.plugin.stay?this.plugin.stay&&this.plugin.stay.reset(n,o,c):this.logger.info("stayDuration is not init"):this.logger.warn("sdk init error, api can not call")},l.prototype.profileSet=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){c?o.appBridge.profileSet(JSON.stringify(n)):o.profile&&o.profile.setProfile(n)}):this.profile&&this.profile.setProfile(n):this.logger.warn("sdk init error, api can not call")},l.prototype.profileSetOnce=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){c?o.appBridge.profileSetOnce(JSON.stringify(n)):o.profile&&o.profile.setOnceProfile(n)}):this.profile&&this.profile.setOnceProfile(n):this.logger.warn("sdk init error, api can not call")},l.prototype.profileIncrement=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){c?o.appBridge.profileIncrement(JSON.stringify(n)):o.profile&&o.profile.incrementProfile(n)}):this.profile&&this.profile.incrementProfile(n):this.logger.warn("sdk init error, api can not call")},l.prototype.profileUnset=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){c?o.appBridge.profileUnset(n):o.profile&&o.profile.unsetProfile(n)}):this.profile&&this.profile.unsetProfile(n):this.logger.warn("sdk init error, api can not call")},l.prototype.profileAppend=function(n){var o=this;this.sdkload?this.Native&&this.appBridge.bridgeInject()?this.appBridge.hasStarted(function(c){c?o.appBridge.profileAppend(JSON.stringify(n)):o.profile&&o.profile.appendProfile(n)}):this.profile&&this.profile.appendProfile(n):this.logger.warn("sdk init error, api can not call")},l.prototype.setExternalAbVersion=function(n){this.sdkload?n&&this.plugin.ab&&this.plugin.ab._setAbVersion(n):this.logger.warn("sdk init error, api can not call")},l.prototype.getVar=function(n,o,c){var h=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getVar return default value"),void c(o);this.hook.on("token-error",function(){h.logger.warn("sdk init error, getVar return default value"),c(o)}),this.plugin.ab&&this.plugin.ab.getVar(n,o,c)},l.prototype.getABconfig=function(n,o){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getABconfig return null"),void o(null);this.plugin.ab&&this.plugin.ab._getABconfig(n,o)},l.prototype.getAbSdkVersion=function(n){if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAbSdkVersion return null"),void n(null);this.plugin.ab&&this.plugin.ab.getAbSdkVersion(n)},l.prototype.onAbSdkVersionChange=function(n){this.sdkload?this.hook.on("onAbSdkVersionChange",n):this.logger.warn("sdk init error, api can not call")},l.prototype.offAbSdkVersionChange=function(n){this.sdkload?n?this.hook.off("onAbSdkVersionChange",n):this.hook.off("onAbSdkVersionChange"):this.logger.warn("sdk init error, api can not call")},l.prototype.openOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.openOverlayer():this.logger.warn("sdk init error, api can not call")},l.prototype.closeOverlayer=function(){this.sdkload?this.plugin.ab&&this.plugin.ab.closeOverlayer():this.logger.warn("sdk init error, api can not call")},l.prototype.getAllVars=function(n){var o=this;if(!this.sdkload)return this.logger.warn("sdk init error, api can not call, getAllVars return null"),void n(null);this.hook.on("token-error",function(){o.logger.warn("sdk init error, getallVar return null"),n(null)}),this.plugin.ab&&this.plugin.ab.getAllVars(n)},l.prototype.destroy=function(){this.destroyInstance||(this.destroyInstance=!0,this.hook.off("token-ready"))},l}();function _defineProperty(l,n,o){return n in l?Object.defineProperty(l,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):l[n]=o,l}var CollectAsync=function(l){var n=this;return _defineProperty(this,"_exportCollect",function(){for(var o=arguments.length,c=new Array(o),h=0;h<o;h++)c[h]=arguments[h];n._isProcess?n._executeCmd.apply(n,c):(n.cmdQueue.push(c),n._processCmd())}),_defineProperty(this,"_processCmd",function(){if(n.cmdQueue.length!==0){var o,c,h,g,b;c=n.cmdQueue,h="init",g="0",b=-1,c.forEach(function(y,O){(g!==void 0?y[g]:y)===h&&(b=O)}),(o=b)!==-1&&(n._isProcess=!0,n._executeCmd.apply(n,n.cmdQueue[o]),n.cmdQueue.forEach(function(y,O){O!==o&&n._executeCmd.apply(n,y)}),n.cmdQueue=[])}}),_defineProperty(this,"_executeCmd",function(){for(var o=arguments.length,c=new Array(o),h=0;h<o;h++)c[h]=arguments[h];var g,b,y=c[0];Methods.indexOf(y)>-1?(g=n.colloctor)[y].apply(g,c.slice(1)):(b=n.colloctor).event.apply(b,c)}),this.cmdQueue=[],this.name=l,this.colloctor=new Collector(l),this._isProcess=!1,this._alias={},this._processCmd(),Methods.forEach(function(o){n._exportCollect[o]=n._exportCollect.bind(n,o)}),this._exportCollect},insMap={},CmdMap={},getInstance=function(l){return insMap[l]||(insMap[l]=new CollectAsync(l)),insMap[l]},getCmdArray=function(l){return CmdMap[l]||(CmdMap[l]=[]),CmdMap[l]},processCmdArray=function(l){try{var n=__read(l),o=n[0],c=n.slice(1);if(!o)return void console.error("the eventName is: "+o+", error, stop report, please check");var h=o.split(".");if(h.length===1)getCmdArray("default").push(__spread([o],c));else if(h.length===2)h[0]==="event"?getCmdArray("default").push(__spread([o],c)):getCmdArray(h[0]).push(__spread([h[1]],c));else{var g=h[0],b=[h[1],h[2]].join(".");getCmdArray(g).push(__spread([b],c))}}catch(y){console.log(y)}},processCmd=function(){defaultClient.q.forEach(function(l){var n=[].slice.call(l);Object.prototype.toString.call(n[0]).slice(8,-1)==="Array"?n.forEach(function(o){processCmdArray(o)}):processCmdArray(n)}),Object.keys(CmdMap).forEach(function(l){CmdMap[l].forEach(function(n){getInstance(l).apply(void 0,__spread(n))}),CmdMap[l]=[]}),defaultClient.q=[]},defaultClient=function l(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];l.q.push(n),processCmd()};defaultClient.q=[],defaultClient.l=Date.now(),defaultClient._instanceMap=insMap,defaultClient._instanceCmdMap=CmdMap,Methods.forEach(function(l){defaultClient[l]=defaultClient.bind(null,l)}),processCmd();var Collector$1=CollectAsync,__WEBPACK_DEFAULT_EXPORT__=defaultClient},78424:(l,n,o)=>{o.d(n,{P:()=>Sn});/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var c=function(){return c=Object.assign||function(e){for(var r,s=1,f=arguments.length;s<f;s++){r=arguments[s];for(var p in r)Object.prototype.hasOwnProperty.call(r,p)&&(e[p]=r[p])}return e},c.apply(this,arguments)};function h(u,e){var r={};for(var s in u)Object.prototype.hasOwnProperty.call(u,s)&&e.indexOf(s)<0&&(r[s]=u[s]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,s=Object.getOwnPropertySymbols(u);f<s.length;f++)e.indexOf(s[f])<0&&(r[s[f]]=u[s[f]]);return r}function g(u,e,r,s){return new(r||(r=Promise))(function(f,p){function A(Y){try{Q(s.next(Y))}catch(Le){p(Le)}}function T(Y){try{Q(s.throw(Y))}catch(Le){p(Le)}}function Q(Y){Y.done?f(Y.value):new r(function(Le){Le(Y.value)}).then(A,T)}Q((s=s.apply(u,e||[])).next())})}function b(u,e){var r={label:0,sent:function(){if(p[0]&1)throw p[1];return p[1]},trys:[],ops:[]},s,f,p,A;return A={next:T(0),throw:T(1),return:T(2)},typeof Symbol=="function"&&(A[Symbol.iterator]=function(){return this}),A;function T(Y){return function(Le){return Q([Y,Le])}}function Q(Y){if(s)throw new TypeError("Generator is already executing.");for(;r;)try{if(s=1,f&&(p=Y[0]&2?f.return:Y[0]?f.throw||((p=f.return)&&p.call(f),0):f.next)&&!(p=p.call(f,Y[1])).done)return p;switch(f=0,p&&(Y=[Y[0]&2,p.value]),Y[0]){case 0:case 1:p=Y;break;case 4:return r.label++,{value:Y[1],done:!1};case 5:r.label++,f=Y[1],Y=[0];continue;case 7:Y=r.ops.pop(),r.trys.pop();continue;default:if(p=r.trys,!(p=p.length>0&&p[p.length-1])&&(Y[0]===6||Y[0]===2)){r=0;continue}if(Y[0]===3&&(!p||Y[1]>p[0]&&Y[1]<p[3])){r.label=Y[1];break}if(Y[0]===6&&r.label<p[1]){r.label=p[1],p=Y;break}if(p&&r.label<p[2]){r.label=p[2],r.ops.push(Y);break}p[2]&&r.ops.pop(),r.trys.pop();continue}Y=e.call(u,r)}catch(Le){Y=[6,Le],f=0}finally{s=p=0}if(Y[0]&5)throw Y[1];return{value:Y[0]?Y[1]:void 0,done:!0}}}function y(u){var e=typeof Symbol=="function"&&u[Symbol.iterator],r=0;return e?e.call(u):{next:function(){return u&&r>=u.length&&(u=void 0),{value:u&&u[r++],done:!u}}}}function O(u,e){var r=typeof Symbol=="function"&&u[Symbol.iterator];if(!r)return u;var s=r.call(u),f,p=[],A;try{for(;(e===void 0||e-- >0)&&!(f=s.next()).done;)p.push(f.value)}catch(T){A={error:T}}finally{try{f&&!f.done&&(r=s.return)&&r.call(s)}finally{if(A)throw A.error}}return p}function M(){for(var u=[],e=0;e<arguments.length;e++)u=u.concat(O(arguments[e]));return u}var G=function(){function u(){this._hooks={},this._cache=[],this._hooksCache={}}return u.prototype.on=function(e,r){!e||!r||typeof r!="function"||(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(r))},u.prototype.once=function(e,r){var s=this;if(!(!e||!r||typeof r!="function")){var f=function p(A){r(A),s.off(e,p)};this.on(e,f)}},u.prototype.off=function(e,r){if(!(!e||!this._hooks[e]||!this._hooks[e].length))if(r){var s=this._hooks[e].indexOf(r);s!==-1&&this._hooks[e].splice(s,1)}else this._hooks[e]=[]},u.prototype.emit=function(e,r,s){if(!s)this._emit(e,r);else{if(!e)return;this._cache.indexOf(s)!==-1?this._emit(e,r):(this._hooksCache.hasOwnProperty(s)||(this._hooksCache[s]={}),this._hooksCache[s].hasOwnProperty(e)||(this._hooksCache[s][e]=[]),this._hooksCache[s][e].push(r))}},u.prototype._emit=function(e,r){!e||!this._hooks[e]||!this._hooks[e].length||M(this._hooks[e]).forEach(function(s){try{s(r)}catch(f){}})},u.prototype.set=function(e){!e||this._cache.indexOf(e)!==-1||this._cache.push(e)},u}(),le=function(e){return e!=null&&Object.prototype.toString.call(e)=="[object Object]"},Pe=function(e){return typeof e=="number"&&!isNaN(e)},Ce=function(e){return typeof e=="string"},De=function(e){return Array.isArray(e)},Ae=function(){var u=+Date.now()+Number((""+Math.random()).slice(2,8));return function(){return u+=1,u}}(),ge=function(e,r,s){if(!(typeof e!="string"||typeof r!="number"||typeof s!="number")){var f=[],p=[];s=s<=25?s:s%25;var A=String.fromCharCode(s+97);f=e.split(A);for(var T=0;T<f.length;T++){var Q=parseInt(f[T],s);Q=Q*1^r;var Y=String.fromCharCode(Q);p.push(Y)}var Le=p.join("");return Le}},Te=function(e){return ge(e,64,25)},ce=function(e){var r=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);r?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)},x=function(){try{var e=JSON.parse(atob(window.name));return e||void 0}catch(r){return}},P=function(e,r,s){var f=document.createElement("script");f.src=e,f.onerror=function(){s(e)},f.onload=function(){r()},document.getElementsByTagName("head")[0].appendChild(f)},$=function(){var e=0;return["hidden","msHidden","webkitHidden"].forEach(function(r){document[r]!==void 0&&(e=1)}),e},he=function(e,r){e===void 0&&(e=function(){}),r===void 0&&(r=1e3);var s=Date.now()+r,f;function p(){var A=Date.now()-s;e(),s+=r,f=window.setTimeout(p,Math.max(0,r-A))}return f=window.setTimeout(p,r),function(){window.clearTimeout(f)}},ye=function(e){var r=document.createElement("a");return r.href=e,r},Re=function(e){var r={};try{var s=ye(e).search;if(!s)return r;s=s.slice(1),s.split("&").forEach(function(f){var p=f.split("="),A,T;p.length&&(A=p[0],T=p[1]);try{r[A]=decodeURIComponent(typeof T=="undefined"?"":T)}catch(Q){r[A]=T}})}catch(f){}return r},He=function(e){e+="";for(var r=0,s=0,f=e.length,p=0;p<f;p++)r=31*r+e.charCodeAt(s++),(r>140737488355327||r<-140737488355328)&&(r&=281474976710655);return r<0&&(r+=2251799813685247),r},we=typeof window!="undefined"?window:typeof o.g!="undefined"?o.g:typeof self!="undefined"?self:{};function fe(u,e){return e={exports:{}},u(e,e.exports),e.exports}var K=fe(function(u,e){(function(r){var s;if(u.exports=r(),s=!0,!s){var f=window.Cookies,p=window.Cookies=r();p.noConflict=function(){return window.Cookies=f,p}}})(function(){function r(){for(var p=0,A={};p<arguments.length;p++){var T=arguments[p];for(var Q in T)A[Q]=T[Q]}return A}function s(p){return p.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function f(p){function A(){}function T(Y,Le,Ve){if(typeof document!="undefined"){Ve=r({path:"/"},A.defaults,Ve),typeof Ve.expires=="number"&&(Ve.expires=new Date(new Date*1+Ve.expires*864e5)),Ve.expires=Ve.expires?Ve.expires.toUTCString():"";try{var Ge=JSON.stringify(Le);/^[\{\[]/.test(Ge)&&(Le=Ge)}catch(ht){}Le=p.write?p.write(Le,Y):encodeURIComponent(String(Le)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),Y=encodeURIComponent(String(Y)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var xe="";for(var dt in Ve)!Ve[dt]||(xe+="; "+dt,Ve[dt]!==!0&&(xe+="="+Ve[dt].split(";")[0]));return document.cookie=Y+"="+Le+xe}}function Q(Y,Le){if(typeof document!="undefined"){for(var Ve={},Ge=document.cookie?document.cookie.split("; "):[],xe=0;xe<Ge.length;xe++){var dt=Ge[xe].split("="),ht=dt.slice(1).join("=");!Le&&ht.charAt(0)==='"'&&(ht=ht.slice(1,-1));try{var hr=s(dt[0]);if(ht=(p.read||p)(ht,hr)||s(ht),Le)try{ht=JSON.parse(ht)}catch(_r){}if(Ve[hr]=ht,Y===hr)break}catch(_r){}}return Y?Ve[Y]:Ve}}return A.set=T,A.get=function(Y){return Q(Y,!1)},A.getJSON=function(Y){return Q(Y,!0)},A.remove=function(Y,Le){T(Y,"",r(Le,{expires:-1}))},A.defaults={},A.withConverter=f,A}return f(function(){})})}),I=function(e,r){try{var s=void 0;return e?s=K.get(e,{domain:r||document.domain}):s=K.get(),s}catch(f){return""}},k=function(e,r,s,f){try{var p=f||document.domain,A=+new Date,T=s||7*1e3*60*60*24,Q=A+T;K.set(e,r,{expires:new Date(Q),path:"/",domain:p})}catch(Y){}},se=function(){function u(){this.cache={}}return u.prototype.setItem=function(e,r){this.cache[e]=r},u.prototype.getItem=function(e){return this.cache[e]},u.prototype.removeItem=function(e){this.cache[e]=void 0},u.prototype.getCookie=function(e,r){return I(e,r)},u.prototype.setCookie=function(e,r,s,f){k(e,r,s,f)},u}();function pe(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(u){return!1}}function Je(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(u){return!1}}var me={getItem:function(e){try{var r=localStorage.getItem(e),s=r;try{r&&typeof r=="string"&&(s=JSON.parse(r))}catch(f){}return s||{}}catch(f){}return{}},setItem:function(e,r){try{var s=typeof r=="string"?r:JSON.stringify(r);localStorage.setItem(e,s)}catch(f){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(r){}},getCookie:function(e,r){return I(e,r)},setCookie:function(e,r,s,f){k(e,r,s,f)},isSupportLS:pe()},Ne={getItem:function(e){try{var r=sessionStorage.getItem(e),s=r;try{r&&typeof r=="string"&&(s=JSON.parse(r))}catch(f){}return s||{}}catch(f){}return{}},setItem:function(e,r){try{var s=typeof r=="string"?r:JSON.stringify(r);sessionStorage.setItem(e,s)}catch(f){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(r){}},getCookie:function(e,r){return I(e,r)},setCookie:function(e,r,s,f){k(e,r,s,f)},isSupportSession:Je()},ne=function(){function u(e,r){r&&r==="session"?this._storage=Ne:this._storage=!e&&me.isSupportLS?me:new se}return u.prototype.getItem=function(e){return this._storage.getItem(e)},u.prototype.setItem=function(e,r){this._storage.setItem(e,r)},u.prototype.getCookie=function(e,r){return this._storage.getCookie(e,r)},u.prototype.setCookie=function(e,r,s,f){this._storage.setCookie(e,r,s,f)},u.prototype.removeItem=function(e){this._storage.removeItem(e)},u}(),$e=function(e,r,s,f){var p=new ne(!1),A=new ne(!1,"session"),T=e?"_tea_utm_cache_"+e:"_tea_utm_cache",Q=e?"_$utm_from_url_"+e:"_$utm_from_url",Y={},Le=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],Ve={ad_id:Number(r.ad_id)||void 0,campaign_id:Number(r.campaign_id)||void 0,creative_id:Number(r.creative_id)||void 0,utm_source:r.utm_source,utm_medium:r.utm_medium,utm_campaign:r.utm_campaign,utm_term:r.utm_term,utm_content:r.utm_content,tr_shareuser:r.tr_shareuser,tr_admaster:r.tr_admaster,tr_param1:r.tr_param1,tr_param2:r.tr_param2,tr_param3:r.tr_param3,tr_param4:r.tr_param4};try{var Ge=!1;for(var xe in Ve)Ve[xe]&&(Le.indexOf(xe)!==-1?(Y.hasOwnProperty("tracer_data")||(Y.tracer_data={}),Y.tracer_data[xe]=Ve[xe]):Y[xe]=Ve[xe],Ge=!0);if(Ge)A.setItem(Q,"1"),p.setCookie(T,JSON.stringify(Y),f,s);else{var dt=p.getCookie(T,s);dt&&(Y=JSON.parse(dt))}A.getItem(Q)&&(Y.hasOwnProperty("tracer_data")||(Y.tracer_data={}),Y.tracer_data.$utm_from_url=1)}catch(ht){return Ve}return Y},Oe=function(){function u(e,r,s){this.appid=e,this.domain=r,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=s}return u.prototype.init=function(){var e=window.navigator.userAgent,r=window.navigator.language,s=document.referrer,f=s?ye(s).hostname:"",p=Re(window.location.href),A=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=$e(this.appid,p,this.domain,this.cookie_expire);var T=this.browser(),Q=this.os();return{browser:T.browser,browser_version:T.browser_version,platform:A,os_name:Q.os_name,os_version:Q.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(Q.os_name),language:r,referrer:s,referrer_host:f,utm:this.utm,latest_data:this.last(s,f)}},u.prototype.last=function(e,r){var s="",f="",p="",A=location.hostname,T=!1;if(e&&r&&A!==r){s=e,f=r,T=!0;var Q=Re(e);Q.keyword&&(p=Q.keyword)}return{$latest_referrer:s,$latest_referrer_host:f,$latest_search_keyword:p,isLast:T}},u.prototype.browser=function(){var e="",r=""+parseFloat(this.appVersion),s,f,p=this.userAgent;return p.indexOf("Edge")!==-1||p.indexOf("Edg")!==-1?(e="Microsoft Edge",p.indexOf("Edge")!==-1?(s=p.indexOf("Edge"),r=p.substring(s+5)):(s=p.indexOf("Edg"),r=p.substring(s+4))):(s=p.indexOf("MSIE"))!==-1?(e="Microsoft Internet Explorer",r=p.substring(s+5)):(s=p.indexOf("Lark"))!==-1?(e="Lark",r=p.substring(s+5,s+11)):(s=p.indexOf("MetaSr"))!==-1?(e="sougoubrowser",r=p.substring(s+7,s+10)):p.indexOf("MQQBrowser")!==-1||p.indexOf("QQBrowser")!==-1?(e="qqbrowser",p.indexOf("MQQBrowser")!==-1?(s=p.indexOf("MQQBrowser"),r=p.substring(s+11,s+15)):p.indexOf("QQBrowser")!==-1&&(s=p.indexOf("QQBrowser"),r=p.substring(s+10,s+17))):p.indexOf("Chrome")!==-1?(s=p.indexOf("MicroMessenger"))!==-1?(e="weixin",r=p.substring(s+15,s+20)):(s=p.indexOf("360"))!==-1?(e="360browser",r=p.substring(p.indexOf("Chrome")+7)):p.indexOf("baidubrowser")!==-1||p.indexOf("BIDUBrowser")!==-1?(p.indexOf("baidubrowser")!==-1?(s=p.indexOf("baidubrowser"),r=p.substring(s+13,s+16)):p.indexOf("BIDUBrowser")!==-1&&(s=p.indexOf("BIDUBrowser"),r=p.substring(s+12,s+15)),e="baidubrowser"):(s=p.indexOf("xiaomi"))!==-1?p.indexOf("openlanguagexiaomi")!==-1?(e="openlanguage xiaomi",r=p.substring(s+7,s+13)):(e="xiaomi",r=p.substring(s-7,s-1)):(s=p.indexOf("TTWebView"))!==-1?(e="TTWebView",r=p.substring(s+10,s+23)):((s=p.indexOf("Chrome"))!==-1||(s=p.indexOf("Chrome"))!==-1)&&(e="Chrome",r=p.substring(s+7)):p.indexOf("Safari")!==-1?(s=p.indexOf("QQ"))!==-1?(e="qqbrowser",r=p.substring(s+10,s+16)):(s=p.indexOf("Safari"))!==-1&&(e="Safari",r=p.substring(s+7),(s=p.indexOf("Version"))!==-1&&(r=p.substring(s+8))):(s=p.indexOf("Firefox"))!==-1?(e="Firefox",r=p.substring(s+8)):(s=p.indexOf("MicroMessenger"))!==-1?(e="weixin",r=p.substring(s+15,s+20)):(s=p.indexOf("QQ"))!==-1&&(e="qqbrowser",r=p.substring(s+3,s+8)),(f=r.indexOf(";"))!==-1&&(r=r.substring(0,f)),(f=r.indexOf(" "))!==-1&&(r=r.substring(0,f)),(f=r.indexOf(")"))!==-1&&(r=r.substring(0,f)),{browser:e,browser_version:r}},u.prototype.os=function(){for(var e="",r="",s=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],f=0;f<s.length;f++){var p=s[f];if(p.r.test(this.userAgent)){e=p.s,e==="Mac OS X"&&this.isNewIpad()&&(e="iOS");break}}var A=function(Le,Ve){var Ge=Le.exec(Ve);return Ge&&Ge[1]?Ge[1]:""},T=function(Le,Ve){var Ge=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+Le+")","i"),xe=Ge.exec(Ve);if(xe){var dt=xe.slice(1);return dt[0]}return""};/Windows/.test(e)&&(r=A(/Windows (.*)/,e),e="windows");var Q=function(Le){var Ve=A(/Android ([\.\_\d]+)/,Le);return Ve||(Ve=A(/Android\/([\.\_\d]+)/,Le)),Ve};switch(e){case"Mac OS X":r=T("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":r=Q(this.userAgent),e="android";break;case"iOS":this.isNewIpad()?r=T("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(r=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion),r?r=r[1]+"."+r[2]+"."+(r[3]|0):r=""),e="ios";break}return{os_name:e,os_version:r}},u.prototype.getDeviceModel=function(e){var r="";try{if(e==="android"){var s=navigator.userAgent.split(";");s.forEach(function(A){A.indexOf("Build/")>-1&&(r=A.slice(0,A.indexOf("Build/")))})}else if(e==="ios"||e==="mac"||e==="windows")if(this.isNewIpad())r="iPad";else{var f=navigator.userAgent.replace("Mozilla/5.0 (",""),p=f.indexOf(";");r=f.slice(0,p)}}catch(A){return r.trim()}return r.trim()},u.prototype.isNewIpad=function(){return this.userAgent!==void 0&&navigator.platform==="MacIntel"&&typeof navigator.maxTouchPoints=="number"&&navigator.maxTouchPoints>1},u}(),je;je={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"};var vt={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},Rt=je,_t="5.1.1",Xe="npm",ut=Xe,yt="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-editor-rangers.js",Bt="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-core.js",ar="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/visual-ab-loader.js",Et="https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/heatmap-core",Zt="https://lf3-data.volccdn.com/obj/data-static/log-sdk/collect/tester-event-inspector",xt=function(){function u(e,r){this.collector=e,this.config=r,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return u.prototype.checkVerify=function(e){var r=this;if(!e||!e.length)return!1;var s=e[0];if(!s)return!1;var f=s.events,p=s.header;if(!f||!f.length)return!1;var A=!0;return f.forEach(function(T){if(!T){A=!1,T.checkEvent="\u4E8B\u4EF6\u5F02\u5E38";return}r.checkEventName(T.event)||(A=!1,T.checkEvent="\u4E8B\u4EF6\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934"),r.checkEventParams(T.params)||(A=!1,T.checkParams="\u5C5E\u6027\u540D\u4E0D\u80FD\u4EE5 $ or __\u5F00\u5934")}),this.checkEventParams(p)||(A=!1),A},u.prototype.checkEventName=function(e){return e?this.calculate(e,"event"):!1},u.prototype.checkEventParams=function(e){var r=e;if(typeof e=="string"&&(r=JSON.parse(r)),!Object.keys(r).length)return!0;for(var s in r)return this.calculate(s,"params")?typeof r[s]=="string"&&r[s].length>1024?(console.warn("params: "+s+" can not over 1024 byte, please check;"),!1):!0:!1;return!0},u.prototype.calculate=function(e,r){var s=r==="event"?this.eventNameWhiteList:this.paramsNameWhiteList;return s.indexOf(e)!==-1?!0:new RegExp("^\\$").test(e)||new RegExp("^__").test(e)?(console.warn((r==="event"?"event":"params")+" name: "+e+" can not start with $ or __, pleace check;"),!1):!0},u}(),zt;(function(u){u.Init="init",u.Config="config",u.Start="start",u.Ready="ready",u.UnReady="un-ready",u.TokenComplete="token-complete",u.TokenStorage="token-storage",u.TokenFetch="token-fetch",u.TokenError="token-error",u.ConfigUuid="config-uuid",u.ConfigWebId="config-webid",u.ConfigDomain="config-domain",u.CustomWebId="custom-webid",u.TokenChange="token-change",u.TokenReset="token-reset",u.ConfigTransform="config-transform",u.EnvTransform="env-transform",u.SessionReset="session-reset",u.SessionResetTime="session-reset-time",u.Event="event",u.Events="events",u.EventNow="event-now",u.CleanEvents="clean-events",u.BeconEvent="becon-event",u.SubmitBefore="submit-before",u.SubmitScuess="submit-scuess",u.SubmitAfter="submit-after",u.SubmitError="submit-error",u.SubmitVerify="submit-verify",u.Stay="stay",u.ResetStay="reset-stay",u.StayReady="stay-ready",u.SetStay="set-stay",u.RouteChange="route-change",u.RouteReady="route-ready",u.Ab="ab",u.AbVar="ab-var",u.AbAllVars="ab-all-vars",u.AbConfig="ab-config",u.AbExternalVersion="ab-external-version",u.AbVersionChangeOn="ab-version-change-on",u.AbVersionChangeOff="ab-version-change-off",u.AbOpenLayer="ab-open-layer",u.AbCloseLayer="ab-close-layer",u.AbReady="ab-ready",u.AbComplete="ab-complete",u.AbTimeout="ab-timeout",u.Profile="profile",u.ProfileSet="profile-set",u.ProfileSetOnce="profile-set-once",u.ProfileUnset="profile-unset",u.ProfileIncrement="profile-increment",u.ProfileAppend="profile-append",u.ProfileClear="profile-clear",u.Autotrack="autotrack",u.AutotrackReady="autotrack-ready",u.CepReady="cep-ready",u.TracerReady="tracer-ready",u.sessionRecord="session-record",u.SessionRecordStart="session-record-start",u.SessionRecordPause="session-record-pause",u.SessionRecordEnd="session-record-end",u.SessionRecordReport="session-record-report",u.DestoryInstance="destory-instance",u.VisualCollectReady="visual-collect-ready",u.VisualApiReady="visual-api-ready",u.VisualApiUpdate="visual-api-update"})(zt||(zt={}));var ae;(function(u){u.DEBUGGER_MESSAGE="debugger-message",u.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",u.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",u.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",u.DEBUGGER_MESSAGE_EVENT="debugger-message-event",u.DEVTOOL_WEB_READY="devtool-web-ready"})(ae||(ae={}));var Me=zt,te=void 0,S=new Date,J=S.getTimezoneOffset(),z=parseInt(""+-J/60,10),B=J*60,q="/webid",oe="/tobid",We="/list",Qe=60*60*1e3*24*90,be=function(){function u(e,r){this.is_first_time=!0,this.configPersist=!1,this.initConfig=r,this.collect=e;var s=new Oe(r.app_id,r.cookie_domain||"",r.cookie_expire||Qe),f=s.init();this.eventCheck=new xt(e,r);var p="__tea_cache_first_"+r.app_id;this.configKey="__tea_cache_config_"+r.app_id,this.sessionStorage=new ne(!1,"session"),this.localStorage=new ne(!1,"local"),r.configPersist&&(this.configPersist=!0,this.storage=r.configPersist===1?this.sessionStorage:this.localStorage);var A=this.localStorage.getItem(p);A&&A==1?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(p,"1")),this.envInfo={user:{user_unique_id:te,user_type:te,user_id:te,user_is_auth:te,user_is_login:te,device_id:te,web_id:te,ip_addr_id:te,user_unique_id_type:te},header:{app_id:te,app_name:te,app_install_id:te,install_id:te,app_package:te,app_channel:te,app_version:te,ab_version:te,os_name:f.os_name,os_version:f.os_version,device_model:f.device_model,ab_client:te,traffic_type:te,client_ip:te,device_brand:te,os_api:te,access:te,language:f.language,region:te,app_language:te,app_region:te,creative_id:f.utm.creative_id,ad_id:f.utm.ad_id,campaign_id:f.utm.campaign_id,log_type:te,rnd:te,platform:f.platform,sdk_version:_t,sdk_lib:"js",province:te,city:te,timezone:z,tz_offset:B,tz_name:te,sim_region:te,carrier:te,resolution:f.screen_width+"x"+f.screen_height,browser:f.browser,browser_version:f.browser_version,referrer:f.referrer,referrer_host:f.referrer_host,width:f.screen_width,height:f.screen_height,screen_width:f.screen_width,screen_height:f.screen_height,utm_term:f.utm.utm_term,utm_content:f.utm.utm_content,utm_source:f.utm.utm_source,utm_medium:f.utm.utm_medium,utm_campaign:f.utm.utm_campaign,tracer_data:JSON.stringify(f.utm.tracer_data),custom:{},wechat_unionid:te,wechat_openid:te}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(f),this.initDomain(),this.initABData()}return u.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e){this.domain=e;return}var r=this.initConfig.channel;this.domain=Te(Rt[r])},u.prototype.setDomain=function(e){this.domain=e},u.prototype.getDomain=function(){return this.domain},u.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,r=null;if(this.initConfig.ab_cross){var s=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);r=s?JSON.parse(s):null}else r=this.localStorage.getItem(e);this.setAbCache(r)},u.prototype.setAbCache=function(e){this.ab_cache=e},u.prototype.getAbCache=function(){return this.ab_cache},u.prototype.setAbVersion=function(e){this.ab_version=e},u.prototype.getAbVersion=function(){return this.ab_version},u.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},u.prototype.getUrl=function(e){var r="";switch(e){case"event":r=We;break;case"webid":r=q;break;case"tobid":r=oe;break}var s="";return this.initConfig.caller&&(s="?sdk_version="+_t+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+r+s},u.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast){delete e.latest_data.isLast,this.isLast=!0;for(var r in e.latest_data)this.envInfo.header.custom[r]=e.latest_data[r]}},u.prototype.set=function(e){var r=this;Object.keys(e).forEach(function(s){(e[s]===void 0||e[s]===null)&&r.delete(s);try{r.eventCheck.calculate(s,"config")}catch(T){}if(s==="traffic_type"&&r.isLast&&(r.envInfo.header.custom.$latest_traffic_source_type=e[s]),s==="evtParams")r.evtParams=c({},r.evtParams||{},e.evtParams||{});else if(s==="_staging_flag")r.evtParams=c({},r.evtParams||{},{_staging_flag:e._staging_flag});else if(s==="reportErrorCallback"&&typeof e[s]=="function")r.reportErrorCallback=e[s];else{var f="",p="";if(s.indexOf(".")>-1){var A=s.split(".");f=A[0],p=A[1]}f?f==="user"||f==="header"?r.envInfo[f][p]=e[s]:r.envInfo.header.custom[p]=e[s]:Object.hasOwnProperty.call(r.envInfo.user,s)?["user_type","ip_addr_id"].indexOf(s)>-1?r.envInfo.user[s]=e[s]?Number(e[s]):e[s]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(s)>-1?r.envInfo.user[s]=e[s]?String(e[s]):e[s]:["user_is_auth","user_is_login"].indexOf(s)>-1?r.envInfo.user[s]=Boolean(e[s]):s==="device_id"&&(r.envInfo.user[s]=e[s]):Object.hasOwnProperty.call(r.envInfo.header,s)?r.envInfo.header[s]=e[s]:r.envInfo.header.custom[s]=e[s]}})},u.prototype.get=function(e){try{return e?e==="evtParams"?this.evtParams:e==="reportErrorCallback"?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(r){console.log("get config stringify error "),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:r.message})}},u.prototype.setStore=function(e){try{if(!this.configPersist)return;var r=this.storage.getItem(this.configKey)||{};if(r&&Object.keys(e).length){var s=Object.assign(e,r);this.storage.setItem(this.configKey,s)}}catch(f){console.log("setStore error"),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:f.message})}},u.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(r){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:r.message}),null}},u.prototype.delete=function(e){try{if(!this.configPersist)return;var r=this.storage.getItem(this.configKey)||{};r&&Object.hasOwnProperty.call(r,e)&&(delete r[e],this.storage.setItem(this.configKey,r))}catch(s){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:s.message}),console.log("delete error")}},u}(),at=function(){function u(e,r){this.isLog=r||!1,this.name=e||""}return u.prototype.info=function(e){this.isLog&&console.log("%c %s","color: yellow; background-color: black;","[AppLog WEB SDK] [instance: "+this.name+"] "+e)},u.prototype.warn=function(e){this.isLog&&console.warn("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},u.prototype.error=function(e){this.isLog&&console.error("[AppLog WEB SDK] [instance: "+this.name+"] "+e)},u.prototype.throw=function(e){throw this.error(this.name),new Error(e)},u}(),Pt=function(){function u(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return u.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var r=window.navigator.userAgent;if(!r)return!0;var s=!1;return this.spiderBot.forEach(function(f){r.indexOf(f)!==-1&&(s=!0)}),s},u}(),qe=function(){function u(r,s){this.collect=r,this.native=s}var e=u.prototype;return e.bridgeInject=function(){try{return this.native?AppLogBridge?(console.log("AppLogBridge is injected"),!0):(console.log("AppLogBridge is not inject"),!1):!1}catch(s){return console.log("AppLogBridge is not inject"),!1}},e.bridgeReady=function(){var s=this;return new Promise(function(f,p){try{s.bridgeInject()?AppLogBridge.hasStarted(function(A){console.log("AppLogBridge is started? : "+A),A?f(!0):p(!1)}):p(!1)}catch(A){console.log("AppLogBridge, error:"+JSON.stringify(A.stack)),p(!1)}})},e.setNativeAppId=function(s){try{AppLogBridge.setNativeAppId(JSON.stringify(s)),console.log("change bridge appid, event report with appid: "+s)}catch(f){console.error("setNativeAppId error")}},e.setConfig=function(s){var f=this;try{Object.keys(s).forEach(function(p){p==="user_unique_id"?f.setUserUniqueId(s[p]):s[p]?f.addHeaderInfo(p,s[p]):f.removeHeaderInfo(p)})}catch(p){console.error("setConfig error")}},e.setUserUniqueId=function(s){try{AppLogBridge.setUserUniqueId(s)}catch(f){console.error("setUserUniqueId error")}},e.addHeaderInfo=function(s,f){try{AppLogBridge.addHeaderInfo(s,f)}catch(p){console.error("addHeaderInfo error")}},e.setHeaderInfo=function(s){try{AppLogBridge.setHeaderInfo(JSON.stringify(s))}catch(f){console.error("setHeaderInfo error")}},e.removeHeaderInfo=function(s){try{AppLogBridge.removeHeaderInfo(s)}catch(f){console.error("removeHeaderInfo error")}},e.reportPv=function(s){this.onEventV3("predefine_pageview",s)},e.onEventV3=function(s,f){try{AppLogBridge.onEventV3(s,f),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57CB\u70B9\u4E0A\u62A5",time:Date.now(),data:[{events:[{event:s,params:f}]}],code:200,status:"success"})}catch(p){console.error("onEventV3 error")}},e.profileSet=function(s){try{AppLogBridge.profileSet(s)}catch(f){console.error("profileSet error")}},e.profileSetOnce=function(s){try{AppLogBridge.profileSetOnce(s)}catch(f){console.error("profileSetOnce error")}},e.profileIncrement=function(s){try{AppLogBridge.profileIncrement(s)}catch(f){console.error("profileIncrement error")}},e.profileUnset=function(s){try{AppLogBridge.profileUnset(s)}catch(f){console.error("profileUnset error")}},e.profileAppend=function(s){try{AppLogBridge.profileAppend(s)}catch(f){console.error("profileAppend error")}},u}(),Ft=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=Math.random()*16|0,s=e==="x"?r:r&3|8;return s.toString(16)})},wr=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;this.collect=e,this.storage=new ne(!1,"session"),this.sessionKey="__tea_session_id_"+r.app_id,this.expireTime=r.expireTime||30*60*1e3,this.disableSession=r.disable_session,!this.disableSession&&(this.setSessionId(),this.collect.on(Me.SessionReset,function(){s.resetSessionId()}),this.collect.on(Me.SessionResetTime,function(){s.updateSessionIdTime()}))},u.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var r=e.timestamp;Date.now()-r>this.expireTime?e={sessionId:Ft(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},u.prototype.setSessionId=function(){var e=this,r=this.storage.getItem(this.sessionKey);r&&r.sessionId?r.timestamp=Date.now():r={sessionId:Ft(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,r),this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime)},u.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},u.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval(function(){e.checkEXp()},this.expireTime))},u.prototype.resetSessionId=function(){var e={sessionId:Ft(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,e)},u.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var r=Date.now()-e.timestamp;r+30>=this.expireTime&&(e={sessionId:Ft(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))}},u}(),Wt=function(){function u(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return u.prototype.apply=function(e,r){var s=this;this.collect=e,this.config=r,this.configManager=e.configManager,this.eventCheck=new xt(e,r),this.cacheStorgae=new ne(!0),this.localStorage=new ne(!1),this.maxReport=r.max_report||10,this.reportTime=r.reportTime||r.report_time||30,this.timeout=r.timeout||1e5,this.enable_ttwebid=r.enable_ttwebid,this.reportUrl=r.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=Ft(),this.collect.on(Me.Ready,function(){s.reportAll(!1)}),this.collect.on(Me.ConfigDomain,function(){s.reportUrl=s.configManager.getUrl("event")}),this.collect.on(Me.Event,function(f){s.event(f)}),this.collect.on(Me.BeconEvent,function(f){s.beconEvent(f)}),this.collect.on(Me.CleanEvents,function(){s.reportAll(!1)}),this.linster()},u.prototype.linster=function(){var e=this;window.addEventListener("unload",function(){e.reportAll(!0)},!1),ce(function(){e.reportAll(!0)}),document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&e.reportAll(!0)},!1)},u.prototype.reportAll=function(e){this.report(e),this.reportBecon()},u.prototype.event=function(e){var r=this;try{var s=this.cacheStorgae.getItem(this.eventKey)||[],f=M(e,s);if(this.cacheStorgae.setItem(this.eventKey,f),this.reportTimeout&&clearTimeout(this.reportTimeout),f.length>=this.maxReport)this.report(!1);else{var p=this.reportTime;this.reportTimeout=setTimeout(function(){r.report(!1),r.reportTimeout=null},p)}}catch(A){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:A.message})}},u.prototype.beconEvent=function(e){var r=this.cacheStorgae.getItem(this.beconKey)||[],s=M(e,r);this.cacheStorgae.setItem(this.beconKey,s),!this.collect.destroy&&(this.collect.sdkStop||!this.collect.tokenManager.getReady()||!this.collect.sdkReady||(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(s)),!0)))},u.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&!!this.collect.tokenManager.getReady()&&!!this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];!e||!e.length||(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},u.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&!!this.collect.tokenManager.getReady()&&!!this.collect.sdkReady){var r=this.cacheStorgae.getItem(this.eventKey)||[];!r.length||(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(r,e))}},u.prototype.sliceEvent=function(e,r){if(e.length>this.eventLimit)for(var s=0;s<e.length;s+=this.eventLimit){var f=[];f=e.slice(s,s+this.eventLimit);var p=this.split(this.merge(f));this.send(p,r)}else{var p=this.split(this.merge(e));this.send(p,r)}},u.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var r=this.localStorage.getItem(this.refer_key)||{};r.routeChange?e=r.refer_key:e=this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(s){e=document.referrer}return e},u.prototype.merge=function(e,r){var s=this,f=this.configManager.get(),p=f.header,A=f.user;this.config.enable_pageid&&(p.custom.page_id=this.pageId),p.referrer=this.handleRefer(),p.custom=JSON.stringify(p.custom);var T=this.configManager.get("evtParams"),Q=this.configManager.get("user_unique_id_type"),Y=e.map(function(Ge){try{Object.keys(T).length&&!r&&(Ge.params=c({},T,Ge.params)),Q&&(Ge.params.$user_unique_id_type=Q);var xe=s.configManager.getAbCache();return xe&&xe.uuid&&xe.uuid===A.user_unique_id&&s.configManager.getAbVersion()&&(Ge.ab_sdk_version=s.configManager.getAbVersion()),Ge.session_id=s.collect.sessionManager.getSessionId(),Ge.params=JSON.stringify(Ge.params),Ge}catch(dt){return s.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:dt.message}),Ge}}),Le=JSON.parse(JSON.stringify({events:Y,user:A,header:p}));Le.local_time=Math.floor(Date.now()/1e3),Le.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,Le.verbose=1;var Ve=[];return Ve.push(Le),Ve},u.prototype.split=function(e){return e=e.map(function(r){var s=[];return s.push(r),s}),e},u.prototype.send=function(e,r){var s=this;!e.length||this.config.disable_track_event||e.forEach(function(f){try{var p=JSON.parse(JSON.stringify(f));s.config.filter&&(p=s.config.filter(p),p||console.warn("filter must return data !!")),s.collect.eventFilter&&p&&(p=s.collect.eventFilter(p),p||console.warn("filterEvent api must return data !!"));var A=p||f,T=JSON.parse(JSON.stringify(A));if(s.eventCheck.checkVerify(T),!A.length)return;s.collect.emit(Me.SubmitBefore,A),s.collect.requestManager.useRequest({url:s.reportUrl,data:A,success:function(Y,Le){Y&&Y.e!==0?(s.collect.emit(Me.SubmitError,{type:"f_data",eventData:Le,errorCode:Y.e,response:Y}),s.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u5931\u8D25",time:Date.now(),data:T,code:Y.e,failType:"\u6570\u636E\u5F02\u5E38\u5931\u8D25",status:"fail"})):(s.collect.emit(Me.SubmitScuess,{eventData:Le,res:Y}),s.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:T,code:200,status:"success"}))},fail:function(Y,Le){s.configManager.get("reportErrorCallback")(Y,Le),s.collect.emit(Me.SubmitError,{type:"f_net",eventData:Y,errorCode:Le}),s.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u7F51\u7EDC\u5F02\u5E38",time:Date.now(),data:T,code:Le,failType:"\u7F51\u7EDC\u5F02\u5E38\u5931\u8D25",status:"fail"})},timeout:s.timeout,useBeacon:r,withCredentials:s.enable_ttwebid}),s.collect.emit(Me.SubmitAfter,A)}catch(Q){console.warn("something error, "+JSON.stringify(Q.stack)),s.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Q.message})}})},u}(),Gr=function u(e){return e?(e^Math.random()*16>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,u)},Nr=function(){return Gr().replace(/-/g,"").slice(0,19)},tn=function(){function u(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return u.prototype.apply=function(e,r){var s=this;this.collect=e,this.config=r,this.configManager=this.collect.configManager,this.storage=new ne(!1),this.tokenKey="__tea_cache_tokens_"+r.app_id,this.enable_ttwebid=r.enable_ttwebid,this.enableCustomWebid=r.enable_custom_webid,this.collect.on(Me.ConfigUuid,function(f){s.setUuid(f)}),this.collect.on(Me.ConfigWebId,function(f){s.setWebId(f)}),this.enableCookie=r.cross_subdomain,this.expiresTime=r.cookie_expire||60*60*1e3*24*7,this.cookieDomain=r.cookie_domain||"",this.checkStorage()},u.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var r=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=r&&typeof r=="string"?JSON.parse(r):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};if(this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default",this.tokenType==="custom"&&!this.enableCustomWebid){this.remoteWebid();return}else if(this.enableCustomWebid){this.collect.on(Me.CustomWebId,function(){e.tokenReady=!0,e.collect.emit(Me.TokenComplete)});return}this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check())},u.prototype.check=function(){!this.cacheToken||!this.cacheToken.web_id?this.config.disable_webid?this.complete({web_id:Nr(),user_unique_id:this.configManager.get("user_unique_id")||Nr()}):this.remoteWebid():this.complete(this.cacheToken)},u.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(e.indexOf("miniProgram")!==-1||e.indexOf("MiniProgram")!==-1){var r=Re(window.location.href);return r&&r.Web_ID?(this.complete({web_id:""+r.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+r.Web_ID}),!0):!1}return!1},u.prototype.remoteWebid=function(){var e=this,r=this.configManager.getUrl("webid"),s={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77WEBID\u8BF7\u6C42",logType:"fetch",level:"info",time:Date.now(),data:s});var f=Nr();this.collect.requestManager.useRequest({url:r,data:s,success:function(A){var T;A&&A.e===0?(T=A.web_id,e.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u6210\u529F",logType:"fetch",level:"info",time:Date.now(),data:A})):(T=f,e.collect.configManager.set({localWebId:f}),e.collect.emit(Me.TokenError),e.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u8FD4\u56DE\u503C\u5F02\u5E38",logType:"fetch",level:"warn",time:Date.now(),data:A}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")),e.complete({web_id:e.configManager.get("web_id")||T,user_unique_id:e.configManager.get("user_unique_id")||T})},fail:function(){e.complete({web_id:e.configManager.get("web_id")||f,user_unique_id:e.configManager.get("user_unique_id")||f}),e.collect.configManager.set({localWebId:f}),e.collect.emit(Me.TokenError),e.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},u.prototype.complete=function(e){var r=e.web_id,s=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:r,user_unique_id:s}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(Me.TokenComplete)},u.prototype.completeTtWid=function(e){var r=e.user_unique_id||"",s=this.configManager.get("user_unique_id");(s||r)&&this.configManager.set({user_unique_id:s||r}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(Me.TokenComplete)},u.prototype.setUuid=function(e){if(!e||["null","undefined","Null","None"].indexOf(e)!==-1)this.clearUuid();else{var r=String(e),s=this.configManager.get("user_unique_id"),f=this.cacheToken&&this.cacheToken.user_unique_id;if(r===s&&r===f)return;this.configManager.set({user_unique_id:r}),this.cacheToken?this.cacheToken.user_unique_id=r:(this.cacheToken={},this.cacheToken.user_unique_id=r),this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(Me.TokenChange,"uuid"),this.collect.emit(Me.SessionReset)}},u.prototype.clearUuid=function(){this.config.enable_ttwebid||!this.configManager.get("web_id")||this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(Me.TokenReset,"uuid"))},u.prototype.setWebId=function(e){if(!(!e||this.config.enable_ttwebid)){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var r=this.configManager.get("web_id"),s=this.configManager.get("user_unique_id");(!s||s===r)&&(this.configManager.set({user_unique_id:e}),this.collect.emit(Me.TokenChange,"uuid")),r!==e&&(this.configManager.set({web_id:e}),this.collect.emit(Me.TokenChange,"webid")),this.setStorage(this.cacheToken)}},u.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default";var r="diss".split("").reverse().join("");delete e[r],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},u.prototype.getReady=function(){return this.tokenReady},u.prototype.getTobId=function(){var e=this;return new Promise(function(r){e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(f){f&&f.e===0?r(f.tobid):r("")},fail:function(){r("")},time:3e4,withCredentials:e.enable_ttwebid})})},u}(),rn=function(){return!!(window.navigator&&window.navigator.sendBeacon)},Zr=function(){function u(e,r){this.collector=e,this.config=r,this.requestType=r.request_type||"xhr",this.supportBeacon=rn(),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005}}return u.prototype.useFetch=function(e){var r=e.url,s=e.data,f=e.method,p=e.success,A=e.fail;window.fetch?fetch(r,{method:f||"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify(s)}).then(function(T){return T.json()}).then(function(T){p&&p(T)}).catch(function(T){A&&A(s,T)}):(this.requestType="xhr",console.log("your brwoser not support fetch, use xhr"),this.useRequest({url:r,data:s,method:f,success:p,fail:A}))},u.prototype.useBeacon=function(e){var r=e.url,s=e.data,f=e.success,p=e.fail,A=window.navigator.sendBeacon(r,JSON.stringify(s));A?f&&f():p&&p(s,this.errorCode.BEACON_FALSE)},u.prototype.useRequest=function(e){var r=this,s=e.url,f=e.data,p=e.method,A=e.success,T=e.fail,Q=e.timeout,Y=e.useBeacon,Le=e.withCredentials,Ve=e.app_key,Ge=e.forceXhr;if(Y&&this.supportBeacon){this.useBeacon({url:s,data:f,method:p,success:A,fail:T});return}if(this.requestType==="fetch"&&!Ge){this.useFetch({url:s,data:f,method:p,success:A,fail:T});return}try{var xe=new XMLHttpRequest,dt=p||"POST";xe.open(dt,""+s,!0),xe.setRequestHeader("Content-Type","application/json; charset=utf-8"),Ve&&xe.setRequestHeader("X-MCS-AppKey",""+Ve),Le&&(xe.withCredentials=!0),Q&&(xe.timeout=Q,xe.ontimeout=function(){T&&T(f,r.errorCode.TIMEOUT)}),xe.onload=function(){if(A){var ht=null;if(xe.responseText){try{ht=JSON.parse(xe.responseText)}catch(hr){ht={}}A(ht,f)}}},xe.onerror=function(){xe.abort(),T&&T(f,r.errorCode.XHR_ON)},xe.send(JSON.stringify(f))}catch(ht){}},u}(),Xr=function(){function u(e,r){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,!!r.enable_debug){var s=e.adapters.storage;this.collect=e,this.config=r,this.app_id=r.app_id,this.cacheStorgae=new s(!1,"session"),this.eventVerifyInfo=[],this.sdk_type=_t.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return u.prototype.loadScript=function(e){try{var r=document.createElement("script");r.src=e,r.onerror=function(){console.log("load DevTool render fail")},r.onload=function(){console.log("load DevTool render success")},document.getElementsByTagName("body")[0].appendChild(r)}catch(s){console.log("devTool load fail, "+s.message)}},u.prototype.parseUrl=function(){var e={};try{var r=window.location.href,s=r.split("?")[1].split("&");s.length&&s.forEach(function(f){var p=f.split("=");e[decodeURIComponent(p[0])]=decodeURIComponent(p[1])})}catch(f){}return e},u.prototype.load=function(){return g(this,void 0,void 0,function(){var e,r,s;return b(this,function(f){switch(f.label){case 0:if(f.trys.push([0,2,,3]),e=this.parseUrl(),e.open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return[2]}else if(!this.getStorage())return[2];return this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()];case 1:return r=f.sent(),this.sendData("devtool:web:verify",r.verifyStatus),this.eventVerifyInfo=r.data,[3,3];case 2:return s=f.sent(),console.log("debug fail, "+s.message),[3,3];case 3:return[2]}})})},u.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},u.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},u.prototype.loadDevTool=function(){var e="0.0.2";this.loadScript("https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/debug-web."+e+".js")},u.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57FA\u672C\u4FE1\u606F",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,\u4E0A\u62A5\u57DF\u540D:this.collect.configManager.getDomain(),SDK\u7248\u672C:_t,SDK\u5F15\u5165\u65B9\u5F0F:ut}},{title:"\u7528\u6237\u4FE1\u606F",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70B9\u51FB\u83B7\u53D6SSID"}},{title:"\u516C\u5171\u53C2\u6570\u4FE1\u606F",type:2,infoName:{\u6D4F\u89C8\u5668:this.collect.configManager.get("browser"),\u6D4F\u89C8\u5668\u7248\u672C:this.collect.configManager.get("browser_version"),\u5E73\u53F0:this.collect.configManager.get("platform"),\u8BBE\u5907\u578B\u53F7:this.collect.configManager.get("device_model"),\u64CD\u4F5C\u7CFB\u7EDF:this.collect.configManager.get("os_name"),\u64CD\u4F5C\u7CFB\u7EDF\u7248\u672C:this.collect.configManager.get("os_version"),\u5C4F\u5E55\u5206\u8FA8\u7387:this.collect.configManager.get("resolution"),\u6765\u6E90:this.collect.configManager.get("referrer"),\u81EA\u5B9A\u4E49\u4FE1\u606F:""}},{title:"\u914D\u7F6E\u4FE1\u606F",type:3,infoName:{\u5168\u57CB\u70B9:!!this.config.autotrack,\u505C\u7559\u65F6\u957F:!!this.config.enable_stay_duration}},{title:"A/B\u914D\u7F6E\u4FE1\u606F",type:4,infoName:{"A/B\u5B9E\u9A8C":!!this.config.enable_ab_test}},{title:"\u5BA2\u6237\u7AEF\u4FE1\u606F",type:3,infoName:{\u6253\u901A\u5F00\u5173:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(Me.Ready,function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName.\u81EA\u5B9A\u4E49\u4FE1\u606F=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName.\u5DF2\u66DD\u5149VID=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57DF\u540D"]=e.config.ab_channel_domain||Te(vt[e.config.channel]),e.info[4].infoName.\u5168\u90E8\u914D\u7F6E=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName.\u662F\u5426\u6253\u901A=!!e.collect.bridgeReport)})},u.prototype.loadHook=function(){var e=this;this.collect.stop(),this.collect.on(ae.DEBUGGER_MESSAGE,function(r){switch(r.type){case ae.DEBUGGER_MESSAGE_SDK:var s={time:r.time,type:r.logType||"sdk",level:r.level,name:r.info,show:!0,levelShow:!0,needDesc:!!r.data};r.data&&(s.desc={content:JSON.stringify(r.data)}),e.updateLog(s),r.secType&&r.secType==="AB"?(e.info[4].infoName.\u5DF2\u66DD\u5149VID=e.collect.configManager.getAbVersion(),e.info[4].infoName.\u5168\u90E8\u914D\u7F6E=e.collect.configManager.getAbData()):r.secType==="USER"&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),e.updateInfo();return;case ae.DEBUGGER_MESSAGE_EVENT:if(r.data&&r.data.length){var f=r.data[0],p=f.events,A=f.header;if(A.custom=JSON.parse(A.custom),!p.length)return;p.forEach(function(T){T.checkShow=!0,T.searchShow=!0,T.type=e.filterEvent.indexOf(T.event)!==-1?"sdk":"cus",T.type=e.collect.bridgeReport?"bridge":T.type,T.params=JSON.parse(T.params),r.status==="fail"&&(T.info={message:"code: "+r.code+"\uFF0C msg: "+r.failType},T.failType=r.failType);var Q=!1,Y=!1,Le=[];e.eventVerifyInfo&&e.eventVerifyInfo.length&&(e.eventVerifyInfo.forEach(function(Ve){Ve.eventStatus=!1}),e.eventVerifyInfo.forEach(function(Ve){T.event===Ve.name&&(Y=!0,Q=!0,T.verifyStatus=Ve.status,Object.keys(T.params).forEach(function(Ge){if(Ge!=="event_index"){var xe={};xe.paramsKey=Ge,xe.paramsKeyValue=T.params[""+Ge],xe.paramsStatus=!1,xe.paramsStatusInfo="\u5C5E\u6027\u672A\u5F55\u5165",Ve.params.forEach(function(dt){Ge===dt.name&&(dt.checked=!0,typeof T.params[""+Ge]!==e.formatParamsType(dt.value_type)?xe.paramsStatusInfo="\u5C5E\u6027\u7C7B\u578B\u9519\u8BEF\uFF0C\u5E94\u4E3A"+e.formatParamsType(dt.value_type):(xe.paramsStatus=!0,xe.paramsStatusInfo=""))}),Le.push(xe),xe.paramsStatusInfo&&(Y=!1)}}),Ve.params.forEach(function(Ge){Ge.checked||(Y=!1,Le.push({paramsKey:Ge.name,paramsStatus:!1,paramsStatusInfo:"\u7F3A\u5C11\u5C5E\u6027"+Ge.name}))}))})),T.reportStatus=r.status==="success",T.paramsInfo=Le,T.eventStatus=Y&&r.status==="success",T.eventRecord=Q}),e.updateEvent(f)}return}})},u.prototype.formatParamsType=function(e){switch(e){case 0:return"string";case 1:return"number";case 2:return"number";case 3:return"boolean"}},u.prototype.fetchEventInfo=function(){var e=this;try{var r="1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18";return new Promise(function(s){var f=Te(r)+"?app_id="+e.app_id+"&t="+e.sdk_type+"&nc=false";e.collect.requestManager.useRequest({url:f,method:"GET",success:function(A){e.eventVerifyReady=!0,e.collect.reStart(),s({data:A.data,verifyStatus:!0})},fail:function(){e.eventVerifyReady=!0,e.collect.reStart(),s({data:[],verifyStatus:!1})},timeout:3e3})})}catch(s){return{data:[],verifyStatus:!1}}},u.prototype.addLintener=function(){var e=this;window.addEventListener("message",function(r){if(r.origin===location.origin){if(r&&r.data&&r.data.type==="devtool:web:ready"){if(e.devToolOrigin=r.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,appid:e.app_id}),e.sendAlready=!0}r&&r.data&&r.data.type==="devtool:web:ssid"&&e.collect.getToken(function(s){e.info[1].infoName.ssid=s.tobid,e.updateInfo()}),r&&r.data&&r.data.type==="devtool:web:open-draw-ready"}})},u.prototype.sendData=function(e,r){try{var s={type:e,payload:r};(window.opener||window.parent).postMessage(s,this.devToolOrigin)}catch(f){}},u.prototype.updateInfo=function(){!this.devToolReady||this.sendData("devtool:web:info",this.info)},u.prototype.updateLog=function(e){if(!this.devToolReady){this.log.push(e);return}this.sendData("devtool:web:log",e)},u.prototype.updateEvent=function(e){if(!this.devToolReady&&!this.eventVerifyReady){this.event.push(e);return}this.sendData("devtool:web:event",e)},u.prototype.loadDebuggerModule=function(){var e=`#debugger-applog-web {
      position: fixed;
      width: 50px;
      height: 50px;
      background-image: url('https://lf-cdn-tos.bytescm.com/obj/static/log-sdk/collect/devtool/applog.png');;
      bottom: 5%;
      right: 10%;
      cursor: pointer;
      z-index:100;
      background-size: 50px;
    }`,r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.appendChild(document.createTextNode(e)),r.appendChild(s);var f='<div id="debugger-applog-web" class="debugger-applog-web"></div>',p=document.createElement("div");p.innerHTML=f;var A='<div id="debugger-container" class="debugger-container"></div>',T=document.createElement("div");T.innerHTML=A,document.getElementsByTagName("body")[0].appendChild(p),document.getElementsByTagName("body")[0].appendChild(T);var Q=document.getElementById("debugger-applog-web");Q.addEventListener("click",function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)})},u}(),Wr={autotrack:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/autotrack.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/autotrack.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/autotrack.js"},object:"LogAutoTrack"},ab:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/ab.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/ab.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/ab.js"},object:"LogAb"},stay:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/stay.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/stay.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/stay.js"},object:"LogStay"},route:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/route.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/route.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/route.js"},object:"LogRoute"},cep:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/cep.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/cep.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/cep.js"},object:"LogCep"},tracer:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/tracer.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/tracer.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/tracer.js"},object:"LogTracer"},retry:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/retry.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/retry.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/retry.js"},object:"LogRetry"},visual:{src:{cn:"https://lf3-cdn-tos.bytescm.com/obj/static/log-sdk/collect/5.0/plugin/visual.js",sg:"https://sf16-scmcdn-sg.ibytedtos.com/obj/static-sg/log-sdk/collect/5.0/plugin/visual.js",va:"https://sf16-scmcdn-va.ibytedtos.com/obj/static-us/log-sdk/collect/5.0/plugin/visual.js"},object:"LogVisual"}},qr=["et","profile","heartbeat","monitor"];qr=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"];var zr=qr,cr=function(){function u(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new G,this.remotePlugin=new Map,this.Types=Me,this.adapters.storage=ne,this.loadType="full"}return u.usePlugin=function(e,r,s){if(r){for(var f=!1,p=0,A=u.plugins.length;p<A;p++){var T=u.plugins[p];if(T.name===r){u.plugins[p].plugin=e,u.plugins[p].options=s||{},f=!0;break}}f||u.plugins.push({name:r,plugin:e,options:s})}else u.plugins.push({plugin:e})},u.prototype.usePlugin=function(e,r,s){if(!!e){if(this.loadType==="full"&&zr.includes(e)){console.info("your sdk version has "+e+" plugin already ~");return}r?typeof r=="string"?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:r,call:s}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:r}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk")}},u.prototype.init=function(e){var r=this;if(this.logger=new at(this.name,e.log),this.inited){this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!");return}if(!e||!le(e)){this.logger.warn("init params error,please check!");return}if(!e.app_id||!Pe(e.app_id)){this.logger.warn("app_id param is error, must be number, please check!");return}if(e.app_key&&!Ce(e.app_key)){this.logger.warn("app_key param is error, must be string, please check!");return}if(!e.channel_domain&&["cn","sg","va"].indexOf(e.channel)===-1&&(this.logger.warn("channel must be `cn`, `sg`,`va` !"),e.channel="cn"),this.spider=new Pt,this.spider.checkSpider(e)){this.logger.warn("your env may be a spider, can not report!");return}this.appBridge=new qe(this,e.enable_native),this.requestManager=new Zr(this,e),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new be(this,e),this.debugger=new Xr(this,e),this.initConfig=e,this.emit(Me.Init),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CINIT",data:e,level:"info",time:Date.now()}),e.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:e.app_id}),this.eventManager=new Wt,this.tokenManager=new tn,this.sessionManager=new wr,Promise.all([new Promise(function(s){r.once(Me.TokenComplete,function(){s(!0)})}),new Promise(function(s){r.once(Me.Start,function(){s(!0)})})]).then(function(){try{u.plugins.reduce(function(s,f){var p=f.plugin,A=f.options,T=Object.assign(r.initConfig,A),Q=new p;return Q.apply(r,T),s.push(Q),s},r.pluginInstances)}catch(s){console.warn("load plugin error, "+s.message),r.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:s.message})}r.sdkReady=!0,r.emit(Me.Ready),r.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u521D\u59CB\u5316\u5B8C\u6210",time:Date.now(),level:"info",data:r.configManager.get("user")}),r.logger.info("appid: "+e.app_id+", userInfo:"+JSON.stringify(r.configManager.get("user"))),r.logger.info("appid: "+e.app_id+", sdk is ready, version type is "+r.loadType+", version is "+_t+", you can report now !!!"),e.disable_auto_pv&&(r.disableAutoPageView=!0);try{r.loadType==="full"&&(e.enable_ab_test||e.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(s){r.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:s.message})}r.pageView(),r.on(Me.TokenChange,function(s){s==="webid"&&r.pageView(),r.logger.info("appid: "+e.app_id+" token change, new userInfo:"+JSON.stringify(r.configManager.get("user"))),r.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u8BBE\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:r.configManager.get("user")})}),r.on(Me.TokenReset,function(){r.logger.info("appid: "+e.app_id+" token reset, new userInfo:"+JSON.stringify(r.configManager.get("user"))),r.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u91CD\u7F6E\u4E86\u7528\u6237\u4FE1\u606F",time:Date.now(),secType:"USER",level:"info",data:r.configManager.get("user")})}),r.on(Me.RouteChange,function(s){s.init||e.disable_route_report||r.pageView()})}),this.tokenManager.apply(this,e),this.eventManager.apply(this,e),this.sessionManager.apply(this,e)),this.inited=!0},u.prototype.config=function(e){if(!this.inited){this.logger.warn("config must be use after function init");return}if(!e||!le(e)){this.logger.warn("config params is error, please check");return}if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&e._staging_flag===1&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var r=c({},e),s=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&s){var f=this.configManager.getStore();f&&(r=Object.assign(f,e)),this.configManager.setStore(e)}var p=r.web_id,A=r.user_unique_id,T=h(r,["web_id","user_unique_id"]);this.configManager.set(T),r.hasOwnProperty("web_id")&&this.emit(Me.ConfigWebId,r.web_id),r.hasOwnProperty("user_unique_id")&&this.emit(Me.ConfigUuid,r.user_unique_id),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CCONFIG",level:"info",time:Date.now(),data:r})}},u.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},u.prototype.setHeaderInfo=function(e,r){var s={};s[e]=r,this.config(s)},u.prototype.removeHeaderInfo=function(e){var r={};r[e]=void 0,this.config(r)},u.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(Me.ConfigDomain)},u.prototype.getConfig=function(e){return this.configManager.get(e)},u.prototype.send=function(){this.start()},u.prototype.start=function(){!this.inited||this.sended||(this.sended=!0,this.started=!0,this.emit(Me.Start),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(Me.Ready)))},u.prototype.event=function(e,r){var s=this;try{var f=[];if(Array.isArray(e))e.forEach(function(A){var T=s.processEvent(A[0],A[1]||{});!T||f.push(T)});else{var p=this.processEvent(e,r);if(!p)return;f.push(p)}this.bridgeReport?f.forEach(function(A){var T=A.event,Q=A.params;s.appBridge.onEventV3(T,JSON.stringify(Q))}):f.length&&(this.emit(Me.Event,f),this.emit(Me.SessionResetTime))}catch(A){this.logger.warn("something error, please check"),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:A.message})}},u.prototype.beconEvent=function(e,r){if(Array.isArray(e)){this.logger.warn("beconEvent not support batch report, please check");return}var s=[],f=this.processEvent(e,r||{});!f||(s.push(f),s.length&&(this.emit(Me.BeconEvent,s),this.emit(Me.SessionResetTime)))},u.prototype.processEvent=function(e,r){r===void 0&&(r={});try{if(!e)return this.logger.warn("eventName is null\uFF0C please check"),null;var s=/^event\./,f=e;s.test(e)&&(f=e.slice(6));var p=r;typeof p!="object"&&(p={}),p.profile?delete p.profile:p.event_index=Ae();var A=void 0;p.local_ms?(A=p.local_ms,delete p.local_ms):A=+new Date;var T={event:f,params:p,local_time_ms:A,is_bav:this.initConfig&&this.initConfig.autotrack?1:0};return T}catch(Q){return this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Q.message}),{event:e,params:r}}},u.prototype.filterEvent=function(e){this.eventFilter=e},u.prototype.on=function(e,r){this.hook.on(e,r)},u.prototype.once=function(e,r){this.hook.once(e,r)},u.prototype.off=function(e,r){this.hook.off(e,r)},u.prototype.emit=function(e,r,s){this.hook.emit(e,r,s)},u.prototype.set=function(e){this.hook.set(e)},u.prototype.stop=function(){this.sdkStop=!0},u.prototype.reStart=function(){this.sdkStop=!1},u.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},u.prototype.predefinePageView=function(e){if(e===void 0&&(e={}),!this.inited){console.warn("predefinePageView must be use after function init");return}var r={title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer,$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},s=c({},r,e);this.event("predefine_pageview",s)},u.prototype.clearEventCache=function(){this.emit(Me.CleanEvents)},u.prototype.setWebIDviaUnionID=function(e){if(!!e){var r=He(e);this.config({web_id:""+r,wechat_unionid:e}),this.emit(Me.CustomWebId)}},u.prototype.setWebId=function(e){this.config({web_id:""+e})},u.prototype.setWebIDviaOpenID=function(e){if(!!e){var r=He(e);this.config({web_id:""+r,wechat_openid:e}),this.emit(Me.CustomWebId)}},u.prototype.setNativeAppId=function(e){!this.bridgeReport||this.appBridge.setNativeAppId(e)},u.prototype.resetStayDuration=function(e,r,s){this.emit(Me.ResetStay,{url_path:e,title:r,url:s},Me.Stay)},u.prototype.resetStayParams=function(e,r,s){e===void 0&&(e=""),r===void 0&&(r=""),s===void 0&&(s=""),this.emit(Me.SetStay,{url_path:e,title:r,url:s},Me.Stay)},u.prototype.getToken=function(e,r){var s=this;if(!this.inited){console.warn("getToken must be use after function init");return}var f=!1,p=function(Q){if(!f){f=!0;var Y=s.configManager.get().user;return Q&&(Y.tobid=Q,Y["diss".split("").reverse().join("")]=Q),e(c({},Y))}},A=function(){s.tokenManager.getTobId().then(function(Q){p(Q)})};if(this.sdkReady){A();return}r&&setTimeout(function(){p()},r),this.on(Me.Ready,function(){A()})},u.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(Me.ProfileSet,e,Me.Profile),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSet",level:"info",time:Date.now(),data:e})},u.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(Me.ProfileSetOnce,e,Me.Profile),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileSetOnce",level:"info",time:Date.now(),data:e})},u.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(Me.ProfileIncrement,e,Me.Profile),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileIncrement",level:"info",time:Date.now(),data:e})},u.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(Me.ProfileUnset,e,Me.Profile),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileUnset",level:"info",time:Date.now(),data:e})},u.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(Me.ProfileAppend,e,Me.Profile),this.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884CprofileAppend",level:"info",time:Date.now(),data:e})},u.prototype.setExternalAbVersion=function(e){this.emit(Me.AbExternalVersion,typeof e=="string"&&e?(""+e).trim():null,Me.Ab)},u.prototype.getVar=function(e,r,s){this.emit(Me.AbVar,{name:e,defaultValue:r,callback:s},Me.Ab)},u.prototype.getABconfig=function(e,r){this.emit(Me.AbConfig,{params:e,callback:r},Me.Ab)},u.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},u.prototype.onAbSdkVersionChange=function(e){var r=this;return this.emit(Me.AbVersionChangeOn,e,Me.Ab),function(){r.emit(Me.AbVersionChangeOff,e,Me.Ab)}},u.prototype.offAbSdkVersionChange=function(e){this.emit(Me.AbVersionChangeOff,e,Me.Ab)},u.prototype.openOverlayer=function(){this.emit(Me.AbOpenLayer,"",Me.Ab)},u.prototype.closeOverlayer=function(){this.emit(Me.AbCloseLayer,"",Me.Ab)},u.prototype.getAllVars=function(e){this.emit(Me.AbAllVars,e,Me.Ab)},u.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(Me.TokenComplete),this.emit(Me.DestoryInstance))},u.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(Me.TokenComplete),this.emit(Me.DestoryInstance))},u.plugins=[],u}(),Ur="__rangers_ab_style__";function Lr(){if(!document.getElementById(Ur)){var u="body { opacity: 0 !important; }",e=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.id=Ur,r.type="text/css",r.styleSheet?r.styleSheet.cssText=u:r.appendChild(document.createTextNode(u)),e.appendChild(r)}}function ve(){var u=document.getElementById(Ur);u&&u.parentElement.removeChild(u)}var de={},D=[],W=function(e){e.length&&e.forEach(function(r){D.push(r)})};function C(u,e,r,s){var f=u&&u.source||window.opener||window.parent,p=u&&u.origin||s||"*",A={type:e,payload:r};f.postMessage(JSON.stringify(A),p)}function Z(u,e){de[u]=de[u]||[],de[u].push(e)}function ie(u){if(D.some(function(f){return f==="*"})||D.some(function(f){return u.origin.indexOf(f)>-1})){var e=u.data;if(typeof u.data=="string")try{e=JSON.parse(u.data)}catch(f){e=void 0}if(!e)return;var r=e.type,s=e.payload;de[r]&&de[r].forEach(function(f){typeof f=="function"&&f(u,s)})}}function Ie(u,e){var r={};if(Object.keys(u).length)for(var s in u){if(s==="filter"||s==="autotrack"||s==="enable_stay_duration")break;r[s]=u[s]}(window.opener||window.parent).postMessage({type:"tea:sdk:info",config:r,version:e},"*"),window.addEventListener("message",ie,!1)}var Ze="",ot=!1;function Ye(u){var e=u.event,r=u.editorUrl,s=u.collectInstance,f=u.fromSession;ot||(ot=!0,P(r,function(){C(e,"abEditorScriptloadSuccess")},function(){e&&C(e,"abEditorScriptloadError"),ot=!1}))}function ct(u,e){window.TEAVisualEditor=window.TEAVisualEditor||{},W(["*"]);var r="";Ie(e,_t);var s,f="";try{var p=window.performance.getEntriesByType("resource");if(p&&p.length&&(p.forEach(function(T){T.initiatorType==="script"&&T.name&&T.name.indexOf("collect")!==-1&&(f=T.name)}),f||document.currentScript&&(f=document.currentScript.src),f&&(s=f.split("/"),s&&s.length))){r="https:/";for(var A=2;A<s.length&&A!==s.length-1;A++)r=r+("/"+s[A]);r=r+"/visual-ab-core"}}catch(T){}Z("tea:openVisualABEditor",function(T){var Q=T.data;if(typeof T.data=="string")try{Q=JSON.parse(T.data)}catch(xe){Q=void 0}if(!!Q){var Y=Q.lang,Le=Q.appId;if(Le!==e.app_id){C(T,"appIdError"),console.error("abtest appid is not belong the page appid please check");return}var Ve=Q.version;if(Ve){var Ge=Ve?"."+Ve:".1.0.1";r?Ze=""+r+Ge+".js?query="+Date.now():Ze=Bt+"?query="+Date.now()}else Ze=Bt+"?query="+Date.now();window.TEAVisualEditor.lang=Y,window.TEAVisualEditor.__ab_domin=e.channel_domain||"",Ye({event:T,editorUrl:Ze,collectInstance:u})}})}var Gt=function(e,r){window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.appId=r.app_id,Z("tea:openTesterEventInspector",function(s){var f=s.data;if(typeof s.data=="string")try{f=JSON.parse(s.data)}catch(Y){f=void 0}if(!!f){var p=f.referrer,A=f.lang,T=f.appId;window.TEAVisualEditor.__editor_ajax_domain=p||"",window.TEAVisualEditor.__ab_appId=T||"",window.TEAVisualEditor.lang=A||"";var Q=Zt;Ye({event:s,editorUrl:Q+".js?query="+Date.now(),collectInstance:e})}})},$t=function(e){window.TEAVisualEditor=window.TEAVisualEditor||{},window.TEAVisualEditor.__ab_config=e,P(ar+"?query="+Date.now(),function(){console.log("load visual render success")},function(){console.log("load visual render fail")})},Vt;(function(u){u[u.Var=0]="Var",u[u.All=1]="All"})(Vt||(Vt={}));var vr=1*30*24*60*60*1e3,Ut="/service/2/abtest_config/",Dt=function(){function u(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return u.prototype.apply=function(e,r){var s=this;if(!!r.enable_ab_test){this.collect=e,this.config=r;var f=r.enable_multilink,p=r.ab_channel_domain,A=r.enable_ab_visual,T=r.ab_cross,Q=r.ab_cookie_domain,Y=r.ab_timeout,Le=p||Te(vt[r.channel||"cn"]),Ve=e.adapters.storage,Ge=this.collect.Types;this.types=Ge,this.cacheStorgae=new Ve(!1),this.timeout=Y||3e3,this.enable_multilink=f,this.enable_ab_visual=A,this.abKey="__tea_sdk_ab_version_"+r.app_id,this.ab_cross=T,this.ab_cookie_domain=Q||"",this.fetchUrl=""+Le+Ut,this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=r.exposure_limit||20,this.ab_batch_time=r.ab_batch_time||500,this.collect.on(Ge.TokenChange,function(xe){xe==="uuid"&&(!s.readyStatus||(s.clearCache(),s.fetchAB()))}),this.collect.on(Ge.TokenReset,function(xe){xe==="uuid"&&(!s.readyStatus||(s.clearCache(),s.fetchAB()))}),this.collect.on(Ge.AbVar,function(xe){var dt=xe.name,ht=xe.defaultValue,hr=xe.callback;s.getVar(dt,ht,hr)}),this.collect.on(Ge.AbAllVars,function(xe){s.getAllVars(xe)}),this.collect.on(Ge.AbConfig,function(xe){var dt=xe.params,ht=xe.callback;s.getABconfig(dt,ht)}),this.collect.on(Ge.AbExternalVersion,function(xe){s.setExternalAbVersion(xe)}),this.collect.on(Ge.AbOpenLayer,function(){s.openOverlayer()}),this.collect.on(Ge.AbCloseLayer,function(){s.closeOverlayer()}),this.collect.on(Ge.AbVersionChangeOn,function(xe){s.changeListener.set(xe,xe)}),this.collect.on(Ge.AbVersionChangeOff,function(xe){s.changeListener.get(xe)&&s.changeListener.delete(xe)}),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(Ge.AbReady)}},u.prototype.ready=function(e){var r=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var s=this.collect.hook._hooksCache[e];if(!Object.keys(s).length)return;var f=function(T){s[T].length&&s[T].forEach(function(Q){r.collect.hook.emit(T,Q)})};for(var p in s)f(p)}},u.prototype.loadMode=function(){var e=x(),r="";if(e){var s=e.scenario,f=e.href;s?(this.editMode=!0,r=s):f&&(f.indexOf("datatester")!==-1||f.indexOf("visual-editor")!==-1)&&(this.editMode=!0,r="visual-editor")}if(this.enable_ab_visual&&(ct(this.collect,this.config),r==="visual-editor")){this.collect.destoryInstace();return}this.enable_multilink&&Gt(this.collect,this.config)},u.prototype.checkLocal=function(){var e=this.getABCache(),r=e.ab_version,s=e.ab_ext_version,f=e.ab_version_multilink,p=e.data,A=this.checkFromUrl();A?this.mulilinkVersions.push(A):this.mulilinkVersions=f||[],this.extVersions=s||[],this.versions=r||[],this.data=p;var T=this.versions.concat(this.extVersions);this.enable_multilink&&(T=T.concat(this.mulilinkVersions)),this.configVersions(T.join(","))},u.prototype.checkFromUrl=function(){var e=Re(window.location.href);return e&&e.vid?e.vid:""},u.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach(function(r){typeof r=="function"&&r(e)})},u.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},u.prototype.getVar=function(e,r,s){if(!e)throw new Error("variable must not be empty");if(r===void 0)throw new Error("variable no default value");if(typeof s!="function")throw new Error("callback must be a function");var f={name:e,defaultValue:r,callback:s,type:Vt.Var};this.fetchStatus==="complete"&&this.refreshFetchStatus==="complete"?this.getRealVar(f,e):this.callbacks.push(f)},u.prototype.getRealVar=function(e,r){var s=e.name,f=e.defaultValue,p=e.callback,A=this.data;if(!A){p(f);return}if(le(A[s])){var T=A[s].vid;r==="$ab_url"?this.mulilinkVersions.includes(T)||this.mulilinkVersions.push(T):this.versions.includes(T)||this.versions.push(T),this.updateVersions(),this.fechEvent(T,r,f),p(A[s].val),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66DD\u5149\u4E86\u5B9E\u9A8C"+s,level:"info",time:Date.now(),data:A[s]});return}this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getVar",level:"info",time:Date.now(),data:f}),p(f)},u.prototype.getAllVars=function(e){if(typeof e!="function")throw new Error("callback must be a function");var r={callback:e,type:Vt.All};this.fetchStatus==="complete"&&this.refreshFetchStatus==="complete"?this.getRealAllVars(r):this.callbacks.push(r)},u.prototype.getRealAllVars=function(e){var r=e.callback;r(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8C03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},u.prototype.fechEvent=function(e,r,s){try{if(this.config.disable_track_event||!e)return;var f=this.collect.configManager.get(),p=f.header,A=f.user,T=this.getABCache();if(T&&T.uuid&&T.uuid!==A.user_unique_id)return;var Q={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:r==="$ab_url"?s:window.location.href}),local_time_ms:Date.now()};p.custom=JSON.stringify(p.custom);var Y={events:[Q],user:A,header:p};this.reportExposure(Y,r)}catch(Le){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Le.message})}},u.prototype.reportExposure=function(e,r){var s=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(r):this.reportTimeout=setTimeout(function(){s.report(r),clearTimeout(s.reportTimeout)},this.ab_batch_time)},u.prototype.report=function(e){var r=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:e==="$ab_url"}),this.exposureCache.forEach(function(s){r.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:[s],code:200,status:"success"})}),this.exposureCache=[]},u.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},u.prototype.getABconfig=function(e,r){var s=Object.keys(e);s&&s.length&&this.collect.configManager.set(e),this.fetchAB(r)},u.prototype.get=function(e){if(this.ab_cross){var r=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return r?JSON.parse(r):{}}else return this.cacheStorgae.getItem(e)},u.prototype.set=function(e,r){this.ab_cross?this.cacheStorgae.setCookie(e,r,vr,this.ab_cookie_domain):this.cacheStorgae.setItem(e,r),this.collect.configManager.setAbCache(r)},u.prototype.getABCache=function(e){var r={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""},s=this.get(this.abKey);return r=s||r,e?r[e]:r},u.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},u.prototype.setAbCache=function(e){var r=this.getABCache();r.data=this.data,r.uuid=e,r.timestamp=Date.now(),this.set(this.abKey,r)},u.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},u.prototype.openOverlayer=function(e){var r=this;if(Lr(),e)var s=setTimeout(function(){r.closeOverlayer(),clearTimeout(s)},e)},u.prototype.closeOverlayer=function(){ve()},u.prototype.fetchComplete=function(e,r){var s=this;try{if(e&&Object.prototype.toString.call(e)=="[object Object]"){this.data=e,this.setAbCache(r);var f=[];Object.keys(e).forEach(function(Y){var Le=e[Y].vid;Le&&f.push(Le)}),this.versions=this.versions.filter(function(Y){return f.includes(Y)});var p=e.$ab_url,A=e.$ab_modification;if(A&&A.val&&this.enable_ab_visual){if(this.collect.destroy)return;this.getVar("$ab_modification",window.location.href,function(){$t(A.val),s.closeOverlayer()})}else if(p&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter(function(Y){return f.includes(Y)});var T=p.val,Q=p.vid;T&&Q&&this.getVar("$ab_url",T,function(){s.editMode||(T!==window.location.href?setTimeout(function(){if(!s.collect.destroy){var Y=""+T;Y=Y.indexOf("http")===-1?"https://"+Y:Y;var Le=ye(Y).host;Le!==location.host?Y=Y+"&vid="+Q:window.history.replaceState("","",Y),window.location.href=Y}},100):s.closeOverlayer())})}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach(function(Y){return s[Y.type===Vt.Var?"getRealVar":"getRealAllVars"](Y,"")}),this.callbacks=[]}catch(Y){}},u.prototype.fetchAB=function(e){var r=this,s=this.collect.configManager.get(),f={header:c({aid:this.config.app_id},s.user||{},s.header||{},{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u53D1\u8D77AB\u5B9E\u9A8C\u8BF7\u6C42",level:"info",logType:"fetch",time:Date.now(),data:f}),this.collect.requestManager.useRequest({url:this.fetchUrl,data:f,success:function(A){r.fetchStatus="complete",r.refreshFetchStatus="complete";var T=A.data,Q=A.message;Q==="success"?(r.fetchComplete(T,s.user.user_unique_id),e&&e(T)):(r.fetchComplete(null,s.user.user_unique_id),e&&e(null)),r.collect.emit(r.types.AbComplete,T),r.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u6210\u529F",level:"info",logType:"fetch",time:Date.now(),data:T})},fail:function(){r.fetchStatus="complete",r.refreshFetchStatus="complete",r.fetchComplete(null,s.user.user_unique_id),r.collect.emit(r.types.AbTimeout),e&&e(null),r.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5B9E\u9A8C\u8BF7\u6C42\u7F51\u7EDC\u5F02\u5E38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},u}(),gr=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;if(!!r.event_verify_url){if(typeof r.event_verify_url!="string"){console.log("please use correct et_test url");return}this.url=r.event_verify_url+"/v1/list_test",e.on(e.Types.SubmitBefore,function(f){e.requestManager.useBeacon({url:s.url,data:f})})}},u}(),Kt=function(){function u(e,r){this.maxDuration=12*60*60*1e3,this.aliveDTime=60*1e3,this.options={aliveName:"predefine_page_alive",params:{}},this.collect=e,this.config=r,this.pageStartTime=Date.now(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,le(r.enable_stay_duration)&&(this.options=Object.assign(this.options,r.enable_stay_duration))}return u.prototype.setParams=function(e,r,s){this.set_path=e,this.set_url=s,this.set_title=r},u.prototype.enable=function(e,r,s){this.url_path=e,this.url=s,this.title=r,this.disableCallback=this.enablePageAlive()},u.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},u.prototype.sendEvent=function(e,r){r===void 0&&(r=!1);var s=r?this.aliveDTime:Date.now()-this.sessionStartTime;s<0||s>this.aliveDTime||Date.now()-this.pageStartTime>this.maxDuration||r&&document.visibilityState==="hidden"||(this.collect.beconEvent(this.options.aliveName,c({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),duration:s,is_support_visibility_change:$(),startTime:this.sessionStartTime,hidden:document.visibilityState,leave:e},this.options.params)),this.sessionStartTime=Date.now())},u.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},u.prototype.setUpTimer=function(){var e=this;return this.timerHandler&&clearInterval(this.timerHandler),setInterval(function(){Date.now()-e.sessionStartTime>e.aliveDTime&&e.sendEvent(!1,!0)},1e3)},u.prototype.visibilitychange=function(){document.visibilityState==="hidden"?this.timerHandler&&(clearInterval(this.timerHandler),this.sendEvent(!1)):document.visibilityState==="visible"&&(this.sessionStartTime=Date.now(),this.timerHandler=this.setUpTimer())},u.prototype.beforeunload=function(){document.hidden||this.sendEvent(!0)},u.prototype.enablePageAlive=function(){var e=this;this.timerHandler=this.setUpTimer();var r=this.visibilitychange.bind(this),s=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",r),window.addEventListener("pagehide",s),function(){e.beforeunload(),document.removeEventListener("visibilitychange",r),window.removeEventListener("pagehide",s)}},u}(),or=function(){function u(e,r){var s=this;this.maxDuration=12*60*60*1e3,this.aliveDTime=60*1e3,this.options={closeName:"predefine_page_close",params:{}},this.visibilitychange=function(){document.visibilityState==="hidden"?s.activeEndTime=Date.now():document.visibilityState==="visible"&&(s.activeEndTime&&(s.totalTime+=s.activeEndTime-s.activeStartTime,s.activeTimes+=1),s.activeEndTime=void 0,s.activeStartTime=Date.now())},this.beforeunload=function(){if(s.totalTime+=(s.activeEndTime||Date.now())-s.activeStartTime,s.config.autotrack){var f="_tea_cache_duration";try{var p=window.sessionStorage;p.setItem(f,JSON.stringify({duration:s.totalTime,page_title:document.title||location.pathname}))}catch(A){}}s.sendEventPageClose()},this.collect=e,this.config=r,this.maxDuration=r.maxDuration||r.max_duration||24*60*60*1e3,this.pageStartTime=Date.now(),le(r.enable_stay_duration)&&(this.options=Object.assign(this.options,r.enable_stay_duration)),this.resetData()}return u.prototype.setParams=function(e,r,s){this.set_path=e,this.set_url=s,this.set_title=r},u.prototype.resetParams=function(e,r,s){this.url_path=e,this.url=s,this.title=r},u.prototype.enable=function(e,r,s){this.url_path=e,this.url=s,this.title=r,this.disableCallback=this.enablePageClose()},u.prototype.disable=function(){this.disableCallback()},u.prototype.resetData=function(){this.activeStartTime=this.activeStartTime===void 0?this.pageStartTime:Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0,this.resetParams(location.pathname,document.title,location.href)},u.prototype.sendEventPageClose=function(){var e=Date.now()-this.pageStartTime;this.totalTime<0||e<0||this.totalTime>=this.maxDuration||(this.collect.beconEvent(this.options.closeName,c({url_path:this.getParams("url_path"),title:this.getParams("title"),url:this.getParams("url"),active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:$()},this.options.params)),this.pageStartTime=Date.now(),this.resetData())},u.prototype.getParams=function(e){switch(e){case"url_path":return this.set_path||this.url_path||location.pathname;case"title":return this.set_title||this.title||document.title||location.pathname;case"url":return this.set_url||this.url||location.href}},u.prototype.enablePageClose=function(){var e=this,r=this.visibilitychange.bind(this),s=this.beforeunload.bind(this);return document.addEventListener("visibilitychange",r),window.addEventListener("pagehide",s),function(){e.beforeunload(),document.removeEventListener("visibilitychange",r),window.removeEventListener("pagehide",s)}},u}(),Ar=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;if(this.collect=e,this.config=r,!!this.config.enable_stay_duration){this.title=document.title||location.pathname,this.url=location.href,this.url_path=location.pathname,this.pageAlive=new Kt(e,r),this.pageClose=new or(e,r);var f=this.collect.Types;this.collect.on(f.ResetStay,function(p){var A=p.url_path,T=p.title,Q=p.url;s.resetStayDuration(A,T,Q)}),this.collect.on(f.RouteChange,function(p){p.init||r.disable_route_report||s.resetStayDuration()}),this.collect.on(f.SetStay,function(p){var A=p.url_path,T=p.title,Q=p.url;s.setStayParmas(A,T,Q)}),this.enable(this.url_path,this.title,this.url),this.ready(f.Stay),this.collect.emit(f.StayReady)}},u.prototype.ready=function(e){var r=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var s=this.collect.hook._hooksCache[e];if(!Object.keys(s).length)return;var f=function(T){s[T].length&&s[T].forEach(function(Q){r.collect.hook.emit(T,Q)})};for(var p in s)f(p)}},u.prototype.enable=function(e,r,s){this.pageAlive.enable(e,r,s),this.pageClose.enable(e,r,s)},u.prototype.disable=function(){this.pageAlive.disable(),this.pageClose.disable()},u.prototype.setStayParmas=function(e,r,s){e===void 0&&(e=""),r===void 0&&(r=""),s===void 0&&(s=""),this.pageAlive.setParams(e,r,s),this.pageClose.setParams(e,r,s),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayParams",level:"info",time:Date.now(),data:{url_path:e,title:r,url:s}})},u.prototype.reset=function(e,r,s){this.disable(),this.enable(e,r,s)},u.prototype.resetStayDuration=function(e,r,s){this.reset(e,r,s),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884C resetStayDuration",level:"info",time:Date.now(),data:{url_path:e,title:r,url:s}})},u}(),Kr=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;this.collect=e,this.config=r,this.duration=60*1e3,this.reportUrl=e.configManager.getDomain()+"/profile/list";var f=e.Types;this.eventCheck=new xt(e,r),this.cache={},this.collect.on(f.ProfileSet,function(p){s.setProfile(p)}),this.collect.on(f.ProfileSetOnce,function(p){s.setOnceProfile(p)}),this.collect.on(f.ProfileUnset,function(p){s.unsetProfile(p)}),this.collect.on(f.ProfileIncrement,function(p){s.incrementProfile(p)}),this.collect.on(f.ProfileAppend,function(p){s.appendProfile(p)}),this.collect.on(f.ProfileClear,function(){s.cache={}}),this.ready(f.Profile)},u.prototype.ready=function(e){var r=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var s=this.collect.hook._hooksCache[e];if(!Object.keys(s).length)return;var f=function(T){s[T].length&&s[T].forEach(function(Q){r.collect.hook.emit(T,Q)})};for(var p in s)f(p)}},u.prototype.report=function(e,r){r===void 0&&(r={});try{if(this.config.disable_track_event)return;var s=[];s.push(this.collect.processEvent(e,r));var f=this.collect.eventManager.merge(s);this.collect.requestManager.useRequest({url:this.reportUrl,data:f}),this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_EVENT,info:"\u57CB\u70B9\u4E0A\u62A5\u6210\u529F",time:Date.now(),data:f,code:200,status:"success"})}catch(p){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:p.message})}},u.prototype.setProfile=function(e){var r=this.formatParams(e);!r||!Object.keys(r).length||(this.pushCache(r),this.report("__profile_set",c({},r,{profile:!0})))},u.prototype.setOnceProfile=function(e){var r=this.formatParams(e,!0);!r||!Object.keys(r).length||(this.pushCache(r),this.report("__profile_set_once",c({},r,{profile:!0})))},u.prototype.incrementProfile=function(e){if(!e){console.warn("please check the params, must be object!!!");return}this.report("__profile_increment",c({},e,{profile:!0}))},u.prototype.unsetProfile=function(e){if(!e){console.warn("please check the key, must be string!!!");return}var r={};r[e]="1",this.report("__profile_unset",c({},r,{profile:!0}))},u.prototype.appendProfile=function(e){if(!e){console.warn("please check the params, must be object!!!");return}var r={};for(var s in e)if(typeof e[s]!="string"&&Object.prototype.toString.call(e[s]).slice(8,-1)!=="Array"){console.warn("please check the value of param: "+s+", must be string or array !!!");continue}else r[s]=e[s];var f=Object.keys(r);!f.length||this.report("__profile_append",c({},r,{profile:!0}))},u.prototype.pushCache=function(e){var r=this;Object.keys(e).forEach(function(s){r.cache[s]={val:r.clone(e[s]),timestamp:Date.now()}})},u.prototype.formatParams=function(e,r){var s=this;r===void 0&&(r=!1);try{if(!e||Object.prototype.toString.call(e)!=="[object Object]"){console.warn("please check the params type, must be object !!!");return}var f={};for(var p in e)if(typeof e[p]=="string"||typeof e[p]=="number"||Object.prototype.toString.call(e[p]).slice(8,-1)==="Array")f[p]=e[p];else{console.warn("please check the value of params:"+p+", must be string,number,Array !!!");continue}var A=Object.keys(f);if(!A.length||!this.eventCheck.checkEventParams(f))return;var T=Date.now();return A.filter(function(Q){var Y=s.cache[Q];return r?!Y:!(Y&&s.compare(Y.val,e[Q])&&T-Y.timestamp<s.duration)}).reduce(function(Q,Y){return Q[Y]=f[Y],Q},{})}catch(Q){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Q.message}),console.log("error")}},u.prototype.compare=function(e,r){try{return JSON.stringify(e)===JSON.stringify(r)}catch(s){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:s.message}),!1}},u.prototype.clone=function(e){try{return JSON.parse(JSON.stringify(e))}catch(r){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:r.message}),e}},u.prototype.unReady=function(){console.warn("sdk is not ready, please use this api after start")},u}(),tr=function(){function u(){var e=this;this.setInterval=function(){e.clearIntervalFunc=he(function(){e.isSessionhasEvent&&e.endCurrentSession()},e.sessionInterval)},this.clearInterval=function(){e.clearIntervalFunc&&e.clearIntervalFunc()}}return u.prototype.apply=function(e,r){var s=this;if(this.collect=e,!r.disable_heartbeat){this.sessionInterval=60*1e3,this.startTime=0,this.lastTime=0,this.setInterval();var f=this.collect.Types;this.collect.on(f.SessionResetTime,function(){s.process()})}},u.prototype.endCurrentSession=function(){this.collect.event("_be_active",{start_time:this.startTime,end_time:this.lastTime,url:window.location.href,referrer:window.document.referrer,title:document.title||location.pathname}),this.isSessionhasEvent=!1,this.startTime=0},u.prototype.process=function(){this.isSessionhasEvent||(this.isSessionhasEvent=!0,this.startTime=+new Date);var e=this.lastTime||+new Date;this.lastTime=+new Date,this.lastTime-e>this.sessionInterval&&(this.clearInterval(),this.endCurrentSession(),this.setInterval())},u}(),Br=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;r.channel_domain||r.disable_track_event||r.disable_sdk_monitor||(this.collect=e,this.config=r,this.url=e.configManager.getUrl("event"),this.collect.on(e.Types.Ready,function(){s.sdkOnload()}),this.collect.on(e.Types.SubmitError,function(f){var p=f.type,A=f.eventData,T=f.errorCode;p==="f_data"&&s.sdkError(A,T)}))},u.prototype.sdkOnload=function(){var e=this;try{var r=this.collect.configManager.get(),s=r.header,f=r.user,p=s.app_id,A=s.app_name,T=s.sdk_version,Q=f.web_id,Y={event:"onload",params:JSON.stringify({app_id:p,app_name:A||"",sdk_version:T,sdk_type:ut,sdk_config:this.config,sdk_desc:"TOC",url:location.href}),local_time_ms:Date.now()},Le={events:[Y],user:{user_unique_id:Q},header:{}};setTimeout(function(){e.collect.requestManager.useRequest({url:e.url,data:[Le],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(Ve){}},u.prototype.sdkError=function(e,r){var s=this;try{var f=e[0],p=f.user,A=f.header,T=[];e.forEach(function(Le){Le.events.forEach(function(Ve){T.push(Ve)})});var Q=T.map(function(Le){return{event:"on_error",params:JSON.stringify({error_code:r,app_id:A.app_id,app_name:A.app_name||"",error_event:Le.event,sdk_version:A.sdk_version,local_time_ms:Le.local_time_ms,tea_event_index:Date.now(),params:Le.params,header:JSON.stringify(A),user:JSON.stringify(p)}),local_time_ms:Date.now()}}),Y={events:Q,user:{user_unique_id:p.user_unique_id},header:{}};setTimeout(function(){s.collect.requestManager.useRequest({url:s.url,data:[Y],timeout:3e4,app_key:"566f58151b0ed37e",forceXhr:!0})},16)}catch(Le){}},u}();function nn(u,e){if(e===void 0&&(e="list"),!u)return!1;if(e&&e==="list"){if(["LI","TR","DL"].includes(u.nodeName)||u.dataset&&u.dataset.hasOwnProperty("teaIdx")||u.hasAttribute&&u.hasAttribute("data-tea-idx"))return!0}else if(["A","BUTTON"].includes(u.nodeName)||u.dataset&&u.dataset.hasOwnProperty("teaContainer")||u.hasAttribute&&u.hasAttribute("data-tea-container"))return!0;return!1}var dn=function(e,r){return!!Ir(e,r)};function ln(u){for(var e=u;e&&!nn(e,"container");){if(e.nodeName==="HTML"||e.nodeName==="BODY")return u;e=e.parentElement}return e||u}function on(u){var e="";return u.nodeType===3?e=u.textContent.trim():u.dataset&&u.dataset.hasOwnProperty("teaTitle")||u.hasAttribute("ata-tea-title")?e=u.getAttribute("data-tea-title"):u.hasAttribute("title")?e=u.getAttribute("title"):u.nodeName==="INPUT"&&["button","submit"].includes(u.getAttribute("type"))?e=u.getAttribute("value"):u.nodeName==="IMG"&&u.getAttribute("alt")&&(e=u.getAttribute("alt")),e.slice(0,200)}function wn(u){var e=ln(u),r=[];return function s(f){var p=on(f);if(p&&r.indexOf(p)===-1&&r.push(p),f.childNodes.length>0)for(var A=f.childNodes,T=0;T<A.length;T++)A[T].nodeType!==8&&s(A[T])}(e),r}function Jr(u){var e=ln(u),r="";return function s(f){var p=on(f);if(p&&(r=r+p),f.childNodes.length>0)for(var A=f.childNodes,T=0;T<A.length;T++)A[T].nodeType===3&&s(A[T])}(e),r}function un(u){for(var e=u;e&&e.parentNode;){if(e.hasAttribute("data-tea-ignore"))return!0;if(e.nodeName==="HTML"||e.nodeName==="body")return!1;e=e.parentNode}return!1}var Qr=function(e,r){if(e.hasAttribute)return e.hasAttribute(r);if(e.attributes)return!!(e.attributes[r]&&e.attributes[r].specified)},Ir=function(e,r){if(typeof r=="string")return Qr(e,r);if(De(r)){for(var s=!1,f=0;f<r.length;f++){var p=Qr(e,r[f]);if(p){s=!0;break}}return s}},hn=function(e,r){var s={};if(typeof r=="string")Qr(e,r)&&(s.attrs=e.getAttribute(r));else if(De(r))for(var f=0;f<r.length;f++){var p=Qr(e,r[f]);p&&(s[r[f]]=e.getAttribute(r[f]))}return s},m=function(e){if(e.children.length){var r=e.children;return![].slice.call(r).some(function(s){return s.children.length>0})}return!0},E=function(e){if(e.tagName.toLowerCase()==="svg")return!0;for(var r=e.parentElement,s=!1;r;)r.tagName.toLowerCase()==="svg"?(r=null,s=!0):r=r.parentElement;return s};function F(u,e){var r=window.innerHeight,s=window.innerWidth;if(u.nodeType!==1||!e.svg&&E(u)||["HTML","BODY"].includes(u.tagName.toUpperCase()))return!1;var f=u;return f.style.display==="none"?!1:nn(f,"container")?!0:!(!m(f)&&!e.svg)}var re=function(){function u(e,r,s){var f=this;this.statistics=!1,this.pageView=!1,this.clickEvent=function(p){F(p.target,f.options)&&f.eventHandel({eventType:"dom",eventName:"click"},p)},this.changeEvent=function(p){f.eventHandel({eventType:"dom",eventName:"change"},p)},this.submitEvent=function(p){f.eventHandel({eventType:"dom",eventName:"submit"},p)},this.getPageViewEvent=function(p,A){A&&A==="pushState"&&f.eventHandel({eventType:"dom",eventName:"beat"},c({beat_type:0},p)),f.eventHandel({eventType:"dom",eventName:"page_view"},p)},this.getPageLoadEvent=function(p){f.eventHandel({eventType:"dom",eventName:"page_statistics"},{lcp:p})},this.config=s.getConfig().eventConfig,this.collect=r,this.options=e,this.beatTime=e.beat,this.domContainer=e.container||document}return u.prototype.init=function(e){this.eventHandel=e;var r=this.config.mode;this.addListener(r)},u.prototype.addListener=function(e){var r=this;if(e==="proxy-capturing"){if(this.config.click&&(De(this.domContainer)?this.domContainer.forEach(function(Ve){Ve.addEventListener("click",r.clickEvent,!0)}):this.domContainer.addEventListener("click",this.clickEvent,!0)),this.config.pv){this.collect.on("route-change",function(Ve){var Ge=Ve.config,xe=Ve.name;r.getPageViewEvent(Ge,xe),r.pageView=!0});var s=setTimeout(function(){r.pageView||(r.getPageViewEvent(r.getDefaultConfig()),r.pageView=!0,clearTimeout(s))},2e3)}if(this.config.beat){try{document.readyState==="complete"?this.beatEvent(this.beatTime):window.addEventListener("load",function(){r.beatEvent(r.beatTime)});var f=0,p=0,A=null;window.addEventListener("scroll",function(){clearTimeout(A),A=setTimeout(T,500),f=document.documentElement.scrollTop||document.body.scrollTop});var T=function(){p=document.documentElement.scrollTop||document.body.scrollTop,p==f&&r.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:1})}}catch(Ve){}try{var Q=window.performance&&window.performance.getEntriesByType("paint");if(Q&&Q.length){var Y=new PerformanceObserver(function(Ve){var Ge=Ve.getEntries(),xe=Ge[Ge.length-1],dt=xe.renderTime||xe.loadTime;r.statistics||(r.getPageLoadEvent(dt),r.statistics=!0)});Y.observe({entryTypes:["largest-contentful-paint"]});var Le=setTimeout(function(){r.statistics||(r.getPageLoadEvent(Q[0].startTime||0),r.statistics=!0,clearTimeout(Le))},2e3)}else this.getPageLoadEvent(0)}catch(Ve){this.getPageLoadEvent(0)}}}},u.prototype.removeListener=function(){var e=this;De(this.domContainer)?this.domContainer.forEach(function(r){r.removeEventListener("click",e.clickEvent,!0)}):this.domContainer.removeEventListener("click",this.clickEvent,!0)},u.prototype.beatEvent=function(e){var r=this;try{this.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:3});var s;this.beatTime&&(s=setInterval(function(){r.eventHandel({eventType:"dom",eventName:"beat"},{beat_type:2})},e)),ce(function(){r.eventHandel({eventType:"dom",eventName:"beat",eventSend:"becon"},{beat_type:0}),r.beatTime&&clearInterval(s)})}catch(f){}},u.prototype.getDefaultConfig=function(){return{is_html:1,url:location.href,referrer:document.referrer,page_key:location.href,refer_page_key:document.referrer,page_title:document.title||location.pathname,page_manual_key:"",refer_page_manual_key:"",refer_page_title:"",page_path:location.pathname,page_host:location.host}},u}(),Ee={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,beat:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},Se=function(){function u(e,r){this.config=e,this.config.eventConfig=Object.assign(this.config.eventConfig,r)}return u.prototype.getConfig=function(){return this.config},u.prototype.setConfig=function(e){return this.config=e},u}();function ze(u){if(!!u){var e=u.getBoundingClientRect(),r=e.width,s=e.height,f=e.left,p=e.top;return{left:f,top:p,element_width:r,element_height:s}}}function et(u,e){u===void 0&&(u={}),e===void 0&&(e={});var r=u.clientX,s=u.clientY,f=e.left,p=e.top,A=r-f>=0?r-f:0,T=s-p>=0?s-p:0;return{touch_x:Math.floor(A),touch_y:Math.floor(T)}}function kt(u){var e=[];if(!u)return{element_path:"",positions:[]};for(;u.parentElement!==null;)e.push(u),u=u.parentElement;var r=[],s=[];return e.forEach(function(f){var p=ir(f),A=p.str,T=p.index;r.unshift(A),s.unshift(T)}),{element_path:"/"+r.join("/"),positions:s}}function ir(u){if(u===null)return{str:"",index:0};var e=0,r=u.parentElement;if(r)for(var s=r.children,f=0;f<s.length&&s[f]!==u;f++)s[f].nodeName===u.nodeName&&e++;var p=[u.nodeName.toLowerCase(),nn(u,"list")?"[]":""].join("");return{str:p,index:e}}function lr(u,e,r,s){var f={},p=ze(e),A=et(u,p),T=p.element_width,Q=p.element_height,Y=A.touch_x,Le=A.touch_y,Ve=kt(e),Ge=Ve.element_path,xe=Ve.positions,dt=wn(e),ht=window.performance.timing.navigationStart,hr=Date.now()-ht,_r=xe.map(function(gt){return""+gt}),jr=null;if(window.TEAVisualEditor&&window.TEAVisualEditor.getOriginXpath&&(jr=window.TEAVisualEditor.getOriginXpath({xpath:Ge,positions:_r})),f.element_path=jr&&jr.xpath||Ge,f.positions=jr&&jr.positions||_r,s&&!s.text&&(f.texts=dt,f.element_title=Jr(e)),f.element_id=e.getAttribute("id")||"",f.element_class_name=e.getAttribute("class")||"",f.element_type=e.nodeType,f.element_width=Math.floor(T),f.element_height=Math.floor(Q),f.touch_x=Y,f.touch_y=Le,f.page_manual_key="",f.elememt_manual_key="",f.since_page_start_ms=hr,f.page_start_ms=ht,f.page_path=location.pathname,f.page_host=location.host,r.track_attr&&dn(e,r.track_attr)){var Yt=hn(e,r.track_attr);for(var Sr in Yt)f[Sr]=Yt[Sr]}var It=ln(e);return It.tagName==="A"&&(f.href=It.getAttribute("href")),e.tagName==="IMG"&&(f.src=e.getAttribute("src")),f}var At=function(e,r,s,f,p){return c({event:e},lr(r,s,f,p),{is_html:1,page_key:window.location.href,page_title:document.title})},Qt=function(e,r){try{if(e==="bav2b_change")return r.hasAttribute("data-tea-track")?{value:r.value}:{}}catch(s){return{}}},fr=function(){function u(e,r){this.ignore={text:!1},this.initConfig=e,this.options=r,this.eventName=r&&r.custom==="tea"?{click:"__bav_click",page:"__bav_page",beat:"__bav_beat",static:"__bav_page_statistics",exposure:"__bav_page_exposure"}:{click:"bav2b_click",page:"bav2b_page",beat:"bav2b_beat",static:"bav2b_page_statistics",exposure:"bav2b_exposure"},r&&r.text===!1&&(this.ignore.text=!0),r&&r.exposure&&r.exposure.eventName&&(this.eventName.exposure=r.exposure.eventName)}return u.prototype.handleEvent=function(e,r){try{if(un(e.target))return null;var s="bav2b_click";switch(r){case"click":return s=this.eventName.click,At(s,e,e.target,this.options,this.ignore);case"exposure":return s=this.eventName.exposure,At(s,e,e.target,this.options,this.ignore);case"change":return s="bav2b_change",c({},At(s,e,e.target,this.options),Qt(s,e.target));case"submit":return s="bav2b_submit",At(s,e,e.target,this.options)}}catch(f){return console.error(f),null}},u.prototype.handleViewEvent=function(e){e.event=this.eventName.page,e.page_title=document.title,e.page_total_width=window.innerWidth,e.page_total_height=window.innerHeight;try{var r=window.sessionStorage.getItem("_tea_cache_duration");if(r){var s=JSON.parse(r);e.refer_page_duration_ms=s?s.duration:""}e.scroll_width=document.documentElement.scrollLeft?document.documentElement.scrollLeft+window.innerWidth:window.innerWidth,e.scroll_height=document.documentElement.scrollTop?document.documentElement.scrollTop+window.innerHeight:window.innerHeight,e.page_start_ms=window.performance.timing.navigationStart}catch(f){console.log("page event error "+JSON.stringify(f))}return e},u.prototype.handleStatisticsEvent=function(e){var r={};r.event=this.eventName.static,r.is_html=1,r.page_key=location.href,r.refer_page_key=document.referrer||"",r.page_title=document.title,r.page_manual_key=this.initConfig.autotrack.page_manual_key||"",r.refer_page_manual_key="";try{var s=e.lcp,f=window.performance.timing,p=f.loadEventEnd-f.navigationStart;r.page_init_cost_ms=parseInt(s||(p>0?p:0)),r.page_start_ms=f.navigationStart}catch(A){console.log("page_statistics event error "+JSON.stringify(A))}return r},u.prototype.handleBeadtEvent=function(e){e.event=this.eventName.beat,e.page_key=window.location.href,e.is_html=1,e.page_title=document.title,e.page_manual_key=this.initConfig.autotrack.page_manual_key||"";try{e.page_viewport_width=window.innerWidth,e.page_viewport_height=window.innerHeight,e.page_total_width=document.documentElement.scrollWidth,e.page_total_height=document.documentElement.scrollHeight,e.scroll_width=document.documentElement.scrollLeft+window.innerWidth,e.scroll_height=document.documentElement.scrollTop+window.innerHeight,e.since_page_start_ms=Date.now()-window.performance.timing.navigationStart,e.page_start_ms=window.performance.timing.navigationStart}catch(r){console.log("beat event error "+JSON.stringify(r))}return e},u}(),dr=function(){function u(e){this.collect=e,this.eventNameList=["report_click_event","report_change_event","report_submit_event","report_exposure_event","report_page_view_event","report_page_statistics_event","report_beat_event"]}return u.prototype.send=function(e,r){var s=e.eventSend,f=r.event;delete r.event,s&&s==="becon"?this.collect.beconEvent(f,r):this.collect.event(f,r)},u.prototype.get=function(e,r){var s={headers:{"content-type":"application/json"},method:"GET"},f=Object.assign(s,r);fetch(e,f)},u.prototype.post=function(e,r){var s={headers:{"content-type":"application/json"},method:"POST"},f=Object.assign(s,r);fetch(e,f)},u}(),Rr="_TEA_VE_OPEN",Or="_TEA_VE_APIHOST",Mr="lang",sn="_VISUAL_EDITOR_V",pn="_VISUAL_EDITOR_U";function vn(){return K.get(Rr)==="1"}function Yr(){var u=K.get(Or);try{u=JSON.parse(u)}catch(e){}return u}function Cr(){var u=K.get(pn);return u}function $r(){try{var u=window.TEAVisualEditor.lang=window.TEAVisualEditor.lang||K.get(Mr),e=window.TEAVisualEditor.__editor_ajax_domain=window.TEAVisualEditor.__editor_ajax_domain||K.get(Or),r=window.TEAVisualEditor.__editor_verison=window.TEAVisualEditor.__editor_verison||K.get(sn),s=window.TEAVisualEditor.__editor_url=window.TEAVisualEditor.__editor_url||K.get(pn),f=+new Date,p=f+30*60*1e3,A=new Date(p);K.set(Rr,"1",{expires:A}),K.set(Or,e,{expires:A}),K.set(pn,s,{expires:A}),K.set(Mr,u,{expires:A}),K.set(sn,r||"",{expires:A})}catch(T){console.log("set cookie err")}}var _=!1;function R(u){var e=u.event,r=u.editorUrl,s=u.autoTrackInstance;_||(_=!0,P(r,function(){C(e,"editorScriptloadSuccess"),s.destroy()},function(){e&&C(e,"editorScriptloadError"),_=!1}))}function N(u,e){window.TEAVisualEditor=window.TEAVisualEditor||{};var r="",s=yt+"?query="+Date.now();window.TEAVisualEditor.appId=e.app_id;var f=e.channel_domain,p="";if(W(["*"]),f){var A,T="";try{var Q=window.performance.getEntriesByType("resource");if(Q&&Q.length&&(Q.forEach(function(xe){xe.initiatorType==="script"&&xe.name&&xe.name.indexOf("collect")!==-1&&(T=xe.name)}),T&&(A=T.split("/"),A&&A.length))){p="https:/";for(var Y=2;Y<A.length&&Y!==A.length-1;Y++)p=p+("/"+A[Y]);if(p&&p.indexOf("/5.0")){var Le=p.split("/5.0");p=Le[0]||p}}}catch(xe){}}if(Ie(e,_t),vn()){var Ve=Yr(),Ge="";Ve&&(window.TEAVisualEditor.__editor_ajax_domain=Ve,Ge=Cr()),R({event:null,editorUrl:Ge||s,autoTrackInstance:u}),$r()}else try{Z("tea:openVisualEditor",function(xe){var dt=xe.data;if(typeof xe.data=="string")try{dt=JSON.parse(xe.data)}catch(Yt){dt=void 0}if(!!dt){var ht=dt.referrer,hr=dt.lang;if(ht&&(window.TEAVisualEditor.__editor_ajax_domain=ht),r=s,f){var _r=dt.version,jr=_r?"/visual-editor-rangers-v"+_r:"/visual-editor-rangers-v1.0.0";p?r=""+p+jr+".js":r=s,window.TEAVisualEditor.__editor_verison=_r}window.TEAVisualEditor.__editor_url=r,window.TEAVisualEditor.lang=hr,R({event:xe,editorUrl:r,autoTrackInstance:u}),$r()}}),window.TEAVisualEditor.openAutotrackEditor=function(){R({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:u})}}catch(xe){console.log("receive message error")}try{Z("tea:openHeatMapCore",function(xe){var dt=Et,ht=xe.data.app_id;ht&&ht!==e.app_id||R({event:xe,editorUrl:dt+".js?query="+Date.now(),autoTrackInstance:u})})}catch(xe){console.log("openHeatMapCore error")}}var X=function(){function u(e){this._instance=null,this._intersection=e,this.init()}return u.prototype.init=function(){var e=this;this._instance=new MutationObserver(function(r){r.forEach(function(s){s.type==="attributes"&&e.attributeChangeObserve(s),s.type==="childList"&&e.modifyNodeObserve(s)})}),this._instance.observe(document.body,{childList:!0,attributes:!0,subtree:!0,attributeOldValue:!1})},u.prototype.attributeChangeObserve=function(e){var r=e.target;r.hasAttribute("data-exposure")?this.exposureAdd(e,"mutation"):this.exposureRemove(e)},u.prototype.modifyNodeObserve=function(e){var r=this;Array.prototype.forEach.call(e.addedNodes,function(s){s.nodeType===1&&s.hasAttribute("data-exposure")&&r.exposureAdd(s,"intersect"),r.mapChild(s,r.exposureAdd)}),Array.prototype.forEach.call(e.removedNodes,function(s){s.nodeType===1&&s.hasAttribute("data-exposure")&&r.exposureRemove(s),r.mapChild(s,r.exposureRemove)})},u.prototype.mapChild=function(e,r){var s=this;e.nodeType===1&&(!e.children.length||Array.prototype.forEach.call(e.children,function(f){f.nodeType===1&&f.hasAttribute("data-exposure")&&r(f),s.mapChild(f,r)}))},u.prototype.exposureAdd=function(e,r){this._intersection.exposureAdd(e,r)},u.prototype.exposureRemove=function(e){this._intersection.exposureRemove(e)},u._exposure_observer=null,u}(),ee=function(){function u(e,r){this.count=1,this.instance=this.buildObserver(),this.observeMap=u._observer_map,e.autotrack.exposure.ratio?this.Ratio=e.autotrack.exposure.ratio:e.autotrack.exposure.ratio===0?this.Ratio=0:this.Ratio=.5,this.EventHandle=r}return u.prototype.buildObserver=function(){var e=this;if(!u._observer_instance)return IntersectionObserver&&(u._observer_instance=new IntersectionObserver(function(r){r.forEach(function(s){var f=e.observeMap.get(s.target._observeId);f&&e.exposureEvent(s)})},{threshold:[.01,.25,.5,.75,1]})),u._observer_instance},u.prototype.exposureAdd=function(e,r){var s=e;r==="mutation"&&(s=e.target);var f=s._observeId;if(!f&&!this.observeMap.has(f))s._observeId=this.count,s.visible=!1,this.observeMap.set(this.count,s),this.observe(s),this.count++;else if(s.visible===!1){var p=s.getBoundingClientRect(),A=p.top,T=p.left,Q=p.right,Y=p.bottom;A>=0&&Y<=window.innerHeight&&T>=0&&Q<=window.innerWidth&&(s.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e))}},u.prototype.exposureRemove=function(e){this.observeMap.has(e._observeId)&&(this.observeMap.delete(e._observeId),this.unobserve(e))},u.prototype.exposureEvent=function(e){if(e.intersectionRatio>=this.Ratio&&e.isIntersecting){if(e.target.style.opacity==="0"||e.target.style.visibility==="hidden"||e.target.visible===!0)return;e.target.visible=!0,this.EventHandle({eventType:"dom",eventName:"exposure"},e)}else e.target.visible=!1},u.prototype.observe=function(e){this.instance.observe(e)},u.prototype.unobserve=function(e){this.instance.unobserve(e)},u._observer_instance=null,u._observer_map=new Map,u}(),j=function(){function u(e,r){!e.autotrack||!e.autotrack.exposure||(this._intersection=new ee(e,r),this._observer=new X(this._intersection),this.initObserver())}return u.prototype.initObserver=function(){var e=this;Array.prototype.forEach.call(document.querySelectorAll("[data-exposure]"),function(r){e._intersection.exposureAdd(r,"intersect")})},u}(),ue={hashTag:!1,impr:!1},Ke=function(){function u(){}return u.prototype.apply=function(e,r){if(this.autoTrackStart=!1,this.collect=e,this.config=r,!!r.autotrack){var s=e.Types;r.autotrack&&r.autotrack.collect_url&&!r.autotrack.collect_url()||(this.ready(s.Autotrack),this.collect.emit(s.AutotrackReady))}},u.prototype.ready=function(e){this.collect.set(e);var r=this.config.autotrack;r=typeof r=="object"?r:{},r=Object.assign(ue,r),this.destroyed=!1,this.options=r,this.Config=new Se(Ee,this.options),this.Exposure=new j(this.config,this.handle.bind(this)),this.Listener=new re(r,this.collect,this.Config),this.EventHandle=new fr(this.config,r),this.Request=new dr(this.collect),this.autoTrackStart=!0,this.init(),N(this,this.config)},u.prototype.init=function(){this.Listener.init(this.handle.bind(this));try{this.collect.loadType==="base"&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(e){}},u.prototype.handle=function(e,r){var s=e.eventType;s==="dom"&&this.handleDom(e,r)},u.prototype.handleDom=function(e,r){try{var s=e.eventName;if(s==="click"||s==="exposure"||s==="change"||s==="submit"){var f=this.EventHandle.handleEvent(r,s);f!==null&&this.Request.send({eventType:"custom",eventName:"report_"+s+"_event",extra:{methods:"GET"}},f)}else if(s==="page_view"||s==="page_statistics"){var p=void 0;s==="page_view"?p=this.EventHandle.handleViewEvent(r):p=this.EventHandle.handleStatisticsEvent(r),this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"}},p)}else if(s==="beat"){var A=this.EventHandle.handleBeadtEvent(r),T=e.eventSend;this.Request.send({eventType:"custom",eventName:"report_${eventName}_event",extra:{methods:"GET"},eventSend:T},A)}}catch(Q){console.log("handel dom event error "+JSON.stringify(Q))}},u.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},u}(),ke;(function(u){u.Net="net",u.FailNet="f_net",u.FailData="f_data"})(ke||(ke={}));var rt={pv:["predefine_pageview"],sdk:["_be_active","predefine_page_alive","predefine_page_close","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append"],autotrack:["bav2b_click","bav2b_page","bav2b_beat","bav2b_page_statistics","__bav_click","__bav_page","__bav_beat","__bav_page_statistics"]},st=function(){function u(){}return u.prototype.apply=function(e,r){var s=this;if(!!(r.app_id&&r.enable_tracer&&!r.disable_track_event)){this.limit={pv:1,sdk:3,autotrack:3,log:3},this.errorCode={f_net:0,f_data:0},this.tracerCache=new Map,this.collect=e,this.appid=r.app_id,this.reportUrl=e.configManager.getUrl("event");var f=this.collect.Types;this.collect.on(f.Event,function(){s.addCount("log")}),this.collect.on(f.SubmitError,function(p){var A=p.type,T=p.eventDate,Q=p.errorCode,Y=p.response;s.addErrorCount(T,A,Q,Y)}),this.listener(),this.collect.emit(f.TracerReady)}},u.prototype.addCount=function(e,r,s){r===void 0&&(r="net"),s===void 0&&(s=1);try{this.tracerCache||(this.tracerCache=new Map);var f=void 0;if(this.tracerCache.has(e)){var p=this.tracerCache.get(e);if(!p.has(r))f=s,p.set(r,this.processTracer(s,e,r));else{var A=p.get(r);f=A.params.count,f++,p.set(r,this.processTracer(f,e,r))}}else{var p=new Map;f=s,p.set(r,this.processTracer(s,e,r)),this.tracerCache.set(e,p)}r==="net"&&f>=this.limit[e]&&this.report(!1)}catch(T){console.log(T)}},u.prototype.addErrorCount=function(e,r,s,f){var p=this;try{if(e&&e.length){var A=e[0].events;A&&A.length&&(r==="f_data"?(f&&f.hasOwnProperty("sc")?this.addCount("log",r,A.length-f.sc):this.addCount("log",r,A.length),this.errorCode[r]=s):A.forEach(function(T){var Q="log";for(var Y in rt)if(rt[Y].indexOf(T.event)!==-1){Q=Y;break}p.addCount(Q,r,1),p.errorCode[r]=s}))}}catch(T){}},u.prototype.report=function(e){if(!!this.tracerCache){var r=[];this.tracerCache.forEach(function(s){console.log(s),s.forEach(function(f){r.push(f)})}),r&&r.length&&this.sendTracer(r,e)}},u.prototype.sendTracer=function(e,r){try{var s=this.collect.eventManager.merge(e);this.collect.requestManager.useRequest({url:this.reportUrl,data:s,useBeacon:r}),this.tracerCache=null}catch(f){}},u.prototype.processTracer=function(e,r,s){var f={count:e,state:s,key:r,params_for_special:"applog_trace",aid:this.appid,platform:"web",_staging_flag:1,sdk_version:_t};(s==="f_net"||s==="f_data")&&(f.errorCode=this.errorCode[s]);var p=this.collect.processEvent("applog_trace",f);if(p&&p.event)return delete p.is_bav,p},u.prototype.listener=function(){var e=this;document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&e.leavePage()}),ce(function(){e.leavePage()})},u.prototype.leavePage=function(){this.report(!0)},u}(),bt=function(){function u(){this.retryWaitTime=3e3,this.retryStatus=!1,this.retryCacheStatus=!1}return u.prototype.apply=function(e,r){var s=this;if(!(!r.enable_storage||r.disable_storage)&&(this.collect=e,this.config=r,!this.collect.destroy)){var f=e.Types,p=e.adapters.storage;this.storage=new p(!1),this.eventUrl=this.collect.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+r.app_id,this.storageNum=r.storage_num||50,this.retryNum=r.retry_num||3,this.retryInterval=1e3,e.on(f.SubmitError,function(A){A.type!=="f_data"&&s.storeData(A)}),e.on(f.Ready,function(){s.checkStorage()})}},u.prototype.retryRightNow=function(e){var r=this;if(this.retryStatus){this.errorCache.push(e);return}var s=0;this.retryStatus=!0;var f=setInterval(function(){if(s===3){r.storeData(r.errorCache),r.retryStatus=!1,clearInterval(f);return}var p=e.eventData;r.fetchData(p,function(){r.retryStatus=!1,clearInterval(f),r.retryCacheStatus&&r.errorCache.splice(0,1),r.errorCache.length&&(r.retryCacheStatus=!0,r.retryRightNow(r.errorCache[0]))},function(){s++})},this.retryInterval)},u.prototype.storeData=function(e){var r=this.storage.getItem(this.eventKey),s=e.eventData;Object.keys(r).length!==this.storageNum&&(r[Date.now()]=s,this.storage.setItem(this.eventKey,r))},u.prototype.checkStorage=function(){var e=this;try{if(!window.navigator.onLine)return;var r=this.storage.getItem(this.eventKey);if(!r||!Object.keys(r).length)return;var s={events:[{event:"ontest",params:{app_id:this.config.app_id},local_time_ms:Date.now()}],user:{user_unique_id:this.collect.configManager.get("web_id")},header:{}},f=function(){var A=JSON.parse(JSON.stringify(r)),T=function(Le){e.fetchData(r[Le],function(){delete A[Le],e.storage.setItem(e.eventKey,A)},function(){},!1)};for(var Q in r)T(Q)};this.fetchData([s],f,function(){console.log("network error\uFF0Ccompensate report fail")},!0)}catch(p){console.warn("error check storage")}},u.prototype.fetchData=function(e,r,s,f){this.collect.requestManager.useRequest({url:this.eventUrl,data:e,timeout:3e4,success:r,fail:s,app_key:f?"566f58151b0ed37e":""})},u}(),Be=fe(function(u,e){(function(r,s){u.exports=s()})(we,function(){var r=1e3,s=6e4,f=36e5,p="millisecond",A="second",T="minute",Q="hour",Y="day",Le="week",Ve="month",Ge="quarter",xe="year",dt="date",ht="Invalid Date",hr=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_r=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,jr={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},Yt=function(Ot,mt,lt){var Mt=String(Ot);return!Mt||Mt.length>=mt?Ot:""+Array(mt+1-Mt.length).join(lt)+Ot},Sr={s:Yt,z:function(Ot){var mt=-Ot.utcOffset(),lt=Math.abs(mt),Mt=Math.floor(lt/60),ft=lt%60;return(mt<=0?"+":"-")+Yt(Mt,2,"0")+":"+Yt(ft,2,"0")},m:function Ot(mt,lt){if(mt.date()<lt.date())return-Ot(lt,mt);var Mt=12*(lt.year()-mt.year())+(lt.month()-mt.month()),ft=mt.clone().add(Mt,Ve),Xt=lt-ft<0,jt=mt.clone().add(Mt+(Xt?-1:1),Ve);return+(-(Mt+(lt-ft)/(Xt?ft-jt:jt-ft))||0)},a:function(Ot){return Ot<0?Math.ceil(Ot)||0:Math.floor(Ot)},p:function(Ot){return{M:Ve,y:xe,w:Le,d:Y,D:dt,h:Q,m:T,s:A,ms:p,Q:Ge}[Ot]||String(Ot||"").toLowerCase().replace(/s$/,"")},u:function(Ot){return Ot===void 0}},It="en",gt={};gt[It]=jr;var pt=function(Ot){return Ot instanceof Er},er=function(Ot,mt,lt){var Mt;if(!Ot)return It;if(typeof Ot=="string")gt[Ot]&&(Mt=Ot),mt&&(gt[Ot]=mt,Mt=Ot);else{var ft=Ot.name;gt[ft]=Ot,Mt=ft}return!lt&&Mt&&(It=Mt),Mt||!lt&&It},Nt=function(Ot,mt){if(pt(Ot))return Ot.clone();var lt=typeof mt=="object"?mt:{};return lt.date=Ot,lt.args=arguments,new Er(lt)},Tt=Sr;Tt.l=er,Tt.i=pt,Tt.w=function(Ot,mt){return Nt(Ot,{locale:mt.$L,utc:mt.$u,x:mt.$x,$offset:mt.$offset})};var Er=function(){function Ot(lt){this.$L=er(lt.locale,null,!0),this.parse(lt)}var mt=Ot.prototype;return mt.parse=function(lt){this.$d=function(Mt){var ft=Mt.date,Xt=Mt.utc;if(ft===null)return new Date(NaN);if(Tt.u(ft))return new Date;if(ft instanceof Date)return new Date(ft);if(typeof ft=="string"&&!/Z$/i.test(ft)){var jt=ft.match(hr);if(jt){var ur=jt[2]-1||0,kr=(jt[7]||"0").substring(0,3);return Xt?new Date(Date.UTC(jt[1],ur,jt[3]||1,jt[4]||0,jt[5]||0,jt[6]||0,kr)):new Date(jt[1],ur,jt[3]||1,jt[4]||0,jt[5]||0,jt[6]||0,kr)}}return new Date(ft)}(lt),this.$x=lt.x||{},this.init()},mt.init=function(){var lt=this.$d;this.$y=lt.getFullYear(),this.$M=lt.getMonth(),this.$D=lt.getDate(),this.$W=lt.getDay(),this.$H=lt.getHours(),this.$m=lt.getMinutes(),this.$s=lt.getSeconds(),this.$ms=lt.getMilliseconds()},mt.$utils=function(){return Tt},mt.isValid=function(){return this.$d.toString()!==ht},mt.isSame=function(lt,Mt){var ft=Nt(lt);return this.startOf(Mt)<=ft&&ft<=this.endOf(Mt)},mt.isAfter=function(lt,Mt){return Nt(lt)<this.startOf(Mt)},mt.isBefore=function(lt,Mt){return this.endOf(Mt)<Nt(lt)},mt.$g=function(lt,Mt,ft){return Tt.u(lt)?this[Mt]:this.set(ft,lt)},mt.unix=function(){return Math.floor(this.valueOf()/1e3)},mt.valueOf=function(){return this.$d.getTime()},mt.startOf=function(lt,Mt){var ft=this,Xt=!!Tt.u(Mt)||Mt,jt=Tt.p(lt),ur=function(fn,yr){var _n=Tt.w(ft.$u?Date.UTC(ft.$y,yr,fn):new Date(ft.$y,yr,fn),ft);return Xt?_n:_n.endOf(Y)},kr=function(fn,yr){return Tt.w(ft.toDate()[fn].apply(ft.toDate("s"),(Xt?[0,0,0,0]:[23,59,59,999]).slice(yr)),ft)},pr=this.$W,Pr=this.$M,an=this.$D,nr="set"+(this.$u?"UTC":"");switch(jt){case xe:return Xt?ur(1,0):ur(31,11);case Ve:return Xt?ur(1,Pr):ur(0,Pr+1);case Le:var mn=this.$locale().weekStart||0,yn=(pr<mn?pr+7:pr)-mn;return ur(Xt?an-yn:an+(6-yn),Pr);case Y:case dt:return kr(nr+"Hours",0);case Q:return kr(nr+"Minutes",1);case T:return kr(nr+"Seconds",2);case A:return kr(nr+"Milliseconds",3);default:return this.clone()}},mt.endOf=function(lt){return this.startOf(lt,!1)},mt.$set=function(lt,Mt){var ft,Xt=Tt.p(lt),jt="set"+(this.$u?"UTC":""),ur=(ft={},ft[Y]=jt+"Date",ft[dt]=jt+"Date",ft[Ve]=jt+"Month",ft[xe]=jt+"FullYear",ft[Q]=jt+"Hours",ft[T]=jt+"Minutes",ft[A]=jt+"Seconds",ft[p]=jt+"Milliseconds",ft)[Xt],kr=Xt===Y?this.$D+(Mt-this.$W):Mt;if(Xt===Ve||Xt===xe){var pr=this.clone().set(dt,1);pr.$d[ur](kr),pr.init(),this.$d=pr.set(dt,Math.min(this.$D,pr.daysInMonth())).$d}else ur&&this.$d[ur](kr);return this.init(),this},mt.set=function(lt,Mt){return this.clone().$set(lt,Mt)},mt.get=function(lt){return this[Tt.p(lt)]()},mt.add=function(lt,Mt){var ft,Xt=this;lt=Number(lt);var jt=Tt.p(Mt),ur=function(Pr){var an=Nt(Xt);return Tt.w(an.date(an.date()+Math.round(Pr*lt)),Xt)};if(jt===Ve)return this.set(Ve,this.$M+lt);if(jt===xe)return this.set(xe,this.$y+lt);if(jt===Y)return ur(1);if(jt===Le)return ur(7);var kr=(ft={},ft[T]=s,ft[Q]=f,ft[A]=r,ft)[jt]||1,pr=this.$d.getTime()+lt*kr;return Tt.w(pr,this)},mt.subtract=function(lt,Mt){return this.add(-1*lt,Mt)},mt.format=function(lt){var Mt=this,ft=this.$locale();if(!this.isValid())return ft.invalidDate||ht;var Xt=lt||"YYYY-MM-DDTHH:mm:ssZ",jt=Tt.z(this),ur=this.$H,kr=this.$m,pr=this.$M,Pr=ft.weekdays,an=ft.months,nr=function(yr,_n,kn,En){return yr&&(yr[_n]||yr(Mt,Xt))||kn[_n].substr(0,En)},mn=function(yr){return Tt.s(ur%12||12,yr,"0")},yn=ft.meridiem||function(yr,_n,kn){var En=yr<12?"AM":"PM";return kn?En.toLowerCase():En},fn={YY:String(this.$y).slice(-2),YYYY:this.$y,M:pr+1,MM:Tt.s(pr+1,2,"0"),MMM:nr(ft.monthsShort,pr,an,3),MMMM:nr(an,pr),D:this.$D,DD:Tt.s(this.$D,2,"0"),d:String(this.$W),dd:nr(ft.weekdaysMin,this.$W,Pr,2),ddd:nr(ft.weekdaysShort,this.$W,Pr,3),dddd:Pr[this.$W],H:String(ur),HH:Tt.s(ur,2,"0"),h:mn(1),hh:mn(2),a:yn(ur,kr,!0),A:yn(ur,kr,!1),m:String(kr),mm:Tt.s(kr,2,"0"),s:String(this.$s),ss:Tt.s(this.$s,2,"0"),SSS:Tt.s(this.$ms,3,"0"),Z:jt};return Xt.replace(_r,function(yr,_n){return _n||fn[yr]||jt.replace(":","")})},mt.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},mt.diff=function(lt,Mt,ft){var Xt,jt=Tt.p(Mt),ur=Nt(lt),kr=(ur.utcOffset()-this.utcOffset())*s,pr=this-ur,Pr=Tt.m(this,ur);return Pr=(Xt={},Xt[xe]=Pr/12,Xt[Ve]=Pr,Xt[Ge]=Pr/3,Xt[Le]=(pr-kr)/6048e5,Xt[Y]=(pr-kr)/864e5,Xt[Q]=pr/f,Xt[T]=pr/s,Xt[A]=pr/r,Xt)[jt]||pr,ft?Pr:Tt.a(Pr)},mt.daysInMonth=function(){return this.endOf(Ve).$D},mt.$locale=function(){return gt[this.$L]},mt.locale=function(lt,Mt){if(!lt)return this.$L;var ft=this.clone(),Xt=er(lt,Mt,!0);return Xt&&(ft.$L=Xt),ft},mt.clone=function(){return Tt.w(this.$d,this)},mt.toDate=function(){return new Date(this.valueOf())},mt.toJSON=function(){return this.isValid()?this.toISOString():null},mt.toISOString=function(){return this.$d.toISOString()},mt.toString=function(){return this.$d.toUTCString()},Ot}(),Dr=Er.prototype;return Nt.prototype=Dr,[["$ms",p],["$s",A],["$m",T],["$H",Q],["$W",Y],["$M",Ve],["$y",xe],["$D",dt]].forEach(function(Ot){Dr[Ot[1]]=function(mt){return this.$g(mt,Ot[0],Ot[1])}}),Nt.extend=function(Ot,mt){return Ot.$i||(Ot(mt,Er,Nt),Ot.$i=!0),Nt},Nt.locale=er,Nt.isDayjs=pt,Nt.unix=function(Ot){return Nt(1e3*Ot)},Nt.en=gt[It],Nt.Ls=gt,Nt.p={},Nt})}),Fe=fe(function(u,e){(function(r,s){u.exports=s()})(we,function(){var r,s,f=1e3,p=6e4,A=36e5,T=864e5,Q=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,Y=31536e6,Le=2592e6,Ve=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,Ge={years:Y,months:Le,days:T,hours:A,minutes:p,seconds:f,milliseconds:1,weeks:6048e5},xe=function(It){return It instanceof Sr},dt=function(It,gt,pt){return new Sr(It,pt,gt.$l)},ht=function(It){return s.p(It)+"s"},hr=function(It){return It<0},_r=function(It){return hr(It)?Math.ceil(It):Math.floor(It)},jr=function(It){return Math.abs(It)},Yt=function(It,gt){return It?hr(It)?{negative:!0,format:""+jr(It)+gt}:{negative:!1,format:""+It+gt}:{negative:!1,format:""}},Sr=function(){function It(pt,er,Nt){var Tt=this;if(this.$d={},this.$l=Nt,pt===void 0&&(this.$ms=0,this.parseFromMilliseconds()),er)return dt(pt*Ge[ht(er)],this);if(typeof pt=="number")return this.$ms=pt,this.parseFromMilliseconds(),this;if(typeof pt=="object")return Object.keys(pt).forEach(function(Ot){Tt.$d[ht(Ot)]=pt[Ot]}),this.calMilliseconds(),this;if(typeof pt=="string"){var Er=pt.match(Ve);if(Er){var Dr=Er.slice(2).map(function(Ot){return Number(Ot)});return this.$d.years=Dr[0],this.$d.months=Dr[1],this.$d.weeks=Dr[2],this.$d.days=Dr[3],this.$d.hours=Dr[4],this.$d.minutes=Dr[5],this.$d.seconds=Dr[6],this.calMilliseconds(),this}}return this}var gt=It.prototype;return gt.calMilliseconds=function(){var pt=this;this.$ms=Object.keys(this.$d).reduce(function(er,Nt){return er+(pt.$d[Nt]||0)*Ge[Nt]},0)},gt.parseFromMilliseconds=function(){var pt=this.$ms;this.$d.years=_r(pt/Y),pt%=Y,this.$d.months=_r(pt/Le),pt%=Le,this.$d.days=_r(pt/T),pt%=T,this.$d.hours=_r(pt/A),pt%=A,this.$d.minutes=_r(pt/p),pt%=p,this.$d.seconds=_r(pt/f),pt%=f,this.$d.milliseconds=pt},gt.toISOString=function(){var pt=Yt(this.$d.years,"Y"),er=Yt(this.$d.months,"M"),Nt=+this.$d.days||0;this.$d.weeks&&(Nt+=7*this.$d.weeks);var Tt=Yt(Nt,"D"),Er=Yt(this.$d.hours,"H"),Dr=Yt(this.$d.minutes,"M"),Ot=this.$d.seconds||0;this.$d.milliseconds&&(Ot+=this.$d.milliseconds/1e3);var mt=Yt(Ot,"S"),lt=pt.negative||er.negative||Tt.negative||Er.negative||Dr.negative||mt.negative,Mt=Er.format||Dr.format||mt.format?"T":"",ft=(lt?"-":"")+"P"+pt.format+er.format+Tt.format+Mt+Er.format+Dr.format+mt.format;return ft==="P"||ft==="-P"?"P0D":ft},gt.toJSON=function(){return this.toISOString()},gt.format=function(pt){var er=pt||"YYYY-MM-DDTHH:mm:ss",Nt={Y:this.$d.years,YY:s.s(this.$d.years,2,"0"),YYYY:s.s(this.$d.years,4,"0"),M:this.$d.months,MM:s.s(this.$d.months,2,"0"),D:this.$d.days,DD:s.s(this.$d.days,2,"0"),H:this.$d.hours,HH:s.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:s.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:s.s(this.$d.seconds,2,"0"),SSS:s.s(this.$d.milliseconds,3,"0")};return er.replace(Q,function(Tt,Er){return Er||String(Nt[Tt])})},gt.as=function(pt){return this.$ms/Ge[ht(pt)]},gt.get=function(pt){var er=this.$ms,Nt=ht(pt);return Nt==="milliseconds"?er%=1e3:er=Nt==="weeks"?_r(er/Ge[Nt]):this.$d[Nt],er===0?0:er},gt.add=function(pt,er,Nt){var Tt;return Tt=er?pt*Ge[ht(er)]:xe(pt)?pt.$ms:dt(pt,this).$ms,dt(this.$ms+Tt*(Nt?-1:1),this)},gt.subtract=function(pt,er){return this.add(pt,er,!0)},gt.locale=function(pt){var er=this.clone();return er.$l=pt,er},gt.clone=function(){return dt(this.$ms,this)},gt.humanize=function(pt){return r().add(this.$ms,"ms").locale(this.$l).fromNow(!pt)},gt.milliseconds=function(){return this.get("milliseconds")},gt.asMilliseconds=function(){return this.as("milliseconds")},gt.seconds=function(){return this.get("seconds")},gt.asSeconds=function(){return this.as("seconds")},gt.minutes=function(){return this.get("minutes")},gt.asMinutes=function(){return this.as("minutes")},gt.hours=function(){return this.get("hours")},gt.asHours=function(){return this.as("hours")},gt.days=function(){return this.get("days")},gt.asDays=function(){return this.as("days")},gt.weeks=function(){return this.get("weeks")},gt.asWeeks=function(){return this.as("weeks")},gt.months=function(){return this.get("months")},gt.asMonths=function(){return this.as("months")},gt.years=function(){return this.get("years")},gt.asYears=function(){return this.as("years")},It}();return function(It,gt,pt){r=pt,s=pt().$utils(),pt.duration=function(Tt,Er){var Dr=pt.locale();return dt(Tt,{$l:Dr},Er)},pt.isDuration=xe;var er=gt.prototype.add,Nt=gt.prototype.subtract;gt.prototype.add=function(Tt,Er){return xe(Tt)&&(Tt=Tt.asMilliseconds()),er.bind(this)(Tt,Er)},gt.prototype.subtract=function(Tt,Er){return xe(Tt)&&(Tt=Tt.asMilliseconds()),Nt.bind(this)(Tt,Er)}}})});Be.extend(Fe);var it=["__cep_sdk_onboard","__cep_trigger_sdk","_be_active"],tt=["and","or","not"],rr=function(){function u(){this.support=!0,this.currentPlan=1,this.shouldSendEvent=!1,this.staing=!1,this.test=!1,this.cepReady=!1,this.eventCache=[]}return u.prototype.apply=function(e,r){var s=this;if(!!r.cep){this.collect=e,this.config=r;var f=e.adapters.storage,p=e.Types;this.types=p,this.storage=new f(!1),this.configManager=e.configManager,this.url=r.cep_url?""+r.cep_url:e.configManager.getDomain()+"/service/2/cep_settings/",this.reportUrl=e.configManager.getUrl("event"),this.key="__tea_cep_plan_"+r.app_id,this.quotasKey="__tea_cep_plan_quotas_"+r.app_id,this.isWait=!1,this.eventCache=[],this.test=e.configManager.staging,this.collect.on(p.SubmitAfter,function(A){s.matchEvent(A)}),this.init()}},u.prototype.init=function(){var e=this,r=!0,s=0,f=0,p=0,A=!1,T=this.storage.getItem(this.key)||{};if(T&&Object.keys(T).length&&(A=!0,s=T.last_update_time,f=T.fetch_interval,p=T.config_version||0,r=Date.now()-s>f*1e3),r){var Q=this.configManager.get(),Y=Q.header,Le=Q.user;this.collect.requestManager.useRequest({url:this.url,data:{header:Y,user:Le,local_time:Date.now(),config_version:p},success:function(Ge){Ge&&Ge.code===0?(T.fetch_interval=Ge.fetch_interval,T.data=Ge.data,T.last_update_time=Date.now(),T.config_version=Ge.config_version,e.clearQuotas(),e.initState(Ge.data),e.storage.setItem(e.key,T),Ge.data.forEach(function(xe){e.event("__cep_sdk_onboard",xe.plan_id)})):(Ge.code===304||Ge.code===400)&&A?(console.log("code: "+Ge.code+", use old rules~"),T.last_update_time=Date.now(),e.storage.setItem(e.key,T),e.initState(T.data)):console.log("code: "+Ge.code+", request error\uFF0Cplease try leater")},fail:function(){A?(e.planData=T.data,e.initState(T.data)):(e.support=!1,console.log("request error\uFF0Cplease try leater"))},timeout:5e3})}else T.last_update_time=Date.now(),this.storage.setItem(this.key,T),console.log("rule still work, use cache"),this.initState(T.data)},u.prototype.initState=function(e){var r=this;!e||!e.length||(this.stateArray=new Map,this.waitArray=new Map,this.planData=e,e.forEach(function(s){var f=new Map;if(s.pattern&&s.pattern.events){var p=s.pattern.events.length===1;s.pattern.events.forEach(function(A){f.set(A.id,{id:A.id,isMatch:!1,event:null,after:A.after||null,connection:A.connection||null,window:A.window||null,matchTime:0,initTime:Date.now(),singleRule:p})}),r.stateArray.set(s.plan_id,{patternState:f,singleRule:p,pattern:{aid:s.aid,biz_id:s.biz_id,end_time:s.end_time,start_time:s.start_time,web_sdk_version:s.web_sdk_version,stage:s.stage},quotas:s.quotas})}}),this.cepReady=!0,this.dealCache(),this.collect.emit(this.types.CepReady))},u.prototype.check=function(e){var r=Date.now();return Date.now()>e.end_time*1e3?(console.log("event rules:"+e.plan_id+" is over"),!1):r<e.start_time*1e3||r>e.end_time*1e3?(console.log("rule:"+e.plan_id+" time error"),!1):(this.staing=e.staing==="testing",_t<e.web_sdk_version?(this.support=!1,console.log("you sdk version is old\uFF0Cplease update to "+e.web_sdk_version+" at least"),!1):!0)},u.prototype.dealCache=function(){var e=this;if(this.eventCache.length){var r=1;this.eventCache.forEach(function(s){e.matchEvent(s),r++}),r===this.eventCache.length&&(this.eventCache=[])}},u.prototype.matchEvent=function(e){if(!!this.support&&!(this.staing&&!this.test)&&!(!e||!e.length))try{if(!this.cepReady){this.eventCache.push(e);return}var r=e[0],s=r.header,f=r.user,p=r.events;p.length&&p.reverse();for(var A=0;A<p.length;A++){var T=p[A].event;if(it.indexOf(T)!==-1)return!1;this.matchRule(s,f,p[A])}}catch(Q){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Q.message}),console.log(Q.message);return}},u.prototype.matchRule=function(e,r,s){try{for(var f=0;f<this.planData.length;f++){var p=this.planData[f],A=p.plan_id;if(!!this.check(p)&&!!this.checkQuotas(A)&&p.pattern&&p.pattern.events)for(var T=p.pattern.events,Q=0;Q<T.length;Q++){var Y=this.rule(e,r,s,T[Q].condition);if(!!Y){var Le=this.stateArray.get(A).patternState,Ve=Le.get(T[Q].id),Ge=this.stateArray.get(A).singleRule;if(Ge){this.changeStatus(A,T[Q].id,s),this.publish([s],A,T[Q].id);break}else{if(!Ve.isMatch){Ve.after&&Le.get(Ve.after).isMatch?this.changeStatus(A,T[Q].id,s):Ve.after||this.changeStatus(A,T[Q].id,s);break}continue}}}}this.statusCheck()}catch(xe){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:xe.message}),console.log(xe.message);return}},u.prototype.changeStatus=function(e,r,s){var f=this.stateArray.get(e),p=f.patternState.get(r);p.isMatch=!0,p.event=s,p.matchTime=s.local_time_ms||Date.now(),f.patternState.set(r,p),this.stateArray.set(e,f)},u.prototype.statusCheck=function(){var e,r,s,f;try{for(var p=y(this.stateArray),A=p.next();!A.done;A=p.next()){var T=O(A.value,2),Q=T[0],Y=T[1],Le=Y.patternState;if(Y.isSingle)break;try{for(var Ve=y(Le),Ge=Ve.next();!Ge.done;Ge=Ve.next()){var xe=O(Ge.value,2),dt=xe[0],ht=xe[1];if(!(!ht.after||ht.after&&!Le.get(ht.after).isMatch))if(ht.connection==="NOT_FOLLOWED_BY"){ht.isMatch?this.reset(Q,dt):Date.now()-Le.get(ht.after).matchTime>ht.window?this.publish([Le.get(ht.after).event,ht.event],Q,dt):this.startWait(Q,dt,ht);break}else{ht.isMatch?ht.matchTime-Le.get(ht.after).matchTime<=ht.window?this.publish([Le.get(ht.after).event,ht.event],Q,dt):this.reset(Q,dt):Date.now()-Le.get(ht.after).matchTime>ht.window?this.reset(Q,dt):this.startWait(Q,dt,ht);break}}}catch(hr){s={error:hr}}finally{try{Ge&&!Ge.done&&(f=Ve.return)&&f.call(Ve)}finally{if(s)throw s.error}}}}catch(hr){e={error:hr}}finally{try{A&&!A.done&&(r=p.return)&&r.call(p)}finally{if(e)throw e.error}}},u.prototype.startWait=function(e,r,s){var f=this;try{this.waitArray.get(e)||this.waitArray.set(e,new Map);var p=this.waitArray.get(e);if(!p.get(r)){var A=setTimeout(function(){var T=f.stateArray.get(e).patternState,Q=T.get(r);if(Q.connection==="NOT_FOLLOWED_BY")if(!Q.isMatch&&T.get(Q.after).isMatch||Q.matchTime-T.get(Q.after).matchTime>s.window){var Y=f.waitArray.get(e).get(r);Y.triggerWait=!0,f.waitArray.set(e,f.waitArray.get(e).set(r,Y)),f.publish([T.get(Q.after).event],e,r)}else f.reset(e,r);else if(Q.connection==="FOLLOWED_BY")if(Q.isMatch&&T.get(Q.after).isMatch){var Y=f.waitArray.get(e).get(r);Y.triggerWait=!0,f.waitArray.set(e,f.waitArray.get(e).set(r,Y)),f.publish([T.get(Q.after).event],e,r)}else f.reset(e,r)},s.window);p.set(r,{waitFn:A,triggerWait:!1}),this.waitArray.set(e,p)}}catch(T){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:T.message}),console.log(T.message,T.stack)}},u.prototype.rule=function(e,r,s,f){var p=this;try{var A=s.event,T=s.params;if(T=JSON.parse(T),tt.indexOf(f.op)!==-1)if(f.conditions&&f.conditions.length){var Q=f.conditions,Y=0,Le=new Map;Le.set(Y,{op:f.op,result:void 0,resultList:[],resultKey:[],resultLength:Q.length});var Ve=function Yt(Sr,It){for(var gt=0;gt<Sr.length;gt++)if(Y++,tt.indexOf(Sr[gt].op)!==-1&&Sr[gt].hasOwnProperty("conditions"))Le.set(Y,{op:Sr[gt].op,result:void 0,fatherKey:It,resultList:[],resultKey:[],resultLength:Sr[gt].conditions.length}),Yt(Sr[gt].conditions,Y);else{var pt=p.scope(Sr[gt].key),er=pt.scope,Nt=pt.key,Tt=pt.key2,Er=er?er==="header"?Tt?JSON.parse(e[Tt])[Nt]:e[Nt]:er==="user"?r[Nt]:T[Nt]:A,Dr=p.calculate(Sr[gt].op,Er,Sr[gt].value);Le.set(Y,{op:Sr[gt].op,result:Dr,fatherKey:It});continue}};Ve(Q,Y);for(var Ge=Le.get(0);Ge.result===void 0||Ge.resultList.length<Ge.resultLength;)Le.forEach(function(Yt,Sr){if(Yt.result!==void 0&&Yt.fatherKey!==void 0){var It=Le.get(Yt.fatherKey);It.resultList.length<It.resultLength&&It.resultKey.indexOf(Sr)===-1&&(It.resultKey.push(Sr),It.resultList.push(Yt.result),Le.set(Yt.fatherKey,It))}}),Le.forEach(function(Yt){Yt.resultList&&Yt.resultList.length===Yt.resultLength&&(Yt.op==="and"&&(Yt.result=Yt.resultList.indexOf(!1)===-1),Yt.op==="or"&&(Yt.result=Yt.resultList.indexOf(!0)!==-1))});var xe=Le.get(0).result;return xe}else return!1;else{var dt=this.scope(f.key),ht=dt.scope,hr=dt.key,_r=dt.key2,jr=ht?ht==="header"?_r?JSON.parse(e[_r])[hr]:e[hr]:ht==="user"?r[hr]:T[hr]:A;return this.calculate(f.op,jr,f.value)}}catch(Yt){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Yt.message}),console.log(Yt.message),!1}},u.prototype.publish=function(e,r,s){try{var f=this.configManager.get().user,p={biz_id:this.stateArray.get(r).pattern.biz_id,plan_id:r,uid:f.user_id||"",did:f.device_id||"",uuid:f.user_unique_id,events:e,extra:{url:window.location.href}};this.collect.emit("__cep_match",p),(window.opener||window.parent).postMessage({type:"__cep_match",data:p},"*"),this.event("__cep_trigger_sdk",r),this.addQuotas(r),this.reset(r,s),console.log(this.stateArray)}catch(A){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:A.message}),console.log(A.message);return}},u.prototype.addQuotas=function(e){var r=this.stateArray.get(e).quotas;if(r&&r.length){var s=this.storage.getItem(this.quotasKey)||{};s[e]||(s[e]={value:0,lastTime:Date.now()});var f=s[e].value;f===0&&(s[e].lastTime=Date.now()),s[e].value=f+1,this.storage.setItem(this.quotasKey,s)}},u.prototype.checkQuotas=function(e){var r=this.stateArray.get(e).quotas,s=this.storage.getItem(this.quotasKey)||{};if(s[e]||(s[e]={value:0,lastTime:Date.now()}),r&&r.length){var f=r[0].granularity,p=r[0].value;if(r[0].type!=="per_keyid")return!0;var A=this.release(f);if(A==="all")return s[e].value>=p?(console.log("plan:"+e+" limit"),!1):!0;var T=Date.now()-s[e].lastTime;return T>=A?(s[e].value=0,s[e].lastTime=Date.now(),this.storage.setItem(this.quotasKey,s),!0):s[e].value>=p?(console.log("plan:"+e+" limit"),!1):!0}return!0},u.prototype.clearQuotas=function(){this.storage.setItem(this.quotasKey,null)},u.prototype.release=function(e){if(e==="all")return e;var r=Be.duration(e);return r?r.asMilliseconds():"all"},u.prototype.reset=function(e,r){var s=this.stateArray.get(e),f=s.singleRule;if(f){var p=s.patternState.get(r);p.isMatch=!1,p.event=null,p.matchTime=0,p.initTime=Date.now(),s.patternState.set(r,p)}else s.patternState.forEach(function(T){T.isMatch=!1,T.event=null,T.matchTime=0,T.initTime=Date.now()});this.stateArray.set(e,s);var A=this.waitArray.get(e);A&&A.get(r)&&(clearTimeout(A.get(r).waitFn),A.delete(r))},u.prototype.event=function(e,r){try{var s={event:e,params:JSON.stringify({plan_id:r||"",biz_id:this.stateArray.get(r).pattern.biz_id}),local_time_ms:Date.now()},f=this.configManager.get(),p=f.header,A=f.user;p.custom=JSON.stringify(p.custom);var T={events:[s],user:A,header:p};this.collect.requestManager.useRequest({url:this.reportUrl,data:[T]})}catch(Q){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:Q.message}),console.log(Q.message);return}},u.prototype.scope=function(e){var r="",s="";if(e.indexOf(".")>-1){var f=e.split(".");r=f[0],e=f[1],r==="header"&&e==="custom"&&(e=f[2],s=f[1])}return{scope:r,key:e,key2:s}},u.prototype.calculate=function(e,r,s){try{if(e==="=")return r===s;if(["=","<",">",">=","<=","!="].indexOf(e)!==-1)switch(e){case"=":return r===s;case"<":return r<s;case">":return r>s;case">=":return r>=s;case"<=":return r<=s;case"!=":return r!==s}else{if(["in","contains"].indexOf(e)!==-1)return s.indexOf(r)!==-1;if(["is not null","is null"].indexOf(e)!==-1)return e==="is null"?r==null:r!=null;if(["startswith","endswith"].indexOf(e)!==-1){if(e==="startswith")return r.indexOf(s)===0;var f=r.length-s.length,p=r.substr(f,s.length);return p===s}}}catch(A){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:A.message}),console.log(A.message),!1}},u}(),Tr=function(){return typeof window!="undefined"?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null},mr=Tr(),xr=function(){function u(){}return u.prototype.apply=function(e,r){this._plugin={},this.config=r,this.collect=e,this.channel=r.channel||"cn",this.loadExtend()},u.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach(function(r,s){if(r==="sdk")if(Wr.hasOwnProperty(s)){var f=Wr[s].object,p=Wr[s].src[e.channel]+"?query="+Date.now();e.exist(s,f,p)}else console.warn("your "+s+" is not exist\uFF0Cplease check plugin name");else typeof r=="object"&&(r.src?e.exist(s,r.call,r.src):e.process(s,r.instance,"INSTANCE"))})}catch(r){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:r.message}),console.log("load extend error")}},u.prototype.exist=function(e,r,s){var f=this;mr[r]?(this.process(e,mr[r]),console.log("\u5DF2\u6709"+e+"\u63D2\u4EF6\uFF0C\u907F\u514D\u91CD\u590D\u52A0\u8F7D~")):this.loadPlugin(e,s,function(){f.process(e,mr[r]),console.log(" %c %s %s %s","color: yellow; background-color: black;","\u2013","load plugin:"+e+" success","-")},function(){console.log(" %c %s %s %s","color: red; background-color: yellow;","\u2013","load plugin:"+e+" error","-")})},u.prototype.process=function(e,r,s){try{if(s){var f=new r;f.apply&&f.apply(this.collect,this.config),console.log("excude "+e+" success")}else r&&r(this.collect,this.config)}catch(p){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:p.message}),console.log("excude "+e+" error, message:"+p.message)}},u.prototype.loadPlugin=function(e,r,s,f){var p=this;try{var A=document.createElement("script");A.src=r,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(s),A.onerror=function(){f(r)},A.onload=function(){p._plugin[e].forEach(function(T){T()})},document.getElementsByTagName("head")[0].appendChild(A)}catch(T){this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:T.message})}},u}(),Vr=function(){function u(){this.autotrack=!1,this.spa=!1,this.cache={},this.allowHash=!1}return u.prototype.apply=function(e,r){if(!(!r.spa&&!r.autotrack)){var s=e.Types;this.collect=e,this.config=r,this.appid=r.app_id,this.allowHash=r.allow_hash,this.fncArray=new Map,this.setKey(),this.setLocation(),this.hack(),this.init(),this.listener(),e.emit(s.RouteReady)}},u.prototype.setKey=function(){var e=this.collect.adapters.storage;this.storage=new e(!1),this.cache_key="__tea_cache_refer_"+this.appid,this.cache={refer_key:"",refer_title:document.title||location.pathname,refer_manual_key:"",routeChange:!1},this.config.autotrack&&typeof this.config.autotrack=="object"&&this.config.autotrack.page_manual_key&&(this.cache.refer_manual_key=this.config.autotrack.page_manual_key),this.storage.setItem(this.cache_key,this.cache)},u.prototype.hack=function(){var e=this,r=window.history.pushState;history.pushState=function(f){for(var p=[],A=1;A<arguments.length;A++)p[A-1]=arguments[A];typeof history.onpushstate=="function"&&history.onpushstate({state:f});var T=r.call.apply(r,M([history,f],p));if(e.lastLocation!==location.href){var Q=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(Q,"pushState"),T}};var s=history.replaceState;history.replaceState=function(f){for(var p=[],A=1;A<arguments.length;A++)p[A-1]=arguments[A];typeof history.onreplacestate=="function"&&history.onreplacestate({state:f});var T=s.call.apply(s,M([history,f],p));if(e.lastLocation!==location.href){var Q=e.getPopStateChangeEventData();return e.setReferCache(e.lastLocation),e.lastLocation=location.href,e.sendPv(Q),T}}},u.prototype.setLocation=function(){typeof window!="undefined"&&(this.lastLocation=window.location.href)},u.prototype.getLocation=function(){return this.lastLocation},u.prototype.init=function(){var e=this.getPopStateChangeEventData();this.collect.emit("route-change",{config:e,init:!0})},u.prototype.listener=function(){var e=this,r=null,s=10;window.addEventListener("hashchange",function(f){if(e.lastLocation!==window.location.href&&(clearTimeout(r),e.allowHash)){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var p=e.getPopStateChangeEventData();e.sendPv(p)}}),window.addEventListener("popstate",function(f){e.lastLocation!==window.location.href&&(r=setTimeout(function(){e.setReferCache(e.lastLocation),e.lastLocation=window.location.href;var p=e.getPopStateChangeEventData();e.sendPv(p)},s))})},u.prototype.getPopStateChangeEventData=function(){var e=this.pageConfig();return e.is_back=0,e},u.prototype.pageConfig=function(){try{var e=this.storage.getItem(this.cache_key)||{},r=!1,s=this.storage.getItem("__tea_cache_first_"+this.appid);return s&&s==1?r=!1:r=!0,{is_html:1,url:location.href,referrer:this.handleRefer(),page_key:location.href,refer_page_key:this.handleRefer(),page_title:document.title||location.pathname,page_manual_key:this.config.autotrack&&this.config.autotrack.page_manual_key||"",refer_page_manual_key:e&&e.refer_manual_key||"",refer_page_title:e&&e.refer_title||"",page_path:location.pathname,page_host:location.host,is_first_time:""+r}}catch(f){return this.collect.emit(ae.DEBUGGER_MESSAGE,{type:ae.DEBUGGER_MESSAGE_SDK,info:"\u53D1\u751F\u4E86\u5F02\u5E38",level:"error",time:Date.now(),data:f.message}),{}}},u.prototype.sendPv=function(e,r){this.collect.emit("route-change",{config:e,init:!1})},u.prototype.handleRefer=function(){var e="";try{var r=this.storage.getItem()||{};r.routeChange?e=r.refer_key:e=this.collect.configManager.get("referrer")}catch(s){e=document.referrer}return e},u.prototype.setReferCache=function(e){var r=this.storage.getItem(this.cache_key)||{};r.refer_key=e,r.routeChange=!0,this.storage.setItem(this.cache_key,r)},u}();cr.usePlugin(xr,"extend"),cr.usePlugin(Dt,"ab"),cr.usePlugin(Ar,"stay"),cr.usePlugin(Ke,"autotrack"),cr.usePlugin(gr,"et"),cr.usePlugin(Kr,"profile"),cr.usePlugin(bt,"retry"),cr.usePlugin(rr,"cep"),cr.usePlugin(tr,"heartbeat"),cr.usePlugin(Br,"monitor"),cr.usePlugin(Vr,"route"),cr.usePlugin(st,"tracer");var Hr=new cr("default"),Sn=cr,gn=null},30653:(l,n,o)=>{o.d(n,{ZP:()=>ti});var c=o(72364),h=o.n(c),g=()=>{},b=Object.prototype.toString,y=typeof WebAssembly=="object",O=window.requestIdleCallback||window.requestAnimationFrame;function M(){return Math.random().toString(36).substr(2,8)}function G(t){return t&&typeof t=="object"}function le(t){return b.call(t)==="[object Object]"}function Pe(t){return b.call(t).slice(8,-1).toLowerCase()}function Ce(t){return G(t)&&typeof t.then=="function"}var De=Object.prototype.hasOwnProperty;function Ae(t,i){return De.call(t,i)}function ge(t,i,a){Object.defineProperty(t,i,{get:()=>a,set:d=>{typeof process!="undefined"&&process.env},configurable:(typeof process!="undefined"&&process.env,!1)})}function Te(t){const i=Object.create(null);for(let a=0;a<t.length;a++)i[t[a]]=!0;return a=>!!i[a]}function ce(t){const i=Object.create(null);for(let a=0;a<t.length;a++)i[t[a]]=!0;return i}function x(){return typeof window!="undefined"}var P="[Garfish warning]",$=(t,i)=>{try{typeof t=="string"?(t=`${P}: ${t}

`,i(t,!0)):t instanceof Error&&(t.message.startsWith(P)||(t.message=`${P}: ${t.message}`),i(t,!1))}catch(a){i(t,typeof t=="string")}};function he(t){$(t,(i,a)=>{const d=a?i:i.message;console.warn(d)})}function ye(t){$(t,(i,a)=>{throw a?new Error(i):i})}function Re(t){return!!new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i").test(t)}function He(t){const i={};return i[t]=!0,Object.keys(i)[0]}function we(t,i,a,d=!1){const v=Object.keys(i),w=(0,eval)("window;"),L="__garfish__exec_temporary__",U=v.map(H=>`window.${L}.${H}`),V="__garfish_exec_temporary_context__";try{w[L]=i,w[V]=a;const H=[`;(function(${v.join(",")}){${d?'"use strict";':""}`,`
}).call(window.${V},${U.join(",")});`],_e=He(H[0]+t+H[1]);(0,eval)(_e)}catch(H){throw H}finally{delete w[L],delete w[V]}}function fe(t,i){try{t()}catch(a){!i&&(typeof process!="undefined"&&process.env)}}function K(t){Promise.resolve().then(t)}function I(t,i){t||ye(i||"unknow reason")}function k(t){return t===""?!0:t==="false"?!1:Boolean(t)}function se(t,i){if(Array.isArray(t)){const a=t.indexOf(i);return a>-1?(t.splice(a,1),!0):!1}else return t.has(i)?(t.delete(i),!0):!1}function pe(t,...i){}function Je(t){const i=[];for(let a=0,d=t.length;a<d;a++){for(let v=a+1;v<d;v++)t[a]===t[v]&&(v=++a);i.push(t[a])}return i}function me(t){return t===null||typeof t=="string"||typeof t=="number"||typeof t=="bigint"||typeof t=="symbol"||typeof t=="boolean"||typeof t=="undefined"||b.call(t)==="[object RegExp]"}function Ne(t){return Object.keys(t).reduce((i,a)=>(i[a]===void 0&&delete i[a],i),t)}function ne(t,i,a,d){const v=new WeakMap,w=new WeakMap,L=new WeakMap,U=Te(d||[]),V=Array.isArray,H=(nt,St)=>{if(v.has(nt)||w.has(nt))return v.has(St)||w.has(St)},_e=nt=>{if(me(nt)||typeof nt=="function")return nt;if(L.has(nt))return L.get(nt);if(v.has(nt))return v.get(nt);if(w.has(nt))return w.get(nt);if(V(nt)){a&&(nt=Je(nt));const St=[];L.set(nt,St);for(let Ct=0,Lt=nt.length;Ct<Lt;Ct++)St[Ct]=_e(nt[Ct]);return St}else if(typeof nt=="object"){const St={};return L.set(nt,St),Reflect.ownKeys(nt).forEach(Lt=>St[Lt]=_e(nt[Lt])),St}},Ue=(nt,St,Ct)=>{if(nt.has(St))return nt.get(St);{if(U[Ct])return St;const Lt=_e(St);return!me(Lt)&&typeof Lt!="function"&&nt.set(St,Lt),Lt}},wt=(nt,St)=>{const Ct={},Lt=Reflect.ownKeys(nt),qt=Reflect.ownKeys(St);return v.set(nt,Ct),w.set(St,Ct),Lt.forEach(Ht=>{const Jt=nt[Ht],br=St[Ht];if(Ae(St,Ht))if(V(Jt)&&V(br)){const cn=_e([...Jt,...br]);Ct[Ht]=a?Je(cn):cn}else le(Jt)&&le(br)?Ct[Ht]=H(Jt,br)?v.get(Jt):wt(Jt,br):Ct[Ht]=Ue(w,br,Ht);else Ct[Ht]=Ue(v,Jt,Ht)}),qt.forEach(Ht=>{Ae(Ct,Ht)||(Ct[Ht]=Ue(w,St[Ht],Ht))}),Ct};return wt(t,i)}function $e(t){return!!(!/^[a-zA-Z]:\\/.test(t)&&/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(t))}function Oe(t,i){const a=new URL(t,location.href);return new URL(i,a.href).href}function je(t){const i=new URL(t);return i.protocol.startsWith("http")?(i.protocol=i.protocol==="https:"?"wss:":"ws:",i.toString()):t}function vt(t,i){for(const a of i){const d=t.querySelector(a);if(d)return d}return t}function Rt(t,i,a,d,v,w,L){if(!t)return g;const U=document.createElement("script");return!d&&i&&(U.textContent=i),L&&L.getAttributeNames().forEach(H=>{U.setAttribute(H,L.getAttribute(H)||"")}),v&&U.setAttribute("async","true"),w&&U.setAttribute("defer","true"),(H=>{try{a?Object.defineProperty(t,"currentScript",{value:H,writable:!0,configurable:!0}):t.currentScript=H}catch(_e){typeof process!="undefined"&&process.env}})(U),()=>fe(()=>delete t.currentScript,!0)}function _t(t,i){Object.setPrototypeOf(t,i);function a(){this.constructor=t}i===null?t.prototype=Object.create(i):(i.prototype&&(a.prototype=i.prototype),t.prototype=new a)}function Xe(t,i){const a={};for(const d in t)t.hasOwnProperty(d)&&(a[d]=i(d,t[d]));return a}function ut(t,i){return new Promise(a=>{const d=new FileReader;d.readAsDataURL(new Blob([t],{type:i})),d.onload=()=>a(d.result)})}var yt=(t,i,a)=>(...d)=>{if(!t)return g;const v=t[i],w=a(v,...d);let L=w;return typeof L=="function"&&(L=function(...U){try{return w.apply(this,U)}catch(V){return typeof v=="function"&&v.apply(this,U)}}),t[i]=L,U=>{(!U||L===t[i])&&(t[i]=v)}};function Bt(t,i=window.location.href){t=t.replace(/[\[\]]/g,"\\$&");const a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),d=a.exec(i);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}function ar(){const t="__GARFISH_INSTANCE_DEBUG__";return localStorage.getItem(t)||Bt(t)}function Et(){let t=!1;return{triggerSet(){t=!0},handleDescriptor(i){t===!0&&(t=!1,(i==null?void 0:i.writable)===!1&&(i.writable=!0),(i==null?void 0:i.enumerable)===!1&&(i.enumerable=!0),(i==null?void 0:i.configurable)===!1&&(i.configurable=!0))}}}var Zt=/[@#] sourceMappingURL=/g;function xt(t){return Zt.test(t)}function zt(t,i){return sr(this,null,function*(){return`//@ sourceMappingURL=${yield ut(JSON.stringify({version:3,sources:[i],sourcesContent:[t],mappings:";"+t.split(`
`).map(()=>"AACA").join(";")}))}`})}function ae(t){return t instanceof URL?t.href:t instanceof Request?t.url:t.startsWith("/")?`${location.origin}${t}`:t}function Me(t,i=0){return new Promise(a=>{setTimeout(()=>a(t),i)})}var te=class{constructor(){this.fx=[],this.init=!0,this.lock=!1,this.finishDefers=new Set}next(){if(!this.lock)if(this.lock=!0,this.fx.length===0)this.init=!0,this.finishDefers.forEach(t=>t.resolve()),this.finishDefers.clear();else{const t=this.fx.shift();t&&t(()=>{this.lock=!1,this.next()})}}add(t){this.fx.push(t),this.init&&(this.lock=!1,this.init=!1,this.next())}awaitCompletion(){if(this.init)return Promise.resolve();const t={};return this.finishDefers.add(t),new Promise((i,a)=>{t.resolve=i,t.reject=a})}},S=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,J=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,z=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,B=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,q=/\((\S*)(?::(\d+))(?::(\d+))\)/,oe="?";function We(t){const i=t&&t.message;return i?i.error&&typeof i.error.message=="string"?i.error.message:i:"No error message"}function Qe(t){if(!t||!t.stack)return null;const i=[],a=t.stack.split(`
`);let d,v,w,L;for(let U=0;U<a.length;++U){if(w=S.exec(a[U])){const V=w[2]&&w[2].indexOf("native")===0;d=w[2]&&w[2].indexOf("eval")===0,d&&(v=q.exec(w[2]))&&(w[2]=v[1]);let H=w[2]&&w[2].indexOf("address at ")===0?w[2].substr("address at ".length):w[2],_e=w[1]||oe;const Ue=_e.indexOf("safari-extension")!==-1,wt=_e.indexOf("safari-web-extension")!==-1;(Ue||wt)&&(_e=_e.indexOf("@")!==-1?_e.split("@")[0]:oe,H=Ue?`safari-extension:${H}`:`safari-web-extension:${H}`),L={url:H,func:_e,args:V?[w[2]]:[],line:w[3]?+w[3]:null,column:w[4]?+w[4]:null}}else if(w=z.exec(a[U]))L={url:w[2],func:w[1]||oe,args:[],line:+w[3],column:w[4]?+w[4]:null};else if(w=J.exec(a[U]))d=w[3]&&w[3].indexOf(" > eval")>-1,d&&(v=B.exec(w[3]))?(w[1]=w[1]||"eval",w[3]=v[1],w[4]=v[2],w[5]=""):U===0&&!w[5]&&t.columnNumber!==void 0&&(i[0].column=t.columnNumber+1),L={url:w[3],func:w[1]||oe,args:w[2]?w[2].split(","):[],line:w[4]?+w[4]:null,column:w[5]?+w[5]:null};else continue;!L.func&&L.line&&(L.func=oe),i.push(L)}return i.length?{message:We(t),name:t.name,stack:i}:null}var be=["link","style","script","img","video","audio","iframe"],at=Te(be);function Pt(t){if(t&&t.filename)return t.filename;const i=Qe(t);if(i)return i.stack.map(d=>d.url)[0]||null;if(t&&t.target&&t.target.tagName){const a=t.target.tagName.toLowerCase();if(at(a))return t.target.src||t.target.href}return null}function qe(t,i,a){const d=function(L){typeof i=="function"&&(a?(console.log("**********",Pt(L)),a.find(V=>V.indexOf(Pt(L))!==-1)&&i(L)):i(L))},v=function(L){L.promise.catch(U=>{U instanceof Error?d(U):typeof i=="function"&&i(L)})};return function(L){typeof i=="function"&&(t==="unhandledrejection"?v(L):t==="error"?d(L):i(L))}}var Ft=120,wr=58,Wt="http://www.w3.org/2000/svg",Gr="http://www.w3.org/1999/xlink",Nr="http://www.w3.org/XML/1998/namespace",tn="xlink",rn="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Zr=Te(rn.split(","));function Xr(t){return Zr(t)?t:t.toLowerCase()}function Wr(t){return!t||t.length===0?"":t.reduce((i,{key:a,value:d})=>i+(d?`${a}="${d}" `:a),"")}var qr=class{constructor(t){this.document=t||document}isText(t){return t&&t.type==="text"}isNode(t){return t&&t.type==="element"}isCommentNode(t){return t&&t.type==="comment"}isCssLinkNode(t){return this.isNode(t)&&t.tagName==="link"?!!t.attributes.find(({key:i,value:a})=>i==="rel"&&a==="stylesheet"):!1}isIconLinkNode(t){return this.isNode(t)&&t.tagName==="link"?!!t.attributes.find(({key:i,value:a})=>i==="rel"&&a==="icon"):!1}isPrefetchJsLinkNode(t){if(!this.isNode(t)||t.tagName!=="link")return!1;let i,a;for(const{key:d,value:v}of t.attributes)if(d==="rel"){if(i=!0,v!=="preload"&&v!=="prefetch")return!1}else if(d==="as"&&(a=!0,v!=="script"))return!1;return Boolean(i&&a)}isRemoteModule(t){if(!this.isNode(t)||t.tagName!=="meta")return!1;let i,a;for(const{key:d,value:v}of t.attributes)if(d==="name"){if(i=!0,v!=="garfish-remote-module")return!1}else if(d==="src"&&(a=!0,typeof v=="undefined"||v===""))return!1;return Boolean(i&&a)}removeElement(t){const i=t&&t.parentNode;i&&i.removeChild(t)}createElement(t){const{tagName:i,attributes:a}=t,d=Zr(i)?this.document.createElementNS(Wt,i):this.document.createElement(i);return this.applyAttributes(d,a),d}createTextNode(t){return this.document.createTextNode(t.content)}createStyleNode(t){const i=this.document.createElement("style");return t&&(i.textContent=t),this.applyAttributes(i,[{key:"type",value:"text/css"}]),i}createLinkCommentNode(t){return this.isNode(t)?`<link ${Wr(t.attributes).slice(0,-1)}></link>`:(t=t?`src="${t}" `:"",this.document.createComment(`<link ${t}execute by garfish(dynamic)></link>`))}createScriptCommentNode(t){if(this.isNode(t)){const{attributes:i,children:a}=t,d=Wr(i),v=(a==null?void 0:a[0])?a[0].content:"";return this.document.createComment(`<script ${d} execute by garfish>${v}</script>`)}else{const{src:i,code:a}=t,d=i?`src="${i}" `:"";return this.document.createComment(`<script ${d}execute by garfish(dynamic)>${a}</script>`)}}applyAttributes(t,i){if(!(!i||i.length===0))for(const{key:a,value:d}of i)a&&(d===null?t.setAttribute(a,""):typeof d=="string"&&(a.charCodeAt(0)!==Ft?t.setAttribute(a,d):a.charCodeAt(3)===wr?t.setAttributeNS(Nr,a,d):a.charCodeAt(5)===wr&&a.slice(0,5)===tn?t.setAttributeNS(Gr,a,d):t.setAttribute(a,d)))}},zr=Symbol.for("__LOADER_FLAG__"),cr=Symbol.for("__GARFISH_FLAG__"),Ur="__garfishmockhtml__",Lr="__garfishmockbody__",ve="__garfishmockhead__",de="__garfishremovenode__";function D(t){if(t=t==null?void 0:t.trim(),!t)return null;let i=0,a="",d="";for(;i<t.length&&t[i]!=="/";)a+=t[i],i++;if(a.length===0||i>=t.length)return null;for(i++;i<t.length&&t[i]!==";";)d+=t[i],i++;return d=d.replace(/[ \t\n\r]+$/,""),d.length===0?null:{type:a.toLocaleLowerCase(),subtype:d.toLocaleLowerCase()}}function W(t){return t?t.type==="text"&&t.subtype==="css":!1}function C(t){return t?t.type==="text"&&t.subtype==="html":!1}function Z(t){const{type:i,subtype:a}=t||{};switch(i){case"text":switch(a){case"ecmascript":case"javascript":case"javascript1.0":case"javascript1.1":case"javascript1.2":case"javascript1.3":case"javascript1.4":case"javascript1.5":case"jscript":case"livescript":case"x-ecmascript":case"x-javascript":return!0;default:return!1}case"application":switch(a){case"ecmascript":case"javascript":case"x-ecmascript":case"x-javascript":return!0;default:return!1}default:return!1}}function ie(t,i){const a=/callback/;try{const d=new URL(i).search,{type:v,subtype:w}=t||{};if(v==="application"&&w==="json"&&a.test(d))return!0}catch(d){return!1}return!1}function Ie({src:t="",type:i}){if(/\.js$/.test(t))return!0;if(i){if(i==="module")return!0;const a=D(i);if(ie(a,t)||Z(a))return!0}return!1}function Ze({src:t="",type:i}){if(/\.css$/.test(t))return!0;if(i){const a=D(i);if(W(a))return!0}return!1}function ot({src:t="",type:i}){if(/\.html$/.test(t))return!0;if(i){const a=D(i);if(C(a))return!0}return!1}function Ye({type:t=""}){return/garfish-config/i.test(t)}var ct=["onAbort","onAnimationCancel","onAnimationEnd","onAnimationIteration","onAuxClick","onBlur","onChange","onClick","onClose","onContextMenu","onDoubleClick","onError","onFocus","onGotPointerCapture","onInput","onKeyDown","onKeyPress","onKeyUp","onLoad","onLoadEnd","onLoadStart","onLostPointerCapture","onMouseDown","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onReset","onResize","onScroll","onSelect","onSelectionChange","onSelectStart","onSubmit","onTouchCancel","onTouchMove","onTouchStart","onTouchEnd","onTransitionCancel","onTransitionEnd","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onFocusOut"],Gt={onDoubleClick:"dblclick"},$t={onInput:"onChange",onFocusOut:"onBlur",onSelectionChange:"onSelect"};function Vt(t){const i=[];return ct.forEach(function(a){const d=or(a);function v(w){const L=w.path||w.composedPath&&w.composedPath()||Ar(w.target);for(let U=0;U<L.length;U++){const V=L[U];let H=null;const _e=Ut(V),Ue=vr(V);if(Ue?H=Ue:H=gr(_e),_e&&H&&Kt(w,a,H),_e&&H&&$t[a]&&Kt(w,$t[a],H),w.cancelBubble||V===t)break}}t.addEventListener(d,v,!1),i.push(function(){t.removeEventListener(d,v,!1)})}),function(){i.forEach(function(a){a()})}}function vr(t){return Dt(t,"__reactEventHandlers")}function Ut(t){return Dt(t,"_reactInternal")}function Dt(t,i){for(const a in t)if(Ae(t,a)&&a.indexOf(i)!==-1)return t[a]}function gr(t){if(!!t){if(t.memoizedProps)return t.memoizedProps;if(t._currentElement&&t._currentElement.props)return t._currentElement.props}}function Kt(t,i,a){t.persist=function(){t.isPersistent=()=>!0},a[i]&&a[i](t)}function or(t){return Gt[t]?Gt[t]:t.replace(/^on/,"").toLowerCase()}function Ar(t){const i=[];for(;t;){if(i.push(t),t.tagName==="HTML")return i.push(document),i.push(window),i;t=t.parentElement}}var Kr="garfish_app_for";function tr(t){let i=document.createElement("div");const a=document.createElement("div");if(t.sandbox&&t.sandbox.strictIsolation){i=document.createElement("html");const d=a.attachShadow({mode:"open"});d.appendChild(i),Vt(d)}else i.setAttribute(Ur,""),a.appendChild(i);return a.id=`${Kr}_${t.name}_${M()}`,{htmlNode:i,appContainer:a}}function Br(t,i,a){const d=50,v=document.querySelector(t);if(v!==null||a<=0){i(v);return}setTimeout(function(){Br(t,i,a-d)},d)}function nn(t){return new Promise(function(i){setTimeout(i,t)})}function dn(t,i=3e3){const a=new Promise(function(d){Br(t,function(v){return d(v)},i)});return Promise.race([nn(i),a])}function ln(t){return sr(this,null,function*(){I(t,`Invalid domGetter:
 ${t}.`);let i;return typeof t=="string"?i=yield dn(t):typeof t=="function"&&(i=yield Promise.resolve(t())),I(i instanceof Element,`Invalid domGetter: ${t}`),i})}function on({name:t,value:i}){this.key=t,this.value=i}var wn=t=>{const i=[],a=t.attributes,d=a.length;if(d>0)if(d===1)i[0]=new on(a[0]);else if(d===2)i[0]=new on(a[0]),i[1]=new on(a[1]);else for(let v=0;v<d;v++)i[v]=new on(a[v]);return i},Jr=(t,i)=>{switch(t.nodeType){case 3:return{type:"text",content:t.textContent};case 8:return{type:"comment",content:t.textContent};case 1:return i({type:"element",tagName:Xr(t.tagName),attributes:wn(t),children:Array.from(t.childNodes).map(a=>Jr(a,i))});default:ye(`Invalid node type "${t.nodeType}"`)}};function un(t,i){let a=[];const d=document.createElement("html"),v={},w=L=>(i.includes(L.tagName)&&v[L.tagName].push(L),L);d.innerHTML=t;for(const L of i)v[L]=[];return a=Array.from(d.childNodes).map(L=>Jr(L,w)),[a,v]}var Qr=h()("garfish"),Ir=Qr.extend("core"),hn=Qr.extend("router"),m=class{constructor(){this.id=0,this.lockQueue=[]}genId(){return++this.id}getId(){return this.id}wait(t){return sr(this,null,function*(){const{lockQueue:i}=this,a=i[0],d=a?i[i.length-1]:void 0;if((a==null?void 0:a.id)===t)return;let v=i.find(w=>w.id===t);if(!v){let w=()=>{};const L=new Promise(U=>{w=U});v={id:t,waiting:L,resolve:w},i.push(v)}d&&(yield d.waiting)})}release(){const{lockQueue:t}=this,i=t[0];!i||(t.shift(),i.resolve())}clear(){this.lockQueue=[]}},E=class{constructor(t){this.type="",this.listeners=new Set,t&&(this.type=t)}on(t){typeof t=="function"?this.listeners.add(t):typeof process!="undefined"&&process.env}once(t){const i=this;this.on(function a(...d){return i.remove(a),t.apply(null,d)})}emit(...t){this.listeners.size>0&&this.listeners.forEach(i=>i.apply(null,t))}remove(t){return this.listeners.delete(t)}removeAll(){this.listeners.clear()}},F=class extends E{emit(...t){let i;const a=Array.from(this.listeners);if(a.length>0){let d=0;const v=w=>w===!1?!1:d<a.length?Promise.resolve(a[d++].apply(null,t)).then(v):w;i=v()}return Promise.resolve(i)}};function re(t,i){if(!G(i))return!1;if(t!==i){for(const a in t)if(!(a in i))return!1}return!0}var Ee=class extends E{constructor(t){super();this.onerror=ye,this.type=t}emit(t){G(t)||ye(`"${this.type}" hook response data must be an object.`);for(const i of this.listeners)try{const a=i(t);if(re(t,a))t=a;else{this.onerror(`The return value of hook "${this.type}" is incorrect.`);break}}catch(a){typeof process!="undefined"&&process.env,this.onerror(a)}return t}},Se=class extends E{constructor(t){super();this.onerror=ye,this.type=t}emit(t){G(t)||ye(`"${this.type}" hook response data must be an object.`);const i=Array.from(this.listeners);if(i.length>0){let a=0;const d=w=>(typeof process!="undefined"&&process.env,this.onerror(w),t),v=w=>{if(w===!1)return!1;if(re(t,w)){if(t=w,a<i.length)try{return Promise.resolve(i[a++](t)).then(v,d)}catch(L){return d(L)}}else this.onerror(`The return value of hook "${this.type}" is incorrect.`);return t};return Promise.resolve(v(t))}return Promise.resolve(t)}},ze=class{constructor(t){this.registerPlugins={},this.lifecycle=t,this.lifecycleKeys=Object.keys(t)}usePlugin(t){I(le(t),"Invalid plugin configuration.");const i=t.name;if(I(i,"Plugin must provide a name."),this.registerPlugins[i])he(`Repeat to register plugin hooks "${i}".`);else{this.registerPlugins[i]=t;for(const a in this.lifecycle){const d=t[a];d&&this.lifecycle[a].on(d)}}}removePlugin(t){I(t,"Must provide a name.");const i=this.registerPlugins[t];I(i,`plugin "${t}" is not registered.`);for(const a in i)a!=="name"&&this.lifecycle[a].remove(i[a])}inherit({lifecycle:t,registerPlugins:i}){for(const a in t)I(!this.lifecycle[a],`"${a}" hook has conflict and cannot be inherited.`),this.lifecycle[a]=t[a];for(const a in i)I(!this.registerPlugins[a],`"${a}" plugin has conflict and cannot be inherited.`),this.usePlugin(i[a]);return this}},et=Object.defineProperty,kt=Object.getOwnPropertySymbols,ir=Object.prototype.hasOwnProperty,lr=Object.prototype.propertyIsEnumerable,At=(t,i,a)=>i in t?et(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,Qt=(t,i)=>{for(var a in i||(i={}))ir.call(i,a)&&At(t,a,i[a]);if(kt)for(var a of kt(i))lr.call(i,a)&&At(t,a,i[a]);return t},fr=/url\(\s*(['"])?(.*?)\1\s*\)/g,dr=/@charset\s+(['"])(.*?)\1\s*;?/g,Rr=/@import\s+(['"])(.*?)\1/g,Or=class{constructor(t,i){this.depsStack=new Set,this.scopeData=null,this.url=i||null,this.styleCode=t}correctPath(t){const{url:i,styleCode:a}=this;t||(t=i),t&&typeof a=="string"&&(this.styleCode=a.replace(dr,"").replace(Rr,function(d,v,w){return w?`@import url(${v}${w}${v})`:d}).replace(fr,(d,v,w)=>$e(w)?d:`url("${t?Oe(t,w):w}")`))}transformCode(t){return t}setDep(t){this.depsStack.add(t)}setScope(t){this.scopeData=t}isSameOrigin(t){return this.depsStack.has(t)}renderAsStyleElement(t=""){const i=document.createElement("style"),a=t+(this.styleCode?this.styleCode:"/**empty style**/");return i.setAttribute("type","text/css"),i.textContent=this.transformCode(a),i}clone(){const t=new this.constructor;return t.url=this.url,t.styleCode=this.styleCode,t.scopeData=this.scopeData,t.depsStack=new Set(this.depsStack),t}},Mr=class{constructor(t,i){this.alias=null,this.url=i||null,this.moduleCode=t}setAlias(t){t&&typeof t=="string"&&(this.alias=t)}clone(){const t=new this.constructor;return t.url=this.url,t.alias=this.alias,t.moduleCode=this.moduleCode,t}},sn=class{constructor(t,i){if(this.DOMApis=new qr,this.astTree=[],this.pretreatmentStore={},this.url=i,t){const[a,d]=un(t,["meta","link","style","script"]);this.astTree=a,this.pretreatmentStore=d}}getNodesByTagName(...t){let i=0;const a={};for(const d of t)this.pretreatmentStore[d]?(i++,a[d]=this.pretreatmentStore[d]):a[d]=[];if(i!==t.length){const d=v=>{if(v.type==="element"){t.indexOf(v.tagName)>-1&&!this.pretreatmentStore[v.tagName]&&a[v.tagName].push(v);for(const w of v.children)d(w)}};for(const v of this.astTree)d(v)}return a}createElements(t,i,a){const d=[],v=(w,L)=>{var U;let V;if(!this.DOMApis.isCommentNode(w)){if(this.DOMApis.isText(w))V=this.DOMApis.createTextNode(w),L&&L.appendChild(V);else if(this.DOMApis.isNode(w)){const{tagName:H,children:_e}=w;if(typeof a=="function"&&(V=(U=a(w,i))==null?void 0:U.customElement),V||(t[H]?V=t[H](w):V=this.DOMApis.createElement(w)),L&&V&&L.appendChild(V),V){const{nodeType:Ue,_ignoreChildNodes:wt}=V;if(!wt&&Ue!==8&&Ue!==10)for(const nt of _e)v(nt,V)}}}return V};for(const w of this.astTree)if(this.DOMApis.isNode(w)&&w.tagName!=="!doctype"){const L=v(w,i);L&&d.push(L)}return d}toResolveUrl(t,i,a){var d;const v=(d=t.attributes)==null?void 0:d.find(({key:w})=>w===i);v&&v.value&&a&&(v.value=Oe(a,v.value))}ignoreChildNodesCreation(t){return t&&(t._ignoreChildNodes=!0),t}findAllMetaNodes(){return this.getNodesByTagName("meta").meta}findAllLinkNodes(){return this.getNodesByTagName("link").link}findAllJsNodes(){return this.getNodesByTagName("script").script}findAttributeValue(t,i){var a,d;return((d=(a=t.attributes)==null?void 0:a.find(({key:v})=>v===i))==null?void 0:d.value)||void 0}cloneNode(t){return ne(t,{})}clone(){const t=new this.constructor;return t.url=this.url,t.astTree=this.astTree,t.pretreatmentStore=this.pretreatmentStore,t.DOMApis=new qr(this.DOMApis.document),t}},pn=class{constructor(t,i){this.depsStack=new Set,this.mimeType="",this.async=!1,this.defer=!1,this.url=i,this.scriptCode=t}isModule(){return this.mimeType==="module"}isInlineScript(){return Boolean(!this.url)}setMimeType(t){this.mimeType=t||""}setAsyncAttribute(t){this.async=Boolean(t)}setDefferAttribute(t){this.defer=Boolean(t)}setDep(t){this.depsStack.add(t)}isSameOrigin(t){return this.depsStack.has(t)}clone(){const t=new this.constructor;return t.url=this.url,t.async=this.async,t.mimeType=this.mimeType,t.scriptCode=this.scriptCode,t.depsStack=new Set(this.depsStack),t}};function vn(t){return function(a,d){return sr(this,null,function*(){let v=yield t.emit(a,d||{});(!v||!(v instanceof Response))&&(v=yield fetch(a,d||{})),v.status>=400&&ye(`"${a}" load failed with status "${v.status}"`);const w=yield v.text(),L=v.headers.get("content-type")||"",U=Number(v.headers.get("content-size")),V=D(L||"");return{code:w,result:v,mimeType:V,type:L,size:Number.isNaN(U)?null:U}})}}function Yr(t){return t.resourceManager&&(t.resourceManager=t.resourceManager.clone()),t}function Cr(t,i){const a=t.requestConfig,d=typeof a=="function"?a(i):a;return Qt({mode:"cors"},d)}var $r=new WeakSet,_=1024*1024*50,R=Symbol("__defaultBufferPoll__"),N=["js","css","module","template",R],X=class{constructor(t=_){this.totalSize=0,this.recorder={},this.maxSize=t,N.forEach(i=>{this.recorder[i]=0,this[i]=new Map})}bufferPool(t){return this[t]}has(t){return N.some(i=>this[i].has(t))}get(t){for(const i of N)if(this[i].has(t))return this[i].get(t)}set(t,i,a){const d=$r.has(i)?0:i.size,v=this.totalSize+d;if(v<this.maxSize){let w=a,L=this.bufferPool(a);return L||(w=R,L=this.bufferPool(R)),L.set(t,i),this.totalSize=v,this.recorder[w]+=d,!0}return!1}clear(t){if(typeof t=="string"){const i=this.bufferPool(t);if(i&&i instanceof Map){const a=this.recorder[t];this.totalSize-=a,this.recorder[t]=0,i.clear()}}else N.forEach(i=>{this[i].clear(),this.recorder[i]=0}),this.totalSize=0}},ee=(t=>(t.anonymous="same-origin",t["use-credentials"]="include",t))(ee||{}),j=class{constructor(t){this.personalId=zr,this.StyleManager=Or,this.ModuleManager=Mr,this.TemplateManager=sn,this.JavaScriptManager=pn,this.hooks=new ze({error:new E,loaded:new Ee("loaded"),clear:new Ee("clear"),beforeLoad:new Ee("beforeLoad"),fetch:new F("fetch")}),this.options=t||{},this.loadingList=Object.create(null),this.cacheStore=Object.create(null)}setOptions(t){this.options=Qt(Qt({},this.options),t)}clear(t,i){const a=this.cacheStore[t];a&&(a.clear(i),this.hooks.lifecycle.clear.emit({scope:t,fileType:i}))}clearAll(t){for(const i in this.cacheStore)this.clear(i,t)}usePlugin(t){this.hooks.usePlugin(t)}setLifeCycle(t){this.hooks.usePlugin(Qt({name:"loader-lifecycle"},t))}loadModule(t){return this.load({scope:"modules",url:t,isRemoteModule:!0})}load(w){return sr(this,arguments,function*({scope:t,url:i,isRemoteModule:a=!1,crossOrigin:d="anonymous",defaultContentType:v=""}){const{options:L,loadingList:U,cacheStore:V}=this,H=U[i];if(H&&Object.keys(H).includes(t))return Me(H[t],4);let _e=V[t];if(_e||(_e=V[t]=new X(L.maxSize)),_e.has(i))return Me(Yr(_e.get(i)),4);for(const Ct in V){const Lt=V[Ct];if(Lt!==_e&&Lt.has(i)){const qt=Lt.get(i);return $r.add(qt),_e.set(i,qt,qt.fileType),Me(Yr(qt),4)}}const Ue=Cr(this,i);Ue.credentials=ee[d];const wt=this.hooks.lifecycle.beforeLoad.emit({url:i,scope:t,requestConfig:Ue}),St=vn(this.hooks.lifecycle.fetch)(wt.url,wt.requestConfig).then(({code:Ct,size:Lt,result:qt,type:Ht})=>{let Jt,br="";a?(br="module",Jt=this.ModuleManager):ot({type:Ht,src:qt.url})||ot({type:v})?(br="template",Jt=this.TemplateManager):Ie({type:v})||Ie({type:Ht,src:qt.url})?(br="js",Jt=this.JavaScriptManager):(Ze({src:qt.url,type:Ht})||Ze({type:v}))&&(br="css",Jt=this.StyleManager);const cn=Jt?new Jt(Ct,qt.url):null,Fr=this.hooks.lifecycle.loaded.emit({result:qt,value:{url:i,scope:t,resourceManager:cn,fileType:br||"",size:Lt||Ct.length,code:cn?"":Ct}});return br&&_e.set(i,Fr.value,br),Yr(Fr.value)}).catch(Ct=>{throw typeof process!="undefined"&&process.env,this.hooks.lifecycle.error.emit(Ct,{scope:t}),Ct}).finally(()=>{});return U[i]?U[i][t]=St:U[i]={[t]:St},St})}},ue=o(50436),Ke=o(38989),ke=Object.defineProperty,rt=Object.defineProperties,st=Object.getOwnPropertyDescriptors,bt=Object.getOwnPropertySymbols,Be=Object.prototype.hasOwnProperty,Fe=Object.prototype.propertyIsEnumerable,it=(t,i,a)=>i in t?ke(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,tt=(t,i)=>{for(var a in i||(i={}))Be.call(i,a)&&it(t,a,i[a]);if(bt)for(var a of bt(i))Fe.call(i,a)&&it(t,a,i[a]);return t},rr=(t,i)=>rt(t,st(i)),Tr={beforeBootstrap:!0,bootstrap:!0,beforeRegisterApp:!0,registerApp:!0,beforeLoad:!0,afterLoad:!0,errorLoadApp:!0,appID:!0,apps:!0,disableStatistics:!0,disablePreloadApp:!0,plugins:!0,autoRefreshApp:!0,onNotMatchRouter:!0,loader:!0},mr=(t,i)=>{const a=tt(tt({},t.props||{}),i.props||{}),d=ne(Ne(t),Ne(i));return d.props=a,d},xr=(t,i)=>{const a=mr(t,i);return Object.keys(a).forEach(d=>{Tr[d]&&delete a[d]}),a},Vr=(t,i,a)=>{let d=i.appInfos[t]||{name:t};return d=xr(i.options,rr(tt(tt({},d),a),{props:tt(tt({},d.props||{}),(a==null?void 0:a.props)||{})})),d},Hr=()=>({appID:"",apps:[],autoRefreshApp:!0,disableStatistics:!1,disablePreloadApp:!1,basename:"/",props:{},asyncProviderTimeout:2e3,domGetter:()=>document.createElement("div"),sandbox:{snapshot:!1,fixBaseUrl:!1,disableWith:!1,strictIsolation:!1},beforeLoad:()=>{},afterLoad:()=>{},errorLoadApp:i=>ye(i),onNotMatchRouter:()=>{},beforeEval:()=>{},afterEval:()=>{},beforeMount:()=>{},afterMount:()=>{},beforeUnmount:()=>{},afterUnmount:()=>{},errorMountApp:i=>ye(i),errorUnmountApp:i=>ye(i),customLoader:void 0});function Sn(){return new ze({beforeBootstrap:new E,bootstrap:new E,beforeRegisterApp:new E,registerApp:new E,beforeLoad:new F,afterLoad:new F,errorLoadApp:new E})}function gn(){return new ze({beforeEval:new E,afterEval:new E,beforeMount:new E,afterMount:new E,errorMountApp:new E,beforeUnmount:new E,afterUnmount:new E,errorUnmountApp:new E,errorExecCode:new E,customRender:new Ee("customRender")})}var u="__GARFISH_ESM_ENV__",e=t=>{let i="",a=t,d=0;const v="import",w="_import_";return(L,U="")=>{const{d:V,n:H,s:_e,e:Ue,ss:wt,se:nt}=L;if(V>-1){const Ct=wt-d,Lt=nt-d,qt=a.slice(Ct,Lt);i+=a.slice(0,Ct),i+=qt.replace(v,w),a=a.slice(Lt),d=nt}else if(H){const Ct=_e-d,Lt=Ue-d;i+=a.slice(0,Ct),i+=U,a=a.slice(Lt),d=Ue}return[i,a]}},r=(t,i,a)=>`;import*as m$$_${t} from'${i}';import{u$$_ as u$$_${t}}from'${a}';u$$_${t}(m$$_${t})`,s=class{constructor(t){this.moduleCache={},this.lock=new m,this.app=t,this.globalVarKey=`${u}_${this.app.appId}`}execModuleCode(t){const i=(0,eval)(`import('${t}')`);return this.lock.release(),i}createBlobUrl(t){return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}setBlobUrl(t,i){this.moduleCache[t].blobUrl=i}fetchModuleResource(t,i,a,d,v){return sr(this,null,function*(){const{resourceManager:w}=yield this.app.context.loader.load({scope:this.app.name,url:v});if(w){let L="",{url:U,scriptCode:V}=w;xt(V)||(L=yield zt(V,v)),V=yield this.analysisModule(t,V,i,a,d,U);const H=this.createBlobUrl(`import.meta.url='${U}';${this.app.isNoEntryScript(U)?a:i}${V}
${L}`);this.setBlobUrl(d,H)}})}getUrl(t,i){return!$e(i)&&t?Oe(t,i):i}preloadStaticModuleAsync(t,i){const[a]=t;for(let d=0,v=a.length;d<v;d++){const w=a[d],{d:L,n:U}=w,V=L>-1;U&&!V&&this.app.context.loader.load({scope:this.app.name,url:this.getUrl(i,U)})}}analysisModule(t,i,a,d,v,w){return sr(this,null,function*(){yield this.lock.wait(t),yield(0,Ke.S)();const L=(0,Ke.Q)(i,w||""),U={analysis:L,source:i};v&&(this.moduleCache[v]=U);let V=["",i],H="";const _e=`var _import_=(url)=>window.${this.globalVarKey}.import(url,'${v}','${w}');`,Ue=e(i),[wt]=L;this.preloadStaticModuleAsync(L,w);for(let nt=0,St=wt.length;nt<St;nt++){const Ct=wt[nt],{d:Lt,n:qt}=Ct,Ht=Lt>-1;let Jt=qt||"",br="";if(qt&&!Ht){const cn=this.getUrl(w,qt);Jt=this.getUrl(v,qt);let Fr=this.moduleCache[Jt];if(Fr&&!Fr.blobUrl){if(!Fr.shellUrl){const[An,Mn]=Fr.analysis,Nn=An.filter(en=>{const ni=Fr.source.substring(en.ss,en.se);return/^export\s*\*\s*from\s*/.test(ni)}),ri=[];for(let en=0,ni=Nn.length;en<ni;en++){const xi=Nn[en].n||"",Ii=this.getUrl(v,xi);yield this.fetchModuleResource(t,a,d,Ii,this.getUrl(w,xi));const ii=this.moduleCache[Ii];(ii==null?void 0:ii.blobUrl)&&ri.push(`export * from '${ii.blobUrl}'`)}Fr.shellUrl=this.createBlobUrl(`export function u$$_(m){${Mn.map(en=>en.n==="default"?"d$$_=m.default":`${en.n}=m.${en.n}`).join(",")}}${Mn.map(en=>en.n==="default"?"let d$$_;export{d$$_ as default}":`export let ${en.n}`).join(";")}${ri.length?`;${ri.join(";")}`:""}
//# sourceURL=${Jt}?cycle`)}br=Fr.shellUrl}else if(Fr)br=Fr.blobUrl;else{yield this.fetchModuleResource(t,a,d,Jt,cn),Fr=this.moduleCache[Jt];const{blobUrl:An,shellUrl:Mn,shellExecuted:Nn}=Fr;br=An,Mn&&!Nn&&(H+=r(nt,br,Mn),Fr.shellExecuted=!0)}}V=Ue(Ct,br||qt)}return U.source="",delete U.analysis,`${_e}${H};${V.join("")}`})}destroy(){for(const t in this.moduleCache){const{blobUrl:i,shellUrl:a}=this.moduleCache[t];i&&URL.revokeObjectURL(i),a&&URL.revokeObjectURL(a)}this.moduleCache={},this.lock.clear(),delete this.app.global[this.globalVarKey]}load(t,i,a,d){return new Promise(v=>sr(this,null,function*(){if(a&&this.moduleCache[a])return v();const w=(wt,nt,St)=>`export * from '${wt}'${r(0,wt,nt)}
//# sourceURL=${St}?cycle`;i=rr(tt({},i),{resolve:v,import:(wt,nt,St)=>sr(this,null,function*(){let Ct=wt,Lt=wt;$e(wt)||(Ct=Oe(nt,wt),Lt=Oe(St,wt));let qt=this.moduleCache[Ct];return(qt==null?void 0:qt.blobUrl)||(yield this.fetchModuleResource(this.lock.genId(),U,V,Ct,Lt),qt=this.moduleCache[Ct]),qt&&qt.shellUrl&&!qt.shellExecuted&&qt.blobUrl?this.execModuleCode(this.createBlobUrl(w(qt.blobUrl,qt.shellUrl,Ct))):this.execModuleCode(qt.blobUrl)})});const L=(wt,nt)=>{const St=tt({},wt);return nt&&(delete St.exports,delete St.module),Object.keys(St).reduce((Ct,Lt)=>Lt==="resolve"||Lt==="import"?Ct:`${Ct} var ${Lt} = window.${this.globalVarKey}.${Lt};`,"")},U=L(i),V=L(i,!0);let H="";!xt(t)&&a&&(H=yield zt(t,d&&d.isInline?`index.html(inline.${this.app.scriptCount}.js)`:a)),t=yield this.analysisModule(this.lock.genId(),t,U,V,a,a),t=`import.meta.url='${a}';${(d==null?void 0:d.noEntry)?V:U}${t}
;window.${this.globalVarKey}.resolve();
${H}`,this.app.global[this.globalVarKey]=i;let _e=this.createBlobUrl(t);d&&!d.isInline&&a&&this.setBlobUrl(a,_e);const Ue=this.moduleCache[a||""];(Ue==null?void 0:Ue.shellUrl)&&!Ue.shellExecuted&&(_e=this.createBlobUrl(w(_e,Ue.shellUrl,a||""))),this.execModuleCode(_e)}))}},f=0,p="__GARFISH_GLOBAL_ENV__",A="__GARFISH_EXPORTS__",T=class{constructor(t,i,a,d,v,w){this.appId=f++,this.scriptCount=0,this.display=!1,this.mounted=!1,this.mounting=!1,this.strictIsolation=!1,this.esmQueue=new te,this.esModuleLoader=new s(this),this.global=window,this.customExports={},this.sourceList=[],this.sourceListMap=new Map,this.childGarfishConfig={},this.active=!1,this.unmounting=!1,this.deferNodeMap=new Map;var L;this.context=t,this.appInfo=i,this.name=i.name,this.resources=d,this.isHtmlMode=v,this.entryManager=a,this.appInfo.appId=this.appId,this.globalEnvVariables={currentApp:this,loader:t.loader,externals:t.externals,remoteModulesCode:d.modules},this.cjsModules={exports:{},module:null,require:V=>{const H=this.global[V]||t.externals[V]||window[V];return H||he(`Package "${V}" is not found`),H}},this.cjsModules.module=this.cjsModules,this.customLoader=w,this.hooks=gn(),this.hooks.usePlugin(rr(tt({},i),{name:`${i.name}-lifecycle`}));const U=a.getNodesByTagName(...be);for(const V in U)U[V].forEach(H=>{var _e,Ue;const wt=a.findAttributeValue(H,"href")||a.findAttributeValue(H,"src");wt&&this.addSourceList({tagName:H.tagName,url:a.url?Oe(a.url,wt):wt}),Ye({type:a.findAttributeValue(H,"type")})&&(this.childGarfishConfig=JSON.parse((Ue=(_e=H.children)==null?void 0:_e[0])==null?void 0:Ue.content))});this.appInfo.entry&&this.addSourceList({tagName:"html",url:this.appInfo.entry}),this.asyncProviderTimeout=(L=this.appInfo.asyncProviderTimeout)!=null?L:0}get rootElement(){return vt(this.htmlNode,[`div[${Lr}]`,"body"])}get getSourceList(){return this.sourceList}addSourceList(t){if(!this.appInfo.disableSourceListCollect)if(Array.isArray(t)){const i=t.filter(a=>{const d=ae(a.url);return!this.sourceListMap.has(d)&&d.startsWith("http")?(this.sourceListMap.set(d,a),!0):!1});this.sourceList=this.sourceList.concat(i)}else{const i=ae(t.url);!this.sourceListMap.get(i)&&i.startsWith("http")&&(this.sourceList.push(t),this.sourceListMap.set(i,t))}}initAsyncProviderRegistration(){const{asyncProviderTimeout:t,customExports:i}=this;t&&(i.registerProvider=a=>{var d;this.asyncProvider=a,(d=this.resolveAsyncProvider)==null||d.call(this)})}awaitAsyncProviderRegistration(){return new Promise(t=>{if(this.asyncProvider){t(this.asyncProvider);return}const i=setTimeout(()=>{t(this.asyncProvider)},this.asyncProviderTimeout);this.resolveAsyncProvider=()=>{clearTimeout(i),t(this.asyncProvider)}})}getProvider(){return this.provider?Promise.resolve(this.provider):this.checkAndGetProvider()}isNoEntryScript(t=""){var i,a;return(a=(i=this.childGarfishConfig.sandbox)==null?void 0:i.noEntryScripts)==null?void 0:a.some(d=>t.indexOf(d)>-1)}execScript(t,i,a,d){i=tt(tt({},this.getExecScriptEnv(d==null?void 0:d.noEntry)),i||{}),this.scriptCount++;const v=[this.appInfo,t,i,a,d];this.hooks.lifecycle.beforeEval.emit(...v);try{this.runCode(t,i,a,d)}catch(w){throw this.hooks.lifecycle.errorExecCode.emit(w,...v),w}this.hooks.lifecycle.afterEval.emit(...v)}runCode(t,i,a,d){if(d&&d.isModule)this.esmQueue.add(v=>sr(this,null,function*(){yield this.esModuleLoader.load(t,tt(tt({},this.getExecScriptEnv()),i),a,d),v()}));else{const v=Rt(this.global.document,t,!0,a,d==null?void 0:d.async,d==null?void 0:d.defer,d==null?void 0:d.originScript);t+=a?`
//# sourceURL=${a}
`:"",Ae(i,"window")||(i=rr(tt({},i),{window:this.global})),we(`;${t}`,i,this.global),Promise.resolve().then(v)}}show(){return sr(this,null,function*(){this.active=!0;const{display:t,mounted:i,provider:a}=this;return t?!1:i?(this.hooks.lifecycle.beforeMount.emit(this.appInfo,this,!0),this.context.activeApps.push(this),yield this.addContainer(),this.callRender(a,!1),this.display=!0,this.hooks.lifecycle.afterMount.emit(this.appInfo,this,!0),!0):(typeof process!="undefined"&&process.env,!1)})}hide(){this.active=!1,this.mounting=!1;const{display:t,mounted:i,provider:a}=this;return t?i?(this.hooks.lifecycle.beforeUnmount.emit(this.appInfo,this,!0),this.callDestroy(a,!1),this.display=!1,se(this.context.activeApps,this),this.hooks.lifecycle.afterUnmount.emit(this.appInfo,this,!0),!0):(typeof process!="undefined"&&process.env,!1):!1}mount(){return sr(this,null,function*(){if(!this.canMount())return!1;this.hooks.lifecycle.beforeMount.emit(this.appInfo,this,!1),this.active=!0,this.mounting=!0;try{this.context.activeApps.push(this),this.initAsyncProviderRegistration();const{asyncScripts:t,deferScripts:i}=yield this.compileAndRenderContainer();if(!this.stopMountAndClearEffect())return!1;i();const a=yield this.getProvider();if(!this.stopMountAndClearEffect()||(this.callRender(a,!0),this.display=!0,this.mounted=!0,this.hooks.lifecycle.afterMount.emit(this.appInfo,this,!1),yield t,!this.stopMountAndClearEffect()))return!1}catch(t){return this.entryManager.DOMApis.removeElement(this.appContainer),this.hooks.lifecycle.errorMountApp.emit(t,this.appInfo),!1}finally{this.mounting=!1}return!0})}unmount(){if(this.active=!1,this.mounting=!1,!this.mounted||!this.appContainer)return!1;if(this.unmounting)return typeof process!="undefined"&&process.env,!1;this.unmounting=!0,this.hooks.lifecycle.beforeUnmount.emit(this.appInfo,this,!1);try{this.callDestroy(this.provider,!0),this.display=!1,this.mounted=!1,this.provider=void 0,this.customExports={},this.cjsModules.exports={},this.esModuleLoader.destroy(),se(this.context.activeApps,this),this.hooks.lifecycle.afterUnmount.emit(this.appInfo,this,!1)}catch(t){return se(this.context.activeApps,this),this.entryManager.DOMApis.removeElement(this.appContainer),this.hooks.lifecycle.errorUnmountApp.emit(t,this.appInfo),!1}finally{this.unmounting=!1}return!0}getExecScriptEnv(t){const i={[A]:this.customExports,[p]:this.globalEnvVariables};return t?rr(tt({},i),{require:this.cjsModules.require}):tt(tt({},i),this.cjsModules)}compileAndRenderContainer(){return sr(this,null,function*(){yield this.renderTemplate();const t=i=>{for(const a of this.resources.js)if(a[i])try{let d=!1;const v=a.url||this.appInfo.entry;if(i==="defer"){const w=this.deferNodeMap.get(a);w&&(d=k(this.entryManager.findAttributeValue(w,"no-entry"))),d||(d=k(this.isNoEntryScript(v)))}this.execScript(a.scriptCode,{},v,{noEntry:d,defer:i==="defer",async:i==="async",isModule:a.isModule(),isInline:a.isInlineScript()})}catch(d){if(i!=="defer")this.hooks.lifecycle.errorMountApp.emit(d,this.appInfo);else throw d}};return{deferScripts:()=>t("defer"),asyncScripts:new Promise(i=>{setTimeout(()=>{this.stopMountAndClearEffect()&&t("async"),i()})})}})}canMount(){return this.mounting||this.mounted||this.unmounting?(typeof process!="undefined"&&process.env,!1):!0}stopMountAndClearEffect(){return this.active?!0:(typeof process!="undefined"&&process.env,this.mounting=!1,this.appContainer&&this.entryManager.DOMApis.removeElement(this.appContainer),Ir(`${this.appInfo.name} id:${this.appId} stopMountAndClearEffect`,this.appContainer),!1)}callRender(t,i){t&&t.render&&t.render({appName:this.appInfo.name,dom:this.rootElement,basename:this.appInfo.basename,appRenderInfo:{isMount:i},props:this.appInfo.props})}callDestroy(t,i){const{rootElement:a,appContainer:d}=this;t&&t.destroy&&t.destroy({appName:this.appInfo.name,dom:a,appRenderInfo:{isUnmount:i},props:this.appInfo.props}),this.entryManager.DOMApis.removeElement(d)}addContainer(){return sr(this,null,function*(){const t=yield ln(this.appInfo.domGetter);typeof t.appendChild=="function"&&t.appendChild(this.appContainer)})}renderTemplate(){return sr(this,null,function*(){const{appInfo:t,entryManager:i,resources:a}=this,{url:d,DOMApis:v}=i,{htmlNode:w,appContainer:L}=tr(t);this.htmlNode=w,this.appContainer=L,yield this.addContainer();const U={meta:()=>null,img:V=>(d&&i.toResolveUrl(V,"src",d),v.createElement(V)),video:V=>(d&&i.toResolveUrl(V,"src",d),v.createElement(V)),audio:V=>(d&&i.toResolveUrl(V,"src",d),v.createElement(V)),iframe:V=>(d&&i.toResolveUrl(V,"src",d),v.createElement(V)),body:V=>(this.strictIsolation||(V=i.cloneNode(V),V.tagName="div",V.attributes.push({key:Lr,value:null})),v.createElement(V)),head:V=>(this.strictIsolation||(V=i.cloneNode(V),V.tagName="div",V.attributes.push({key:ve,value:null})),v.createElement(V)),script:V=>{const H=i.findAttributeValue(V,"type"),_e=H==="module";if(H&&!_e&&!Ie({type:H}))return v.createElement(V);const Ue=a.js.find(wt=>wt.async?!1:wt.isSameOrigin(V));if(Ue)if(Ue.defer)this.deferNodeMap.set(Ue,V);else{const{url:wt,scriptCode:nt}=Ue,St=document.createElement("script");V.attributes.forEach(Lt=>{Lt.key&&St.setAttribute(Lt.key,Lt.value||"")});const Ct=wt||this.appInfo.entry;this.execScript(nt,{},Ct,{isModule:_e,async:!1,defer:!1,isInline:Ue.isInlineScript(),noEntry:k(i.findAttributeValue(V,"no-entry")||this.isNoEntryScript(Ct)),originScript:St})}else typeof process!="undefined"&&process.env;return v.createScriptCommentNode(V)},style:V=>{const H=V.children[0];if(H){const _e=new this.context.loader.StyleManager(H.content,d);return _e.setScope({appName:this.name,rootElId:this.appContainer.id}),d&&_e.correctPath(d),i.ignoreChildNodesCreation(_e.renderAsStyleElement())}return v.createElement(V)},link:V=>{if(v.isCssLinkNode(V)){const H=this.resources.link.find(_e=>_e.isSameOrigin(V));if(H)return H.setScope({appName:this.name,rootElId:this.appContainer.id}),H.renderAsStyleElement((typeof process!="undefined"&&process.env,""))}return v.isPrefetchJsLinkNode(V)?v.createScriptCommentNode(V):v.isIconLinkNode(V)?null:v.createElement(V)}};i.createElements(U,w,(V,H)=>this.hooks.lifecycle.customRender.emit({node:V,parent:H,app:this,customElement:null}))})}checkAndGetProvider(){return sr(this,null,function*(){const{appInfo:t,rootElement:i,cjsModules:a,customExports:d}=this,{name:v,props:w,basename:L}=t;let U;yield this.esmQueue.awaitCompletion(),a.exports&&(Ce(a.exports)&&(a.exports=yield a.exports),a.exports.provider&&(U=a.exports.provider)),d.provider&&(U=d.provider),this.asyncProviderTimeout&&!U&&(U=yield this.awaitAsyncProviderRegistration()),typeof U=="function"?U=yield U(tt({basename:L,dom:i},w||{}),w):Ce(U)&&(U=yield U),!G(U)&&typeof U!="function"&&he(` Invalid module content: ${v}, you should return both render and destroy functions in provider function.`);const V=yield this.customLoader&&this.customLoader(U,t,L);if(V){const{mount:H,unmount:_e}=V||{};typeof H=="function"&&typeof _e=="function"&&(U.render=H,U.destroy=_e)}return t.noCheckProvider||(I(U,`"provider" is "${U}".`),I("render"in U,'"render" is required in provider.'),I("destroy"in U,'"destroy" is required in provider.')),this.provider=U,U})}};function Q(t,i,a){const d=U=>typeof U!="undefined"&&U!=="false",v=Promise.all(a.findAllJsNodes().map(U=>{const V=a.findAttributeValue(U,"src"),H=a.findAttributeValue(U,"type"),_e=a.findAttributeValue(U,"crossorigin");if(V){const Ue=a.url?Oe(a.url,V):V,wt=a.findAttributeValue(U,"async"),nt=a.findAttributeValue(U,"defer");return i.load({scope:t,url:Ue,crossOrigin:_e,defaultContentType:H}).then(({resourceManager:St})=>{if(St)return St.setDep(U),H&&St.setMimeType(H),St.setAsyncAttribute(d(wt)),St.setDefferAttribute(d(nt)),St;he(`[${t}] Failed to load script: ${Ue}`)}).catch(()=>null)}else if(U.children.length>0){const Ue=U.children[0].content;if(Ue){const wt=new i.JavaScriptManager(Ue,"");return wt.setDep(U),H&&wt.setMimeType(H),wt}}}).filter(Boolean)),w=Promise.all(a.findAllLinkNodes().map(U=>{if(!a.DOMApis.isCssLinkNode(U))return;const V=a.findAttributeValue(U,"href");if(V){const H=a.url?Oe(a.url,V):V;return i.load({scope:t,url:H}).then(({resourceManager:_e})=>{if(_e)return _e.setDep(U),_e==null||_e.correctPath(),_e;he(`${t} Failed to load link: ${H}`)}).catch(()=>null)}}).filter(Boolean)),L=Promise.all(a.findAllMetaNodes().map(U=>{if(!a.DOMApis.isRemoteModule(U))return;const V=a.findAttributeValue(U,"async"),H=a.findAttributeValue(U,"alias");if(d(V))H&&he(`Asynchronous loading module, the alias "${H}" is invalid.`);else{const _e=a.findAttributeValue(U,"src");if(_e)return i.loadModule(_e).then(({resourceManager:Ue})=>(Ue&&H&&Ue&&Ue.setAlias(H),Ue)).catch(()=>null)}}).filter(Boolean));return Promise.all([v,w,L]).then(U=>U.map(V=>V.filter(Boolean)))}function Y(t,i){return sr(this,null,function*(){let a=!1,d;const v={js:[],link:[],modules:[]};I(i.entry,`[${i.name}] Entry is not specified.`);const{resourceManager:w}=yield t.load({scope:i.name,url:Oe(location.href,i.entry)});if(w instanceof t.TemplateManager){a=!0;const[L,U,V]=yield Q(i.name,t,w);v.js=L,v.link=U,v.modules=V}else if(w instanceof t.JavaScriptManager){a=!1;const L=`<script src="${w.url}"></script>`;d=new t.TemplateManager(L,w.url),w.setDep(d.findAllJsNodes()[0]),v.js=[w]}else ye(`Entrance wrong type of resource of "${i.name}".`);return[d||w,v,a]})}function Le(){let t=!1,i=!1;return function(a){return{name:"fix-hmr",version:"1.14.3",bootstrap(){if(t)return;t=!0;let d="webpackHotUpdate",v=window[d];for(const w in window)w.includes("webpackHotUpdate")&&(d=w,v=window[w]);typeof v=="function"&&(window[d]=function(){return i=!0,v.apply(this,arguments)},new MutationObserver(()=>{!i||(i=!1,a.activeApps.forEach(L=>{L.mounted&&setTimeout(()=>{L.display&&L.hide(),L.show()})}))}).observe(document.documentElement,{subtree:!0,childList:!0,attributes:!0}))}}}}function Ve(t,i){return function(){return tt({name:i,version:"1.14.3"},t)}}var Ge="__garfishPreloadApp__",xe=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),dt=new te,ht=()=>navigator.connection?navigator.connection.saveData||/(2|3)g/.test(navigator.connection.effectiveType):!1,hr=typeof O!="function"?window.setTimeout:O;function _r({loader:t,appName:i,url:a,isModule:d,immediately:v,callback:w}){const L=(H=()=>{})=>({resourceManager:_e})=>{w&&w(_e),setTimeout(H,500)},U=(H=()=>{})=>_e=>{typeof process!="undefined"&&process.env,H()},V=(H=()=>{})=>{const _e=U(H),Ue=L(H);try{d?t.loadModule(a).then(Ue,_e):t.load({scope:i,url:a}).then(Ue,_e)}catch(wt){_e(wt),H()}};v?V():dt.add(H=>{hr(()=>V(H))})}function jr(t,i,a=!1){const d=Oe(location.href,i.entry);_r({loader:t,appName:i.name,url:d,isModule:!1,immediately:a,callback:v=>{const w=()=>{if(v instanceof sn){const L=v.url,U=v.findAllJsNodes(),V=v.findAllLinkNodes(),H=v.findAllMetaNodes();U&&U.forEach(_e=>{const Ue=v.findAttributeValue(_e,"src");Ue&&_r({loader:t,appName:i.name,url:L?Oe(L,Ue):Ue,isModule:!1,immediately:a})}),V&&V.forEach(_e=>{if(v.DOMApis.isCssLinkNode(_e)){const Ue=v.findAttributeValue(_e,"href");Ue&&_r({loader:t,appName:i.name,url:L?Oe(L,Ue):Ue,isModule:!1,immediately:a})}}),H&&H.forEach(_e=>{if(v.DOMApis.isRemoteModule(_e)){const Ue=v.findAttributeValue(_e,"src");Ue&&$e(Ue)?_r({loader:t,appName:i.name,url:Ue,isModule:!0,immediately:a}):he(`The loading of the remote module must be an absolute path. "${Ue}"`)}})}};a?w():hr(w)}})}function Yt(){const t=localStorage.getItem(Ge);return t?JSON.parse(t).sort((a,d)=>d.count-a.count):[]}function Sr(t){const i=localStorage.getItem(Ge),a={appName:t,count:1};if(!i)fe(()=>localStorage.setItem(Ge,JSON.stringify([a])));else{const d=JSON.parse(i),v=d.find(w=>w.appName===t);v?v.count++:d.push(a),fe(()=>localStorage.setItem(Ge,JSON.stringify(d)))}}var It=Object.create(null);function gt(){return function(t){return t.preloadApp=i=>{It[i]||(It[i]=!0,jr(t.loader,t.appInfos[i],!0))},{name:"preload",version:"1.14.3",beforeLoad(i){t.options.disablePreloadApp||Sr(i.name)},registerApp(i){t.options.disablePreloadApp||setTimeout(()=>{if(xe||ht())return;const a=Yt();for(const{appName:d}of a)i[d]&&!It[d]&&(It[d]=!0,jr(t.loader,i[d]));for(const d in i)It[d]||jr(t.loader,i[d])},5e3)}}}}var pt=class{constructor(t){this.observer=new MutationObserver(this._mutationObserverCallback.bind(this)),this.subAppBeforeLoadTime=0,this.subAppBeforeMountTime=0,this.subAppStartPageShowTime=0,this.subAppPageShowTime=0,this.entry="",this.observeTimer=0,this.dataTimer=0,this.domQuerySelector=t.subAppRootSelector,this.config={attributes:!0,childList:!0,subtree:!0},this.targetSubscriber=[],this.timeLag=t.domObserverMaxTime||3e3,this.reportTimeLag=t.waitSubAppNotifyMaxTime||1e4,this.isRecordFinish=!1,this.cbEntryList=[],this.isStartShowFlag=!0,this.isCallBackFinish=!1,this.isSubAppNotifyFinish=!1,this.finishAction="",this.performanceData={resourceLoadTime:0,blankScreenTime:0,firstScreenTime:0,isFirstRender:!0,entry:"",action:""}}subscribePerformanceData(t){try{this.targetSubscriber.push(t)}catch(i){he(i)}}subscribePerformanceDataOnce(t){try{const i=a=>{t(a),this.unsubscribePerformanceData(i)};this.targetSubscriber.push(i)}catch(i){he(i)}}unsubscribePerformanceData(t){try{this.targetSubscriber=this.targetSubscriber.filter(i=>i===t)}catch(i){he(i)}}subAppBeforeLoad(t){this.entry=t,this.isRecordFinish=!1,this.isSubAppNotifyFinish=!1,this.subAppBeforeLoadTime=performance.now(),this.isCallBackFinish=!1,this._handleSubscribeCallback(!1)}subAppBeforeMount(){this.subAppBeforeMountTime=performance.now(),this._subAppStartObserver()}subAppUnmount(){this.isRecordFinish||this._subAppEndObserver("subAppUnmount"),this._handleSubscribeCallback(!0)}afterRenderNotify(){this.isRecordFinish?this.isSubAppNotifyFinish||(this.isSubAppNotifyFinish=!0,this.isRecordFinish=!0,this.finishAction="SubAppRenderNotify",this._subAppPerformanceDataHandle()):this._subAppEndObserver("SubAppRenderNotify")}_mutationObserverCallback(){this.isStartShowFlag&&(this.subAppStartPageShowTime=performance.now(),this.isStartShowFlag=!1),clearTimeout(this.observeTimer),this.observeTimer=setTimeout(()=>{clearTimeout(this.observeTimer),this.isRecordFinish||this._subAppEndObserver("MutationObserver")},this.timeLag)}_subAppEndObserver(t){this.isRecordFinish=!0,this.finishAction=t,this.subAppPageShowTime=performance.now(),this.observer.disconnect(),this._subAppPerformanceDataHandle(),this.isStartShowFlag=!0}_subAppStartObserver(){return sr(this,null,function*(){try{const t=yield ln(this.domQuerySelector);this.observer.observe(t,this.config),this._subAppClickEventObserver(t)}catch(t){he(t)}})}_subAppPerformanceDataHandle(){const t=this.finishAction==="MutationObserver"?this.timeLag:0;this.performanceData={resourceLoadTime:this.subAppBeforeMountTime-this.subAppBeforeLoadTime,blankScreenTime:this.subAppStartPageShowTime-this.subAppBeforeLoadTime,firstScreenTime:this.subAppPageShowTime-this.subAppBeforeLoadTime-t,isFirstRender:this.cbEntryList.indexOf(this.entry)===-1,entry:this.entry,action:this.finishAction}}_subAppClickEventObserver(t){const i=()=>{clearTimeout(this.observeTimer),this.isRecordFinish||this._subAppEndObserver("UserEvent")};t.addEventListener("click",i),t.addEventListener("keyup",i),t.addEventListener("keydown",i),t.addEventListener("keypress",i)}_handleCallback(){try{this.isCallBackFinish=!0,this.targetSubscriber.forEach(t=>{const{firstScreenTime:i,blankScreenTime:a,resourceLoadTime:d,action:v,entry:w}=this.performanceData;i>0&&a>0&&d>0&&v&&w?(typeof process!="undefined"&&process.env,this.cbEntryList.push(this.entry),t(this.performanceData)):typeof process!="undefined"&&process.env})}catch(t){he(t)}}_handleSubscribeCallback(t){try{clearTimeout(this.dataTimer),t&&!this.isCallBackFinish?this._handleCallback():this.dataTimer=setTimeout(()=>{this._handleCallback()},this.reportTimeLag)}catch(i){he(i)}}};function er(){return function(){const t={};return{name:"performance",beforeLoad(i){!t[i.name]&&i.domGetter&&(t[i.name]=new pt({subAppRootSelector:i.domGetter})),t[i.name].subAppBeforeLoad(i.entry)},afterLoad(i,a){a&&(a.appPerformance=t[i.name])},beforeMount(i){t[i.name].subAppBeforeMount(i.entry)},beforeUnmount(i){t[i.name].subAppUnmount(i.entry)}}}}function Nt(){return function(){return{name:"garfish-logger",version:"1.14.3",beforeLoad(t,...i){Ir(`${t.name} beforeLoad`,[t,...i])},afterLoad(t,i,...a){i&&Ir(`${t.name} id: ${i.appId} afterLoad`,[t,...a])},beforeMount(t,i,...a){Ir(`${t.name} id: ${i.appId} beforeMount`,[t,...a])},afterMount(t,i,...a){Ir(`${t.name} id: ${i.appId} afterMount`,[t,...a])},beforeUnmount(t,i,...a){Ir(`${t.name} id: ${i.appId} beforeUnmount`,[t,...a])},afterUnmount(t,i,...a){Ir(`${t.name} id: ${i.appId} afterUnmount`,[t,...a])}}}}var Tt=new WeakMap,Er={SyncHook:E,AsyncHook:F,SyncWaterfallHook:Ee,AsyncWaterfallHook:Se},Dr=class extends ue.EventEmitter2{constructor(t){super();this.running=!1,this.version="1.14.3",this.flag=cr,this.loader=new j,this.hooks=Sn(),this.channel=new ue.EventEmitter2,this.options=Hr(),this.externals={},this.activeApps=[],this.plugins={},this.cacheApps={},this.appInfos={},this.loading={};var i;this.setOptions(t),Tt.set(this,{}),(i=this.options.plugins)==null||i.forEach(a=>this.usePlugin(a)),this.usePlugin(Le()),this.usePlugin(er()),this.usePlugin(gt()),this.usePlugin(Nt())}get props(){return this.options&&this.options.props||Tt.get(this)}setOptions(t){return I(!this.running,"Garfish is running, can`t set options"),le(t)&&(this.options=mr(this.options,t)),this}createPluginSystem(t){const i=t(Er);return new ze(i)}usePlugin(t,...i){I(!this.running,"Cannot register plugin after Garfish is started."),I(typeof t=="function","Plugin must be a function."),i.unshift(this);const a=t.apply(null,i);return I(a.name,"The plugin must have a name."),this.plugins[a.name]?typeof process!="undefined"&&process.env:(this.plugins[a.name]=a,this.hooks.usePlugin(a)),this}run(t={}){var i;return this.running?(typeof process!="undefined"&&process.env,this):(this.setOptions(t),(i=t.plugins)==null||i.forEach(a=>this.usePlugin(a)),this.usePlugin(Ve(this.options,"global-lifecycle")),this.hooks.lifecycle.beforeBootstrap.emit(this.options),this.registerApp(this.options.apps||[]),this.running=!0,this.hooks.lifecycle.bootstrap.emit(this.options),this)}registerApp(t){const i={};this.hooks.lifecycle.beforeRegisterApp.emit(t),Array.isArray(t)||(t=[t]);for(const a of t)I(a.name,"Miss app.name."),this.appInfos[a.name]?typeof process!="undefined"&&process.env:(I(a.entry,`${a.name} application entry is not url: ${a.entry}`),i[a.name]=a,this.appInfos[a.name]=a);return this.hooks.lifecycle.registerApp.emit(i),this}setExternal(t,i){if(I(t,"Invalid parameter."),typeof t=="object")for(const a in t)typeof process!="undefined"&&process.env,this.externals[a]=t[a];else this.externals[t]=i;return this}loadApp(t,i){I(t,"Miss appName.");let a=Vr(t,this,i);const d=()=>sr(this,null,function*(){if((yield this.hooks.lifecycle.beforeLoad.emit(a))===!1)return he(`Load ${t} application is terminated by beforeLoad.`),null;a=Vr(t,this,a),I(a.entry,`Can't load unexpected child app "${t}", Please provide the entry parameters or registered in advance of the app.`);let w=null;const L=this.cacheApps[t];if(a.cache&&L)w=L;else try{const[U,V,H]=yield Y(this.loader,a);w=new T(this,a,U,V,H,a.customLoader);for(const _e in this.plugins)w.hooks.usePlugin(this.plugins[_e]);a.cache&&(this.cacheApps[t]=w)}catch(U){typeof process!="undefined"&&process.env,this.hooks.lifecycle.errorLoadApp.emit(U,a)}return yield this.hooks.lifecycle.afterLoad.emit(a,w),w});return this.loading[t]||(this.loading[t]=d().finally(()=>{delete this.loading[t]})),this.loading[t]}},Ot=Object.defineProperty,mt=Object.defineProperties,lt=Object.getOwnPropertyDescriptors,Mt=Object.getOwnPropertySymbols,ft=Object.prototype.hasOwnProperty,Xt=Object.prototype.propertyIsEnumerable,jt=(t,i,a)=>i in t?Ot(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,ur=(t,i)=>{for(var a in i||(i={}))ft.call(i,a)&&jt(t,a,i[a]);if(Mt)for(var a of Mt(i))Xt.call(i,a)&&jt(t,a,i[a]);return t},kr=(t,i)=>mt(t,lt(i)),pr="__GARFISH_ROUTER_UPDATE_FLAG__",Pr="__GARFISH_ROUTER_FLAG__",an="garfish:before-routing-event",nr={basename:"/",current:{fullPath:"/",path:"/",matched:[],query:{},state:{},href:""},apps:[],beforeEach:(t,i,a)=>a(),afterEach:(t,i,a)=>a(),active:()=>Promise.resolve(),deactive:()=>Promise.resolve(),routerChange:()=>{},autoRefreshApp:!0,listening:!0};function mn(t,i){nr[t]=i}function yn(t){Object.assign(nr,t)}function fn(t=""){const i={};return t&&t.slice(1).split("&").map(a=>{const d=a.split("=");i[d[0]]=d}),i}function yr(t="/",i){return t==="/"||t===""?i||location.pathname:(i||location.pathname).replace(new RegExp(`^/?${t}`),"")}function _n(t){const i=yr(t.basename,location.pathname);let a=t.basename==="/"?"":t.basename||"";return typeof t.activeWhen=="string"?a+=t.activeWhen:a+=i.split("").reduce((d,v)=>typeof t.activeWhen=="function"&&!t.activeWhen(d)?d+v:d,""),a}function kn(t,i){return sr(this,null,function*(){const a=t.length;let d=0;for(;d<a;){const v=t[d];yield i(v,d,t),d++}})}function En(t,i,a){return new Promise((d,v)=>{try{a(t,i,d)}catch(w){v(w)}})}function Di(t){let i;return navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0?(i=document.createEvent("UIEvents"),i.initUIEvent(t.toLowerCase(),!0,!1,window,0)):i=new Event(t.toLowerCase()),i}var zn=typeof o.g!="undefined"?o.g==null?void 0:o.g.CustomEvent:null;function Li(){try{const t=new zn("cat",{detail:{foo:"bar"}});return t.type==="cat"&&t.detail.foo==="bar"}catch(t){}return!1}var xn;zn&&Li()?xn=zn:typeof document!="undefined"&&typeof document.createEvent=="function"?xn=function(t,i){i=i||{bubbles:!1,cancelable:!1,detail:null};const a=document.createEvent("CustomEvent");return a.initCustomEvent(t,i.bubbles||!1,i.cancelable||!1,i.detail||null),a}:xn=function(t,i){const a=document.createEventObject();return a.type=t,i?(a.bubbles=Boolean(i.bubbles),a.cancelable=Boolean(i.cancelable),a.detail=i.detail):(a.bubbles=!1,a.cancelable=!1,a.detail=void 0),a};var oi=xn;function Pi(t,i){let a;try{a=new PopStateEvent("popstate",{state:t})}catch(d){a=document.createEvent("PopStateEvent"),a.initPopStateEvent("popstate",!1,!1,t)}return a.garfish=!0,a.garfishTrigger=i,a}var Ni=t=>{const i=Pi(window.history.state,t);window.dispatchEvent(i)},si=function(t,i,a){if(!t||typeof t!="string")return"";let d=t;if(d[0]!=="/"&&(d="/"+d),Object.prototype.toString.call(i)==="[object Object]"){const v=Object.keys(i).map(w=>`${w}=${i[w]}`).join("&");d+=v?"?"+v:""}return a!=="/"&&(d=a+d),d[0]!=="/"&&(d="/"+d),d},zi=({path:t,query:i,basename:a})=>{a||(a=nr.basename||"/");let d=null;Re(t)?d=/(^https?:)|(^\/\/)/.test(t)?t:`//${t}`:d=si(t,i,a),history.pushState(ur({[pr]:!0},history.state),"",d)},Ui=({path:t,query:i,basename:a})=>{a||(a=nr.basename||"/");let d=null;Re(t)?d=/^(https?:)(\/\/)/.test(t)?t:`//${t}`:d=si(t,i,a),history.replaceState(ur({[pr]:!0},history.state),"",d)},ai=(t,i)=>{if(typeof t=="string"){if(t[0]!=="/"&&(t=`/${t}`),t==="/"&&i===t)return!0;const a=t.split("/"),d=i.split("/");let v=!0;return a.forEach((w,L)=>{w&&w!==d[L]&&(v=!1)}),v}else return t(i)},ci=d=>sr(this,[d],function*({toRouterInfo:t,fromRouterInfo:i,eventType:a}){const{current:v,apps:w,deactive:L,active:U,notMatch:V,beforeEach:H,afterEach:_e,autoRefreshApp:Ue}=nr,wt=v.matched.filter(Ht=>!ai(Ht.activeWhen,yr(Ht.basename,location.pathname))),nt=w.filter(Ht=>ai(Ht.activeWhen,yr(Ht.basename,location.pathname))),St=nt.filter(({name:Ht})=>!v.matched.some(({name:Jt})=>Ht===Jt)),Ct=kr(ur({},t),{matched:St}),Lt=kr(ur({},i),{matched:wt});yield En(Ct,Lt,H),v.matched.length>0&&(yield kn(wt,Ht=>sr(this,null,function*(){return yield L(Ht,yr(Ht.basename,location.pathname))}))),yn({current:{path:yr(nr.basename),fullPath:location.pathname,href:location.href,matched:nt,state:history.state,query:fn(location.search)}});const qt=window.history.state||{};a!=="popstate"&&(qt[pr]||Ue)&&Ni(a),yield kn(St,Ht=>sr(this,null,function*(){const Jt=_n(Ht);yield U(Ht,Jt)})),nt.length===0&&V&&V(location.pathname),yield En(Ct,Lt,_e)}),Bi=()=>{const t=function(){window.addEventListener(an,function(i){nr.routerChange&&nr.routerChange(location.pathname),ci(i.detail)})};if(!window[Pr]){const i=function(a){const d=history[a];return function(){const v=window.location.pathname+window.location.hash,w=history==null?void 0:history.state,L=d.apply(this,arguments),U=window.location.pathname+window.location.hash,V=history==null?void 0:history.state,H=Di(a);return H.arguments=arguments,(v!==U||JSON.stringify(w)!==JSON.stringify(V))&&window.dispatchEvent(new oi(an,{detail:{toRouterInfo:{fullPath:U,href:location.href,query:fn(location.search),path:yr(nr.basename,U),state:V},fromRouterInfo:{fullPath:v,query:nr.current.query,href:nr.current.href,path:yr(nr.basename,v),state:w},eventType:a}})),L}};history.pushState=i("pushState"),history.replaceState=i("replaceState"),window.addEventListener("popstate",function(a){a&&typeof a=="object"&&a.garfish||(history.state&&typeof history.state=="object"&&delete history.state[pr],window.dispatchEvent(new oi(an,{detail:{toRouterInfo:{fullPath:location.pathname,href:location.href,query:fn(location.search),path:yr(nr.basename)},fromRouterInfo:{fullPath:nr.current.fullPath,path:yr(nr.basename,nr.current.path),href:nr.current.href,query:nr.current.query},eventType:"popstate"}})))},!1),window[Pr]=!0}t()},li=()=>{ci({toRouterInfo:{fullPath:location.pathname,href:location.href,path:yr(nr.basename),query:fn(location.search),state:history.state},fromRouterInfo:{fullPath:"/",href:"",path:"/",query:{},state:{}},eventType:"pushState"})},ji=()=>{Bi(),li()},Fi=t=>{mn("beforeEach",t)},Gi=t=>{mn("afterEach",t)},$i=t=>{mn("routerChange",t)},ui=t=>{const i=t.filter(a=>!nr.apps.some(d=>a.name===d.name));mn("apps",nr.apps.concat(i))},fi=({apps:t,basename:i="/",autoRefreshApp:a,active:d,deactive:v,notMatch:w,listening:L=!0})=>{ui(t),yn({basename:i,autoRefreshApp:a,active:d,deactive:v,notMatch:w,listening:L}),ji()},Vi={push:zi,replace:Ui,beforeEach:Fi,afterEach:Gi,registerRouter:ui,routerChange:$i,listenRouterAndReDirect:fi,setRouterConfig:yn,routerConfig:nr},On=Vi;function Hi(t){return function(i){return i.apps={},i.router=On,{name:"router",version:"1.14.3",bootstrap(a){let d=null;const v={},{basename:w}=a,{autoRefreshApp:L=!0,onNotMatchRouter:U=()=>null}=i.options;function V(nt,St="/"){return sr(this,null,function*(){if(hn(`${nt.name} active`,{appInfo:nt,rootPath:St,listening:nr.listening}),!nr.listening)return;const{name:Ct,active:Lt,cache:qt=!0}=nt;if(Lt)return Lt(nt,St);nt.rootPath=St;const Ht=d=M(),Jt=yield i.loadApp(nt.name,{cache:qt,basename:St,entry:nt.entry,domGetter:nt.domGetter});if(Jt){Jt.appInfo.basename=St;const br=(cn,Fr)=>sr(this,null,function*(){if(!cn)return;const An=qt&&cn.mounted;return Fr?yield cn[An?"show":"mount"]():cn[An?"hide":"unmount"]()});i.apps[Ct]=Jt,v[Ct]=()=>{Jt.mounting&&delete i.cacheApps[Ct],br(Jt,!1)},Ht===d&&(yield br(Jt,!0))}})}function H(nt,St){return sr(this,null,function*(){hn(`${nt.name} deactive`,{appInfo:nt,rootPath:St}),d=null;const{name:Ct,deactive:Lt}=nt;if(Lt)return Lt(nt,St);const qt=v[Ct];qt&&qt(),delete i.apps[Ct];const Ht=On.routerConfig.apps.filter(Jt=>{if(nt.rootPath===Jt.basename)return!0});Ht.length>0&&(Ht.forEach(Jt=>{delete i.appInfos[Jt.name],delete i.cacheApps[Jt.name]}),On.setRouterConfig({apps:On.routerConfig.apps.filter(Jt=>!Ht.some(br=>Jt.name===br.name))}))})}const Ue=Object.values(i.appInfos).filter(nt=>(nt.basename||(nt.basename=w),!!nt.activeWhen)),wt={basename:w,active:V,deactive:H,autoRefreshApp:L,notMatch:U,apps:Ue,listening:!0};hn("listenRouterAndReDirect",wt),fi(wt)},registerApp(a){const d=Object.values(a);On.registerRouter(d.filter(v=>!!v.activeWhen)),!!i.running&&(hn("registerApp initRedirect",a),li())}}}}var Wi=Object.defineProperty,qi=Object.defineProperties,Zi=Object.getOwnPropertyDescriptors,di=Object.getOwnPropertySymbols,Ki=Object.prototype.hasOwnProperty,Ji=Object.prototype.propertyIsEnumerable,hi=(t,i,a)=>i in t?Wi(t,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[i]=a,Cn=(t,i)=>{for(var a in i||(i={}))Ki.call(i,a)&&hi(t,a,i[a]);if(di)for(var a of di(i))Ji.call(i,a)&&hi(t,a,i[a]);return t},pi=(t,i)=>qi(t,Zi(i)),Yi="__Garfish__",Tn="__garfish_optimize__",Un=Symbol.for("garfish.proxyNode"),vi=Symbol.for("garfish.domWrapper"),Bn=Symbol.for("garfish.windowBind"),jn=Symbol.for("garfish.sandboxMap"),Fn=Symbol.for("garfish.documentBind"),Gn=Symbol.for("garfish.globalObject"),gi=Symbol.for("garfish.elementSandboxTag"),mi="eval,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Array,ArrayBuffer,BigInt,BigInt64Array,BigUint64Array,Boolean,DataView,Date,Error,EvalError,FinalizationRegistry,Float32Array,Float64Array,Function,Int8Array,Int16Array,Int32Array,Map,Number,Object,Promise,Proxy,RangeError,ReferenceError,RegExp,Set,SharedArrayBuffer,String,Symbol,SyntaxError,TypeError,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,URIError,WeakMap,WeakRef,WeakSet,Atomics,JSON,Math,Reflect,".split(","),Xi="hasOwnProperty,".split(","),Qi=Te(mi),eo=Te(Xi),to=[...mi].filter(t=>t!=="eval"),$n=new Map;window[jn]?$n=window[jn]:window[jn]=$n;var Rn={sandboxMap:$n,get(t){if(!t)return;const i=t[gi];if(typeof i=="number")return this.sandboxMap.get(i)},setElementTag(t,i){!t||(t[gi]=i.id)},set(t){this.sandboxMap.get(t.id)||this.sandboxMap.set(t.id,t)},del(t){this.sandboxMap.delete(t.id)}};function In(t){return t=Array.isArray(t)?t:Array.from(t),t.map(i=>i&&i[Un]?i[Un]:i)}function Vn(t){const i=t&&t.options.el;return i&&i()}function _i(t,i,a){const d={},v={},w=Object.create(null),L=Object.getOwnPropertyNames(t),U=V=>{const H=Object.getOwnPropertyDescriptor(t,V);if(H==null?void 0:H.configurable){const _e=Ae(H,"get"),Ue=Ae(H,"set"),wt=typeof a=="function"&&a(V);_e&&(H.get=()=>Ae(w,V)?w[V]:t[V]),Ue&&(H.set=nt=>(w[V]=nt,!0)),wt&&(H.writable===!1?H.writable=!0:Ue&&(H.set=nt=>(w[V]=nt,!0))),Object.defineProperty(d,V,Object.freeze(H))}};L.forEach(V=>{v[V]=!0,typeof i=="function"?!i(V)&&U(V):U(V)});for(const V in t)!v[V]&&U(V);return d}var Hn=!0;function ro(t){const i=document.children[0];i&&i.parentNode!==t&&(Object.defineProperty(i,"parentNode",{value:t,configurable:!0}),Hn&&(Hn=!1,K(()=>{Hn=!0,Object.defineProperty(i,"parentNode",{value:document,configurable:!0})})))}function Wn(t){var i;return t instanceof HTMLStyleElement&&!t.textContent&&((i=t.sheet)==null?void 0:i.cssRules.length)}var no=class{constructor(){this.id=0,this.lockQueue=[]}genId(){const t=this.id;let i=()=>{};const a=new Promise(v=>{i=v}),d={id:t,waiting:a,resolve:()=>{i(),this.next()}};return this.lockQueue.push(d),this.id+=1,t}getId(){return this.id}wait(t){return sr(this,null,function*(){const{lockQueue:i}=this,a=i[0];if((a==null?void 0:a.id)===t){this.lockQueue.shift(),this.next();return}let d=i.find(v=>v.id===t);d&&(yield d.waiting)})}release(t){const{lockQueue:i}=this,a=i.findIndex(d=>d.id===t);i.splice(a,1),a===0&&this.next()}next(){const t=this.lockQueue.shift();t&&t.resolve()}clear(){this.lockQueue=[]}};function yi(t){return t===void 0?!1:"value"in t||"writable"in t}function bi(t){return t===void 0?!1:"get"in t||"set"in t}function wi(t,i,a){const d=Object.getOwnPropertyDescriptor(t,i);if(d!==void 0&&d.configurable===!1){if(yi(d)&&d.writable===!1){if(!Object.is(a,d.value))return typeof process!="undefined"&&process.env,1}else if(bi(d)&&d.get===void 0)return 2}return 0}function io(t,i,a,d,v){const w=qn(t||v||i,a,d);let L;return w>0&&((w===1||w===2)&&(L=!1),w===3&&(L=!0)),L}function qn(t,i,a){const d=Object.getOwnPropertyDescriptor(t,i);if(d!==void 0&&d.configurable===!1){if(yi(d)&&d.writable===!1)return Object.is(a,d.value)?3:(typeof process!="undefined"&&process.env,1);if(bi(d)&&d.set===void 0)return 2}return 0}function oo(t){try{return t.toString()}catch(i){return"[toString failed]"}}function so(t){const i=t.prototype,a=i&&i.constructor===t&&Object.getOwnPropertyNames(i).length>1,d=!a&&oo(t);return a||/^function\s+[A-Z]/.test(d)||/^class\b/.test(d)}var ao=Te(["length","caller","callee","arguments","prototype",Symbol.hasInstance]);function co(t,i){for(const a of Reflect.ownKeys(t)){if(ao(a))continue;const d=Object.getOwnPropertyDescriptor(i,a);d&&d.writable&&(i[a]=t[a])}}function Si(t,i){const a=function(){};function d(){const v=In(arguments);if(this instanceof d){const w=new t(...v);return Object.setPrototypeOf(w,d.prototype),w}else return t.apply(i,v)}return d.$native=t,co(t,d),t.prototype&&(a.prototype=t.prototype),d.prototype=new a,Symbol.hasInstance&&Object.defineProperty(d,Symbol.hasInstance,{configurable:!0,value(v){const w=t.prototype;return G(w)||typeof w=="function"?v instanceof t:!1}}),d}var lo=Te(["scrollRestoration"]);function uo(){const t=Object.getPrototypeOf(window.history)||History.prototype,i=Object.create(t),a=new Proxy(i,{get(v,w){const L=Ae(v,w)?v[w]:window.history[w];return typeof L=="function"?L.bind(window.history):L},set(v,w,L,U){const V=typeof w=="string"&&lo(w),H=io(V?history:null,v,w,L,U);return H!==void 0?H:V?Reflect.set(history,w,L):Reflect.set(v,w,L,U)},getPrototypeOf(){return i}}),d=function(){throw new TypeError("Illegal constructor")};return d.prototype=i,d.prototype.constructor=d,{override:{history:a,History:d}}}function fo(t){const i=t.options.baseUrl,a=new Set,d=new Set,v=new Set,w=H=>t.options.fixBaseUrl&&i&&typeof H=="string"&&!$e(H);class L extends XMLHttpRequest{constructor(){super();d.add(this)}open(){arguments[2]===!1&&d.delete(this),w(arguments[1])&&(arguments[1]=i?Oe(i,arguments[1]):arguments[1]);const _e=arguments[1];return t.options.addSourceList&&t.options.addSourceList({tagName:"xmlhttprequest",url:_e}),super.open.apply(this,arguments)}abort(){return d.delete(this),super.abort.apply(this,arguments)}}class U extends WebSocket{constructor(_e,Ue){if(w(_e)&&i){const wt=je(i);_e=Oe(wt,arguments[1])}super(_e,Ue);a.add(this)}close(){return a.delete(this),super.close.apply(this,arguments)}}return{override:{WebSocket:U,XMLHttpRequest:L,fetch:(H,_e={})=>{w(H)&&i&&(H=Oe(i,H)),t.options.addSourceList&&t.options.addSourceList({tagName:"fetch",url:H});let Ue;!Ae(_e,"signal")&&window.AbortController&&(Ue=new window.AbortController,v.add(Ue),_e.signal=Ue.signal);const wt=window.fetch(H,_e);return Ue&&Ce(wt)?wt.finally(()=>v.delete(Ue)):wt}},recover(){a.forEach(H=>{typeof H.close=="function"&&H.close()}),d.forEach(H=>{typeof H.abort=="function"&&H.abort()}),v.forEach(H=>{typeof H.abort=="function"&&H.abort()}),a.clear(),d.clear(),v.clear()}}}var Zn=Te(["title","cookie","onselectstart","ondragstart"]),ho=Te(["querySelector","querySelectorAll","getElementById","getElementsByTagName","getElementsByTagNameNS","getElementsByClassName"]);function po(t){return(i,a,d)=>{if(a==="activeElement")return Reflect.get(document,a);const v=Vn(t),w=t.options.strictIsolation,L=Ae(i,a)?Reflect.get(i,a,d):Reflect.get(document,a),U=t.hooks.lifecycle.documentGetter.emit({value:L,rootNode:v,propName:a,proxyDocument:i,customValue:null});if(U.customValue)return U.customValue;const V=H=>(G(H)&&(Rn.setElementTag(H,t),typeof process!="undefined"&&process.env),H);if(v){if(a==="createElement")return function(H,_e){const Ue=L.call(document,H,_e);return V(Ue)};if(a==="createTextNode")return function(H){const _e=L.call(document,H);return V(_e)};if(a==="head")return vt(v,["head",`div[${ve}]`])||L;if(w){if(a==="body")return vt(v,["body",`div[${Lr}]`]);if(ho(a))return a==="getElementById"?H=>v.querySelector(`#${H}`):v[a].bind(v)}}if(typeof L=="function"){let H=Ae(L,Fn)?L[Fn]:null;H||(H=Si(L,document));const _e=wi(i,a,H);if(_e>0){if(_e===1)return L;if(_e===2)return}return L[Fn]=H,H}return L}}var Ei=Et();function vo(t){return(i,a,d,v)=>{const w=Vn(t),L=qn(typeof a=="string"&&Zn(a)?document:v||i,a,d);if(L>0){if(L===1||L===2)return!1;if(L===3)return!0}return a==="onselectstart"||a==="ondragstart"?w?Reflect.set(w,a,d):Reflect.set(document,a,d):typeof a=="string"&&Zn(a)?Reflect.set(document,a,d):(Ei.triggerSet(),Reflect.set(i,a,d,v))}}function go(){return(t,i,a)=>(Ei.handleDescriptor(a),Zn(i)?Reflect.defineProperty(document,i,a):Reflect.defineProperty(t,i,a))}function mo(){return(t,i)=>i==="activeElement"?Reflect.has(document,i):Ae(t,i)||Reflect.has(document,i)}var _o=t=>{let i=Object.create(document);const a=po(t),d=_i(document),v=new Proxy(d,{get:(...w)=>(ro(i),a(...w)),has:mo()});return i=new Proxy(Object.create(v,{currentScript:{value:null,writable:!0},[Un]:{writable:!1,configurable:!1,value:document}}),{set:vo(t),defineProperty:go(),getPrototypeOf(){return HTMLDocument.prototype||Document.prototype}}),{override:{document:i}}},yo=class extends MouseEvent{constructor(t,i){i&&Pe(i.view)==="window"&&(i.view=window),super(t,i)}};function bo(){return{override:{MouseEvent:yo}}}var ki=class{constructor(t,i){this.rawStorage=i,this.namespace=t,this.prefix=`${Yi}${t}__`}get length(){return this.getKeys().length}getKeys(){return Object.keys(this.rawStorage).filter(t=>t.startsWith(this.prefix))}key(t){const i=this.getKeys()[t];return i?i.substring(this.prefix.length):null}getItem(t){return this.rawStorage.getItem(`${this.prefix+t}`)}setItem(t,i){this.rawStorage.setItem(`${this.prefix+t}`,i)}removeItem(t){this.rawStorage.removeItem(`${this.prefix+t}`)}clear(){this.getKeys().forEach(t=>{this.rawStorage.removeItem(t)})}};function wo(t){const i=t.options.namespace;return{override:{localStorage:new ki(i,localStorage),sessionStorage:new ki(i,sessionStorage)}}}function So(t){const i=new Map,a=window.addEventListener,d=window.removeEventListener;function v(U,V,H){const _e=i.get(U)||[];i.set(U,[..._e,V]),a.call(this,U,V,H)}function w(U,V,H){const _e=i.get(U)||[],Ue=_e.indexOf(V);Ue!==-1&&_e.splice(Ue,1),i.set(U,[..._e]),d.call(this,U,V,H)}return{recover:()=>{i.forEach((U,V)=>{U.forEach(H=>{d.call(window,V,H)})}),i.clear()},override:{addEventListener:v.bind(window),removeEventListener:w.bind(window)},created(U){const V=U==null?void 0:U.document;V&&(V.addEventListener=v.bind(document),V.removeEventListener=w.bind(document))}}}function Eo(t){const i=new Set;class a extends MutationObserver{constructor(w){super(w);i.add(this)}}return{recover:()=>{i.forEach(v=>{typeof v.disconnect=="function"&&v.disconnect()}),i.clear()},override:{MutationObserver:a}}}var ko=window.setTimeout,Ai=window.clearTimeout,Ao=window.setInterval,Oi=window.clearInterval,Oo=()=>{const t=new Set;return{recover:()=>{t.forEach(v=>{Ai(v)})},override:{setTimeout:(v,w,...L)=>{const U=ko(v,w,...L);return t.add(U),U},clearTimeout:v=>{t.delete(v),Ai(v)}}}},Co=()=>{const t=new Set;return{recover:()=>{t.forEach(v=>{Oi(v)})},override:{setInterval:(v,w,...L)=>{const U=Ao(v,w,...L);return t.add(U),U},clearInterval:v=>{t.delete(v),Oi(v)},setImmediate:v=>setTimeout(v,0)}}};function To(){if(window.MutationObserver){const a=window.MutationObserver.prototype.observe;MutationObserver.prototype.observe=function(){return a.apply(this,In(arguments))}}const t=Object.getOwnPropertyDescriptor(window.Document.prototype,"activeElement"),i=t&&t.get;i&&Object.defineProperty(window.Document.prototype,"activeElement",{get(...a){return i.apply(In([this])[0],In(a))}})}var Ro=Te(["insertBefore","insertAdjacentElement"]),Kn=Object.create(null),Dn=class{constructor(t,i,a){this.nativeAppend=Kn.appendChild,this.nativeRemove=Kn.removeChild,this.el=t,this.sandbox=i,this.methodName=a,this.rootElement=Vn(i)||document,this.DOMApis=new qr(i.global.document),this.tagName=t.tagName?t.tagName.toLowerCase():""}is(t){return this.tagName===t}fixResourceNodeUrl(t){const i=this.sandbox.options.baseUrl;if(i){const a=t.getAttribute("src"),d=t.getAttribute("href");a&&(t.src=Oe(i,a)),d&&(t.href=Oe(i,d));const v=t.src||t.href;v&&this.sandbox.options.addSourceList&&this.sandbox.options.addSourceList({tagName:t.tagName,url:v})}}dispatchEvent(t,i){Promise.resolve().then(()=>{var a;const d=t==="error";let v;d&&i?v=new ErrorEvent(t,pi(Cn({},i),{message:(a=i.error)==null?void 0:a.message})):v=new Event(t),v.__byGarfish__=!0,Object.defineProperty(v,"target",{value:this.el}),this.el.dispatchEvent(v),d&&window.dispatchEvent(v)})}addDynamicLinkNode(t){const{href:i,type:a}=this.el;if(!a||Ze({src:i,type:a})){if(i){const{baseUrl:v,namespace:w,styleScopeId:L}=this.sandbox.options,U=v?Oe(v,i):i,V=Dn.linkLock.genId();this.sandbox.loader.load({scope:w,url:U,defaultContentType:a}).then(_e=>sr(this,[_e],function*({resourceManager:H}){yield Dn.linkLock.wait(V),H?(H.correctPath(),L&&H.setScope({appName:w,rootElId:L()}),t(H.renderAsStyleElement())):he(`Invalid resource type "${a}", "${i}" can't generate styleManager`),this.dispatchEvent("load")})).catch(H=>{Dn.linkLock.release(V),typeof process!="undefined"&&process.env,this.dispatchEvent("error",{error:H,filename:U})})}}else typeof process!="undefined"&&process.env;const d=this.DOMApis.createLinkCommentNode(i);return this.el[de]=()=>this.DOMApis.removeElement(d),d}addDynamicScriptNode(){const{src:t,type:i,crossOrigin:a}=this.el,d=i==="module",v=this.el.textContent||this.el.text||"";if(!i||Ie({src:t,type:i})){const{baseUrl:w,namespace:L}=this.sandbox.options;if(t){const V=w?Oe(w,t):t;this.sandbox.loader.load({scope:L,url:V,crossOrigin:a,defaultContentType:i}).then(H=>{if(H.resourceManager){const{resourceManager:{url:_e,scriptCode:Ue}}=H;this.sandbox.execScript(Ue,{},_e,{isModule:d,defer:!1,async:!1,noEntry:!0,originScript:this.el})}else he(`Invalid resource type "${i}", "${t}" can't generate scriptManager`);this.dispatchEvent("load")},H=>{typeof process!="undefined"&&process.env,this.dispatchEvent("error",{error:H,filename:V})})}else v&&this.sandbox.execScript(v,{},w,{noEntry:!0,originScript:this.el});const U=this.DOMApis.createScriptCommentNode({src:t,code:v});return this.el[de]=()=>this.DOMApis.removeElement(U),U}return this.el}monitorChangesOfLinkNode(){if(this.el.modifyFlag)return;new MutationObserver(i=>{var a;if(!this.el.modifyFlag){for(const{type:d,attributeName:v}of i)if(d==="attributes"&&(v==="rel"||v==="stylesheet")){if(this.el.modifyFlag)return;if(this.el.rel==="stylesheet"&&this.el.href){this.el.disabled=this.el.modifyFlag=!0;const w=this.addDynamicLinkNode(L=>{var U;(U=w.parentNode)==null||U.replaceChild(L,w)});(a=this.el.parentNode)==null||a.replaceChild(w,this.el)}}}}).observe(this.el,{attributes:!0})}monitorChangesOfStyle(){const{baseUrl:t,namespace:i,styleScopeId:a}=this.sandbox.options,d=a==null?void 0:a(),v=L=>{if(L){const U=new this.sandbox.loader.StyleManager(L);U.correctPath(t),d&&U.setScope({rootElId:d,appName:i}),L=U.transformCode(L)}return L};new MutationObserver(L=>{var U;for(const{type:V,target:H,addedNodes:_e}of L)if(V==="childList"){const Ue=H;if(Wn(Ue)&&Ue.sheet){const wt=Ue.sheet.insertRule;Ue.sheet.insertRule=function(){return arguments[0]=v(arguments[0]),wt.apply(this,arguments)}}else((U=_e[0])==null?void 0:U.textContent)&&(_e[0].textContent=v(_e[0].textContent))}}).observe(this.el,{childList:!0})}findParentNodeInApp(t,i){return t===document.body?vt(this.rootElement,["body",`div[${Lr}]`]):t===document.head?vt(this.rootElement,["head",`div[${ve}]`]):this.rootElement.contains(t)||!document.contains(t)?t:i==="head"?vt(this.rootElement,["head",`div[${ve}]`]):i==="body"?vt(this.rootElement,["body",`div[${Lr}]`]):t}append(t,i,a){var d;let v,w=t;const{baseUrl:L,namespace:U,styleScopeId:V}=this.sandbox.options;if(be.includes(this.tagName)&&this.fixResourceNodeUrl(this.el),this.is("script"))w=this.findParentNodeInApp(t,"body"),v=this.addDynamicScriptNode();else if(this.is("style")){w=this.findParentNodeInApp(t,"head");const H=new this.sandbox.loader.StyleManager(this.el.textContent);H.correctPath(L),V&&H.setScope({appName:U,rootElId:V()}),this.el.textContent=H.transformCode(H.styleCode),v=this.el,this.sandbox.dynamicStyleSheetElementSet.add(this.el),this.monitorChangesOfStyle()}else this.is("link")&&(w=this.findParentNodeInApp(t,"head"),this.el.rel==="stylesheet"&&this.el.href?v=this.addDynamicLinkNode(H=>this.nativeAppend.call(w,H)):(v=this.el,this.monitorChangesOfLinkNode()));if(!this.rootElement.contains(w)&&document.contains(w)&&w!==this.rootElement&&this.sandbox.deferClearEffects.add(()=>(this.DOMApis.removeElement(this.el),this.el)),this.el&&this.el.querySelectorAll){const H=this.el.querySelectorAll("iframe,img,video,link,script,audio,style");H.length>0&&H.forEach(_e=>{fe(()=>this.fixResourceNodeUrl(_e))})}if(this.is("iframe")&&typeof this.el.onload=="function"){const{el:H,sandbox:_e}=this,Ue=H.onload;H.onload=function(){return fe(()=>ge(H.contentWindow,"parent",_e.global)),Ue.apply(this,arguments)}}return v?Ro(this.methodName)&&this.rootElement.contains(t)&&((d=i[1])==null?void 0:d.parentNode)===t?a():(this.sandbox.hooks.lifecycle.appendNode.emit(w,this.el,v,this.tagName),this.nativeAppend.call(w,v)):a()}removeChild(t,i){if(typeof this.el[de]=="function")return this.el[de](),this.el;if(this.is("style")||this.is("link")||this.is("script")){const a=this.findParentNodeInApp(t,this.is("script")?"body":"head");if(this.el.parentNode===a)return this.sandbox.dynamicStyleSheetElementSet.has(this.el)&&this.sandbox.dynamicStyleSheetElementSet.delete(this.el),this.nativeRemove.call(a,this.el)}return i()}},Jn=Dn;Jn.linkLock=new no;var Mo=["append","appendChild","insertBefore","insertAdjacentElement"],xo=["removeChild"],Io=Te(["STYLE","SCRIPTS","LINK","META","TITLE"]);function Do(t,i){return function(){var a;const d=i==="insertAdjacentElement"?arguments[1]:arguments[0],v=Rn.get(d),w=()=>t.apply(this,arguments);if(fe(()=>{Io(d.tagName)||(d==null?void 0:d.setAttribute)&&typeof(d==null?void 0:d.setAttribute)=="function"&&!(d==null?void 0:d.getAttribute("elementtiming"))&&(d==null||d.setAttribute("elementtiming",v?`${v.options.namespace}-element-timing`:"element-timing"))}),v)if(d&&((a=this==null?void 0:this.tagName)==null?void 0:a.toLowerCase())==="style"){const L=new v.loader.StyleManager(d.textContent),{baseUrl:U,namespace:V,styleScopeId:H}=v.options;return L.correctPath(U),L.setScope({appName:V,rootElId:H()}),d.textContent=L.transformCode(L.styleCode),w()}else return new Jn(d,v,i).append(this,arguments,w);else return w()}}function Lo(t,i){return function(){const a=arguments[0],d=a&&Rn.get(a),v=()=>t.apply(this,arguments);return d?new Jn(a,d,i).removeChild(this,v):v()}}function Po(){Object.defineProperty(window.Element.prototype,"ownerDocument",{get(){const t=this&&Rn.get(this),i=Reflect.get(window.Node.prototype,"ownerDocument",this);return t?t.global.document:i},set(){typeof process!="undefined"&&process.env}})}function Yn(t){if(!Yn.hasInject){if(Yn.hasInject=!0,typeof window.Element=="function"){t.fixBaseUrl&&fe(()=>Po());const i=(a,d)=>{for(const v of a){const w=window.Element.prototype[v];if(typeof w!="function"||w[vi])continue;Kn[v]=w;const L=d(w,v);L[vi]=!0,window.Element.prototype[v]=L}};i(Mo,Do),i(xo,Lo)}To()}}function No(t,i){t.forEach(a=>{Wn(a)&&a.sheet&&i.set(a,a.sheet.cssRules)})}function zo(t,i){t.forEach(a=>{var d,v;const w=i.get(a);if(w&&(Wn(a)||w.length))for(let L=0;L<w.length;L++){const U=w[L];(v=a.sheet)==null||v.insertRule(U.cssText,(d=a.sheet)==null?void 0:d.cssRules.length)}})}function Uo(){return new ze({closed:new E,stared:new E,appendNode:new E,documentGetter:new Ee("documentGetter"),beforeClearEffect:new E,afterClearEffect:new E,beforeInvoke:new E,afterInvoke:new E,invokeError:new E})}function Bo(t){return(i,a,d)=>{if(a===Symbol.unscopables)return;let v;const{overrideList:w}=t.replaceGlobalVariables;if(t.isProtectVariable(a))return Reflect.get(window,a);if(t.isInsulationVariable(a)?v=Reflect.get(i,a,d):v=Ae(i,a)?Reflect.get(i,a,d):Reflect.get(window,a),typeof v=="function"){if(Qi(a)||eo(a)||Ae(w,a)||so(v)||t.isExternalGlobalVariable.has(a))return v}else return v;const L=Ae(v,Bn)?v[Bn]:Si(v,window),U=wi(i,a,L);if(U>0){if(U===1)return v;if(U===2)return}return v[Bn]=L,L}}var Ci=Et();function jo(t){return(i,a,d,v)=>{const w=qn(t.isProtectVariable(a)?window:v||i,a,d);if(w>0){if(w===1||w===2)return!1;if(w===3)return!0}if(t.isProtectVariable(a))return Reflect.set(window,a,d);{Ci.triggerSet();const L=Reflect.set(i,a,d,v);if(L&&(t.initComplete&&t.isExternalGlobalVariable.add(a),t.global)){const U=t.global[`${Tn}Methods`];Array.isArray(U)&&U.includes(a)&&t.global[`${Tn}UpdateStack`].forEach(H=>H(a,d))}return L}}}function Fo(t){return(i,a,d)=>{if(Ci.handleDescriptor(d),t.isProtectVariable(a))return Reflect.defineProperty(window,a,d);{const v=Reflect.defineProperty(i,a,d);return t.initComplete&&v&&t.isExternalGlobalVariable.add(a),v}}}function Go(t){return(i,a)=>(Ae(i,a)?(delete i[a],t.initComplete&&t.isExternalGlobalVariable.has(a)&&t.isExternalGlobalVariable.delete(a)):typeof process!="undefined"&&process.env,!0)}function $o(t){return(i,a)=>!(t.isProtectVariable(a)||t.envVariable===a)}var Vo=0,Ho=[fo,Oo,Co,uo,_o,So,Eo,bo,wo],Ti=t=>G(t)?t[Gn]!==void 0:!1,Wo=(t,i)=>(Ti(t)||(t[Gn]=i),t),Xn=class{constructor(t){this.id=Vo++,this.type="vm",this.closed=!0,this.initComplete=!1,this.version="1.14.3",this.hooks=Uo(),this.deferClearEffects=new Set,this.isExternalGlobalVariable=new Set,this.dynamicStyleSheetElementSet=new Set,this.styledComponentCSSRulesMap=new WeakMap,this.optimizeCode="",this.envVariable="__GARFISH_SANDBOX_ENV_VAR__";const i={baseUrl:"",namespace:"",modules:[],fixBaseUrl:!1,disableWith:!1,strictIsolation:!1,el:()=>null,styleScopeId:()=>"",protectVariable:()=>[],insulationVariable:()=>[]};this.options=le(t)?ne(i,t):i;const{loaderOptions:a,protectVariable:d,insulationVariable:v}=this.options;this.loader=new j(a),this.isProtectVariable=Te((d==null?void 0:d())||[]),this.isInsulationVariable=Te((v==null?void 0:v())||[]),this.replaceGlobalVariables={createdList:[],prepareList:[],recoverList:[],overrideList:{}},Yn(this.options),this.start(),Rn.set(this)}start(){this.closed=!1,this.replaceGlobalVariables=this.getModuleData();const{createdList:t,overrideList:i}=this.replaceGlobalVariables;if(this.global=this.createProxyWindow(Object.keys(i)),i&&this.global)for(const a in i)this.global[a]=i[a];t&&t.forEach(a=>a&&a(this.global)),this.options.disableWith||(this.optimizeCode=this.optimizeGlobalMethod()),this.initComplete=!0,this.hooks.lifecycle.stared.emit(this.global)}close(){this.closed||(this.clearEffects(),this.closed=!0,this.global=void 0,this.optimizeCode="",this.initComplete=!1,this.deferClearEffects.clear(),this.isExternalGlobalVariable.clear(),this.dynamicStyleSheetElementSet.clear(),this.replaceGlobalVariables.createdList=[],this.replaceGlobalVariables.prepareList=[],this.replaceGlobalVariables.recoverList=[],this.replaceGlobalVariables.overrideList=[],this.hooks.lifecycle.closed.emit())}reset(){this.close(),this.start()}createProxyWindow(t=[]){const i=_i(window,this.isInsulationVariable,Te(t)),a={get:Bo(this),set:jo(this),defineProperty:Fo(this),deleteProperty:Go(this),getPrototypeOf(){return Object.getPrototypeOf(window)}},d=pi(Cn({},a),{has:$o(this),getPrototypeOf(){return Object.getPrototypeOf(window)}}),v=new Proxy(i,d),w=new Proxy(i,a);return v.self=w,v.window=w,v.globalThis=w,v.__debug_sandbox__=this,fe(()=>{v.top=window.top===window?w:window.top,v.parent=window.parent===window?w:window.parent}),Wo(v,window),v}getModuleData(){var t;const i=[],a=[],d=[],v={},w=Ho.concat((t=this.options.modules)!=null?t:[]);for(const L of w)if(typeof L=="function"){const{recover:U,override:V,created:H,prepare:_e}=L(this)||{};if(U&&i.push(U),H&&a.push(H),_e&&d.push(_e),V)for(const Ue in V)typeof process!="undefined"&&process.env,v[Ue]=V[Ue]}return{recoverList:i,createdList:a,overrideList:v,prepareList:d}}clearEffects(){this.hooks.lifecycle.beforeClearEffect.emit(),this.replaceGlobalVariables.recoverList.forEach(t=>t&&t()),this.deferClearEffects.forEach(t=>t&&t()),this.hooks.lifecycle.afterClearEffect.emit()}optimizeGlobalMethod(t=[]){let i="";const a=to.filter(d=>d&&!this.isProtectVariable(d)&&!t.includes(d)&&Ae(this.global,d));return a.length>0&&(i=a.reduce((d,v)=>`${d} let ${v} = window.${v};`,i),this.global&&(this.global[`${Tn}Methods`]=a,this.global[`${Tn}UpdateStack`]=[]),i+=`window.${Tn}UpdateStack.push(function(k,v){eval(k+"=v")});`),t.length>0&&(i=t.reduce((d,v)=>`${d} let ${v} = ${this.envVariable}.${v};`,i)),i}createExecParams(t,i){const{disableWith:a}=this.options,{prepareList:d,overrideList:v}=this.replaceGlobalVariables;d&&d.forEach(L=>L&&L());const w=Cn({window:this.global},v);if(a)Object.assign(w,i);else{const L=Object.keys(i),U=L.length>0?this.optimizeGlobalMethod(L):this.optimizeCode;t.code=`with(window) {;${U+t.code}
}`,w[this.envVariable]=i}return w}processExecError(t,i,a,d){if(this.hooks.lifecycle.invokeError.emit(t,i,a,d),this.global&&typeof this.global.onerror=="function"){const v=i||this.options.baseUrl,w=t instanceof Error?t.message:String(t);fe(()=>{var L,U;(U=(L=this.global)==null?void 0:L.onerror)==null||U.call(this.global,w,v,null,null,t)})}throw t}execScript(t,i={},a="",d){var v;const w={code:t},{async:L,defer:U}=d||{};this.hooks.lifecycle.beforeInvoke.emit(w,a,i,d);const V=Rt((v=this.global)==null?void 0:v.document,w.code,!1,a,L,U,d==null?void 0:d.originScript);try{const H=this.createExecParams(w,i);w.code+=`
${a?`//# sourceURL=${a}
`:""}`,we(w.code,H,this.global)}catch(H){this.processExecError(H,a,i,d)}finally{Promise.resolve().then(V)}this.hooks.lifecycle.afterInvoke.emit(w,a,i,d)}static getNativeWindow(){let t=window;for(;Ti(t);)t=t[Gn];return t}static canSupport(){let t=!0;if((!window.Proxy||!Array.prototype.includes||!String.prototype.includes)&&(t=!1),t)try{new Function("let a = 666;")}catch(i){t=!1}return t||he('The current environment does not support "vm sandbox",Please use the "snapshot sandbox" instead.'),t}},qo=["onerror","webpackjsonp","__REACT_ERROR_OVERLAY_GLOBAL_HOOK__",(typeof process!="undefined"&&process.env,"")];function Zo(t){if(!Array.isArray(t)){typeof process!="undefined"&&process.env;const i=[];for(const a in t)i.push(t[a]);t=i}return t}function Ko(t,i,a){var d;const v=a.execScript;a.loader=t.loader,a.execScript=(w,L,U,V)=>{const H=[i.appInfo,w,L,U,V];i.hooks.lifecycle.beforeEval.emit(...H);try{const _e=v.call(a,w,Cn(Cn({},L),i.getExecScriptEnv(V==null?void 0:V.noEntry)),U,V);return i.hooks.lifecycle.afterEval.emit(...H),_e}catch(_e){throw i.hooks.lifecycle.errorExecCode.emit(_e,...H),_e}},i.vmSandbox=a,i.global=a.global,i.strictIsolation=(d=a.options.strictIsolation)!=null?d:!1,i.runCode=function(){return v.apply(a,arguments)},i.entryManager.DOMApis&&a.global&&(i.entryManager.DOMApis.document=a.global.document)}function Jo(t){const i=Xn.canSupport();return{name:"browser-vm",version:"1.14.3",afterLoad(d,v){var w,L,U,V;if(!i||!v||(v==null?void 0:v.vmSandbox)||d.sandbox===!1||d.sandbox&&d.sandbox.open===!1||d.sandbox&&d.sandbox.snapshot){(v==null?void 0:v.vmSandbox)&&(v.global=v.vmSandbox.global);return}Ko(t,v,new Xn({namespace:d.name,addSourceList:v.addSourceList.bind(v),baseUrl:v.entryManager.url,modules:Zo(((w=d.sandbox)==null?void 0:w.modules)||[]),fixBaseUrl:Boolean((L=d.sandbox)==null?void 0:L.fixBaseUrl),disableWith:Boolean((U=d.sandbox)==null?void 0:U.disableWith),strictIsolation:Boolean((V=d.sandbox)==null?void 0:V.strictIsolation),el:()=>v.htmlNode,styleScopeId:()=>v.appContainer.id,protectVariable:()=>d.protectVariable||[],insulationVariable:()=>[...qo,...d.insulationVariable||[]].filter(Boolean)}))},beforeUnmount(d,v){v.vmSandbox&&No(v.vmSandbox.dynamicStyleSheetElementSet,v.vmSandbox.styledComponentCSSRulesMap)},afterUnmount(d,v,w){v.vmSandbox&&!w&&v.vmSandbox.reset()},afterMount(d,v){v.vmSandbox&&(zo(v.vmSandbox.dynamicStyleSheetElementSet,v.vmSandbox.styledComponentCSSRulesMap),v.vmSandbox.execScript(`
          if (typeof window.onload === 'function') {
            window.onload.call(window);
          }
        `))}}}function Yo(){return function(t){return t.getGlobalObject=function(){return Xn.getNativeWindow()},t.setGlobalValue=function(i,a){return this.getGlobalObject()[i]=a},t.clearEscapeEffect=function(i,a){const d=this.getGlobalObject();i in d&&(d[i]=a)},Jo(t)}}var Ln,Pn,Xo=class{constructor(){this.listenerMap=new Map}activate(){this.listenerMap.forEach((t,i)=>[...t].forEach(a=>window.addEventListener(i,a))),(!Ln||!Pn)&&(Ln=window.addEventListener,Pn=window.removeEventListener),window.addEventListener=(t,i,a)=>{const d=this.listenerMap.get(t)||[];return this.listenerMap.set(t,[...d,i]),Ln.call(window,t,i,a)},window.removeEventListener=(t,i,a)=>{const d=this.listenerMap.get(t);return d&&d.length&&d.indexOf(i)!==-1&&d.splice(d.indexOf(i),1),Pn.call(window,t,i,a)}}deactivate(){this.listenerMap.forEach((t,i)=>[...t].forEach(a=>window.removeEventListener(i,a))),window.removeEventListener=Pn,window.addEventListener=Ln}};function Qo(t){var i;return t instanceof HTMLStyleElement&&!t.textContent&&((i=t.sheet)==null?void 0:i.cssRules.length)}var bn=class{constructor(t){this.arrDoms=t,this.arrDoms=t}static take(t=document.head){let i;return t.childNodes?i=Array.prototype.slice.call(t.childNodes):i=Array.prototype.slice.call(t),new bn(i)}diff(t){return t?{created:new bn(this.arrDoms.filter(i=>t.arrDoms.indexOf(i)===-1)),removed:new bn(t.arrDoms.filter(i=>this.arrDoms.indexOf(i)===-1))}:{created:new bn([]),removed:new bn([])}}},es=class{constructor(t=document.head){this.dom=t,this.dom=t,this.dynamicStyleSheetElementSet=new Set,this.styledComponentCSSRulesMap=new WeakMap}add(t,i){let a;if(i)a=t;else{const d=bn.take(this.dom).diff(t);a=d.created,i=d.removed}a.arrDoms.reduce((d,v)=>{var w,L;if(d.appendChild(v),v instanceof HTMLStyleElement){const U=this.styledComponentCSSRulesMap.get(v);if(U&&U.length)for(let V=0;V<U.length;V++){const H=U[V];(L=v.sheet)==null||L.insertRule(H.cssText,(w=v.sheet)==null?void 0:w.cssRules.length)}}return d},this.dom),i.arrDoms.reduce((d,v)=>(d.removeChild(v),d),this.dom)}remove(t,i){let a;if(i)a=t;else{const d=bn.take(this.dom).diff(t);a=d.created,i=d.removed}a.arrDoms.reduce((d,v)=>{var w;return v instanceof HTMLStyleElement&&Qo(v)&&((w=v==null?void 0:v.sheet)==null?void 0:w.cssRules)&&this.styledComponentCSSRulesMap.set(v,v.sheet.cssRules),d.removeChild(v),d},this.dom),i.arrDoms.reduce((d,v)=>(d.appendChild(v),d),this.dom)}},ts=class{constructor(){this.headInterceptor=new es(document.head)}activate(){this.domSnapshotBefore=bn.take(),this.domSnapshotMutated&&this.headInterceptor.add(this.domSnapshotMutated.created,this.domSnapshotMutated.removed)}deactivate(){const t=bn.take();this.domSnapshotMutated=t.diff(this.domSnapshotBefore),!!this.domSnapshotMutated&&this.headInterceptor.remove(this.domSnapshotMutated.created,this.domSnapshotMutated.removed)}formateCtx(t){const i={style:[],script:[],other:[]};return t.forEach(a=>{let d="other";/css/.test(a.type)&&(d="style"),/javascript/.test(a.type)&&(d="script"),i[d].push({src:a.src,outerHTML:a.outerHTML,content:a.innerText})}),i}},Qn,ei,rs=class{activate(){(!Qn||!ei)&&(Qn=window.history.pushState,ei=window.history.replaceState)}deactivate(){window.history.pushState=Qn,window.history.replaceState=ei}},Ri=window.setInterval,Mi=window.clearInterval,ns=class{constructor(){this.intervals=[]}activate(){window.setInterval=(t,i,...a)=>{const d=Ri(t,i,...a);return this.intervals=[...this.intervals,d],d},window.clearInterval=t=>(this.intervals=this.intervals.filter(i=>i!==t),Mi(t))}deactivate(t){t&&this.intervals.forEach(i=>window.clearInterval(i)),window.setInterval=Ri,window.clearInterval=Mi}},is=Object.prototype.hasOwnProperty;function os(t,i){return is.call(t,i)}var ss=class{constructor(t=typeof window!="undefined"?window:globalThis,i=[]){this.targetToProtect=t,this.protectVariable=i,this.snapshotOriginal=new Map,this.snapshotMutated=new Map,this.whiteList=["location","addEventListener","removeEventListener","webpackJsonp"],this.targetToProtect=t,this.protectVariable=i,this.whiteList=[...this.whiteList,...i]}safeIterator(t){for(const i in this.targetToProtect){if(this.whiteList.indexOf(i)!==-1)continue;const a=Object.getOwnPropertyDescriptor(this.targetToProtect,i);!a||!a.writable||os(this.targetToProtect,i)&&t(i)}}activate(){this.safeIterator(t=>{this.snapshotOriginal.set(t,this.targetToProtect[t])}),this.snapshotMutated.forEach((t,i)=>{this.targetToProtect[i]=this.snapshotMutated.get(i)})}deactivate(){const t={},i={},a={};this.safeIterator(d=>{this.snapshotOriginal.get(d)!==this.targetToProtect[d]&&(this.snapshotMutated.set(d,this.targetToProtect[d]),this.targetToProtect[d]=this.snapshotOriginal.get(d),this.targetToProtect[d]===void 0?a[d]=this.snapshotMutated.get(d):i[d]=this.snapshotMutated.get(d)),this.snapshotOriginal.delete(d)}),this.snapshotOriginal.forEach((d,v)=>{this.snapshotMutated.set(v,this.targetToProtect[v]),this.targetToProtect[v]=this.snapshotOriginal.get(v),t[v]=this.targetToProtect[v]})}},as=class{activate(){this.preWebpackJsonp=window.webpackJsonp,window.webpackJsonp=this.currentWebpackJsonp}deactivate(){this.currentWebpackJsonp=window.webpackJsonp,window.webpackJsonp=this.preWebpackJsonp}},cs=class{constructor(t,i=[],a=typeof window!="undefined"?window:globalThis,d=typeof window!="undefined"){this.name=t,this.protectVariable=i,this.targetToProtect=a,this.isInBrowser=d,this.type="snapshot",this.isRunning=!1,this.patchList=[],this.name=t,this.isInBrowser=d,this.patchList.push(new ss(a,i)),this.isInBrowser&&(this.patchList=[...this.patchList,new ts,new Xo,new rs,new ns,new as])}activate(){this.isRunning||(this.patchList.forEach(t=>{t.activate()}),this.isRunning=!0)}deactivate(t=!0){!this.isRunning||([...this.patchList].reverse().forEach(i=>{i.deactivate(t)}),this.isRunning=!1)}};function ls(t){return function(i){const a={openBrowser:!1,version:"1.14.3",name:"browser-snapshot",afterLoad(d,v){var w;const L=t||{open:!0},U=d.sandbox||((w=i==null?void 0:i.options)==null?void 0:w.sandbox);if((U===!1||U.open===!1||(U==null?void 0:U.snapshot)===!1)&&(L.open=!1),U&&(L.protectVariable=[...(i==null?void 0:i.options.protectVariable)||[],...d.protectVariable||[]]),a.openBrowser=!!L.open,!!L.open&&v){if(v.snapshotSandbox)return;const V=new cs(d.name,L.protectVariable);v.snapshotSandbox=V}},beforeMount(d,v){!v.snapshotSandbox||v.snapshotSandbox.activate()},afterUnmount(d,v){!v.snapshotSandbox||v.snapshotSandbox.deactivate()}};return a}}function us(){let t=!1;if(x()&&window.__GARFISH__&&window.Garfish)return window.Garfish;const i=new Dr({plugins:[Hi(),Yo(),ls()]}),a=(d,v=i)=>{if(Ae(window,d)){if(!(window[d]&&window[d].flag===cr)){const w=()=>{t=!0,typeof process!="undefined"&&process.env},L=Object.getOwnPropertyDescriptor(window,d);L&&(L.configurable?(ge(window,d,v),w()):L.writable&&(window[d]=v,w()))}}else t=!0,ge(window,d,v)};return x()&&(a("Garfish"),ge(window,"__GARFISH__",!0)),t&&typeof process!="undefined"&&process.env,i}var ti=us();function fs(t,i){class a extends HTMLElement{constructor(){super();this.appInfo={name:"",entry:"",basename:""},this.options={delay:200},this.state=this._observerAppState({isLoading:!1,error:null,promise:null,loaded:null,pastDelay:!1}),this.options=i}_observerAppState(v){return new Proxy(v,{set:(w,L,U,V)=>{const H=()=>{this.placeholder&&this.contains(this.placeholder)&&this.removeChild(this.placeholder);const Ue=this.options.loading&&this.options.loading({isLoading:this.state.isLoading,error:this.state.error,pastDelay:this.state.pastDelay});return Ue&&this.appendChild(Ue),Ue},_e=Reflect.set(w,L,U,V);if(L==="error"&&U){const Ue=H();Ue&&(this.placeholder=Ue)}else if(L==="pastDelay"&&U===!0){const Ue=H();Ue&&(this.placeholder=Ue)}else if(L==="isLoading"&&U===!0){const Ue=H();Ue&&(this.placeholder=Ue)}else L==="isLoading"&&U===!1&&!this.state.error&&this.contains(this.placeholder)&&this.removeChild(this.placeholder);return _e}})}_loadApp(){this.state.isLoading||(this.state.isLoading=!0,typeof this.options.delay=="number"&&(this.options.delay===0?this.state.pastDelay=!0:this._delay=setTimeout(()=>{this.state.pastDelay=!0},this.options.delay)),this.state.promise=ti.loadApp(this.appInfo.name,{entry:this.appInfo.entry,domGetter:()=>this,basename:this.appInfo.basename,sandbox:{snapshot:!1,strictIsolation:this.hasAttribute("shadow")||!1}}))}_clearTimeouts(){clearTimeout(this._delay)}connectedCallback(){return sr(this,null,function*(){this.appInfo={name:this.getAttribute("name")||"",entry:this.getAttribute("entry")||"",basename:this.getAttribute("basename")||"/"};try{this._loadApp(),this.state.loaded=yield this.state.promise,this.state.loaded.mounted?this.state.loaded.show():yield this.state.loaded.mount()}catch(v){this.state.error=v}finally{this.state.isLoading=!1}})}disconnectedCallback(){this._clearTimeouts(),this.state.loaded&&this.state.loaded.hide()}adoptedCallback(){return sr(this,null,function*(){})}attributeChangedCallback(v,w,L){console.log("Custom square element attributes changed.",v,w,L)}}customElements.get(t)||(ti.run(i.config||{}),customElements.define(t,a))}function ds(t,i){if(typeof t!="string")throw new Error("garfish requires a `htmlTag` name");if(!i.loading)throw new Error("garfish requires a `loading` component");const a=Object.assign({loading:!1,delay:200,timeout:null},i);return fs(t,a)}function hs(t,i){return ds(t,i)}}}]);

//# sourceMappingURL=garfish_52a4e48e.js.map